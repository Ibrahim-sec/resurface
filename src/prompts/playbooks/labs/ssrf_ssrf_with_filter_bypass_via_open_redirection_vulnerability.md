## SSRF with filter bypass via open redirection vulnerability

**Category:** ssrf
**Difficulty:** Unknown

### Description
This lab has a stock check feature which fetches data from an internal system.

### Solution Steps
1. Visit a product, click "Check stock", intercept the request in Burp Suite, and send it to Burp Repeater.
2. Try tampering with the stockApi parameter and observe that it isn't possible to make the server issue the request directly to a different host.
3. Click "next product" and observe that the path parameter is placed into the Location header of a redirection response, resulting in an open redirection.
4. Create a URL that exploits the open redirection vulnerability, and redirects to the admin interface, and feed this into the stockApi parameter on the stock checker: /product/nextProduct?path=http://192.168.0.12:8080/admin
5. Observe that the stock checker follows the redirection and shows you the admin page.
6. Amend the path to delete the target user: /product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos

### Key Payloads
- `http://192.168.0.12:8080/admin`
- `carlos`
- `stockApi`
- `path`
- `/product/nextProduct?path=http://192.168.0.12:8080/admin`
- `/product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos`

### Indicators of Success
- Internal IP/port responds through application
- Cloud metadata endpoint accessed (169.254.169.254)
- DNS lookup to attacker server received
- Internal services enumerated
- Localhost/127.0.0.1 accessible
---
*Source: PortSwigger Web Security Academy*
