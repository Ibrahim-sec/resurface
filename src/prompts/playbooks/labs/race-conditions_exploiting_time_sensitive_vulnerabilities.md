## Exploiting time-sensitive vulnerabilities

**Category:** race_condition
**Difficulty:** Unknown

### Description
This lab contains a password reset mechanism. Although it doesn't contain a race condition, you can exploit the mechanism's broken cryptography by sending carefully timed requests.

### Solution Steps
1. Study the password reset process by submitting a password reset for your own account and observe that you're sent an email containing a reset link. The query string of this link includes your username and a token.
2. Send the POST /forgot-password request to Burp Repeater.
3. In Repeater, send the request a few times, then check your inbox again.
4. Observe that every reset request results in a link with a different token.
5. Consider the following: The token is of a consistent length. This suggests that it's either a randomly generated string with a fixed number of characters, or could be a hash of some unknown data, which may be predictable. The fact that the token is different each time indicates that, if it is in fact a hash digest, it must contain some kind of internal state, such as an RNG, a counter, or a timestamp.
6. Duplicate the Repeater tab and add both tabs to a new group. For details on how to do this, see Creating a new tab group
7. Send the pair of reset requests in parallel a few times.  For details on how to do this, see Sending requests in parallel .
8. Observe that there is still a significant delay between each response and that you still get a different token in each confirmation email. Infer that your requests are still being processed in sequence rather than concurrently.

### Key Payloads
- `carlos`
- `wiener:peter`
- `POST /forgot-password`
- `GET /forgot-password`
- `POST`
- `username`

### Indicators of Success
- Check for changes in application behavior
- Look for error messages or data exposure
- Verify the vulnerability type: race_condition

---
*Source: PortSwigger Web Security Academy*
