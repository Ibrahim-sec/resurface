## Exploiting Ruby deserialization using a documented gadget chain

**Category:** deserialization
**Difficulty:** Expert

### Description
This lab uses a serialization-based session mechanism and the Ruby on Rails framework. There are documented exploits that enable remote code execution via a gadget chain in this framework.

### Solution Steps
1. Login with provided credentials and capture the session cookie
2. Identify that the session cookie is a serialized Ruby object (Base64 decode it)
3. Search for "Universal Deserialisation Gadget for Ruby 2.x-3.x" by vakzz on devcraft.io
4. Download or recreate the gadget chain script that generates malicious serialized objects
5. Modify the payload to execute your desired command: `rm /home/carlos/morale.txt`
6. Generate the malicious serialized payload using: `puts Base64.encode64(payload)`
7. Replace the session cookie value with your malicious Base64-encoded payload
8. Send a request with the poisoned cookie to trigger deserialization
9. The server deserializes the object, triggering the gadget chain and executing your command
10. Verify the file was deleted to confirm RCE

### Key Payloads
- `morale.txt`
- `Universal Deserialisation Gadget for Ruby 2.x-3.x`
- `vakzz`
- `devcraft.io`
- `rm /home/carlos/morale.txt`
- `puts Base64.encode64(payload)`

### Indicators of Success
- Server processes the malicious cookie without error
- Target file (/home/carlos/morale.txt) is deleted
- No deserialization error in response
- Command execution confirmed via side effects or out-of-band callback

---
*Source: PortSwigger Web Security Academy*
