## Exploiting server-side parameter pollution in a REST URL

**Category:** api
**Difficulty:** Unknown

### Description
To solve the lab, log in as theadministratorand deletecarlos.

### Solution Steps
1. In Burp's browser, trigger a password reset for the administrator user.
2. In Proxy > HTTP history , notice the POST /forgot-password request and the related /static/js/forgotPassword.js JavaScript file.
3. Right-click the POST /forgot-password request and select Send to Repeater .
4. In the Repeater tab, resend the request to confirm that the response is consistent.
5. Send a variety of requests with a modified username parameter value to determine whether the input is placed in the URL path of a server-side request without escaping: Submit URL-encoded administrator# as the value of the username parameter. Notice that this returns an Invalid route error message. This suggests that the server may have placed the input in the path of a server-side request, and that the fragment has truncated some trailing data. Observe that the message also refers to an API definition. Change the value of the username parameter from administrator%23 to URL-encoded administrator? , then send the request. Notice that this also returns an Invalid route error message. This suggests that the input may be placed in a URL path, as the ? character indicates the start of the query string and therefore truncates the URL path. Change the value of the username parameter from administrator%3F to ./administrator then send the
                                        request. Notice that this returns the original response. This suggests that the request may have accessed the same URL path as the original request. This further indicates that the input may be placed in the URL path. Change the value of the username parameter from ./administrator to ../administrator , then send the request. Notice that this returns an Invalid route error message. This suggests that the request may have accessed an invalid URL path.

### Key Payloads
- `administrator`
- `carlos`
- `POST /forgot-password`
- `/static/js/forgotPassword.js`
- `administrator#`
- `username`
- `Invalid route`
- `administrator%23`
- `administrator?`
- `administrator%3F`

### Indicators of Success
- Hidden API endpoints discovered
- Parameter pollution successful
- Mass assignment exploited
- API documentation exposed
- Authorization bypass via API
---
*Source: PortSwigger Web Security Academy*
