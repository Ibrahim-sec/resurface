## Exploiting XInclude to retrieve files

**Category:** xxe
**Difficulty:** Unknown

### Description
This lab has a "Check stock" feature that embeds the user input inside a server-side XML document that is subsequently parsed.

### Solution Steps
By default,
XInclude
will try to parse the included document as XML. Since
/etc/passwd
isn't valid XML, you will need to add an extra attribute to the
XInclude
directive to change this behavior.

### Key Payloads
- `XInclude`
- `/etc/passwd`
- `productId`
- `<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>`

### Indicators of Success
- External entity resolved
- Local file contents returned (/etc/passwd)
- DNS/HTTP callback received (blind XXE)
- DTD fetched from external server
- Error messages reveal file contents
---
*Source: PortSwigger Web Security Academy*
