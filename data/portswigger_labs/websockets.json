[
  {
    "url": "https://portswigger.net/web-security/websockets/lab-manipulating-handshake-to-exploit-vulnerabilities",
    "category": "websockets",
    "title": "Manipulating the WebSocket handshake to exploit vulnerabilities",
    "description": "This online shop has a live chat feature implemented using WebSockets.",
    "solution": "If you're struggling to bypass the XSS filter, try out our\nXSS labs\n.\nSometimes you can bypass IP-based restrictions using HTTP headers like\nX-Forwarded-For\n.",
    "payloads": [
      "alert()",
      "X-Forwarded-For",
      "<img src=1 onerror='alert(1)'>",
      "X-Forwarded-For: 1.1.1.1",
      "<img src=1 oNeRrOr=alert`1`>"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/websockets/lab-manipulating-messages-to-exploit-vulnerabilities",
    "category": "websockets",
    "title": "Manipulating WebSocket messages to exploit vulnerabilities",
    "description": "This online shop has a live chat feature implemented using WebSockets.",
    "solution_steps": [
      "Click \"Live chat\" and send a chat message.",
      "In Burp Proxy, go to the WebSockets history tab, and observe that the chat message has been sent via a WebSocket message.",
      "Using the browser, send a new message containing a < character.",
      "In Burp Proxy, find the corresponding WebSocket message and observe that the < has been HTML-encoded by the client before sending.",
      "Ensure that Burp Proxy is configured to intercept WebSocket messages, then send another chat message.",
      "Edit the intercepted message to contain the following payload: <img src=1 onerror='alert(1)'>",
      "Observe that an alert is triggered in the browser. This will also happen in the support agent's browser."
    ],
    "solution": "1. Click \"Live chat\" and send a chat message.\n2. In Burp Proxy, go to the WebSockets history tab, and observe that the chat message has been sent via a WebSocket message.\n3. Using the browser, send a new message containing a < character.\n4. In Burp Proxy, find the corresponding WebSocket message and observe that the < has been HTML-encoded by the client before sending.\n5. Ensure that Burp Proxy is configured to intercept WebSocket messages, then send another chat message.\n6. Edit the intercepted message to contain the following payload: <img src=1 onerror='alert(1)'>\n7. Observe that an alert is triggered in the browser. This will also happen in the support agent's browser.",
    "payloads": [
      "alert()",
      "<img src=1 onerror='alert(1)'>"
    ]
  }
]