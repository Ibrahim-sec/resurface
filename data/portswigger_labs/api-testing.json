[
  {
    "url": "https://portswigger.net/web-security/api-testing/lab-exploiting-api-endpoint-using-documentation",
    "category": "api-testing",
    "title": "Exploiting an API endpoint using documentation",
    "description": "To solve the lab, find the exposed API documentation and deletecarlos. You can log in to your own account using the following credentials:wiener:peter.",
    "solution_steps": [
      "In Burp's browser, log in to the application using the credentials wiener:peter and update your email address.",
      "In Proxy > HTTP history , right-click the PATCH /api/user/wiener request and select Send to Repeater .",
      "Go to the Repeater tab. Send the PATCH /api/user/wiener request. Notice that this retrieves credentials for the user wiener .",
      "Remove /wiener from the path of the request, so the endpoint is now /api/user , then send the request. Notice that this returns an error because there is no user identifier.",
      "Remove /user from the path of the request, so the endpoint is now /api , then send the request. Notice that this retrieves API documentation.",
      "Right-click the response and select Show response in browser . Copy the URL.",
      "Paste the URL into Burp's browser to access the documentation. Notice that the documentation is interactive.",
      "To delete Carlos and solve the lab, click on the DELETE row, enter carlos , then click Send request ."
    ],
    "solution": "1. In Burp's browser, log in to the application using the credentials wiener:peter and update your email address.\n2. In Proxy > HTTP history , right-click the PATCH /api/user/wiener request and select Send to Repeater .\n3. Go to the Repeater tab. Send the PATCH /api/user/wiener request. Notice that this retrieves credentials for the user wiener .\n4. Remove /wiener from the path of the request, so the endpoint is now /api/user , then send the request. Notice that this returns an error because there is no user identifier.\n5. Remove /user from the path of the request, so the endpoint is now /api , then send the request. Notice that this retrieves API documentation.\n6. Right-click the response and select Show response in browser . Copy the URL.\n7. Paste the URL into Burp's browser to access the documentation. Notice that the documentation is interactive.\n8. To delete Carlos and solve the lab, click on the DELETE row, enter carlos , then click Send request .",
    "payloads": [
      "carlos",
      "wiener:peter",
      "PATCH /api/user/wiener",
      "wiener",
      "/wiener",
      "/api/user",
      "/user",
      "/api",
      "DELETE"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/api-testing/lab-exploiting-mass-assignment-vulnerability",
    "category": "api-testing",
    "title": "Exploiting a mass assignment vulnerability",
    "description": "To solve the lab, find and exploit a mass assignment vulnerability to buy aLightweight l33t Leather Jacket. You can log in to your own account using the following credentials:wiener:peter.",
    "solution_steps": [
      "In Burp's browser, log in to the application using the credentials wiener:peter .",
      "Click on the Lightweight \"l33t\" Leather Jacket product and add it to your basket.",
      "Go to your basket and click Place order . Notice that you don't have enough credit for the purchase.",
      "In Proxy > HTTP history , notice both the GET and POST API requests for /api/checkout .",
      "Notice that the response to the GET request contains the same JSON structure as the POST request. Observe that the JSON structure in the GET response includes a chosen_discount parameter, which is not present in the POST request.",
      "Right-click the POST /api/checkout request and select Send to Repeater .",
      "In Repeater, add the chosen_discount parameter to the request. The JSON should look like the following: {\n    \"chosen_discount\":{\n        \"percentage\":0\n    },\n    \"chosen_products\":[\n        {\n            \"product_id\":\"1\",\n            \"quantity\":1\n        }\n    ]\n}",
      "Send the request. Notice that adding the chosen_discount parameter doesn't cause an error.",
      "Change the chosen_discount value to the string \"x\" , then send the request. Observe that this results in an error message as the parameter value isn't a number. This may indicate that the user input is being processed.",
      "Change the chosen_discount percentage to 100 , then send the request to solve the lab."
    ],
    "solution": "1. In Burp's browser, log in to the application using the credentials wiener:peter .\n2. Click on the Lightweight \"l33t\" Leather Jacket product and add it to your basket.\n3. Go to your basket and click Place order . Notice that you don't have enough credit for the purchase.\n4. In Proxy > HTTP history , notice both the GET and POST API requests for /api/checkout .\n5. Notice that the response to the GET request contains the same JSON structure as the POST request. Observe that the JSON structure in the GET response includes a chosen_discount parameter, which is not present in the POST request.\n6. Right-click the POST /api/checkout request and select Send to Repeater .\n7. In Repeater, add the chosen_discount parameter to the request. The JSON should look like the following: {\n    \"chosen_discount\":{\n        \"percentage\":0\n    },\n    \"chosen_products\":[\n        {\n            \"product_id\":\"1\",\n            \"quantity\":1\n        }\n    ]\n}\n8. Send the request. Notice that adding the chosen_discount parameter doesn't cause an error.\n9. Change the chosen_discount value to the string \"x\" , then send the request. Observe that this results in an error message as the parameter value isn't a number. This may indicate that the user input is being processed.\n10. Change the chosen_discount percentage to 100 , then send the request to solve the lab.",
    "payloads": [
      "wiener:peter",
      "POST",
      "/api/checkout",
      "chosen_discount",
      "POST /api/checkout",
      "{\n    \"chosen_discount\":{\n        \"percentage\":0\n    },\n    \"chosen_products\":[\n        {\n            \"product_id\":\"1\",\n            \"quantity\":1\n        }\n    ]\n}"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/api-testing/lab-exploiting-unused-api-endpoint",
    "category": "api-testing",
    "title": "Finding and exploiting an unused API endpoint",
    "description": "To solve the lab, exploit a hidden API endpoint to buy aLightweight l33t Leather Jacket. You can log in to your own account using the following credentials:wiener:peter.",
    "solution_steps": [
      "In Burp's browser, access the lab and click on a product.",
      "In Proxy > HTTP history , notice the API request for the product. For example, /api/products/3/price .",
      "Right-click the API request and select Send to Repeater .",
      "In the Repeater tab, change the HTTP method for the API request from GET to OPTIONS , then send the request. Notice that the response specifies that the GET and PATCH methods are allowed.",
      "Change the method for the API request from GET to PATCH , then send the request. Notice that you receive an Unauthorized message. This may indicate that you need to be authenticated to update the order.",
      "In Burp's browser, log in to the application using the credentials wiener:peter .",
      "Click on the Lightweight \"l33t\" Leather Jacket product.",
      "In Proxy > HTTP history , right-click the API/products/1/price request for the leather jacket and select Send to Repeater .",
      "In the Repeater tab, change the method for the API request from GET to PATCH , then send the request. Notice that this causes an error due to an incorrect Content-Type . The error message specifies that the Content-Type should be application/json .",
      "Add a Content-Type header and set the value to application/json .",
      "Add an empty JSON object {} as the request body, then send the request. Notice that this causes an error due to the request body missing a price parameter.",
      "Add a price parameter with a value of 0 to the JSON object {\"price\":0} . Send the request.",
      "In Burp's browser, reload the leather jacket product page. Notice that the price of the leather jacket is now $0.00 .",
      "Add the leather jacket to your basket.",
      "Go to your basket and click Place order to solve the lab."
    ],
    "solution": "1. In Burp's browser, access the lab and click on a product.\n2. In Proxy > HTTP history , notice the API request for the product. For example, /api/products/3/price .\n3. Right-click the API request and select Send to Repeater .\n4. In the Repeater tab, change the HTTP method for the API request from GET to OPTIONS , then send the request. Notice that the response specifies that the GET and PATCH methods are allowed.\n5. Change the method for the API request from GET to PATCH , then send the request. Notice that you receive an Unauthorized message. This may indicate that you need to be authenticated to update the order.\n6. In Burp's browser, log in to the application using the credentials wiener:peter .\n7. Click on the Lightweight \"l33t\" Leather Jacket product.\n8. In Proxy > HTTP history , right-click the API/products/1/price request for the leather jacket and select Send to Repeater .\n9. In the Repeater tab, change the method for the API request from GET to PATCH , then send the request. Notice that this causes an error due to an incorrect Content-Type . The error message specifies that the Content-Type should be application/json .\n10. Add a Content-Type header and set the value to application/json .\n11. Add an empty JSON object {} as the request body, then send the request. Notice that this causes an error due to the request body missing a price parameter.\n12. Add a price parameter with a value of 0 to the JSON object {\"price\":0} . Send the request.\n13. In Burp's browser, reload the leather jacket product page. Notice that the price of the leather jacket is now $0.00 .\n14. Add the leather jacket to your basket.\n15. Go to your basket and click Place order to solve the lab.",
    "payloads": [
      "wiener:peter",
      "/api/products/3/price",
      "OPTIONS",
      "PATCH",
      "Unauthorized",
      "API/products/1/price",
      "Content-Type",
      "application/json",
      "price",
      "{\"price\":0}",
      "$0.00"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/api-testing/server-side-parameter-pollution/lab-exploiting-server-side-parameter-pollution-in-query-string",
    "category": "api-testing",
    "title": "Exploiting server-side parameter pollution in a query string",
    "description": "To solve the lab, log in as theadministratorand deletecarlos.",
    "solution_steps": [
      "In Burp's browser, trigger a password reset for the administrator user.",
      "In Proxy > HTTP history , notice the POST /forgot-password request and the related /static/js/forgotPassword.js JavaScript file.",
      "Right-click the POST /forgot-password request and select Send to\n                                    Repeater .",
      "In the Repeater tab, resend the request to confirm that the response is consistent.",
      "Change the value of the username parameter from administrator to an invalid username, such as administratorx . Send the request. Notice that this results in an Invalid username error message.",
      "Attempt to add a second parameter-value pair to the server-side request using a URL-encoded & character. For example, add URL-encoded &x=y : username=administrator%26x=y Send the request. Notice that this returns a Parameter is not supported error message. This suggests that the internal API may have interpreted &x=y as a separate parameter, instead of part of the username.",
      "Attempt to truncate the server-side query string using a URL-encoded # character: username=administrator%23 Send the request. Notice that this returns a Field not specified error message. This suggests that the server-side query may include an additional parameter called field , which has been removed by the # character.",
      "Add a field parameter with an invalid value to the request. Truncate the query string after the added parameter-value pair. For example, add URL-encoded &field=x# : username=administrator%26field=x%23 Send the request. Notice that this results in an Invalid field error message. This suggests that the server-side application may recognize the injected field parameter.",
      "Brute-force the value of the field parameter: Right-click the POST /forgot-password request and select Send to Intruder . In the Intruder tab, add a payload position to the value of the field parameter as follows: username=administrator%26field=\u00a7x\u00a7%23 In the Payloads side panel, under Payload configuration , click Add from list . Select the built-in Server-side variable names payload list, then start the attack. Review the results. Notice that the requests with the username and email payloads both return a 200 response.",
      "Change the value of the field parameter from x# to email : username=administrator%26field=email%23 Send the request. Notice that this returns the original response. This suggests that email is a valid field type.",
      "In Proxy > HTTP history , review the /static/js/forgotPassword.js JavaScript file. Notice the password reset endpoint, which refers to the reset_token parameter: /forgot-password?reset_token=${resetToken}",
      "In the Repeater tab, change the value of the field parameter from email to reset_token : username=administrator%26field=reset_token%23 Send the request. Notice that this returns a password reset token. Make a note of this.",
      "In Burp's browser, enter the password reset endpoint in the address bar. Add your password reset token as the value of the reset_token parameter . For example: /forgot-password?reset_token=123456789",
      "Set a new password.",
      "Log in as the administrator user using your password.",
      "Go to the Admin panel and delete carlos to solve the lab."
    ],
    "solution": "1. In Burp's browser, trigger a password reset for the administrator user.\n2. In Proxy > HTTP history , notice the POST /forgot-password request and the related /static/js/forgotPassword.js JavaScript file.\n3. Right-click the POST /forgot-password request and select Send to\n                                    Repeater .\n4. In the Repeater tab, resend the request to confirm that the response is consistent.\n5. Change the value of the username parameter from administrator to an invalid username, such as administratorx . Send the request. Notice that this results in an Invalid username error message.\n6. Attempt to add a second parameter-value pair to the server-side request using a URL-encoded & character. For example, add URL-encoded &x=y : username=administrator%26x=y Send the request. Notice that this returns a Parameter is not supported error message. This suggests that the internal API may have interpreted &x=y as a separate parameter, instead of part of the username.\n7. Attempt to truncate the server-side query string using a URL-encoded # character: username=administrator%23 Send the request. Notice that this returns a Field not specified error message. This suggests that the server-side query may include an additional parameter called field , which has been removed by the # character.\n8. Add a field parameter with an invalid value to the request. Truncate the query string after the added parameter-value pair. For example, add URL-encoded &field=x# : username=administrator%26field=x%23 Send the request. Notice that this results in an Invalid field error message. This suggests that the server-side application may recognize the injected field parameter.\n9. Brute-force the value of the field parameter: Right-click the POST /forgot-password request and select Send to Intruder . In the Intruder tab, add a payload position to the value of the field parameter as follows: username=administrator%26field=\u00a7x\u00a7%23 In the Payloads side panel, under Payload configuration , click Add from list . Select the built-in Server-side variable names payload list, then start the attack. Review the results. Notice that the requests with the username and email payloads both return a 200 response.\n10. Change the value of the field parameter from x# to email : username=administrator%26field=email%23 Send the request. Notice that this returns the original response. This suggests that email is a valid field type.\n11. In Proxy > HTTP history , review the /static/js/forgotPassword.js JavaScript file. Notice the password reset endpoint, which refers to the reset_token parameter: /forgot-password?reset_token=${resetToken}\n12. In the Repeater tab, change the value of the field parameter from email to reset_token : username=administrator%26field=reset_token%23 Send the request. Notice that this returns a password reset token. Make a note of this.\n13. In Burp's browser, enter the password reset endpoint in the address bar. Add your password reset token as the value of the reset_token parameter . For example: /forgot-password?reset_token=123456789\n14. Set a new password.\n15. Log in as the administrator user using your password.\n16. Go to the Admin panel and delete carlos to solve the lab.",
    "payloads": [
      "administrator",
      "carlos",
      "POST /forgot-password",
      "/static/js/forgotPassword.js",
      "username",
      "administratorx",
      "Invalid username",
      "&x=y",
      "username=administrator%26x=y",
      "Parameter is not supported",
      "username=administrator%23",
      "Field not specified",
      "field",
      "&field=x#",
      "username=administrator%26field=x%23"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/api-testing/server-side-parameter-pollution/lab-exploiting-server-side-parameter-pollution-in-rest-url",
    "category": "api-testing",
    "title": "Exploiting server-side parameter pollution in a REST URL",
    "description": "To solve the lab, log in as theadministratorand deletecarlos.",
    "solution_steps": [
      "In Burp's browser, trigger a password reset for the administrator user.",
      "In Proxy > HTTP history , notice the POST /forgot-password request and the related /static/js/forgotPassword.js JavaScript file.",
      "Right-click the POST /forgot-password request and select Send to Repeater .",
      "In the Repeater tab, resend the request to confirm that the response is consistent.",
      "Send a variety of requests with a modified username parameter value to determine whether the input is placed in the URL path of a server-side request without escaping: Submit URL-encoded administrator# as the value of the username parameter. Notice that this returns an Invalid route error message. This suggests that the server may have placed the input in the path of a server-side request, and that the fragment has truncated some trailing data. Observe that the message also refers to an API definition. Change the value of the username parameter from administrator%23 to URL-encoded administrator? , then send the request. Notice that this also returns an Invalid route error message. This suggests that the input may be placed in a URL path, as the ? character indicates the start of the query string and therefore truncates the URL path. Change the value of the username parameter from administrator%3F to ./administrator then send the\n                                        request. Notice that this returns the original response. This suggests that the request may have accessed the same URL path as the original request. This further indicates that the input may be placed in the URL path. Change the value of the username parameter from ./administrator to ../administrator , then send the request. Notice that this returns an Invalid route error message. This suggests that the request may have accessed an invalid URL path."
    ],
    "solution": "1. In Burp's browser, trigger a password reset for the administrator user.\n2. In Proxy > HTTP history , notice the POST /forgot-password request and the related /static/js/forgotPassword.js JavaScript file.\n3. Right-click the POST /forgot-password request and select Send to Repeater .\n4. In the Repeater tab, resend the request to confirm that the response is consistent.\n5. Send a variety of requests with a modified username parameter value to determine whether the input is placed in the URL path of a server-side request without escaping: Submit URL-encoded administrator# as the value of the username parameter. Notice that this returns an Invalid route error message. This suggests that the server may have placed the input in the path of a server-side request, and that the fragment has truncated some trailing data. Observe that the message also refers to an API definition. Change the value of the username parameter from administrator%23 to URL-encoded administrator? , then send the request. Notice that this also returns an Invalid route error message. This suggests that the input may be placed in a URL path, as the ? character indicates the start of the query string and therefore truncates the URL path. Change the value of the username parameter from administrator%3F to ./administrator then send the\n                                        request. Notice that this returns the original response. This suggests that the request may have accessed the same URL path as the original request. This further indicates that the input may be placed in the URL path. Change the value of the username parameter from ./administrator to ../administrator , then send the request. Notice that this returns an Invalid route error message. This suggests that the request may have accessed an invalid URL path.",
    "payloads": [
      "administrator",
      "carlos",
      "POST /forgot-password",
      "/static/js/forgotPassword.js",
      "administrator#",
      "username",
      "Invalid route",
      "administrator%23",
      "administrator?",
      "administrator%3F",
      "./administrator",
      "../administrator",
      "../%23",
      "../../../../%23",
      "Not found"
    ]
  }
]