{
  "id": "2216",
  "title": "Sonium Enterprise Adressbook 0.2 - &#039;folder&#039; Include",
  "cve": "CVE-2006-4311",
  "vuln_type": "unknown",
  "code": "+--------------------------------------------------------------------\r\n+\r\n+ Sonium Enterprise Adressbook Version 0.2 (folder) RFI\r\n+\r\n+ Original advisory:\r\n+ http://www.bb-pcsecurity.de/Websecurity/342/org/Sonium_Enterprise_Adressbook_Version_0.2_(folder)_RFI.htm\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Affected Software .: Sonium Enterprise Adressbook Version 0.2\r\n+ Venedor ...........: http://www.sonium-php.de\r\n+ Class .............: Remote File Inclusion\r\n+ Risk ..............: high (Remote File Execution)\r\n+ Found by ..........: Philipp Niedziela\r\n+ Contact ...........: webmaster[at]bb-pcsecurity[.]de\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Affected Files:\r\n+ /plugins/*.php (not config.php)\r\n+\r\n+ First lines of all these scripts:\r\n+ .....\r\n+     include(\"$folder/config.php\");\r\n+ .....\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ $folder is not properly sanitized before being used\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Solution:\r\n+ Deny direct access to all files in folder \"plugins\"\r\n+ or modify code:\r\n+\r\n+ if(!isset($_REQUEST['folder']) && !isset($_GET['folder']) &&\r\n!isset($_POST['folder'])){\r\n+  //code of org. *.php\r\n+ }\r\n+ else {\r\n+  echo \"You cannot access this file directly.\";\r\n+  die();\r\n+ }\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ PoC:\r\n+\r\n+ http://[target]/plugins/1_Adressbuch/delete.php?folder=[script]\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Greets: /str0ke\r\n+\r\n+-------------------------[ E O F ]----------------------------------\r\n\r\n# milw0rm.com [2006-08-18]",
  "url": "https://www.exploit-db.com/exploits/2216"
}