{
  "id": "570",
  "title": "WordPress Core 1.2 - HTTP Splitting",
  "cve": "CVE-2004-1584",
  "vuln_type": "unknown",
  "code": "#\r\n# This script is (C) Tenable Network Security\r\n#\r\n#\r\n\r\n\r\n\r\n\r\nif(description)\r\n{\r\nscript_id(15443);\r\nscript_bugtraq_id(11348);\r\nscript_version (\"$Revision: 1.1 $\");\r\n\r\nname[\"english\"] = \"WordPress HTTP Splitting Vulnerability\";\r\n\r\nscript_name(english:name[\"english\"]);\r\n\r\ndesc[\"english\"] = \"\r\nThe remote host is running WordPress BLOG, a web blog manager written\r\nin PHP.\r\n\r\nThe remote version of this software is vulnerable to an HTTP-splitting attack \r\nwherein an attacker can insert CR LF characters and then entice an unsuspecting\r\nuser into accessing the URL. The client will parse and possibly act on the \r\nsecondary header which was supplied by the attacker.\r\n\r\nSolution : Upgrade to the latest version of this software\r\nRisk factor : Medium\";\r\n\r\n\r\n\r\n\r\nscript_description(english:desc[\"english\"]);\r\n\r\nsummary[\"english\"] = \"Checks for the presence of WordPress\";\r\n\r\nscript_summary(english:summary[\"english\"]);\r\n\r\nscript_category(ACT_ATTACK);\r\n\r\n\r\nscript_copyright(english:\"This script is Copyright (C) 2004 Tenable Network Security\",\r\nfrancais:\"Ce script est Copyright (C) 2004 Tenable Network Security\");\r\nfamily[\"english\"] = \"CGI abuses\";\r\nfamily[\"francais\"] = \"Abus de CGI\";\r\nscript_family(english:family[\"english\"], francais:family[\"francais\"]);\r\nscript_dependencie(\"http_version.nasl\");\r\nscript_require_ports(\"Services/www\", 80);\r\nexit(0);\r\n}\r\n\r\n#\r\n# The script code starts here\r\n#\r\n\r\n\r\ninclude(\"http_func.inc\");\r\ninclude(\"http_keepalive.inc\");\r\n\r\nport = get_http_port(default:80);\r\n\r\nif(!get_port_state(port))exit(0);\r\nif(!can_host_php(port:port))exit(0);\r\n\r\n\r\n\r\n# The actual attack requires credentials -> do a banner check\r\nfunction check(loc)\r\n{\r\nres = http_keepalive_send_recv(port:port, data:http_get(item:loc + \"/index.php\", port:port));\r\nif ( res == NULL ) exit(0);\r\nres = str_replace(find:'\\n', replace:'', string:res);\r\nres = str_replace(find:'\\r', replace:'', string:res);\r\n\r\nif ( \"WordPress\" >< res && egrep(pattern:'<meta name=\"generator\" content=\"WordPress (0\\\\.|1\\\\.([01]|2\"))', string:res)) { security_warning(port); exit(0); }\r\n}\r\n\r\n\r\n\r\n\r\nforeach dir ( cgi_dirs() )\r\n{\r\ncheck(loc:dir);\r\n}\r\n\r\n\r\n# milw0rm.com [2004-10-10]",
  "url": "https://www.exploit-db.com/exploits/570"
}