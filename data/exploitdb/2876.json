{
  "id": "2876",
  "title": "DZCP (deV!L`z Clanportal) 1.3.6 - Arbitrary File Upload",
  "cve": "CVE-2006-6338",
  "vuln_type": "file_upload",
  "code": "S Y N O P S I S  /\r\n================='\r\n-(  access: remote   severity: high  )-\r\ndeV!L`z Clanportal allows nearly arbitrary files to be uploaded and stored on\r\nthe server's filesystem, which enables anyone, even without a user account, to\r\nupload PHP code and execute it, leading to arbitrary code execution.\r\n\r\n\r\nB A C K G R O U N D  /\r\n====================='\r\ndeV!L`z Clanportal (short \"DZCP\") is a suite of PHP scripts that allow anybody\r\nto create a feature-rich website for her online gaming clan.\r\n\r\n\r\nA F F E C T E D   V E R S I O N S  /\r\n==================================='\r\nverified on:  1.3.6\r\npossibly vulnerable:  <= 1.3.6\r\nfixed in:  1.3.6.1\r\n\r\n\r\nI M P A C T  /\r\n============='\r\nThe attacker can run own code on the web sever with the same privileges as DZCP\r\nitself, enabling her to do almost anything from getting the MySQL password to\r\nhosting own files and scripts or getting a shell on the server.\r\n\r\n\r\nP R E R E Q U I S I T I E S  /\r\n============================='\r\nthe attacker needs a file that is both a valid JPEG or GIF file and valid\r\nPHP (or probably other) code\r\n\r\nA B O U T   T H E   A U T H O R  /\r\n================================='\r\nTim Weber, computer science student at the University of Mannheim, Germany,\r\ncurrently looking for an internship at some IT security or pentesting company,\r\ncan be reached via e-mail: scy-adv-061124b at the host scytale.de.\r\n\r\nP R O O F   O F   C O N C E P T  /\r\n================================='\r\nGet a JPEG file, open it in a hex editor, add some PHP inside the EXIF data or\r\nin similar places.  Make sure PHP's getimagesize() does not return false and\r\nthat the file does not throw parse errors or the like when fed to PHP.  Then:\r\n\r\ncurl -F 'file=@img.php;type=image/jpeg' 'http://<dzcp>/upload/index.php?action=userpic&do=upload'\r\n\r\nThen check http://<dzcp>/inc/images/uploads/userpics/.php\r\n\r\n# milw0rm.com [2006-12-01]",
  "url": "https://www.exploit-db.com/exploits/2876"
}