{
  "id": "3252",
  "title": "EQdkp 1.3.1 - &#039;Referer Spoof&#039; Remote Database Backup",
  "cve": "CVE-2007-0760",
  "vuln_type": "unknown",
  "code": "Title: EQdkp <= 1.3.1 Referer Spoof to access to SQL Database\r\nURL: http://www.eqdkp.com\r\nHook: \"Powered by EQdkp\"\r\nAuthor: Eight10\r\nContact: Eight10@gmail.com\r\n--------------------------------------------------------------------------------------------------------\r\nBackground: EQdkp is the largest DKP tracking program utilized largely by the MMORPG community, specifically\r\nlarge use in the World of Warcraft Community among Guild/clan Websites.\r\n--------------------------------------------------------------------------------------------------------\r\nDiscussion: A Vulnerability exists in all current versions of EQdkp that allows one to\r\nspoof Their refering URL to gain access to an integrated class-1 MySQL Backup/Restore program\r\nwhich allows one to download and modify sensitive SQL data. The script only checks for authentication\r\nvia refering url from the administration control panel. Note some sites have this funcitonality \r\ndisabled/not installed. From the EQdkp_USERS.sql file, the username/email and MD5 Hashed password can be\r\nobtained. From there the password needs to be cracked. \r\n\r\nTested on: 1.3.1 Default install.\r\n\t   1.3.0 Default install.\r\n---------------------------------------------------------------------------------------------------------\r\nExploit:\r\nUse a referer spoofing program, like quickspoof.\r\n\r\nRefering URL - - http://www.sitehere.com/pathtoeqdkp/admin/\r\nTarget URL   - - http://www.sitehere.com/pathtoeqdkp/admin/backup\r\n\r\nFrom the Control menu goto \"Backup MySQL data\" and select the appropraite Database*.\r\nDownload eqdkp_users.sql from there and MD5 Hashes and usernames/emails will be present.\r\nE.g.\r\nVALUES ('1', 'admin', 'ec67739608318602f2dd6bcb141b56bc', 'admin@guildswebsite.com', ......\r\n---------------------------------------------------------------------------------------------------------\r\nAlternative type attack**: \r\nOne downloads the EQDKP_users.sql and modifies the administration hash in there to be \r\n\"5f4dcc3b5aa765d61d8327deb882cf99\"  == password\r\nOne could then restore said Database and login to the EQdkp system as admin.\r\n\r\nAlternate type attack 2**:\r\nOne Downloads the EQDKP_users.sql and modifies the email address to his own. Then one requests\r\na password reset from the \"forgot my password\" page. Then the reset password is emailed to the\r\nnew email address.\r\n----------------------------------------------------------------------------------------------------------\r\n\r\nFuther Discussion: As we know people tend to use the same passwords in multiple places, especially when\r\nthe topics are related, for instance WoW account information and WoW clan websites. Along with similiar \r\npasses often used for the email address, which one can retrieve account names from the blizzards site.\r\nNote, when cracking, the requirements for WoW passwords, I believe it is atleast 8 characters long containing\r\nboth numbers and letters. These can be difficult hashes to break but when the passwords are weak dictionary words\r\nsimply followed by numbers, a good amount of success can be achieved. This method is especially good when\r\nyou already have appropriately generated rainbow tables, or hashes can be sent to online hash crackers.\r\n\r\n*Note Other databases can be obtained using this SQL backup tool too! Such as PHPBB databases.\r\n**(Note Sometimes Permission settings prevent SQL restores)\r\n\r\nShout Out:\r\nRichyPoo (Calrich AKA Faglord). Throhg (pwnt). BrowerPower. Bliznat(ty)\r\n _______ _________ _______          _________ __    _______ \r\n(  ____ \\\\__   __/(  ____ \\|\\     /|\\__   __//  \\  (  __   )\r\n| (    \\/   ) (   | (    \\/| )   ( |   ) (   \\/) ) | (  )  |\r\n| (__       | |   | |      | (___) |   | |     | | | | /   |\r\n|  __)      | |   | | ____ |  ___  |   | |     | | | (/ /) |\r\n| (         | |   | | \\_  )| (   ) |   | |     | | |   / | |\r\n| (____/\\___) (___| (___) || )   ( |   | |   __) (_|  (__) |\r\n(_______/\\_______/(_______)|/     \\|   )_(   \\____/(_______)\r\n\r\n# milw0rm.com [2007-02-02]",
  "url": "https://www.exploit-db.com/exploits/3252"
}