{
  "id": "3729",
  "title": "Quick and Dirty Blog (qdblog) 0.4 - SQL Injection / Local File Inclusion",
  "cve": "CVE-2007-2305",
  "vuln_type": "sqli",
  "code": "  .      .        .  \r\n._ | _.  .|_  _. _.;_/\r\n[_)|(_]\\_|[ )(_](_.| \\.net\r\n|      ._|            \r\n\"QDBlog v0.4 - MULTIPLE VULNERABILITIES\"\r\n\tby Omni\r\n\r\n1) Infos\r\n---------\r\nDate            : 2007-04-12\r\nProduct         : QDBlog\r\nVersion         : v0.4 - Prior version maybe also be affected\r\nVendor          : http://sourceforge.net/projects/qdblog/\r\nVendor Status   : 2007-04-12 -> Not Informed!\r\n\r\nDescription     : QDBlog is an open-source, simple, minimalistic blogging solution. It makes use of PHP and MySQL. It is\r\n                  tiny (goal size is <50kb), and flexible. It designed to be based around choice. However it is\r\n                  more targeted toward the adept user/web master.\r\n\r\nSource          : omnipresent - omni\r\nE-mail          : omnipresent[at]email[dot]it - omni[at]playhack[dot]net\r\nTeam            : Playhack.net Security\r\n\r\n2) Security Issues\r\n-------------------\r\n\r\n--- [ SQL Injection - Admin Access Bypass ] ---\r\n===============================================\r\n\r\n[ authenticate.php Script - Line 7 - 9 ]\r\n\r\n$sql = \"SELECT permissions, username FROM $prefix\".\"auth WHERE username = '\" . $_POST['username'] . \"' AND password =\r\nMD5('\".$_POST['wordpass'].\"');\";\r\n\r\n\t$query = mysql_query($sql, $conn);\r\n\r\n[ end script aithenticate.php ]\r\n\r\nAs we can see the variables passed with POST method from login.php to authenticate.php (username and password) are not\r\nproperly sanitized before being used, so an attacker can inject SQL code and gain access to the administration pannel.\r\n\r\n--- [ PoC ] ---\r\n===============\r\n\r\nPut in the username field (in login.php) a code like 1' OR '1' = '1' # and in the password filed what you want.\r\nClick.. login and.. have fun :D  \r\n\r\n--- [ Local File Inclusion ] ---\r\n================================\r\n\r\nThere are some security problem, concerning Local File Inclusion, in lots of files of this PHP Blog; for example in\r\nindex.php as shown below:\r\n\r\n[ categories.php script - Line 2 ]\r\n\r\ninclude(\"themes/$theme/cat_top.php\");\r\n\r\n[ end index.php script ]\r\n\r\n$theme is not properly sanitized before being used so an attacker can include other files for eg /etc/passwd.\r\n\r\n--- [ PoC ] ---\r\n===============\r\n\r\nhttp://remote_host/qdblog/categories.php?theme=../../../../../../../etc/passwd%00\r\n\r\n\r\nTake again a look to categories.php:\r\n  \r\nin this file there is \"an other vulnerability\", File Traversal:\r\n \r\n   Line 3 : $file1 = fopen(\"themes/$theme/cat_mid.html\", \"r\");\r\n\r\n\r\n\r\n---- [ Patch ] ----\r\n\r\nEdit the source code to ensure that the input is validated.\r\n\r\n# milw0rm.com [2007-04-13]",
  "url": "https://www.exploit-db.com/exploits/3729"
}