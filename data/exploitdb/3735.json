{
  "id": "3735",
  "title": "LS Simple Guestbook 1.0 - Remote Code Execution",
  "cve": "CVE-2007-2093",
  "vuln_type": "rce",
  "code": "########################################################\r\n#   Special Greetings To - Timq,Warpboy,The-Maggot     #\r\n########################################################\r\n\r\nFile: index.php\r\nAffects: LS simple guestbook (v1)\r\nDate: 15th April 2007\r\n\r\nIssue Description:\r\n===========================================================================\r\nLS simple guestbook fails to sanitize user input that it writes to the\r\nposts.txt file when the user leaves a message, this file is then included\r\ncausing any php code within it to be run.\r\n===========================================================================\r\n\r\nScope:\r\n===========================================================================\r\nAn attacker can inject arbitrary php code and potentially execute commands\r\non the system.\r\n===========================================================================\r\n\r\nRecommendation:\r\n===========================================================================\r\nAdd the following line of code in index.php:\r\n\r\n$message = strip_tags($message);\r\n\r\njust above:\r\n\r\nif ($message != \"\") {$file = fopen(\"$dataf\",\"a\");\r\n===========================================================================\r\n\r\n\r\nExample:\r\n\r\nname = Test\r\nmessage = <?php phpinfo(); ?>\r\n\r\n\r\nDiscovered By: Gammarays\r\n\r\n# milw0rm.com [2007-04-14]",
  "url": "https://www.exploit-db.com/exploits/3735"
}