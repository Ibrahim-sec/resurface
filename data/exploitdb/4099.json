{
  "id": "4099",
  "title": "e107 &lt; 0.7.8 - &#039;photograph&#039; Arbitrary File Upload",
  "cve": "CVE-2007-3429",
  "vuln_type": "rce",
  "code": "###############################################################################################\r\n#         ___   ___                         _\r\n#        / _ \\ / _ \\                       | |\r\n#   __ _| | | | | | |_ __  ___   _ __   ___| |_\r\n#  / _` | | | | | | | '_ \\/ __| | '_ \\ / _ \\ __|\r\n# | (_| | |_| | |_| | | | \\__ \\_| | | |  __/ |_\r\n#  \\__, |\\___/ \\___/|_| |_|___(_)_| |_|\\___|\\__|\r\n#   __/ |\r\n#  |___/\r\n###############################################################################################\r\n#INFO:\r\n#Program Title ################################################################################\r\n#e107 <= 0.7.8 - Arbitrary File Upload\r\n#\r\n#Description ##################################################################################\r\n#\"e107 is a content management system written in PHP and using the popular open source MySQL \r\n#database system for content storage. It's completely free, totally customisable and in \r\n#constant development\" - e107.org\r\n#\r\n#Script Download ##############################################################################\r\n#http://e107.org/edownload.php\r\n#\r\n#Original Advisory ############################################################################\r\n#http://www.g00ns-forum.net/showthread.php?t=9388\r\n#\r\n#Vuln #########################################################################################\r\n#vuln discovered by clorox\r\n#shoutz: z3r0, milf, blackhill, godxcel, murderskillz, kirby, katalyst, SyNiCaL, OD, pr0be, rezen, str0ke,\r\n#fish, rey, canuck, ,vipsta, c0ma, grumpy, sick, trin, asdfhacks.com , a59, freeillwill.com, seven, tower, fury, \r\n#SS, <S>, Bernard, rst.void.ru, awesome andrew, and everyone else at g00ns.net\r\n#\r\n#Details ######################################################################################                         \r\n#note: e107 is only vulnerable if it allows you to upload a photograph, avatars will not work.#\r\n#to enable this an admin has to manually the settings in change e107_admin/users.php?options  #\r\n###############################################################################################\r\n#signup.php does not verify that a file submitted as an image is actually an image. it controls files uploaded\r\n#only by the extension. files with a .php extension are blocked, but you can simply rename a php document to\r\n#document.php.jpg and it passes the image verification and is uploaded.  to get the path of the file you uploaded\r\n#you view your profile, view the source of the page and search for the name of the file and it will be there with \r\n#a few random numbers in it, and now all an attacker would have to do is simply call the evil script up and the\r\n#server has been compromised.\r\n#GoogleDork: \"Please note: Any image uploaded to this server that is deemed inappropriate by the administrators will be deleted immediately.\"\r\n#\r\n################################################################################################\r\n\r\n# milw0rm.com [2007-06-24]",
  "url": "https://www.exploit-db.com/exploits/4099"
}